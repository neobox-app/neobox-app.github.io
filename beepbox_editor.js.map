{"version":3,"file":"beepbox_editor.js","sources":["../synth/FFT.ts","../synth/SynthConfig.ts","../node_modules/imperative-html/src/elements-base.ts","../node_modules/imperative-html/src/elements-strict.ts","../synth/usefulFunctions.ts","../synth/song.ts","../editor/Change.ts","../editor/changes.ts","../editor/ColorConfig.ts","../editor/PatternEditor.ts","../editor/TrackEditor.ts","../editor/LoopEditor.ts","../editor/BarScrollBar.ts","../editor/OctaveScrollBar.ts","../editor/Piano.ts","../editor/MixPrompt.ts","../editor/ChorusPrompt.ts","../synth/synth.ts","../editor/ExportPrompt.ts","../editor/ImportPrompt.ts","../editor/ArchivePrompt.ts","../editor/SongDataPrompt.ts","../editor/RefreshKeyPrompt.ts","../editor/SongDurationPrompt.ts","../editor/InstrumentTypePrompt.ts","../editor/ThemePrompt.ts","../editor/SongThemePrompt.ts","../editor/Layout.ts","../editor/LayoutPrompt.ts","../editor/SongEditor.ts","../editor/ChangeNotifier.ts","../editor/Selection.ts","../editor/Preferences.ts","../editor/SongDocument.ts","../editor/style.ts","../editor/main.ts"],"sourcesContent":["/*\r\nCopyright (C) 2018 John Nesky\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\n\r\n\t// interface shared by number[], Float32Array, and other typed arrays in JavaScript.\r\n\tinterface NumberArray {\r\n\t\tlength: number;\r\n\t\t[index: number]: number;\r\n\t}\r\n\t\r\n\t// A basic FFT operation scales the overall magnitude of elements by the\r\n\t// square root of the length of the array, ‚àöN. Performing a forward FFT and\r\n\t// then an inverse FFT results in the original array, but multiplied by N.\r\n\t// This helper function can be used to compensate for that. \r\n\texport function scaleElementsByFactor(array: NumberArray, factor: number): void {\r\n\t\tfor (let i: number = 0; i < array.length; i++) {\r\n\t\t\tarray[i] *= factor;\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction isPowerOf2(n: number): boolean {\r\n\t\treturn !!n && !(n & (n - 1));\r\n\t}\r\n\t\r\n\tfunction countBits(n: number): number {\r\n\t\tif (!isPowerOf2(n)) throw new Error(\"FFT array length must be a power of 2.\");\r\n\t\treturn Math.round(Math.log(n) / Math.log(2));\r\n\t}\r\n\t\r\n\t// Rearranges the elements of the array, swapping the element at an index\r\n\t// with an element at an index that is the bitwise reverse of the first\r\n\t// index in base 2. Useful for computing the FFT.\r\n\tfunction reverseIndexBits(array: NumberArray): void {\r\n\t\tconst fullArrayLength: number = array.length;\r\n\t\tconst bitCount: number = countBits(fullArrayLength);\r\n\t\tif (bitCount > 16) throw new Error(\"FFT array length must not be greater than 2^16.\");\r\n\t\tconst finalShift: number = 16 - bitCount;\r\n\t\tfor (let i: number = 0; i < fullArrayLength; i++) {\r\n\t\t\t// Dear Javascript: Please support bit order reversal intrinsics. Thanks! :D\r\n\t\t\tlet j: number;\r\n\t\t\tj = ((i & 0xaaaa) >> 1) | ((i & 0x5555) << 1);\r\n\t\t\tj = ((j & 0xcccc) >> 2) | ((j & 0x3333) << 2);\r\n\t\t\tj = ((j & 0xf0f0) >> 4) | ((j & 0x0f0f) << 4);\r\n\t\t\tj = ((j           >> 8) | ((j &   0xff) << 8)) >> finalShift;\r\n\t\t\tif (j > i) {\r\n\t\t\t\tlet temp: number = array[i];\r\n\t\t\t\tarray[i] = array[j];\r\n\t\t\t\tarray[j] = temp;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/* Commented out functions that BeepBox doesn't use...\r\n\t\r\n\t// Provided for educational purposes. Easier to read than\r\n\t// fastFourierTransform(), but computes the same result.\r\n\t// Takes two parallel arrays representing the real and imaginary elements,\r\n\t// respectively, and returns an array containing two new arrays, which\r\n\t// contain the complex result of the transform.\r\n\texport function discreteFourierTransform(realArray: NumberArray, imagArray: NumberArray): number[][] {\r\n\t\tconst fullArrayLength: number = realArray.length;\r\n\t\tif (fullArrayLength != imagArray.length) throw new Error(\"FFT arrays must be the same length.\");\r\n\t\tconst realOut: number[] = [];\r\n\t\tconst imagOut: number[] = [];\r\n\t\tfor (let i: number = 0; i < fullArrayLength; i++) {\r\n\t\t\trealOut[i] = 0.0;\r\n\t\t\timagOut[i] = 0.0;\r\n\t\t\tfor (let j: number = 0; j < fullArrayLength; j++) {\r\n\t\t\t\tconst radians: number = -6.2831853 * j * i / fullArrayLength;\r\n\t\t\t\tconst c: number = Math.cos(radians);\r\n\t\t\t\tconst s: number = Math.sin(radians);\r\n\t\t\t\trealOut[i] += realArray[j] * c - imagArray[j] * s;\r\n\t\t\t\timagOut[i] += realArray[j] * s + imagArray[j] * c;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn [realOut, imagOut];\r\n\t}\r\n\t\r\n\t// Performs a Fourier transform in O(N log(N)) operations. Overwrites the\r\n\t// input real and imaginary arrays. Can be used for both forward and inverse\r\n\t// transforms: swap the order of the arguments for the inverse.\r\n\texport function fastFourierTransform(realArray: NumberArray, imagArray: NumberArray): void {\r\n\t\tconst fullArrayLength: number = realArray.length;\r\n\t\tif (!isPowerOf2(fullArrayLength)) throw new Error(\"FFT array length must be a power of 2.\");\r\n\t\tif (fullArrayLength < 4) throw new Error(\"FFT array length must be at least 4.\");\r\n\t\tif (fullArrayLength != imagArray.length) throw new Error(\"FFT arrays must be the same length.\");\r\n\t\t\r\n\t\treverseIndexBits(realArray);\r\n\t\treverseIndexBits(imagArray);\r\n\t\t\r\n\t\t// First two passes, with strides of 2 and 4, can be combined and optimized.\r\n\t\tfor (let startIndex: number = 0; startIndex < fullArrayLength; startIndex += 4) {\r\n\t\t\tconst startIndex1: number = startIndex + 1;\r\n\t\t\tconst startIndex2: number = startIndex + 2;\r\n\t\t\tconst startIndex3: number = startIndex + 3;\r\n\t\t\tconst real0: number = realArray[startIndex ];\r\n\t\t\tconst real1: number = realArray[startIndex1];\r\n\t\t\tconst real2: number = realArray[startIndex2];\r\n\t\t\tconst real3: number = realArray[startIndex3];\r\n\t\t\tconst imag0: number = imagArray[startIndex ];\r\n\t\t\tconst imag1: number = imagArray[startIndex1];\r\n\t\t\tconst imag2: number = imagArray[startIndex2];\r\n\t\t\tconst imag3: number = imagArray[startIndex3];\r\n\t\t\tconst realTemp0: number = real0 + real1;\r\n\t\t\tconst realTemp1: number = real0 - real1;\r\n\t\t\tconst realTemp2: number = real2 + real3;\r\n\t\t\tconst realTemp3: number = real2 - real3;\r\n\t\t\tconst imagTemp0: number = imag0 + imag1;\r\n\t\t\tconst imagTemp1: number = imag0 - imag1;\r\n\t\t\tconst imagTemp2: number = imag2 + imag3;\r\n\t\t\tconst imagTemp3: number = imag2 - imag3;\r\n\t\t\trealArray[startIndex ] = realTemp0 + realTemp2;\r\n\t\t\trealArray[startIndex1] = realTemp1 + imagTemp3;\r\n\t\t\trealArray[startIndex2] = realTemp0 - realTemp2;\r\n\t\t\trealArray[startIndex3] = realTemp1 - imagTemp3;\r\n\t\t\timagArray[startIndex ] = imagTemp0 + imagTemp2;\r\n\t\t\timagArray[startIndex1] = imagTemp1 - realTemp3;\r\n\t\t\timagArray[startIndex2] = imagTemp0 - imagTemp2;\r\n\t\t\timagArray[startIndex3] = imagTemp1 + realTemp3;\r\n\t\t}\r\n\t\t\r\n\t\tfor (let stride: number = 8; stride <= fullArrayLength; stride += stride) {\r\n\t\t\tconst halfLength: number = stride >>> 1;\r\n\t\t\tconst radiansIncrement: number = Math.PI * 2.0 / stride;\r\n\t\t\tconst cosIncrement: number = Math.cos(radiansIncrement);\r\n\t\t\tconst sinIncrement: number = Math.sin(radiansIncrement);\r\n\t\t\tconst oscillatorMultiplier: number = 2.0 * cosIncrement;\r\n\t\t\tfor (let startIndex: number = 0; startIndex < fullArrayLength; startIndex += stride) {\r\n\t\t\t\tlet c: number = 1.0;\r\n\t\t\t\tlet s: number = 0.0;\r\n\t\t\t\tlet cPrev: number = cosIncrement;\r\n\t\t\t\tlet sPrev: number = sinIncrement;\r\n\t\t\t\tconst secondHalf: number = startIndex + halfLength;\r\n\t\t\t\tfor (let i: number = startIndex; i < secondHalf; i++) {\r\n\t\t\t\t\tconst j: number = i + halfLength;\r\n\t\t\t\t\tconst real0: number = realArray[i];\r\n\t\t\t\t\tconst imag0: number = imagArray[i];\r\n\t\t\t\t\tconst real1: number = realArray[j] * c - imagArray[j] * s;\r\n\t\t\t\t\tconst imag1: number = realArray[j] * s + imagArray[j] * c;\r\n\t\t\t\t\trealArray[i] = real0 + real1;\r\n\t\t\t\t\timagArray[i] = imag0 + imag1;\r\n\t\t\t\t\trealArray[j] = real0 - real1;\r\n\t\t\t\t\timagArray[j] = imag0 - imag1;\r\n\t\t\t\t\tconst cTemp: number = oscillatorMultiplier * c - cPrev;\r\n\t\t\t\t\tconst sTemp: number = oscillatorMultiplier * s - sPrev;\r\n\t\t\t\t\tcPrev = c;\r\n\t\t\t\t\tsPrev = s;\r\n\t\t\t\t\tc = cTemp;\r\n\t\t\t\t\ts = sTemp;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t// Computes the Fourier transform from an array of real-valued time-domain\r\n\t// samples. The output is specially formatted for space efficieny: elements\r\n\t// 0 through N/2 represent cosine wave amplitudes in ascending frequency,\r\n\t// and elements N/2+1 through N-1 represent sine wave amplitudes in\r\n\t// descending frequency. Overwrites the input array.\r\n\texport function forwardRealFourierTransform(array: NumberArray): void {\r\n\t\tconst fullArrayLength: number = array.length;\r\n\t\tconst totalPasses: number = countBits(fullArrayLength);\r\n\t\tif (fullArrayLength < 4) throw new Error(\"FFT array length must be at least 4.\");\r\n\t\t\r\n\t\treverseIndexBits(array);\r\n\t\t\r\n\t\t// First and second pass.\r\n\t\tfor (let index: number = 0; index < fullArrayLength; index += 4) {\r\n\t\t\tconst index1: number = index + 1;\r\n\t\t\tconst index2: number = index + 2;\r\n\t\t\tconst index3: number = index + 3;\r\n\t\t\tconst real0: number = array[index ];\r\n\t\t\tconst real1: number = array[index1];\r\n\t\t\tconst real2: number = array[index2];\r\n\t\t\tconst real3: number = array[index3];\r\n\t\t\t// no imaginary elements yet since the input is fully real.\r\n\t\t\tconst tempA: number = real0 + real1;\r\n\t\t\tconst tempB: number = real2 + real3;\r\n\t\t\tarray[index ] = tempA + tempB;\r\n\t\t\tarray[index1] = real0 - real1;\r\n\t\t\tarray[index2] = tempA - tempB;\r\n\t\t\tarray[index3] = real2 - real3;\r\n\t\t}\r\n\t\t\r\n\t\t// Third pass.\r\n\t\tconst sqrt2over2: number = Math.sqrt(2.0) / 2.0;\r\n\t\tfor (let index: number = 0; index < fullArrayLength; index += 8) {\r\n\t\t\tconst index1: number = index + 1;\r\n\t\t\tconst index3: number = index + 3;\r\n\t\t\tconst index4: number = index + 4;\r\n\t\t\tconst index5: number = index + 5;\r\n\t\t\tconst index7: number = index + 7;\r\n\t\t\tconst real0: number = array[index ];\r\n\t\t\tconst real1: number = array[index1];\r\n\t\t\tconst imag3: number = array[index3];\r\n\t\t\tconst real4: number = array[index4];\r\n\t\t\tconst real5: number = array[index5];\r\n\t\t\tconst imag7: number = array[index7];\r\n\t\t\tconst tempA: number = (real5 - imag7) * sqrt2over2;\r\n\t\t\tconst tempB: number = (real5 + imag7) * sqrt2over2;\r\n\t\t\tarray[index ] = real0 + real4;\r\n\t\t\tarray[index1] = real1 + tempA;\r\n\t\t\tarray[index3] = real1 - tempA;\r\n\t\t\tarray[index4] = real0 - real4;\r\n\t\t\tarray[index5] = tempB - imag3;\r\n\t\t\tarray[index7] = tempB + imag3;\r\n\t\t}\r\n\t\t\r\n\t\t// Handle remaining passes.\r\n\t\tfor (let pass: number = 3; pass < totalPasses; pass++) {\r\n\t\t\tconst subStride: number = 1 << pass;\r\n\t\t\tconst midSubStride: number = subStride >> 1;\r\n\t\t\tconst stride: number = subStride << 1;\r\n\t\t\tconst radiansIncrement: number = Math.PI * 2.0 / stride;\r\n\t\t\tconst cosIncrement: number = Math.cos(radiansIncrement);\r\n\t\t\tconst sinIncrement: number = Math.sin(radiansIncrement);\r\n\t\t\tconst oscillatorMultiplier: number = 2.0 * cosIncrement;\r\n\t\t\tfor (let startIndex: number = 0; startIndex < fullArrayLength; startIndex += stride) {\r\n\t\t\t\tconst startIndexA: number = startIndex;\r\n\t\t\t\tconst startIndexB: number = startIndexA + subStride;\r\n\t\t\t\tconst stopIndex: number = startIndexB + subStride;\r\n\t\t\t\tconst realStartA: number = array[startIndexA];\r\n\t\t\t\tconst realStartB: number = array[startIndexB];\r\n\t\t\t\tarray[startIndexA] = realStartA + realStartB;\r\n\t\t\t\tarray[startIndexB] = realStartA - realStartB;\r\n\t\t\t\tlet c: number = cosIncrement;\r\n\t\t\t\tlet s: number = -sinIncrement;\r\n\t\t\t\tlet cPrev: number = 1.0;\r\n\t\t\t\tlet sPrev: number = 0.0;\r\n\t\t\t\tfor (let index: number = 1; index < midSubStride; index++) {\r\n\t\t\t\t\tconst indexA0: number = startIndexA + index;\r\n\t\t\t\t\tconst indexA1: number = startIndexB - index;\r\n\t\t\t\t\tconst indexB0: number = startIndexB + index;\r\n\t\t\t\t\tconst indexB1: number = stopIndex   - index;\r\n\t\t\t\t\tconst real0: number = array[indexA0];\r\n\t\t\t\t\tconst imag0: number = array[indexA1];\r\n\t\t\t\t\tconst real1: number = array[indexB0];\r\n\t\t\t\t\tconst imag1: number = array[indexB1];\r\n\t\t\t\t\tconst tempA: number = real1 * c + imag1 * s;\r\n\t\t\t\t\tconst tempB: number = real1 * s - imag1 * c;\r\n\t\t\t\t\tarray[indexA0] = real0 + tempA;\r\n\t\t\t\t\tarray[indexA1] = real0 - tempA;\r\n\t\t\t\t\tarray[indexB0] =-imag0 - tempB;\r\n\t\t\t\t\tarray[indexB1] = imag0 - tempB;\r\n\t\t\t\t\tconst cTemp: number = oscillatorMultiplier * c - cPrev;\r\n\t\t\t\t\tconst sTemp: number = oscillatorMultiplier * s - sPrev;\r\n\t\t\t\t\tcPrev = c;\r\n\t\t\t\t\tsPrev = s;\r\n\t\t\t\t\tc = cTemp;\r\n\t\t\t\t\ts = sTemp;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t*/\r\n\t\r\n\t// Computes the inverse Fourier transform from a specially formatted array of\r\n\t// scalar values. Elements 0 through N/2 are expected to be the real values of\r\n\t// the corresponding complex elements, representing cosine wave amplitudes in\r\n\t// ascending frequency, and elements N/2+1 through N-1 correspond to the\r\n\t// imaginary values, representing sine wave amplitudes in descending frequency.\r\n\t// Generates real-valued time-domain samples. Overwrites the input array.\r\n\texport function inverseRealFourierTransform(array: NumberArray): void {\r\n\t\tconst fullArrayLength: number = array.length;\r\n\t\tconst totalPasses: number = countBits(fullArrayLength);\r\n\t\tif (fullArrayLength < 4) throw new Error(\"FFT array length must be at least 4.\");\r\n\t\r\n\t\t// Perform all but the last few passes in reverse.\r\n\t\tfor (let pass: number = totalPasses - 1; pass >= 2; pass--) {\r\n\t\t\tconst subStride: number = 1 << pass;\r\n\t\t\tconst midSubStride: number = subStride >> 1;\r\n\t\t\tconst stride: number = subStride << 1;\r\n\t\t\tconst radiansIncrement: number = Math.PI * 2.0 / stride;\r\n\t\t\tconst cosIncrement: number = Math.cos(radiansIncrement);\r\n\t\t\tconst sinIncrement: number = Math.sin(radiansIncrement);\r\n\t\t\tconst oscillatorMultiplier: number = 2.0 * cosIncrement;\r\n\t\t\t\r\n\t\t\tfor (let startIndex: number = 0; startIndex < fullArrayLength; startIndex += stride) {\r\n\t\t\t\tconst startIndexA: number = startIndex;\r\n\t\t\t\tconst midIndexA: number = startIndexA + midSubStride;\r\n\t\t\t\tconst startIndexB: number = startIndexA + subStride;\r\n\t\t\t\tconst midIndexB: number = startIndexB + midSubStride;\r\n\t\t\t\tconst stopIndex: number = startIndexB + subStride;\r\n\t\t\t\tconst realStartA: number = array[startIndexA];\r\n\t\t\t\tconst imagStartB: number = array[startIndexB];\r\n\t\t\t\tarray[startIndexA] = realStartA + imagStartB;\r\n\t\t\t\tarray[midIndexA] *= 2;\r\n\t\t\t\tarray[startIndexB] = realStartA - imagStartB;\r\n\t\t\t\tarray[midIndexB] *= 2;\r\n\t\t\t\tlet c: number = cosIncrement;\r\n\t\t\t\tlet s: number = -sinIncrement;\r\n\t\t\t\tlet cPrev: number = 1.0;\r\n\t\t\t\tlet sPrev: number = 0.0;\r\n\t\t\t\tfor (let index: number = 1; index < midSubStride; index++) {\r\n\t\t\t\t\tconst indexA0: number = startIndexA + index;\r\n\t\t\t\t\tconst indexA1: number = startIndexB - index;\r\n\t\t\t\t\tconst indexB0: number = startIndexB + index;\r\n\t\t\t\t\tconst indexB1: number = stopIndex   - index;\r\n\t\t\t\t\tconst real0: number = array[indexA0];\r\n\t\t\t\t\tconst real1: number = array[indexA1];\r\n\t\t\t\t\tconst imag0: number = array[indexB0];\r\n\t\t\t\t\tconst imag1: number = array[indexB1];\r\n\t\t\t\t\tconst tempA: number = real0 - real1;\r\n\t\t\t\t\tconst tempB: number = imag0 + imag1;\r\n\t\t\t\t\tarray[indexA0] = real0 + real1;\r\n\t\t\t\t\tarray[indexA1] = imag1 - imag0;\r\n\t\t\t\t\tarray[indexB0] = tempA * c - tempB * s;\r\n\t\t\t\t\tarray[indexB1] = tempB * c + tempA * s;\r\n\t\t\t\t\tconst cTemp: number = oscillatorMultiplier * c - cPrev;\r\n\t\t\t\t\tconst sTemp: number = oscillatorMultiplier * s - sPrev;\r\n\t\t\t\t\tcPrev = c;\r\n\t\t\t\t\tsPrev = s;\r\n\t\t\t\t\tc = cTemp;\r\n\t\t\t\t\ts = sTemp;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t/*\r\n\t\t// Commented out this block (and compensated with an extra pass above)\r\n\t\t// because it's slower in my testing so far.\r\n\t\t// Pass with stride 8.\r\n\t\tconst sqrt2over2: number = Math.sqrt(2.0) / 2.0;\r\n\t\tfor (let index: number = 0; index < fullArrayLength; index += 8) {\r\n\t\t\tconst index1: number = index + 1;\r\n\t\t\tconst index2: number = index + 2;\r\n\t\t\tconst index3: number = index + 3;\r\n\t\t\tconst index4: number = index + 4;\r\n\t\t\tconst index5: number = index + 5;\r\n\t\t\tconst index6: number = index + 6;\r\n\t\t\tconst index7: number = index + 7;\r\n\t\t\tconst real0: number = array[index ];\r\n\t\t\tconst real1: number = array[index1];\r\n\t\t\tconst real2: number = array[index2];\r\n\t\t\tconst real3: number = array[index3];\r\n\t\t\tconst imag4: number = array[index4];\r\n\t\t\tconst imag5: number = array[index5];\r\n\t\t\tconst imag6: number = array[index6];\r\n\t\t\tconst imag7: number = array[index7];\r\n\t\t\tconst tempA: number = real1 - real3;\r\n\t\t\tconst tempB: number = imag5 + imag7;\r\n\t\t\tarray[index ] = real0 + imag4;\r\n\t\t\tarray[index1] = real1 + real3;\r\n\t\t\tarray[index2] = real2 * 2;\r\n\t\t\tarray[index3] = imag7 - imag5;\r\n\t\t\tarray[index4] = real0 - imag4;\r\n\t\t\tarray[index5] = (tempA + tempB) * sqrt2over2;\r\n\t\t\tarray[index6] = imag6 * 2;\r\n\t\t\tarray[index7] = (tempB - tempA) * sqrt2over2;\r\n\t\t}\r\n\t\t*/\r\n\t\t// The final passes with strides 4 and 2, combined into one loop.\r\n\t\tfor (let index: number = 0; index < fullArrayLength; index += 4) {\r\n\t\t\tconst index1: number = index + 1;\r\n\t\t\tconst index2: number = index + 2;\r\n\t\t\tconst index3: number = index + 3;\r\n\t\t\tconst real0: number = array[index ];\r\n\t\t\tconst real1: number = array[index1] * 2;\r\n\t\t\tconst imag2: number = array[index2];\r\n\t\t\tconst imag3: number = array[index3] * 2;\r\n\t\t\tconst tempA: number = real0 + imag2;\r\n\t\t\tconst tempB: number = real0 - imag2;\r\n\t\t\tarray[index ] = tempA + real1;\r\n\t\t\tarray[index1] = tempA - real1;\r\n\t\t\tarray[index2] = tempB + imag3;\r\n\t\t\tarray[index3] = tempB - imag3;\r\n\t\t}\r\n\t\t\r\n\t\treverseIndexBits(array);\r\n\t}\r\n\r\n","/*!\r\nCopyright (c) 2012-2022 John Nesky and contributing authors\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\nimport { inverseRealFourierTransform, scaleElementsByFactor } from \"./FFT\";\r\n\r\nexport interface Dictionary<T> {\r\n\t[K: string]: T;\r\n}\r\n\r\nexport interface DictionaryArray<T> extends ReadonlyArray<T> {\r\n\tdictionary: Dictionary<T>;\r\n}\r\n\r\nexport interface BeepBoxOption {\r\n\treadonly index: number;\r\n\treadonly name: string;\r\n}\r\n\r\nexport const enum EnvelopeType {\r\n\tcustom,\r\n\tsteady,\r\n\tpunch,\r\n\tflare,\r\n\tpluck,\r\n\ttremolo,\r\n\tflute,\r\n}\r\n\r\nexport const enum InstrumentType {\r\n\tchip = 0,\r\n\tfm = 1,\r\n\tnoise = 2,\r\n\tpwm = 3,\r\n}\r\n\r\nexport interface Scale extends BeepBoxOption {\r\n\treadonly flags: ReadonlyArray<boolean>;\r\n\treadonly realName: string;\r\n}\r\n\r\nexport interface Key extends BeepBoxOption {\r\n\treadonly isWhiteKey: boolean;\r\n\treadonly basePitch: number;\r\n}\r\n\r\nexport class Config {\r\n\tpublic static readonly scales: DictionaryArray<Scale> = toNameMap([\r\n\t\t{name: \"easy :)\",            realName: \"pentatonic major\",      flags: [true, false,  true, false,  true, false, false,  true, false,  true, false, false]},\r\n\t\t{name: \"easy :(\",            realName: \"pentatonic minor\",      flags: [true, false, false,  true, false,  true, false,  true, false, false,  true, false]},\r\n\t\t{name: \"island :)\",          realName: \"ryukyu\",                flags: [true, false, false, false,  true,  true, false,  true, false, false, false,  true]},\r\n\t\t{name: \"island :(\",          realName: \"pelog selisir\",         flags: [true,  true, false,  true, false, false, false,  true,  true, false, false, false]},\r\n\t\t{name: \"blues :)\",           realName: \"blues major\",           flags: [true, false,  true,  true,  true, false, false,  true, false,  true, false, false]},\r\n\t\t{name: \"blues :(\",           realName: \"blues\",                 flags: [true, false, false,  true, false,  true,  true,  true, false, false,  true, false]},\r\n\t\t{name: \"normal :)\",          realName: \"ionian\",                flags: [true, false,  true, false,  true,  true, false,  true, false,  true, false,  true]},\r\n\t\t{name: \"normal :(\",          realName: \"aeolian\",               flags: [true, false,  true,  true, false,  true, false,  true,  true, false,  true, false]},\r\n\t\t{name: \"dbl harmonic :)\", \t realName: \"double harmonic major\", flags: [true,  true, false, false,  true,  true, false,  true,  true, false, false,  true]},\r\n\t\t{name: \"dbl harmonic :(\",    realName: \"double harmonic minor\", flags: [true, false,  true,  true, false, false,  true,  true,  true, false, false,  true]},\r\n\t\t{name: \"enigma\",             realName: \"whole tone\",            flags: [true, false,  true, false,  true, false,  true, false,  true, false,  true, false]},\r\n\t\t{name: \"expert\",             realName: \"chromatic\",             flags: [true,  true,  true,  true,  true,  true,  true,  true,  true,  true,  true,  true]},\r\n\t\t{name: \"monotonic\",          realName: \"monotonic\",             flags: [true, false, false, false, false, false, false, false, false, false, false, false]},\r\n\t\t{name: \"no dabbing\",         realName: \"no dabbing\",            flags: [true,  true, false,  true,  true,  true,  true,  true,  true, false,  true, false]},\r\n\t]);\r\n\tstatic readonly blackKeyNameParents: ReadonlyArray<number> = [-1, 1, -1, 1, -1, 1, -1, -1, 1, -1, 1, -1];\r\n\tstatic readonly pitchNames: ReadonlyArray<string | null> = [\"C\", null, \"D\", null, \"E\", \"F\", null, \"G\", null, \"A\", null, \"B\"];\r\n\tpublic static readonly oldKeys: ReadonlyArray<string | null> = [\"B\", \"A‚ôØ\", \"A\", \"G‚ôØ\", \"F‚ôØ\", \"F\", \"E\", \"D‚ôØ\", \"D\", \"C‚ôØ\", \"C\"];\r\n\tpublic static readonly keys: DictionaryArray<Key> = toNameMap([\r\n\t\t{name: \"C\",  isWhiteKey:  true, basePitch: 12}, // C0 has index 12 on the MIDI scale. C7 is 96, and C9 is 120. C10 is barely in the audible range.\r\n\t\t{name: \"C‚ôØ\", isWhiteKey: false, basePitch: 13},\r\n\t\t{name: \"D\",  isWhiteKey:  true, basePitch: 14},\r\n\t\t{name: \"D‚ôØ\", isWhiteKey: false, basePitch: 15},\r\n\t\t{name: \"E\",  isWhiteKey:  true, basePitch: 16},\r\n\t\t{name: \"F\",  isWhiteKey:  true, basePitch: 17},\r\n\t\t{name: \"F‚ôØ\", isWhiteKey: false, basePitch: 18},\r\n\t\t{name: \"G\",  isWhiteKey:  true, basePitch: 19},\r\n\t\t{name: \"G‚ôØ\", isWhiteKey: false, basePitch: 20},\r\n\t\t{name: \"A\",  isWhiteKey:  true, basePitch: 21},\r\n\t\t{name: \"A‚ôØ\", isWhiteKey: false, basePitch: 22},\r\n\t\t{name: \"B\",  isWhiteKey:  true, basePitch: 23},\r\n\t]);\r\n\tstatic readonly mixNames: ReadonlyArray<string> = [\"Type A (B & S)\", \"Type B (M)\", \"Type C\"];\r\n\tstatic readonly sampleRateNames: ReadonlyArray<string> = [\"44100kHz\", \"48000kHz\", \"default\", \"√ó4\", \"√ó2\", \"√∑2\", \"√∑4\", \"√∑8\", \"√∑16\"];\r\n\tstatic readonly tempoMin: number = 1;\r\n\tstatic readonly tempoMax: number = 500;\r\n\tstatic readonly reverbRange: number = 5;\r\n\tstatic readonly blendRange: number = 4;\r\n\tstatic readonly riffRange: number = 11;\r\n\tstatic readonly detuneRange: number = 24;\r\n\tstatic readonly muffRange: number = 24;\r\n\tstatic readonly beatsPerBarMin: number = 1;\r\n\tstatic readonly beatsPerBarMax: number = 24;\r\n\tstatic readonly barCountMin: number = 1;\r\n\tstatic readonly barCountMax: number = 256;\r\n\tstatic readonly patternsPerChannelMin: number = 1;\r\n\tstatic readonly patternsPerChannelMax: number = 64;\r\n\tstatic readonly instrumentsPerChannelMin: number = 1;\r\n\tstatic readonly instrumentsPerChannelMax: number = 64;\r\n\tstatic readonly pitchesPerOctave: number = 12; // TODO: Use this for converting pitch to frequency.\r\n\tstatic readonly drumCount: number = 12;\r\n\tstatic readonly pitchOctaves: number = 7;\r\n\tstatic readonly partNames: ReadonlyArray<string> = [\"√∑3 (triplets)\", \"√∑4 (standard)\", \"√∑6\", \"√∑8\", \"√∑16 (arpfest)\", \"√∑12\", \"√∑9\", \"√∑5\", \"√∑50\", \"√∑24\"];\r\n\tstatic readonly partCounts: ReadonlyArray<number> = [3, 4, 6, 8, 16, 12, 9, 5, 50, 24];\r\n\tstatic readonly waveNames: ReadonlyArray<string> = [\"triangle\", \"square\", \"pulse wide\", \"pulse narrow\", \"sawtooth\", \"double saw\", \"double pulse\", \"spiky\", \"plateau\", \"glitch\", \"10% pulse\", \"sunsoft bass\", \"loud pulse\", \"sax\", \"guitar\", \"sine\", \"atari bass\", \"atari pulse\", \"1% pulse\", \"curved sawtooth\", \"viola\", \"brass\", \"acoustic bass\", \"lyre\", \"ramp pulse\", \"piccolo\", \"squaretooth\", \"flatline\", \"pnryshk a (u5)\", \"pnryshk b (riff)\"];\r\n\tstatic readonly waveVolumes: ReadonlyArray<number> = [1.0,        0.5,      0.5,          0.5,            0.65,       0.5,          0.4,            0.4,     0.94,      0.5,      0.5,         1.0,            0.6,          0.1,   0.25,     1.0,    1.0,          1.0,           1.0,        1.0,               1.0,     1.0,     1.0,             0.2,    0.2,          0.9,       0.9,           1.0,        0.4,                 0.5];\r\n\tstatic readonly drumNames: ReadonlyArray<string> = [\"retro\", \"white\", \"periodic\", \"detuned periodic\", \"shine\", \"hollow\", \"deep\", \"cutter\", \"metallic\", \"snare\"/*, \"tom-tom\", \"cymbal\", \"bass\"*/];\r\n\tstatic readonly drumVolumes: ReadonlyArray<number> = [0.25, 1.0, 0.4, 0.3, 0.3, 1.5, 1.5, 0.25, 1.0, 1.0/*, 1.5, 1.5, 1.5*/];\r\n\tstatic readonly drumBasePitches: ReadonlyArray<number> = [69, 69, 69, 69, 69, 96, 120, 96, 96, 69/*, 96, 90, 126*/];\r\n\tstatic readonly drumPitchFilterMult: ReadonlyArray<number> = [100.0, 8.0, 100.0, 100.0, 100.0, 1.0, 100.0, 100.0, 100.0, 100.0/*, 1.0, 1.0, 1.0*/];\r\n\tstatic readonly drumWaveIsSoft: ReadonlyArray<boolean> = [false, true, false, false, false, true, true, false, false, false/*, true, true, true*/];\r\n\t// Noise waves have too many samples to write by hand, they're generated on-demand by getDrumWave instead.\r\n\tprivate static readonly _drumWaves: Array<Float32Array | null> = [null, null, null, null, null, null, null, null, null, null/*, null, null, null*/];\r\n\tstatic readonly pwmwaveNames: ReadonlyArray<string> = [\"5%\", \"10%\", \"15%\", \"20%\", \"25%\", \"30%\", \"35%\", \"40%\", \"45%\", \"50%\"];\r\n\tstatic readonly pwmwaveVolumes: ReadonlyArray<number> = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0];\r\n\tstatic readonly filterNames: ReadonlyArray<string> = [\"none\", \"sustain sharp\", \"sustain medium\", \"sustain soft\", \"decay sharp\", \"decay medium\", \"decay soft\", \"decay drawn\", \"fade sharp\", \"fade medium\", \"fade soft\", \"ring\", \"muffled\", \"submerged\", \"shift\", \"overtone\", \"woosh\", \"undertone\"];\r\n\tstatic readonly filterBases: ReadonlyArray<number> = [0.0, 2.0, 3.5, 5.0, 1.0, 2.5, 4.0, 1.0, 5.0, 7.5, 10.0, -1.0, 4.0, 6.0, 0.0, 1.0, 2.0, 5.0];\r\n\tstatic readonly filterDecays: ReadonlyArray<number> = [0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 4.0, 0.5, -10.0, -7.0, -4.0, 0.2, 0.2, 0.3, 0.0, 0.0, -6.0, 0.0];\r\n\tstatic readonly filterVolumes: ReadonlyArray<number> = [0.2, 0.4, 0.7, 1.0, 0.5, 0.75, 1.0, 0.5, 0.4, 0.7, 1.0, 0.5, 0.75, 0.4, 0.4, 1.0, 0.5, 1.75];\r\n\tstatic readonly transitionNames: ReadonlyArray<string> = [\"seamless\", \"sudden\", \"smooth\", \"slide\", \"trill\", \"click\", \"bow\", \"blip\"];\r\n\tstatic readonly effectNames: ReadonlyArray<string> = [\"none\", \"vibrato light\", \"vibrato delayed\", \"vibrato heavy\", \"tremolo light\", \"tremolo heavy\", \"alien\", \"stutter\", \"strum\"];\r\n\tstatic readonly effectVibratos: ReadonlyArray<number> = [0.0, 0.15, 0.3, 0.45, 0.0, 0.0, 1.0, 0.0, 0.05];\r\n\tstatic readonly effectTremolos: ReadonlyArray<number> = [0.0, 0.0, 0.0, 0.0, 0.25, 0.5, 0.0, 1.0, 0.025];\r\n\tstatic readonly effectVibratoDelays: ReadonlyArray<number> = [0, 0, 3, 0, 0, 0, 0, 0];\r\n\tstatic readonly chorusNames: ReadonlyArray<string> = [\"union\", \"shimmer\", \"hum\", \"honky tonk\", \"dissonant\", \"fifths\", \"octaves\", \"spinner\", \"detune\", \"bowed\", \"rising\", \"vibrate\", \"fourths\", \"bass\", \"dirty\", \"stationary\", \"harmonic (legacy)\", \"recurve\", \"voiced\", \"fluctuate\"];\r\n\tstatic readonly chorusIntervals: ReadonlyArray<number> = [0.0, 0.02, 0.05, 0.1, 0.25, 3.5, 6, 0.02, 0.0, 0.02, 1.0, 3.5, 4, 0, 0.0, 3.5, 0.0, 0.005, 0.25, 12];\r\n\tstatic readonly chorusOffsets: ReadonlyArray<number> = [0.0, 0.0, 0.0, 0.0, 0.0, 3.5, 6, 0.0, 0.25, 0.0, 0.7, 7, 4, -7, 0.1, 0.0, 0.0, 0.0, 3.0, 0.0];\r\n\tstatic readonly chorusVolumes: ReadonlyArray<number> = [0.9, 0.9, 1.0, 1.0, 0.95, 0.95, 0.9, 1.0, 1.0, 1.0, 0.95, 0.975, 0.95, 1.0, 0.975, 0.9, 1.0, 1.0, 0.9, 1.0];\r\n\tstatic readonly chorusSigns: ReadonlyArray<number> = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, 1.0, -1.0, 1.0, 1.0];\r\n\tstatic readonly chorusRiffApp: ReadonlyArray<number> = [0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0];\r\n\tstatic readonly chorusHarmonizes: ReadonlyArray<boolean> = [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false];\r\n\tstatic readonly harmDisplay: ReadonlyArray<string> = [\"arpeggio\", \"duet\", \"chord\", \"seventh\", \"half arpeggio\", \"arp-chord\"];\r\n\tstatic readonly harmNames: ReadonlyArray<number> = [0, 1, 2, 3, 4, 5];\r\n\tstatic readonly fmChorusDisplay: ReadonlyArray<string> = [\"none\", \"default\", \"detune\", \"honky tonk\", \"consecutive\", \"alt. major thirds\", \"alt. minor thirds\", \"fifths\", \"octaves\"];\r\n\tstatic readonly fmChorusNames: ReadonlyArray<number> = [0, 1, 2, 3, 4, 5, 6, 7, 8];\r\n\tstatic readonly imuteNames: ReadonlyArray<string> = [\"‚óâ\", \"‚óé\"];\r\n\tstatic readonly imuteValues: ReadonlyArray<number> = [1, 0];\r\n\tstatic readonly octoffNames: ReadonlyArray<string> = [\"none\", \"+2 (2 octaves)\",  \"+1 1/2 (octave and fifth)\",  \"+1 (octave)\",  \"+1/2 (fifth)\", \"-1/2 (fifth)\", \"-1 (octave)\", \"-1 1/2 (octave and fifth)\", \"-2 (2 octaves\"];\r\n\tstatic readonly octoffValues: ReadonlyArray<number> = [0.0, 24.0, 19.0, 12.0, 7.0, -7.0, -12.0, -19.0, -24.0];\r\n\tstatic readonly volumeNames: ReadonlyArray<string> = [\"loudest\", \"loud\", \"medium\", \"quiet\", \"quietest\", \"mute\", \"i\", \"couldnt\", \"be\", \"bothered\"];\r\n\tstatic readonly volumeValues: ReadonlyArray<number> = [0.0, 0.25, 0.5, 0.75, 1.0, 1.25, 1.5, 1.75, 2.0, -1.0];\r\n\tstatic readonly volumeMValues: ReadonlyArray<number> = [0.0, 0.5, 1.0, 1.5, 2.0, -1.0];\r\n\tstatic readonly ipanValues: ReadonlyArray<number> = [-1.0, -0.75, -0.5, -0.25, 0.0, 0.25, 0.5, 0.75, 1.0];\r\n\tstatic readonly operatorCount: number = 4;\r\n\tstatic readonly operatorAlgorithmNames: ReadonlyArray<string> = [\r\n\t\t\"1‚Üê(2‚ÄÇ3‚ÄÇ4)\",\r\n\t\t\"1‚Üê(2‚ÄÇ3‚Üê4)\",\r\n\t\t\"1‚Üê2‚Üê(3‚ÄÇ4)\",\r\n\t\t\"1‚Üê(2‚ÄÇ3)‚Üê4\",\r\n\t\t\"1‚Üê2‚Üê3‚Üê4\",\r\n\t\t\"1‚Üê3‚ÄÉ2‚Üê4\",\r\n\t\t\"1‚ÄÉ2‚Üê(3‚ÄÇ4)\",\r\n\t\t\"1‚ÄÉ2‚Üê3‚Üê4\",\r\n\t\t\"(1‚ÄÇ2)‚Üê3‚Üê4\",\r\n\t\t\"(1‚ÄÇ2)‚Üê(3‚ÄÇ4)\",\r\n\t\t\"1‚ÄÉ2‚ÄÉ3‚Üê4\",\r\n\t\t\"(1‚ÄÇ2‚ÄÇ3)‚Üê4\",\r\n\t\t\"1‚ÄÉ2‚ÄÉ3‚ÄÉ4\",\r\n\t];\r\n\tstatic readonly midiAlgorithmNames: ReadonlyArray<string> = [\"1<(2 3 4)\", \"1<(2 3<4)\", \"1<2<(3 4)\", \"1<(2 3)<4\", \"1<2<3<4\", \"1<3 2<4\", \"1 2<(3 4)\", \"1 2<3<4\", \"(1 2)<3<4\", \"(1 2)<(3 4)\", \"1 2 3<4\", \"(1 2 3)<4\", \"1 2 3 4\"];\r\n\tstatic readonly operatorModulatedBy: ReadonlyArray<ReadonlyArray<ReadonlyArray<number>>> = [\r\n\t\t[[2, 3, 4], [],     [],  []],\r\n\t\t[[2, 3],    [],     [4], []],\r\n\t\t[[2],       [3, 4], [],  []],\r\n\t\t[[2, 3],    [4],    [4], []],\r\n\t\t[[2],       [3],    [4], []],\r\n\t\t[[3],       [4],    [],  []],\r\n\t\t[[],        [3, 4], [],  []],\r\n\t\t[[],        [3],    [4], []],\r\n\t\t[[3],       [3],    [4], []],\r\n\t\t[[3, 4],    [3, 4], [],  []],\r\n\t\t[[],        [],     [4], []],\r\n\t\t[[4],       [4],    [4], []],\r\n\t\t[[],        [],     [],  []],\r\n\t];\r\n\tstatic readonly operatorAssociatedCarrier: ReadonlyArray<ReadonlyArray<number>> = [\r\n\t\t[1, 1, 1, 1],\r\n\t\t[1, 1, 1, 1],\r\n\t\t[1, 1, 1, 1],\r\n\t\t[1, 1, 1, 1],\r\n\t\t[1, 1, 1, 1],\r\n\t\t[1, 2, 1, 2],\r\n\t\t[1, 2, 2, 2],\r\n\t\t[1, 2, 2, 2],\r\n\t\t[1, 2, 2, 2],\r\n\t\t[1, 2, 2, 2],\r\n\t\t[1, 2, 3, 3],\r\n\t\t[1, 2, 3, 3],\r\n\t\t[1, 2, 3, 4],\r\n\t];\r\n\tstatic readonly operatorCarrierCounts: ReadonlyArray<number> = [1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 4];\r\n\tstatic readonly operatorCarrierChorus: ReadonlyArray<ReadonlyArray<number>> = [\r\n\t\t[0.0, 0.0, 0.0, 0.0],\r\n\t\t[0.0, 0.04, -0.073, 0.091],\r\n\t\t[0.5, 0.54, 0.427, 0.591],\r\n\t\t[0.0, 0.26, -0.45, 0.67],\r\n\t\t[0.0, 1.0, 2.0, 3.0],\r\n\t\t[0.0, 4.0, 7.0, 11.0],\r\n\t\t[0.0, 3.0, 7.0, 10.0],\r\n\t\t[0.0, 7.0, 14.0, 21.0],\r\n\t\t[0.0, 12.0, 24.0, 36.0],\r\n\t];\r\n\tstatic readonly operatorAmplitudeMax: number = 15;\r\n\tstatic readonly operatorFrequencyNames: ReadonlyArray<string> = [\"1√ó\", \"~1√ó\", \"2√ó\", \"~2√ó\", \"3√ó\", \"4√ó\", \"5√ó\", \"6√ó\", \"7√ó\", \"8√ó\", \"9√ó\", \"10√ó\", \"11√ó\", \"13√ó\", \"16√ó\", \"20√ó\"];\r\n\tstatic readonly midiFrequencyNames: ReadonlyArray<string> = [\"1x\", \"~1x\", \"2x\", \"~2x\", \"3x\", \"4x\", \"5x\", \"6x\", \"7x\", \"8x\", \"9x\", \"10x\", \"11x\", \"13x\", \"16x\", \"20x\"];\r\n\tstatic readonly operatorFrequencies: ReadonlyArray<number> =    [1.0, 1.0, 2.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 13.0, 16.0, 20.0];\r\n\tstatic readonly operatorHzOffsets: ReadonlyArray<number> =      [0.0, 1.5, 0.0, -1.3, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0];\r\n\tstatic readonly operatorAmplitudeSigns: ReadonlyArray<number> = [1.0, -1.0, 1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0];\r\n\tstatic readonly operatorEnvelopeNames: ReadonlyArray<string> = [\"custom\", \"steady\", \"punch\", \"flare 1\", \"flare 2\", \"flare 3\", \"pluck 1\", \"pluck 2\", \"pluck 3\", \"swell 1\", \"swell 2\", \"swell 3\", \"tremolo1\", \"tremolo2\", \"tremolo3\", \"custom flare\", \"custom tremolo\", \"flute 1\", \"flute 2\", \"flute 3\"];\r\n\tstatic readonly operatorEnvelopeType: ReadonlyArray<EnvelopeType> = [EnvelopeType.custom, EnvelopeType.steady, EnvelopeType.punch, EnvelopeType.flare, EnvelopeType.flare, EnvelopeType.flare, EnvelopeType.pluck, EnvelopeType.pluck, EnvelopeType.pluck, EnvelopeType.pluck, EnvelopeType.pluck, EnvelopeType.pluck, EnvelopeType.tremolo, EnvelopeType.tremolo, EnvelopeType.tremolo, EnvelopeType.flare, EnvelopeType.tremolo, EnvelopeType.flute, EnvelopeType.flute, EnvelopeType.flute];\r\n\tstatic readonly operatorSpecialCustomVolume: ReadonlyArray<boolean> = [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, true, true, false, false, false];\r\n\tstatic readonly operatorEnvelopeSpeed: ReadonlyArray<number> = [0.0, 0.0, 0.0, 32.0, 8.0, 2.0, 32.0, 8.0, 2.0, 32.0, 8.0, 2.0, 4.0, 2.0, 1.0, 8.0, 0.0, 16.0, 8.0, 4.0];\r\n\tstatic readonly operatorEnvelopeInverted: ReadonlyArray<boolean> = [false, false, false, false, false, false, false, false, false, true, true, true, false, false, false, false, false, false, false, false];\r\n\tstatic readonly operatorFeedbackNames: ReadonlyArray<string> = [\r\n\t\t\"1‚ü≤\",\r\n\t\t\"2‚ü≤\",\r\n\t\t\"3‚ü≤\",\r\n\t\t\"4‚ü≤\",\r\n\t\t\"1‚ü≤‚ÄÉ2‚ü≤\",\r\n\t\t\"3‚ü≤‚ÄÉ4‚ü≤\",\r\n\t\t\"1‚ü≤‚ÄÉ2‚ü≤‚ÄÉ3‚ü≤‚ÄÉ\",\r\n\t\t\"2‚ü≤‚ÄÉ3‚ü≤‚ÄÉ4‚ü≤‚ÄÉ\",\r\n\t\t\"1‚ü≤‚ÄÉ2‚ü≤‚ÄÉ3‚ü≤‚ÄÉ4‚ü≤‚ÄÉ\",\r\n\t\t\"1‚Üí2\",\r\n\t\t\"1‚Üí3\",\r\n\t\t\"1‚Üí4\",\r\n\t\t\"2‚Üí3\",\r\n\t\t\"2‚Üí4\",\r\n\t\t\"3‚Üí4\",\r\n\t\t\"1‚Üí3‚ÄÉ2‚Üí4\",\r\n\t\t\"1‚Üí4‚ÄÉ2‚Üí3\",\r\n\t\t\"1‚Üí2‚Üí3‚Üí4\",\r\n\t\t\"1üóò2\",\r\n\t\t\"1üóò3\",\r\n\t\t\"1üóò4\",\r\n\t\t\"2üóò3\",\r\n\t\t\"2üóò4\",\r\n\t\t\"3üóò4\",\r\n\t];\r\n\tstatic readonly midiFeedbackNames: ReadonlyArray<string> = [\r\n\t\t\"1\",\r\n\t\t\"2\",\r\n\t\t\"3\",\r\n\t\t\"4\",\r\n\t\t\"1 2\",\r\n\t\t\"3 4\",\r\n\t\t\"1 2 3\",\r\n\t\t\"2 3 4\",\r\n\t\t\"1 2 3 4\",\r\n\t\t\"1>2\",\r\n\t\t\"1>3\",\r\n\t\t\"1>4\",\r\n\t\t\"2>3\",\r\n\t\t\"2>4\",\r\n\t\t\"3>4\",\r\n\t\t\"1>3 2>4\",\r\n\t\t\"1>4 2>3\",\r\n\t\t\"1>2>3>4\",\r\n\t\t\"1-2\",\r\n\t\t\"1-3\",\r\n\t\t\"1-4\",\r\n\t\t\"2-3\",\r\n\t\t\"2-4\",\r\n\t\t\"3-4\",\r\n\t];\r\n\tstatic readonly operatorFeedbackIndices: ReadonlyArray<ReadonlyArray<ReadonlyArray<number>>> = [\r\n\t\t[[1], [], [], []],\r\n\t\t[[], [2], [], []],\r\n\t\t[[], [], [3], []],\r\n\t\t[[], [], [], [4]],\r\n\t\t[[1], [2], [], []],\r\n\t\t[[], [], [3], [4]],\r\n\t\t[[1], [2], [3], []],\r\n\t\t[[], [2], [3], [4]],\r\n\t\t[[1], [2], [3], [4]],\r\n\t\t[[], [1], [], []],\r\n\t\t[[], [], [1], []],\r\n\t\t[[], [], [], [1]],\r\n\t\t[[], [], [2], []],\r\n\t\t[[], [], [], [2]],\r\n\t\t[[], [], [], [3]],\r\n\t\t[[], [], [1], [2]],\r\n\t\t[[], [], [2], [1]],\r\n\t\t[[], [1], [2], [3]],\r\n\t\t[[2], [1], [],  []  ],\r\n\t\t[[3], [],  [1], []  ],\r\n\t\t[[4], [],  [],  [1] ],\r\n\t\t[[],  [3], [2], []  ],\r\n\t\t[[],  [4], [],  [2] ],\r\n\t\t[[],  [],  [4], [3] ],\r\n\t];\r\n\tstatic readonly pitchChannelTypeNames: ReadonlyArray<string> = [\"chip\", \"FM (expert)\", \"PWM (beta)\"];\r\n\tstatic readonly pitchChannelTypeValues: ReadonlyArray<number> = [InstrumentType.chip, InstrumentType.fm, InstrumentType.pwm];\r\n\tstatic readonly drumChannelTypeNames: ReadonlyArray<string> = [\"noise\"];\r\n\tstatic readonly instrumentTypeNames: ReadonlyArray<string> = [\"chip\", \"FM\", \"noise\", \"PWM\"];\r\n\r\n\tstatic readonly oldThemeNames: ReadonlyArray<string> = [\"Default\", \"ModBox 2.0\", \"Artic\", \"Cinnamon Roll [!]\", \"Ocean\", \"Rainbow [!]\", \"Float [!]\", \"Windows\", \"Grassland\", \"Dessert\", \"Kahootiest\", \"Beam to the Bit [!]\", \"Pretty Egg\", \"Poniryoshka\", \"Gameboy [!]\", \"Woodkid\", \"Midnight\", \"Snedbox\", \"unnamed\", \"Piano [!] [‚Üª]\", \"Halloween\", \"FrozenOver‚ùÑÔ∏è\"];\r\n\r\n\tstatic readonly channelOneBrightColorPallet: string      = \"#25f3ff\";\r\n\tstatic readonly channelTwoBrightColorPallet: string      = \"#44ff44\";\r\n\tstatic readonly channelThreeBrightColorPallet: string    = \"#ffff25\";\r\n\tstatic readonly channelFourBrightColorPallet: string     = \"#ff9752\";\r\n\tstatic readonly channelFiveBrightColorPallet: string     = \"#ff90ff\";\r\n\tstatic readonly channelSixBrightColorPallet: string      = \"#9f31ea\";\r\n\tstatic readonly channelSevenBrightColorPallet: string    = \"#2b6aff\";\r\n\tstatic readonly channelEightBrightColorPallet: string    = \"#00ff9f\";\r\n\tstatic readonly channelNineBrightColorPallet: string     = \"#ffbf00\";\r\n\tstatic readonly channelTenBrightColorPallet: string      = \"#d85d00\";\r\n\tstatic readonly channelElevenBrightColorPallet: string   = \"#ff00a1\";\r\n\tstatic readonly channelTwelveBrightColorPallet: string   = \"#c26afc\";\r\n\tstatic readonly channelThirteenBrightColorPallet: string = \"#ff1616\";\r\n\tstatic readonly channelFourteenBrightColorPallet: string = \"#ffffff\";\r\n\tstatic readonly channelFifteenBrightColorPallet: string  = \"#768dfc\";\r\n\tstatic readonly channelSixteenBrightColorPallet: string  = \"#a5ff00\";\r\n\r\n\tstatic readonly channelOneDimColorPallet: string      = \"#0099a1\";\r\n\tstatic readonly channelTwoDimColorPallet: string      = \"#439143\";\r\n\tstatic readonly channelThreeDimColorPallet: string    = \"#a1a100\";\r\n\tstatic readonly channelFourDimColorPallet: string     = \"#c75000\";\r\n\tstatic readonly channelFiveDimColorPallet: string     = \"#d020d0\";\r\n\tstatic readonly channelSixDimColorPallet: string      = \"#552377\";\r\n\tstatic readonly channelSevenDimColorPallet: string    = \"#221b89\";\r\n\tstatic readonly channelEightDimColorPallet: string    = \"#00995f\";\r\n\tstatic readonly channelNineDimColorPallet: string     = \"#d6b03e\";\r\n\tstatic readonly channelTenDimColorPallet: string      = \"#b25915\";\r\n\tstatic readonly channelElevenDimColorPallet: string   = \"#891a60\";\r\n\tstatic readonly channelTwelveDimColorPallet: string   = \"#965cbc\";\r\n\tstatic readonly channelThirteenDimColorPallet: string = \"#991010\";\r\n\tstatic readonly channelFourteenDimColorPallet: string = \"#aaaaaa\";\r\n\tstatic readonly channelFifteenDimColorPallet: string  = \"#5869BD\";\r\n\tstatic readonly channelSixteenDimColorPallet: string  = \"#7c9b42\";\r\n\r\n\tstatic readonly pitchChannelColorsDim: ReadonlyArray<string>    = [Config.channelOneDimColorPallet, Config.channelTwoDimColorPallet, Config.channelThreeDimColorPallet, Config.channelFourDimColorPallet, Config.channelFiveDimColorPallet, Config.channelSixDimColorPallet, Config.channelSevenDimColorPallet, Config.channelEightDimColorPallet, Config.channelNineDimColorPallet, Config.channelTenDimColorPallet, Config.channelElevenDimColorPallet, Config.channelTwelveDimColorPallet];\r\n\tstatic readonly pitchChannelColorsBright: ReadonlyArray<string> = [Config.channelOneBrightColorPallet, Config.channelTwoBrightColorPallet, Config.channelThreeBrightColorPallet, Config.channelFourBrightColorPallet, Config.channelFiveBrightColorPallet, Config.channelSixBrightColorPallet, Config.channelSevenBrightColorPallet, Config.channelEightBrightColorPallet, Config.channelNineBrightColorPallet, Config.channelTenBrightColorPallet, Config.channelElevenBrightColorPallet, Config.channelTwelveBrightColorPallet];\r\n\tstatic readonly pitchNoteColorsDim: ReadonlyArray<string>       = [Config.channelOneDimColorPallet, Config.channelTwoDimColorPallet, Config.channelThreeDimColorPallet, Config.channelFourDimColorPallet, Config.channelFiveDimColorPallet, Config.channelSixDimColorPallet, Config.channelSevenDimColorPallet, Config.channelEightDimColorPallet, Config.channelNineDimColorPallet, Config.channelTenDimColorPallet, Config.channelElevenDimColorPallet, Config.channelTwelveDimColorPallet];\r\n\tstatic readonly pitchNoteColorsBright: ReadonlyArray<string>    = [Config.channelOneBrightColorPallet, Config.channelTwoBrightColorPallet, Config.channelThreeBrightColorPallet, Config.channelFourBrightColorPallet, Config.channelFiveBrightColorPallet, Config.channelSixBrightColorPallet, Config.channelSevenBrightColorPallet, Config.channelEightBrightColorPallet, Config.channelNineBrightColorPallet, Config.channelTenBrightColorPallet, Config.channelElevenBrightColorPallet, Config.channelTwelveBrightColorPallet];\r\n\tstatic readonly drumChannelColorsDim: ReadonlyArray<string>    = [Config.channelThirteenDimColorPallet, Config.channelFourteenDimColorPallet, Config.channelFifteenDimColorPallet, Config.channelSixteenDimColorPallet];\r\n\tstatic readonly drumChannelColorsBright: ReadonlyArray<string> = [Config.channelThirteenBrightColorPallet, Config.channelFourteenBrightColorPallet, Config.channelFifteenBrightColorPallet, Config.channelSixteenBrightColorPallet];\r\n\tstatic readonly drumNoteColorsDim: ReadonlyArray<string>       = [Config.channelThirteenDimColorPallet, Config.channelFourteenDimColorPallet, Config.channelFifteenDimColorPallet, Config.channelSixteenDimColorPallet];\r\n\tstatic readonly drumNoteColorsBright: ReadonlyArray<string>    = [Config.channelThirteenBrightColorPallet, Config.channelFourteenBrightColorPallet, Config.channelFifteenBrightColorPallet, Config.channelSixteenBrightColorPallet];\r\n\r\n\tstatic readonly midiPitchChannelNames: ReadonlyArray<string> = [\"cyan channel\", \"yellow channel\", \"orange channel\", \"green channel\", \"purple channel\", \"blue channel\"];\r\n\tstatic readonly midiDrumChannelNames: ReadonlyArray<string> = [\"gray channel\", \"brown channel\", \"indigo channel\"];\r\n\tstatic readonly midiSustainInstruments: number[] = [\r\n\t\t0x47, // triangle -> clarinet\r\n\t\t0x50, // square -> square wave\r\n\t\t0x46, // pulse wide -> bassoon\r\n\t\t0x44, // pulse narrow -> oboe\r\n\t\t0x51, // sawtooth -> sawtooth wave\r\n\t\t0x51, // double saw -> sawtooth wave\r\n\t\t0x51, // double pulse -> sawtooth wave\r\n\t\t0x51, // spiky -> sawtooth wave\r\n\t\t0x4A, // plateau -> recorder\r\n\t];\r\n\tstatic readonly midiDecayInstruments: number[] = [\r\n\t\t0x2E, // triangle -> harp\r\n\t\t0x2E, // square -> harp\r\n\t\t0x06, // pulse wide -> harpsichord\r\n\t\t0x18, // pulse narrow -> nylon guitar\r\n\t\t0x19, // sawtooth -> steel guitar\r\n\t\t0x19, // double saw -> steel guitar\r\n\t\t0x6A, // double pulse -> shamisen\r\n\t\t0x6A, // spiky -> shamisen\r\n\t\t0x21, // plateau -> fingered bass\r\n\t];\r\n\tstatic readonly drumInterval: number = 6;\r\n\tstatic readonly pitchCount: number = 37;\r\n\tstatic readonly maxPitch: number = 84;\r\n\tstatic readonly pitchChannelCountMin: number = 0;\r\n\tstatic readonly pitchChannelCountMax: number = 12;\r\n\tstatic readonly drumChannelCountMin: number = 0;\r\n\tstatic readonly drumChannelCountMax: number = 4;\r\n\tstatic readonly waves: ReadonlyArray<Float64Array> = [\r\n\t\tConfig._centerWave([1.0/15.0, 3.0/15.0, 5.0/15.0, 7.0/15.0, 9.0/15.0, 11.0/15.0, 13.0/15.0, 15.0/15.0, 15.0/15.0, 13.0/15.0, 11.0/15.0, 9.0/15.0, 7.0/15.0, 5.0/15.0, 3.0/15.0, 1.0/15.0, -1.0/15.0, -3.0/15.0, -5.0/15.0, -7.0/15.0, -9.0/15.0, -11.0/15.0, -13.0/15.0, -15.0/15.0, -15.0/15.0, -13.0/15.0, -11.0/15.0, -9.0/15.0, -7.0/15.0, -5.0/15.0, -3.0/15.0, -1.0/15.0]),\r\n\t\tConfig._centerWave([1.0, -1.0]),\r\n\t\tConfig._centerWave([1.0, -1.0, -1.0, -1.0]),\r\n\t\tConfig._centerWave([1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]),\r\n\t\tConfig._centerWave([1.0/31.0, 3.0/31.0, 5.0/31.0, 7.0/31.0, 9.0/31.0, 11.0/31.0, 13.0/31.0, 15.0/31.0, 17.0/31.0, 19.0/31.0, 21.0/31.0, 23.0/31.0, 25.0/31.0, 27.0/31.0, 29.0/31.0, 31.0/31.0, -31.0/31.0, -29.0/31.0, -27.0/31.0, -25.0/31.0, -23.0/31.0, -21.0/31.0, -19.0/31.0, -17.0/31.0, -15.0/31.0, -13.0/31.0, -11.0/31.0, -9.0/31.0, -7.0/31.0, -5.0/31.0, -3.0/31.0, -1.0/31.0]),\r\n\t\tConfig._centerWave([0.0, -0.2, -0.4, -0.6, -0.8, -1.0, 1.0, -0.8, -0.6, -0.4, -0.2, 1.0, 0.8, 0.6, 0.4, 0.2]),\r\n\t\tConfig._centerWave([1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0]),\r\n\t\tConfig._centerWave([1.0, -1.0, 1.0, -1.0, 1.0, 0.0]),\r\n\t\tConfig._centerWave([0.0, 0.2, 0.4, 0.5, 0.6, 0.7, 0.8, 0.85, 0.9, 0.95, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.95, 0.9, 0.85, 0.8, 0.7, 0.6, 0.5, 0.4, 0.2, 0.0, -0.2, -0.4, -0.5, -0.6, -0.7, -0.8, -0.85, -0.9, -0.95, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.95, -0.9, -0.85, -0.8, -0.7, -0.6, -0.5, -0.4, -0.2]),\r\n\t\tConfig._centerWave([1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0,1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0]),\r\n\t\tConfig._centerWave([1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]),\r\n\t\tConfig._centerWave([0.0, 0.1875, 0.3125, 0.5625, 0.5, 0.75, 0.875, 1.0, 1.0, 0.6875, 0.5, 0.625, 0.625, 0.5, 0.375, 0.5625, 0.4375, 0.5625, 0.4375, 0.4375, 0.3125, 0.1875, 0.1875, 0.375, 0.5625, 0.5625, 0.5625, 0.5625, 0.5625, 0.4375, 0.25, 0.0]),\r\n\t\tConfig._centerWave([1.0, 0.7, 0.1, 0.1, 0, 0, 0, 0, 0, 0.1, 0.2, 0.15, 0.25, 0.125, 0.215, 0.345, 4.0]),\r\n\t\tConfig._centerWave([1.0 / 15.0, 3.0 / 15.0, 5.0 / 15.0, 9.0, 0.06]),\r\n\t\tConfig._centerWave([-0.5, 3.5, 3.0, -0.5, -0.25, -1.0]),\r\n\t\tConfig._centerWave([0.0, 0.05, 0.125, 0.2, 0.25, 0.3, 0.425, 0.475, 0.525, 0.625, 0.675, 0.725, 0.775, 0.8, 0.825, 0.875, 0.9, 0.925, 0.95, 0.975, 0.98, 0.99, 0.995, 1, 0.995, 0.99, 0.98, 0.975, 0.95, 0.925, 0.9, 0.875, 0.825, 0.8, 0.775, 0.725, 0.675, 0.625, 0.525, 0.475, 0.425, 0.3, 0.25, 0.2, 0.125, 0.05, 0.0, -0.05, -0.125, -0.2, -0.25, -0.3, -0.425, -0.475, -0.525, -0.625, -0.675, -0.725, -0.775, -0.8, -0.825, -0.875, -0.9, -0.925, -0.95, -0.975, -0.98, -0.99, -0.995, -1, -0.995, -0.99, -0.98, -0.975, -0.95, -0.925, -0.9, -0.875, -0.825, -0.8, -0.775, -0.725, -0.675, -0.625, -0.525, -0.475, -0.425, -0.3, -0.25, -0.2, -0.125, -0.05]),\r\n\t\tConfig._centerWave([1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]),\r\n\t\tConfig._centerWave([0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]),\r\n\t\tConfig._centerWave([1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]),\r\n\t\tConfig._centerWave([1.0, 1.0 / 2.0, 1.0 / 3.0, 1.0 / 4.0]),\r\n\t\tConfig._centerWave([-0.9, -1.0, -0.85, -0.775, -0.7, -0.6, -0.5, -0.4, -0.325, -0.225, -0.2, -0.125, -0.1, -0.11, -0.125, -0.15, -0.175, -0.18, -0.2, -0.21, -0.22, -0.21, -0.2, -0.175, -0.15, -0.1, -0.5, 0.75, 0.11, 0.175, 0.2, 0.25, 0.26, 0.275, 0.26, 0.25, 0.225, 0.2, 0.19, 0.18, 0.19, 0.2, 0.21, 0.22, 0.23, 0.24, 0.25, 0.26, 0.275, 0.28, 0.29, 0.3, 0.29, 0.28, 0.27, 0.26, 0.25, 0.225, 0.2, 0.175, 0.15, 0.1, 0.075, 0.0, -0.01, -0.025, 0.025, 0.075, 0.2, 0.3, 0.475, 0.6, 0.75, 0.85, 0.85, 1.0, 0.99, 0.95, 0.8, 0.675, 0.475, 0.275, 0.01, -0.15, -0.3, -0.475, -0.5, -0.6, -0.71, -0.81, -0.9, -1.0, -0.9]),\r\n\t\tConfig._centerWave([-1.0, -0.95, -0.975, -0.9, -0.85, -0.8, -0.775, -0.65, -0.6, -0.5, -0.475, -0.35, -0.275, -0.2, -0.125, -0.05, 0.0, 0.075, 0.125, 0.15, 0.20, 0.21, 0.225, 0.25, 0.225, 0.21, 0.20, 0.19, 0.175, 0.125, 0.10, 0.075, 0.06, 0.05, 0.04, 0.025, 0.04, 0.05, 0.10, 0.15, 0.225, 0.325, 0.425, 0.575, 0.70, 0.85, 0.95, 1.0, 0.9, 0.675, 0.375, 0.2, 0.275, 0.4, 0.5, 0.55, 0.6, 0.625, 0.65, 0.65, 0.65, 0.65, 0.64, 0.6, 0.55, 0.5, 0.4, 0.325, 0.25, 0.15, 0.05, -0.05, -0.15, -0.275, -0.35, -0.45, -0.55, -0.65, -0.7, -0.78, -0.825, -0.9, -0.925, -0.95, -0.975]),\r\n\t\tConfig._centerWave([1.0, 0.0, 0.1, -0.1, -0.2, -0.4, -0.3, -1.0]),\r\n\t\tConfig._centerWave([1.0, -1.0, 4.0, 2.15, 4.13, 5.15, 0.0, -0.05, 1.0]),\r\n\t\tConfig._centerWave([6.1, -2.9, 1.4, -2.9]),\r\n\t\tConfig._centerWave([1, 4, 2, 1, -0.1, -1, -0.12]),\r\n\t\tConfig._centerWave([0.2, 1.0, 2.6, 1.0, 0.0, -2.4]),\r\n\t\tConfig._centerWave([1.0, 0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1, 0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]),\r\n\t\tConfig._centerWave([1.0, 0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1, 0.0]),\r\n\t\tConfig._centerWave([1.0, -0.9, 0.8, -0.7, 0.6, -0.5, 0.4, -0.3, 0.2, -0.1, 0.0, -0.1, 0.2, -0.3, 0.4, -0.5, 0.6, -0.7, 0.8, -0.9, 1.0]),\r\n\t];\r\n\tstatic readonly wavesMixC: ReadonlyArray<Float64Array> = [\r\n\t\tConfig._centerWave([1.0 / 15.0, 3.0 / 15.0, 5.0 / 15.0, 7.0 / 15.0, 9.0 / 15.0, 11.0 / 15.0, 13.0 / 15.0, 15.0 / 15.0, 15.0 / 15.0, 13.0 / 15.0, 11.0 / 15.0, 9.0 / 15.0, 7.0 / 15.0, 5.0 / 15.0, 3.0 / 15.0, 1.0 / 15.0, -1.0 / 15.0, -3.0 / 15.0, -5.0 / 15.0, -7.0 / 15.0, -9.0 / 15.0, -11.0 / 15.0, -13.0 / 15.0, -15.0 / 15.0, -15.0 / 15.0, -13.0 / 15.0, -11.0 / 15.0, -9.0 / 15.0, -7.0 / 15.0, -5.0 / 15.0, -3.0 / 15.0, -1.0 / 15.0]),\r\n\t\tConfig._centerWave([1.0, -1.0]),\r\n\t\tConfig._centerWave([1.0, -1.0, -1.0, -1.0]),\r\n\t\tConfig._centerWave([1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]),\r\n\t\tConfig._centerWave([1.0 / 31.0, 3.0 / 31.0, 5.0 / 31.0, 7.0 / 31.0, 9.0 / 31.0, 11.0 / 31.0, 13.0 / 31.0, 15.0 / 31.0, 17.0 / 31.0, 19.0 / 31.0, 21.0 / 31.0, 23.0 / 31.0, 25.0 / 31.0, 27.0 / 31.0, 29.0 / 31.0, 31.0 / 31.0, -31.0 / 31.0, -29.0 / 31.0, -27.0 / 31.0, -25.0 / 31.0, -23.0 / 31.0, -21.0 / 31.0, -19.0 / 31.0, -17.0 / 31.0, -15.0 / 31.0, -13.0 / 31.0, -11.0 / 31.0, -9.0 / 31.0, -7.0 / 31.0, -5.0 / 31.0, -3.0 / 31.0, -1.0 / 31.0]),\r\n\t\tConfig._centerWave([0.0, -0.2, -0.4, -0.6, -0.8, -1.0, 1.0, -0.8, -0.6, -0.4, -0.2, 1.0, 0.8, 0.6, 0.4, 0.2]),\r\n\t\tConfig._centerWave([1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0]),\r\n\t\tConfig._centerWave([1.0, -1.0, 1.0, -1.0, 1.0, 0.0]),\r\n\t\tConfig._centerWave([0.0, 0.2, 0.4, 0.5, 0.6, 0.7, 0.8, 0.85, 0.9, 0.95, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.95, 0.9, 0.85, 0.8, 0.7, 0.6, 0.5, 0.4, 0.2, 0.0, -0.2, -0.4, -0.5, -0.6, -0.7, -0.8, -0.85, -0.9, -0.95, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.95, -0.9, -0.85, -0.8, -0.7, -0.6, -0.5, -0.4, -0.2]),\r\n\t\tConfig._centerWave([1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0,1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0]),\r\n\t\tConfig._centerWave([1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]),\r\n\t\tConfig._centerWave([0.0, 0.1875, 0.3125, 0.5625, 0.5, 0.75, 0.875, 1.0, 1.0, 0.6875, 0.5, 0.625, 0.625, 0.5, 0.375, 0.5625, 0.4375, 0.5625, 0.4375, 0.4375, 0.3125, 0.1875, 0.1875, 0.375, 0.5625, 0.5625, 0.5625, 0.5625, 0.5625, 0.4375, 0.25, 0.0]),\r\n\t\tConfig._centerWave([1.0, 0.7, 0.1, 0.1, 0, 0, 0, 0, 0, 0.1, 0.2, 0.15, 0.25, 0.125, 0.215, 0.345, 4.0]),\r\n\t\tConfig._centerWave([1.0 / 15.0, 3.0 / 15.0, 5.0 / 15.0, 9.0, 0.06]),\r\n\t\tConfig._centerWave([-0.5, 3.5, 3.0, -0.5, -0.25, -1.0]),\r\n\t\tConfig._centerWave([0.0, 0.05, 0.125, 0.2, 0.25, 0.3, 0.425, 0.475, 0.525, 0.625, 0.675, 0.725, 0.775, 0.8, 0.825, 0.875, 0.9, 0.925, 0.95, 0.975, 0.98, 0.99, 0.995, 1, 0.995, 0.99, 0.98, 0.975, 0.95, 0.925, 0.9, 0.875, 0.825, 0.8, 0.775, 0.725, 0.675, 0.625, 0.525, 0.475, 0.425, 0.3, 0.25, 0.2, 0.125, 0.05, 0.0, -0.05, -0.125, -0.2, -0.25, -0.3, -0.425, -0.475, -0.525, -0.625, -0.675, -0.725, -0.775, -0.8, -0.825, -0.875, -0.9, -0.925, -0.95, -0.975, -0.98, -0.99, -0.995, -1, -0.995, -0.99, -0.98, -0.975, -0.95, -0.925, -0.9, -0.875, -0.825, -0.8, -0.775, -0.725, -0.675, -0.625, -0.525, -0.475, -0.425, -0.3, -0.25, -0.2, -0.125, -0.05]),\r\n\t\tConfig._centerWave([1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]),\r\n\t\tConfig._centerWave([0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]),\r\n\t\tConfig._centerWave([1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]),\r\n\t\tConfig._centerWave([1.0, 1.0 / 2.0, 1.0 / 3.0, 1.0 / 4.0]),\r\n\t\tConfig._centerWave([-0.9, -1.0, -0.85, -0.775, -0.7, -0.6, -0.5, -0.4, -0.325, -0.225, -0.2, -0.125, -0.1, -0.11, -0.125, -0.15, -0.175, -0.18, -0.2, -0.21, -0.22, -0.21, -0.2, -0.175, -0.15, -0.1, -0.5, 0.75, 0.11, 0.175, 0.2, 0.25, 0.26, 0.275, 0.26, 0.25, 0.225, 0.2, 0.19, 0.18, 0.19, 0.2, 0.21, 0.22, 0.23, 0.24, 0.25, 0.26, 0.275, 0.28, 0.29, 0.3, 0.29, 0.28, 0.27, 0.26, 0.25, 0.225, 0.2, 0.175, 0.15, 0.1, 0.075, 0.0, -0.01, -0.025, 0.025, 0.075, 0.2, 0.3, 0.475, 0.6, 0.75, 0.85, 0.85, 1.0, 0.99, 0.95, 0.8, 0.675, 0.475, 0.275, 0.01, -0.15, -0.3, -0.475, -0.5, -0.6, -0.71, -0.81, -0.9, -1.0, -0.9]),\r\n\t\tConfig._centerWave([-1.0, -0.95, -0.975, -0.9, -0.85, -0.8, -0.775, -0.65, -0.6, -0.5, -0.475, -0.35, -0.275, -0.2, -0.125, -0.05, 0.0, 0.075, 0.125, 0.15, 0.20, 0.21, 0.225, 0.25, 0.225, 0.21, 0.20, 0.19, 0.175, 0.125, 0.10, 0.075, 0.06, 0.05, 0.04, 0.025, 0.04, 0.05, 0.10, 0.15, 0.225, 0.325, 0.425, 0.575, 0.70, 0.85, 0.95, 1.0, 0.9, 0.675, 0.375, 0.2, 0.275, 0.4, 0.5, 0.55, 0.6, 0.625, 0.65, 0.65, 0.65, 0.65, 0.64, 0.6, 0.55, 0.5, 0.4, 0.325, 0.25, 0.15, 0.05, -0.05, -0.15, -0.275, -0.35, -0.45, -0.55, -0.65, -0.7, -0.78, -0.825, -0.9, -0.925, -0.95, -0.975]),\r\n\t\tConfig._centerWave([0.7, 0.0, 0.1, -0.1, -0.2, -0.4, -0.3, -0.7]),\r\n\t\tConfig._centerWave([1.0, -1.0, 4.0, 2.15, 4.1, 5.05, 0.0, -0.05, 1.0]),\r\n\t\tConfig._centerWave([4.5, -1.7, 1.0, -1.7]),\r\n\t\tConfig._centerWave([0.1, 0.4, 0.2, 0.1, -0.1, -1, -0.12]),\r\n\t\tConfig._centerWave([.03, .13, .30, 1.0, 0.0, -.26]),\r\n\t\tConfig._centerWave([2, 1.75, 1.5, 1.25, 1, .75, .5, .25, 0.0, 0.25, 0.5, 0.75, 1, 1.25, 1.5, 1.75]),\r\n\t\tConfig._centerWave([1.0, 1.9, 1.8, 1.7, 1.6, 1.5, 1.4, 1.3, 1.2, 1.1, 1.0]),\r\n\t\tConfig._centerWave([-1.0, -0.9, 0.8, -0.7, 0.6, -0.5, 0.4, -0.3, 0.2, -0.1, 0.0, -0.1, 0.2, -0.3, 0.4, -0.5, 0.6, -0.7, 0.8, -0.9, -1.0]),\r\n\t];\r\n\tstatic readonly pwmwaves: ReadonlyArray<Float64Array> = [\r\n\t\tConfig._centerWave([1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]),\r\n\t\tConfig._centerWave([1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]),\r\n\t\tConfig._centerWave([1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]),\r\n\t\tConfig._centerWave([1.0, 1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]),\r\n\t\tConfig._centerWave([1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]),\r\n\t\tConfig._centerWave([1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]),\r\n\t\tConfig._centerWave([1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]),\r\n\t\tConfig._centerWave([1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]),\r\n\t\tConfig._centerWave([1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]),\r\n\t\tConfig._centerWave([1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0, -1.0]),\r\n\t];\r\n\tstatic readonly sineWaveLength: number = 1 << 8; // 256\r\n\tstatic readonly sineWaveMask: number = Config.sineWaveLength - 1;\r\n\tstatic readonly sineWave: Float64Array = Config.generateSineWave();\r\n\t\r\n\tprivate static _centerWave(wave: Array<number>): Float64Array {\r\n\t\tlet sum: number = 0.0;\r\n\t\tfor (let i: number = 0; i < wave.length; i++) sum += wave[i];\r\n\t\tconst average: number = sum / wave.length;\r\n\t\tfor (let i: number = 0; i < wave.length; i++) wave[i] -= average;\r\n\t\treturn new Float64Array(wave);\r\n\t}\r\n\t\r\n\tstatic getDrumWave(index: number): Float32Array {\r\n\t\tlet wave: Float32Array | null = Config._drumWaves[index];\r\n\t\tif (wave == null) {\r\n\t\t\twave = new Float32Array(32768);\r\n\t\t\tConfig._drumWaves[index] = wave;\r\n\t\t\t\r\n\t\t\tif (index == 0) {\r\n\t\t\t\t// The \"retro\" drum uses a \"Linear Feedback Shift Register\" similar to the NES noise channel.\r\n\t\t\t\tlet drumBuffer: number = 1;\r\n\t\t\t\tfor (let i: number = 0; i < 32768; i++) {\r\n\t\t\t\t\twave[i] = (drumBuffer & 1) * 2.0 - 1.0;\r\n\t\t\t\t\tlet newBuffer: number = drumBuffer >> 1;\r\n\t\t\t\t\tif (((drumBuffer + newBuffer) & 1) == 1) {\r\n\t\t\t\t\t\tnewBuffer += 1 << 14;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdrumBuffer = newBuffer;\r\n\t\t\t\t}\r\n\t\t\t} else if (index == 1) {\r\n\t\t\t\t// White noise is just random values for each sample.\r\n\t\t\t\tfor (let i: number = 0; i < 32768; i++) {\r\n\t\t\t\t\twave[i] = Math.random() * 2.0 - 1.0;\r\n\t\t\t\t}\r\n\t\t\t} else if (index == 2) {\r\n\t\t\t\t// \"periodic\" drum.\r\n\t\t\t\tlet drumBuffer: number = 1;\r\n\t\t\t\tfor (let i: number = 0; i < 32768; i++) {\r\n\t\t\t\t\twave[i] = (drumBuffer & 1) * 2.0 - 1.0;\r\n\t\t\t\t\tlet newBuffer: number = drumBuffer >> 1;\r\n\t\t\t\t\tif (((drumBuffer + newBuffer) & 1) == 1) {\r\n\t\t\t\t\t\tnewBuffer += 2 << 14;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdrumBuffer = newBuffer;\r\n\t\t\t\t}\r\n\t\t\t} else if (index == 3) {\r\n\t\t\t\t// \"detuned periodic\" drum.\r\n\t\t\t\tlet drumBuffer: number = 1;\r\n\t\t\t\tfor (let i: number = 0; i < 32767; i++) {\r\n\t\t\t\t\twave[i] = (drumBuffer & 1) * 2.0 - 1.0;\r\n\t\t\t\t\tlet newBuffer: number = drumBuffer >> 2;\r\n\t\t\t\t\tif (((drumBuffer + newBuffer) & 1) == 1) {\r\n\t\t\t\t\t\tnewBuffer += 4 << 14;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdrumBuffer = newBuffer;\r\n\t\t\t\t}\r\n\t\t\t} else if (index == 4) {\r\n\t\t\t\t// \"shine\" drum.\r\n\t\t\t\tlet drumBuffer: number = 1;\r\n\t\t\t\tfor (let i: number = 0; i < 32768; i++) {\r\n\t\t\t\t\twave[i] = (drumBuffer & 1) * 2.0 - 1.0;\r\n\t\t\t\t\tlet newBuffer: number = drumBuffer >> 1;\r\n\t\t\t\t\tif (((drumBuffer + newBuffer) & 1) == 1) {\r\n\t\t\t\t\t\tnewBuffer += 10 << 2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdrumBuffer = newBuffer;\r\n\t\t\t\t}\r\n\t\t\t} else if (index == 5) {\r\n\t\t\t\t// \"hollow\" drums, designed in frequency space and then converted via FFT:\r\n\t\t\t\tConfig.drawNoiseSpectrum(wave, 10, 11, 1, 1, 0);\r\n\t\t\t\tConfig.drawNoiseSpectrum(wave, 11, 14, -2, -2, 0);\r\n\t\t\t\tinverseRealFourierTransform(wave);\r\n\t\t\t\tscaleElementsByFactor(wave, 1.0 / Math.sqrt(wave.length));\r\n\t\t\t} else if (index == 6) {\r\n\t\t\t\t// \"deep\" drum, designed in frequency space and then converted via FFT:\r\n\t\t\t\tConfig.drawNoiseSpectrum(wave, 1, 10, 1, 1, 0);\r\n\t\t\t\tConfig.drawNoiseSpectrum(wave, 20, 14, -2, -2, 0);\r\n\t\t\t\tinverseRealFourierTransform(wave);\r\n\t\t\t\tscaleElementsByFactor(wave, 1.0 / Math.sqrt(wave.length));\r\n\t\t\t} else if (index == 7) {\r\n\t\t\t\t// \"cutter\" drum.\r\n\t\t\t\tlet drumBuffer: number = 1;\r\n\t\t\t\tfor (let i: number = 0; i < 32768; i++) {\r\n\t\t\t\t\twave[i] = (drumBuffer & 1) * 4.0 * Math.random();\r\n\t\t\t\t\tlet newBuffer: number = drumBuffer >> 1;\r\n\t\t\t\t\tif (((drumBuffer + newBuffer) & 1) == 1) {\r\n\t\t\t\t\t\tnewBuffer += 15 << 2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdrumBuffer = newBuffer;\r\n\t\t\t\t}\r\n\t\t\t} else if (index == 8) {\r\n\t\t\t\t// \"metallic\" drum.\r\n\t\t\t\tlet drumBuffer: number = 1;\r\n\t\t\t\tfor (let i: number = 0; i < 32768; i++) {\r\n\t\t\t\t\twave[i] = (drumBuffer & 1) / 2.0 + 0.5;\r\n\t\t\t\t\tlet newBuffer: number = drumBuffer >> 1;\r\n\t\t\t\t\tif (((drumBuffer + newBuffer) & 1) == 1) {\r\n\t\t\t\t\t\tnewBuffer -= 10 << 2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdrumBuffer = newBuffer;\r\n\t\t\t\t}\r\n\t\t\t} else if (index == 9) {\r\n\t\t\t\t// \"snare\" drum.\r\n\t\t\t\tfor (let i: number = 0; i < 32768; i++) {\r\n\t\t\t\t\twave[i] = Math.random() * 2.0 - 1.0;\r\n\t\t\t\t}\r\n\t\t\t/*\r\n\t\t\t} else if (index == 10) {\r\n\t\t\t\t// \"tom-tom\" drums, designed in frequency space and then converted via FFT:\r\n\t\t\t\tConfig.drawNoiseSpectrum(wave, 10, 14, 0, -4, 0);\r\n\t\t\t\tinverseRealFourierTransform(wave);\r\n\t\t\t\tscaleElementsByFactor(wave, 1.0 / Math.sqrt(wave.length));\r\n\t\t\t} else if (index == 11) {\r\n\t\t\t\t// \"cymbal\" drums, designed in frequency space and then converted via FFT:\r\n\t\t\t\tConfig.drawNoiseSpectrum(wave, 9, 9.4, -1, -1, -0.5);\r\n\t\t\t\tConfig.drawNoiseSpectrum(wave, 9.7, 10, -1, -1, -0.5);\r\n\t\t\t\tConfig.drawNoiseSpectrum(wave, 10.3, 10.6, -1, -1, -0.5);\r\n\t\t\t\tConfig.drawNoiseSpectrum(wave, 10.9, 11.1, -1, -1, -0.5);\r\n\t\t\t\tConfig.drawNoiseSpectrum(wave, 11.3, 11.4, 0, 0, -0.5);\r\n\t\t\t\tConfig.drawNoiseSpectrum(wave, 11.5, 11.7, 1.5, 1.5, -0.5);\r\n\t\t\t\tConfig.drawNoiseSpectrum(wave, 11.7, 12, -1, -1, -0.5);\r\n\t\t\t\tConfig.drawNoiseSpectrum(wave, 12, 12.1, 2, 2, -0.5);\r\n\t\t\t\tConfig.drawNoiseSpectrum(wave, 12.1, 12.6, 0, 2, -0.5);\r\n\t\t\t\tConfig.drawNoiseSpectrum(wave, 12.6, 13, 0, 0, -0.5);\r\n\t\t\t\tConfig.drawNoiseSpectrum(wave, 13, 14, 1, -3, -0.5);\r\n\t\t\t\tinverseRealFourierTransform(wave);\r\n\t\t\t\tscaleElementsByFactor(wave, 1.0 / Math.sqrt(wave.length));\r\n\t\t\t} else if (index == 12) {\r\n\t\t\t\t// \"bass\" drums, designed in frequency space and then converted via FFT:\r\n\t\t\t\tConfig.drawNoiseSpectrum(wave, 7, 8, -2, 4, 0);\r\n\t\t\t\tConfig.drawNoiseSpectrum(wave, 8, 9, 4, -2, 0);\r\n\t\t\t\tConfig.drawNoiseSpectrum(wave, 9, 14, -2, -6, 0);\r\n\t\t\t\tinverseRealFourierTransform(wave);\r\n\t\t\t\tscaleElementsByFactor(wave, 1.0 / Math.sqrt(wave.length));\r\n\t\t\t*/\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(\"Unrecognized drum index: \" + index);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn wave;\r\n\t}\r\n\t\r\n\tprivate static drawNoiseSpectrum(wave: Float32Array, lowOctave: number, highOctave: number, lowPower: number, highPower: number, overalSlope: number): void {\r\n\t\tconst referenceOctave: number = 11;\r\n\t\tconst referenceIndex: number = 1 << referenceOctave;\r\n\t\tconst lowIndex: number = Math.pow(2, lowOctave) | 0;\r\n\t\tconst highIndex: number = Math.pow(2, highOctave) | 0;\r\n\t\tconst log2: number = Math.log(2);\r\n\t\tfor (let i: number = lowIndex; i < highIndex; i++) {\r\n\t\t\tlet amplitude: number = Math.pow(2, lowPower + (highPower - lowPower) * (Math.log(i) / log2 - lowOctave) / (highOctave - lowOctave));\r\n\t\t\tamplitude *= Math.pow(i / referenceIndex, overalSlope);\r\n\t\t\tconst radians: number = Math.random() * Math.PI * 2.0;\r\n\t\t\twave[i] = Math.cos(radians) * amplitude;\r\n\t\t\twave[32768 - i] = Math.sin(radians) * amplitude;\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate static generateSineWave(): Float64Array {\r\n\t\tconst wave: Float64Array = new Float64Array(Config.sineWaveLength + 1);\r\n\t\tfor (let i: number = 0; i < Config.sineWaveLength + 1; i++) {\r\n\t\t\twave[i] = Math.sin(i * Math.PI * 2.0 / Config.sineWaveLength);\r\n\t\t}\r\n\t\treturn wave;\r\n\t}\r\n}\r\n\r\n// Pardon the messy type casting. This allows accessing array members by numerical index or string name.\r\nexport function toNameMap<T extends BeepBoxOption>(array: Array<Pick<T, Exclude<keyof T, \"index\">>>): DictionaryArray<T> {\r\n\tconst dictionary: Dictionary<T> = {};\r\n\tfor (let i: number = 0; i < array.length; i++) {\r\n\t\tconst value: any = array[i];\r\n\t\tvalue.index = i;\r\n\t\tdictionary[value.name] = <T> value;\r\n\t}\r\n\tconst result: DictionaryArray<T> = <DictionaryArray<T>> <any> array;\r\n\tresult.dictionary = dictionary;\r\n\treturn result;\r\n}","// Copyright (C) John Nesky, distributed under the MIT license.\n\nexport function applyElementArgs<T extends HTMLElement | SVGElement | DocumentFragment>(element: T, args: Array<any>): T {\n\tfor (const arg of args) {\n\t\tif (arg instanceof Node) {\n\t\t\telement.appendChild(arg);\n\t\t} else if (typeof arg === \"string\") {\n\t\t\telement.appendChild(document.createTextNode(arg));\n\t\t} else if (typeof arg === \"function\") {\n\t\t\tapplyElementArgs(element, [arg()]);\n\t\t} else if (Array.isArray(arg)) {\n\t\t\tapplyElementArgs(element, arg);\n\t\t} else if (arg && typeof Symbol !== \"undefined\" && typeof arg[Symbol.iterator] === \"function\") {\n\t\t\tapplyElementArgs(element, [...arg]);\n\t\t} else if (arg && arg.constructor === Object && element instanceof Element) {\n\t\t\t// If the argument is a literal {} Object\n\t\t\tfor (const key of Object.keys(arg)) {\n\t\t\t\tconst value = arg[key];\n\t\t\t\t/*if (key === \"classList\") {\n\t\t\t\t\tif (typeof value === \"string\") {\n\t\t\t\t\t\telement.classList.add(...value.split(\" \"));\n\t\t\t\t\t} else if (Array.isArray(arg) || (value && typeof Symbol !== \"undefined\" && typeof value[Symbol.iterator] === \"function\")) {\n\t\t\t\t\t\telement.classList.add(...value);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.warn(\"Invalid classList value \\\"\" + value + \"\\\" on \" + element.tagName + \" element.\");\n\t\t\t\t\t}\n\t\t\t\t} else*/ if (key === \"class\" /* || key === \"className\" */) {\n\t\t\t\t\tif (typeof value === \"string\") {\n\t\t\t\t\t\telement.setAttribute(\"class\", value);\n\t\t\t\t\t} else if (Array.isArray(arg) || (value && typeof Symbol !== \"undefined\" && typeof value[Symbol.iterator] === \"function\")) {\n\t\t\t\t\t\telement.setAttribute(\"class\", [...value].join(\" \"));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.warn(\"Invalid \" + key + \" value \\\"\" + value + \"\\\" on \" + element.tagName + \" element.\");\n\t\t\t\t\t}\n\t\t\t\t} else if (key === \"style\") {\n\t\t\t\t\tif (value && value.constructor === Object) {\n\t\t\t\t\t\tfor (const styleKey of Object.keys(value)) {\n\t\t\t\t\t\t\tif (styleKey in (<HTMLElement | SVGElement>element).style) {\n\t\t\t\t\t\t\t\t// In practice, camelCase and kebab-case properties both work as properties on CSSStyleDeclaration objects.\n\t\t\t\t\t\t\t\t(<any> element).style[styleKey] = value[styleKey];\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// CSS variables start with -- and must be set with setProperty.\n\t\t\t\t\t\t\t\t(<HTMLElement | SVGElement>element).style.setProperty(styleKey, value[styleKey]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\telement.setAttribute(key, value);\n\t\t\t\t\t}\n\t\t\t\t} else if (typeof(value) === \"function\") {\n\t\t\t\t\t// If value is a callback, set as a property instead trying to coerce to string.\n\t\t\t\t\t(<any>element)[key] = value;\n\t\t\t\t} else if (typeof(value) === \"boolean\") {\n\t\t\t\t\t// If value is boolean, set attribute if true, remove if false.\n\t\t\t\t\tif (value) element.setAttribute(key, \"\");\n\t\t\t\t\telse element.removeAttribute(key);\n\t\t\t\t} else {\n\t\t\t\t\t// Default to setting attribute, as if writing html directly.\n\t\t\t\t\telement.setAttribute(key, value);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// Just convert unrecognized objects to text and append them.\n\t\t\telement.appendChild(document.createTextNode(arg));\n\t\t}\n\t}\n\treturn element;\n}\n\nexport const svgNS: string = \"http://www.w3.org/2000/svg\";\n\nexport function parseHTML(...args: Array<any>): DocumentFragment {\n\treturn document.createRange().createContextualFragment(args.join());\n}\n\n//let svgParser: SVGSVGElement | null = null;\nexport function parseSVG(...args: Array<any>): DocumentFragment {\n\tconst fragment: DocumentFragment = document.createDocumentFragment();\n\t\n\t// Internet Explorer doesn't support the first method here, so I commented it out and used a slightly more complex one involving DOMParser below.\n\t/*\n\tif (svgParser === null) svgParser = <SVGSVGElement>document.createElementNS(svgNS, \"svg\");\n\tsvgParser.innerHTML = args.join();\n\twhile (svgParser.firstChild !== null) fragment.appendChild(svgParser.firstChild);\n\t*/\n\tconst svgParser: Element = new DOMParser().parseFromString(\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\">\" + args.join() + \"</svg>\", \"image/svg+xml\").documentElement;\n\twhile (svgParser.firstChild !== null) {\n\t\tdocument.importNode(svgParser.firstChild, true);\n\t\tfragment.appendChild(svgParser.firstChild);\n\t}\n\t\n\treturn fragment;\n}\n\nexport function replaceScriptWith(...args: Array<any>): void {\n\tlet currentScript: HTMLScriptElement | SVGScriptElement | null = document.currentScript;\n\tif (currentScript == null) { // double-equals to intentionally include undefined in Internet Explorer.\n\t\t\n\t\t// Internet Explorer doens't support currentScript, try this method instead:\n\t\tif (document.readyState === \"loading\") {\n\t\t\tconst scripts: HTMLCollectionOf<HTMLScriptElement> = document.getElementsByTagName(\"script\");\n\t\t\tcurrentScript = scripts[scripts.length - 1];\n\t\t}\n\t\t\n\t\tif (currentScript == null) {\n\t\t\tconsole.warn(\"Couldn't replace script because no script is currently being parsed and executed, maybe this is happening in a callback function or event handler instead?\");\n\t\t\treturn;\n\t\t}\n\t}\n\tif (currentScript.parentNode === null) {\n\t\tconsole.warn(\"Couldn't replace script element because it is not attached to a parent anymore, did you try to replace the same script more than once?\");\n\t\treturn;\n\t}\n\tcurrentScript.parentNode.replaceChild(applyElementArgs(document.createDocumentFragment(), args), currentScript);\n}\n\nexport function applyToElement<T extends HTMLElement | SVGElement | DocumentFragment>(element: T, ...args: Array<any>): T {\n\tif (!(element instanceof Element || element instanceof DocumentFragment)) {\n\t\tconsole.warn(\"Couldn't apply to provided argument because it's not an element or DocumentFragment.\");\n\t\treturn element;\n\t}\n\treturn applyElementArgs(element, args);\n}\n","// Copyright (C) John Nesky, distributed under the MIT license.\n\nimport {applyElementArgs, svgNS, parseHTML, parseSVG, replaceScriptWith, applyToElement} from \"./elements-base.js\";\nexport {replaceScriptWith, applyToElement};\n\ninterface HTMLElementFactory {\n\t(...args: Array<string>): DocumentFragment;\n\t//readonly [key: string]: (...args: Array<any>) => HTMLElement;\n\ta(...args: Array<any>): HTMLAnchorElement;\n\tabbr(...args: Array<any>): HTMLElement;\n\taddress(...args: Array<any>): HTMLElement;\n\tarea(...args: Array<any>): HTMLAreaElement;\n\tarticle(...args: Array<any>): HTMLElement;\n\taside(...args: Array<any>): HTMLElement;\n\taudio(...args: Array<any>): HTMLAudioElement;\n\tb(...args: Array<any>): HTMLElement;\n\tbase(...args: Array<any>): HTMLBaseElement;\n\tbdi(...args: Array<any>): HTMLElement;\n\tbdo(...args: Array<any>): HTMLElement;\n\tblockquote(...args: Array<any>): HTMLQuoteElement;\n\tbr(...args: Array<any>): HTMLBRElement;\n\tbutton(...args: Array<any>): HTMLButtonElement;\n\tcanvas(...args: Array<any>): HTMLCanvasElement;\n\tcaption(...args: Array<any>): HTMLTableCaptionElement;\n\tcite(...args: Array<any>): HTMLElement;\n\tcode(...args: Array<any>): HTMLElement;\n\tcol(...args: Array<any>): HTMLTableColElement;\n\tcolgroup(...args: Array<any>): HTMLTableColElement;\n\tdatalist(...args: Array<any>): HTMLDataListElement;\n\tdd(...args: Array<any>): HTMLElement;\n\tdel(...args: Array<any>): HTMLModElement;\n\tdetails(...args: Array<any>): HTMLDetailsElement;\n\tdfn(...args: Array<any>): HTMLElement;\n\tdialog(...args: Array<any>): HTMLDialogElement;\n\tdiv(...args: Array<any>): HTMLDivElement;\n\tdl(...args: Array<any>): HTMLDListElement;\n\tdt(...args: Array<any>): HTMLElement;\n\tem(...args: Array<any>): HTMLElement;\n\tembed(...args: Array<any>): HTMLEmbedElement;\n\tfieldset(...args: Array<any>): HTMLFieldSetElement;\n\tfigcaption(...args: Array<any>): HTMLElement;\n\tfigure(...args: Array<any>): HTMLElement;\n\tfooter(...args: Array<any>): HTMLElement;\n\tform(...args: Array<any>): HTMLFormElement;\n\th1(...args: Array<any>): HTMLHeadingElement;\n\th2(...args: Array<any>): HTMLHeadingElement;\n\th3(...args: Array<any>): HTMLHeadingElement;\n\th4(...args: Array<any>): HTMLHeadingElement;\n\th5(...args: Array<any>): HTMLHeadingElement;\n\th6(...args: Array<any>): HTMLHeadingElement;\n\theader(...args: Array<any>): HTMLElement;\n\thr(...args: Array<any>): HTMLHRElement;\n\ti(...args: Array<any>): HTMLElement;\n\tiframe(...args: Array<any>): HTMLIFrameElement;\n\timg(...args: Array<any>): HTMLImageElement;\n\tinput(...args: Array<any>): HTMLInputElement;\n\tins(...args: Array<any>): HTMLModElement;\n\tkbd(...args: Array<any>): HTMLElement;\n\tlabel(...args: Array<any>): HTMLLabelElement;\n\tlegend(...args: Array<any>): HTMLLegendElement;\n\tli(...args: Array<any>): HTMLLIElement;\n\tlink(...args: Array<any>): HTMLLinkElement;\n\tmain(...args: Array<any>): HTMLElement;\n\tmap(...args: Array<any>): HTMLMapElement;\n\tmark(...args: Array<any>): HTMLElement;\n\tmenu(...args: Array<any>): HTMLMenuElement;\n\tmenuitem(...args: Array<any>): HTMLUnknownElement;\n\tmeta(...args: Array<any>): HTMLMetaElement;\n\tmeter(...args: Array<any>): HTMLMeterElement;\n\tnav(...args: Array<any>): HTMLElement;\n\tnoscript(...args: Array<any>): HTMLElement;\n\tobject(...args: Array<any>): HTMLObjectElement;\n\tol(...args: Array<any>): HTMLOListElement;\n\toptgroup(...args: Array<any>): HTMLOptGroupElement;\n\toption(...args: Array<any>): HTMLOptionElement;\n\toutput(...args: Array<any>): HTMLOutputElement;\n\tp(...args: Array<any>): HTMLParagraphElement;\n\tparam(...args: Array<any>): HTMLParamElement;\n\tpicture(...args: Array<any>): HTMLPictureElement;\n\tpre(...args: Array<any>): HTMLPreElement;\n\tprogress(...args: Array<any>): HTMLProgressElement;\n\tq(...args: Array<any>): HTMLQuoteElement;\n\trp(...args: Array<any>): HTMLElement;\n\trt(...args: Array<any>): HTMLElement;\n\truby(...args: Array<any>): HTMLElement;\n\ts(...args: Array<any>): HTMLElement;\n\tsamp(...args: Array<any>): HTMLElement;\n\tscript(...args: Array<any>): HTMLScriptElement;\n\tsection(...args: Array<any>): HTMLElement;\n\tselect(...args: Array<any>): HTMLSelectElement;\n\tsmall(...args: Array<any>): HTMLElement;\n\tsource(...args: Array<any>): HTMLSourceElement;\n\tspan(...args: Array<any>): HTMLSpanElement;\n\tstrong(...args: Array<any>): HTMLElement;\n\tstyle(...args: Array<any>): HTMLStyleElement;\n\tsub(...args: Array<any>): HTMLElement;\n\tsummary(...args: Array<any>): HTMLElement;\n\tsup(...args: Array<any>): HTMLElement;\n\ttable(...args: Array<any>): HTMLTableElement;\n\ttbody(...args: Array<any>): HTMLTableSectionElement;\n\ttd(...args: Array<any>): HTMLTableCellElement;\n\ttemplate(...args: Array<any>): HTMLTemplateElement;\n\ttextarea(...args: Array<any>): HTMLTextAreaElement;\n\ttfoot(...args: Array<any>): HTMLTableSectionElement;\n\tth(...args: Array<any>): HTMLTableCellElement;\n\tthead(...args: Array<any>): HTMLTableSectionElement;\n\ttime(...args: Array<any>): HTMLTimeElement;\n\ttitle(...args: Array<any>): HTMLTitleElement;\n\ttr(...args: Array<any>): HTMLTableRowElement;\n\ttrack(...args: Array<any>): HTMLTrackElement;\n\tu(...args: Array<any>): HTMLElement;\n\tul(...args: Array<any>): HTMLUListElement;\n\tvar(...args: Array<any>): HTMLElement;\n\tvideo(...args: Array<any>): HTMLVideoElement;\n\twbr(...args: Array<any>): HTMLElement;\n}\n\ninterface SVGElementFactory {\n\t(...args: Array<string>): DocumentFragment;\n\t//readonly [key: string]: (...args: Array<any>) => SVGElement;\n\ta(...args: Array<any>): SVGAElement;\n\taltGlyph(...args: Array<any>): SVGElement;\n\taltGlyphDef(...args: Array<any>): SVGElement;\n\taltGlyphItem(...args: Array<any>): SVGElement;\n\tanimate(...args: Array<any>): SVGAnimateElement;\n\tanimateMotion(...args: Array<any>): SVGAnimateMotionElement;\n\tanimateTransform(...args: Array<any>): SVGAnimateTransformElement;\n\tcircle(...args: Array<any>): SVGCircleElement;\n\tclipPath(...args: Array<any>): SVGClipPathElement;\n\t\"color-profile\"(...args: Array<any>): SVGElement;\n\tcolor_profile(...args: Array<any>): SVGElement;\n\tcursor(...args: Array<any>): SVGElement;\n\tdefs(...args: Array<any>): SVGDefsElement;\n\tdesc(...args: Array<any>): SVGDescElement;\n\tdiscard(...args: Array<any>): SVGElement;\n\tellipse(...args: Array<any>): SVGEllipseElement;\n\tfeBlend(...args: Array<any>): SVGFEBlendElement;\n\tfeColorMatrix(...args: Array<any>): SVGFEColorMatrixElement;\n\tfeComponentTransfer(...args: Array<any>): SVGFEComponentTransferElement;\n\tfeComposite(...args: Array<any>): SVGFECompositeElement;\n\tfeConvolveMatrix(...args: Array<any>): SVGFEConvolveMatrixElement;\n\tfeDiffuseLighting(...args: Array<any>): SVGFEDiffuseLightingElement;\n\tfeDisplacementMap(...args: Array<any>): SVGFEDisplacementMapElement;\n\tfeDistantLight(...args: Array<any>): SVGFEDistantLightElement;\n\tfeDropShadow(...args: Array<any>): SVGElement;\n\tfeFlood(...args: Array<any>): SVGFEFloodElement;\n\tfeFuncA(...args: Array<any>): SVGFEFuncAElement;\n\tfeFuncB(...args: Array<any>): SVGFEFuncBElement;\n\tfeFuncG(...args: Array<any>): SVGFEFuncGElement;\n\tfeFuncR(...args: Array<any>): SVGFEFuncRElement;\n\tfeGaussianBlur(...args: Array<any>): SVGFEGaussianBlurElement;\n\tfeImage(...args: Array<any>): SVGFEImageElement;\n\tfeMerge(...args: Array<any>): SVGFEMergeElement;\n\tfeMergeNode(...args: Array<any>): SVGFEMergeNodeElement;\n\tfeMorphology(...args: Array<any>): SVGFEMorphologyElement;\n\tfeOffset(...args: Array<any>): SVGFEOffsetElement;\n\tfePointLight(...args: Array<any>): SVGFEPointLightElement;\n\tfeSpecularLighting(...args: Array<any>): SVGFESpecularLightingElement;\n\tfeSpotLight(...args: Array<any>): SVGFESpotLightElement;\n\tfeTile(...args: Array<any>): SVGFETileElement;\n\tfeTurbulence(...args: Array<any>): SVGFETurbulenceElement;\n\tfilter(...args: Array<any>): SVGFilterElement;\n\tfont(...args: Array<any>): SVGElement;\n\t\"font-face\"(...args: Array<any>): SVGElement;\n\tfont_face(...args: Array<any>): SVGElement;\n\t\"font-face-format\"(...args: Array<any>): SVGElement;\n\tfont_face_format(...args: Array<any>): SVGElement;\n\t\"font-face-name\"(...args: Array<any>): SVGElement;\n\tfont_face_name(...args: Array<any>): SVGElement;\n\t\"font-face-src\"(...args: Array<any>): SVGElement;\n\tfont_face_src(...args: Array<any>): SVGElement;\n\t\"font-face-uri\"(...args: Array<any>): SVGElement;\n\tfont_face_uri(...args: Array<any>): SVGElement;\n\tforeignObject(...args: Array<any>): SVGForeignObjectElement;\n\tg(...args: Array<any>): SVGGElement;\n\tglyph(...args: Array<any>): SVGElement;\n\tglyphRef(...args: Array<any>): SVGElement;\n\thkern(...args: Array<any>): SVGElement;\n\timage(...args: Array<any>): SVGImageElement;\n\tline(...args: Array<any>): SVGLineElement;\n\tlinearGradient(...args: Array<any>): SVGLinearGradientElement;\n\tmarker(...args: Array<any>): SVGMarkerElement;\n\tmask(...args: Array<any>): SVGMaskElement;\n\tmetadata(...args: Array<any>): SVGMetadataElement;\n\t\"missing-glyph\"(...args: Array<any>): SVGElement;\n\tmissing_glyph(...args: Array<any>): SVGElement;\n\tmpath(...args: Array<any>): SVGElement;\n\tpath(...args: Array<any>): SVGPathElement;\n\tpattern(...args: Array<any>): SVGPatternElement;\n\tpolygon(...args: Array<any>): SVGPolygonElement;\n\tpolyline(...args: Array<any>): SVGPolylineElement;\n\tradialGradient(...args: Array<any>): SVGRadialGradientElement;\n\trect(...args: Array<any>): SVGRectElement;\n\tscript(...args: Array<any>): SVGScriptElement;\n\tset(...args: Array<any>): SVGElement;\n\tstop(...args: Array<any>): SVGStopElement;\n\tstyle(...args: Array<any>): SVGStyleElement;\n\tsvg(...args: Array<any>): SVGSVGElement;\n\tswitch(...args: Array<any>): SVGSwitchElement;\n\tsymbol(...args: Array<any>): SVGSymbolElement;\n\ttext(...args: Array<any>): SVGTextElement;\n\ttextPath(...args: Array<any>): SVGTextPathElement;\n\ttitle(...args: Array<any>): SVGTitleElement;\n\ttref(...args: Array<any>): SVGElement;\n\ttspan(...args: Array<any>): SVGTSpanElement;\n\tuse(...args: Array<any>): SVGUseElement;\n\tview(...args: Array<any>): SVGViewElement;\n\tvkern(...args: Array<any>): SVGElement;\n}\n\nexport const HTML: HTMLElementFactory = <HTMLElementFactory> <unknown> parseHTML;\nexport const SVG: SVGElementFactory = <SVGElementFactory> <unknown> parseSVG;\n\nfor (const name of \"a abbr address area article aside audio b base bdi bdo blockquote br button canvas caption cite code col colgroup datalist dd del details dfn dialog div dl dt em embed fieldset figcaption figure footer form h1 h2 h3 h4 h5 h6 header hr i iframe img input ins kbd label legend li link main map mark menu menuitem meta meter nav noscript object ol optgroup option output p param picture pre progress q rp rt ruby s samp script section select small source span strong style sub summary sup table tbody td template textarea tfoot th thead time title tr track u ul var video wbr\".split(\" \")) {\n\t(<any>HTML)[name] = (...args: Array<any>) => applyElementArgs(document.createElement(name), args);\n}\nfor (const name of \"a altGlyph altGlyphDef altGlyphItem animate animateMotion animateTransform circle clipPath color-profile cursor defs desc discard ellipse feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feDropShadow feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence filter font font-face font-face-format font-face-name font-face-src font-face-uri foreignObject g glyph glyphRef hkern image line linearGradient marker mask metadata missing-glyph mpath path pattern polygon polyline radialGradient rect script set stop style svg switch symbol text textPath title tref tspan use view vkern\".split(\" \")) {\n\t(<any>SVG)[name] = (...args: Array<any>) => applyElementArgs(<SVGElement> document.createElementNS(svgNS, name), args);\n\tif (/-/.test(name)) {\n\t\tconst snakeCaseName = name.replace(/-/g, \"_\");\n\t\t(<any>SVG)[snakeCaseName] = (...args: Array<any>) => applyElementArgs(<SVGElement> document.createElementNS(svgNS, name), args);\n\t}\n}\n","\texport function clamp(min: number, max: number, val: number): number {\r\n\t\tmax = max - 1;\r\n\t\tif (val <= max) {\r\n\t\t\tif (val >= min) return val;\r\n\t\t\telse return min;\r\n\t\t} else {\r\n\t\t\treturn max;\r\n\t\t}\r\n\t}","    import { SongTagCode, CharCode, } from \"./tagCodes\";\r\n    import { Config, Dictionary, InstrumentType } from \"./SynthConfig\";\r\n\timport { clamp } from \"./usefulFunctions\";\r\n    \r\n    export class BitFieldReader {\r\n        private _bits: number[] = [];\r\n        private _readIndex: number = 0;\r\n        \r\n        constructor(base64CharCodeToInt: ReadonlyArray<number>, source: string, startIndex: number, stopIndex: number) {\r\n            for (let i: number = startIndex; i < stopIndex; i++) {\r\n                const value: number = base64CharCodeToInt[source.charCodeAt(i)];\r\n                this._bits.push((value >> 5) & 0x1);\r\n                this._bits.push((value >> 4) & 0x1);\r\n                this._bits.push((value >> 3) & 0x1);\r\n                this._bits.push((value >> 2) & 0x1);\r\n                this._bits.push((value >> 1) & 0x1);\r\n                this._bits.push( value       & 0x1);\r\n            }\r\n        }\r\n        \r\n        public read(bitCount: number): number {\r\n            let result: number = 0;\r\n            while (bitCount > 0) {\r\n                result = result << 1;\r\n                result += this._bits[this._readIndex++];\r\n                bitCount--;\r\n            }\r\n            return result;\r\n        }\r\n        \r\n        public readLongTail(minValue: number, minBits: number): number {\r\n            let result: number = minValue;\r\n            let numBits: number = minBits;\r\n            while (this._bits[this._readIndex++]) {\r\n                result += 1 << numBits;\r\n                numBits++;\r\n            }\r\n            while (numBits > 0) {\r\n                numBits--;\r\n                if (this._bits[this._readIndex++]) {\r\n                    result += 1 << numBits;\r\n                }\r\n            }\r\n            return result;\r\n        }\r\n        \r\n        public readPartDuration(): number {\r\n            return this.readLongTail(1, 2);\r\n        }\r\n        \r\n        public readPinCount(): number {\r\n            return this.readLongTail(1, 0);\r\n        }\r\n        \r\n        public readPitchInterval(): number {\r\n            if (this.read(1)) {\r\n                return -this.readLongTail(1, 3);\r\n            } else {\r\n                return this.readLongTail(1, 3);\r\n            }\r\n        }\r\n    }\r\n    \r\n    export class BitFieldWriter {\r\n        private _bits: number[] = [];\r\n        \r\n        public write(bitCount: number, value: number): void {\r\n            bitCount--;\r\n            while (bitCount >= 0) {\r\n                this._bits.push((value >>> bitCount) & 1);\r\n                bitCount--;\r\n            }\r\n        }\r\n        \r\n        public writeLongTail(minValue: number, minBits: number, value: number): void {\r\n            if (value < minValue) throw new Error(\"value out of bounds\");\r\n            value -= minValue;\r\n            let numBits: number = minBits;\r\n            while (value >= (1 << numBits)) {\r\n                this._bits.push(1);\r\n                value -= 1 << numBits;\r\n                numBits++;\r\n            }\r\n            this._bits.push(0);\r\n            while (numBits > 0) {\r\n                numBits--;\r\n                this._bits.push((value >>> numBits) & 1);\r\n            }\r\n        }\r\n        \r\n        public writePartDuration(value: number): void {\r\n            this.writeLongTail(1, 2, value);\r\n        }\r\n        \r\n        public writePinCount(value: number): void {\r\n            this.writeLongTail(1, 0, value);\r\n        }\r\n        \r\n        public writePitchInterval(value: number): void {\r\n            if (value < 0) {\r\n                this.write(1, 1); // sign\r\n                this.writeLongTail(1, 3, -value);\r\n            } else {\r\n                this.write(1, 0); // sign\r\n                this.writeLongTail(1, 3, value);\r\n            }\r\n        }\r\n        \r\n        public concat(other: BitFieldWriter): void {\r\n            this._bits = this._bits.concat(other._bits);\r\n        }\r\n        \r\n        public encodeBase64(base64IntToCharCode: ReadonlyArray<number>, buffer: number[]): number[] {\r\n            for (let i: number = 0; i < this._bits.length; i += 6) {\r\n                const value: number = (this._bits[i] << 5) | (this._bits[i+1] << 4) | (this._bits[i+2] << 3) | (this._bits[i+3] << 2) | (this._bits[i+4] << 1) | this._bits[i+5];\r\n                buffer.push(base64IntToCharCode[value]);\r\n            }\r\n            return buffer;\r\n        }\r\n        \r\n        public lengthBase64(): number {\r\n            return Math.ceil(this._bits.length / 6);\r\n        }\r\n    }\r\n\r\n\texport class Operator {\r\n\t\tpublic frequency: number = 0;\r\n\t\tpublic amplitude: number = 0;\r\n\t\tpublic envelope: number = 0;\r\n\t\t\r\n\t\tconstructor(index: number) {\r\n\t\t\tthis.reset(index);\r\n\t\t}\r\n\t\t\r\n\t\tpublic reset(index: number): void {\r\n\t\t\tthis.frequency = 0;\r\n\t\t\tthis.amplitude = (index <= 1) ? Config.operatorAmplitudeMax : 0;\r\n\t\t\tthis.envelope = 1;\r\n\t\t}\r\n\t\t\r\n\t\tpublic copy(other: Operator): void {\r\n\t\t\tthis.frequency = other.frequency;\r\n\t\t\tthis.amplitude = other.amplitude;\r\n\t\t\tthis.envelope = other.envelope;\r\n\t\t}\r\n\t}   \r\n\r\n    export interface NotePin {\r\n\t\tinterval: number;\r\n\t\ttime: number;\r\n\t\tvolume: number;\r\n\t}\r\n\t\r\n\texport function makeNotePin(interval: number, time: number, volume: number): NotePin {\r\n\t\treturn {interval: interval, time: time, volume: volume};\r\n\t}\r\n\t\r\n\texport interface Note {\r\n\t\tpitches: number[];\r\n\t\tpins: NotePin[];\r\n\t\tstart: number;\r\n\t\tend: number;\r\n\t}\r\n\t\r\n\texport function makeNote(pitch: number, start: number, end: number, volume: number, fadeout: boolean = false) {\r\n\t\treturn {\r\n\t\t\tpitches: [pitch],\r\n\t\t\tpins: [makeNotePin(0, 0, volume), makeNotePin(0, end - start, fadeout ? 0 : volume)],\r\n\t\t\tstart: start,\r\n\t\t\tend: end,\r\n\t\t};\r\n\t}\r\n\r\nexport class Instrument {\r\n\t\tpublic type: InstrumentType = 0;\r\n\t\tpublic wave: number = 1;\r\n\t\tpublic filter: number = 1;\r\n\t\tpublic transition: number = 1;\r\n\t\tpublic effect: number = 0;\r\n\t\tpublic harm: number = 0;\r\n\t\tpublic fmChorus: number = 1;\r\n\t\tpublic imute: number = 0;\r\n\t\tpublic octoff: number = 0;\r\n\t\tpublic chorus: number = 0;\r\n\t\tpublic volume: number = 0;\r\n\t\tpublic ipan: number = 4;\r\n\t\tpublic algorithm: number = 0;\r\n\t\tpublic feedbackType: number = 0;\r\n\t\tpublic feedbackAmplitude: number = 0;\r\n\t\tpublic feedbackEnvelope: number = 1;\r\n\t\tpublic readonly operators: Operator[] = [];\r\n\t\t\r\n\t\tconstructor() {\r\n\t\t\tfor (let i = 0; i < Config.operatorCount; i++) {\r\n\t\t\t\tthis.operators.push(new Operator(i));\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tpublic reset(): void {\r\n\t\t\tthis.type = 0;\r\n\t\t\tthis.wave = 1;\r\n\t\t\tthis.filter = 1;\r\n\t\t\tthis.transition = 1;\r\n\t\t\tthis.effect = 0;\r\n\t\t\tthis.harm = 0;\r\n\t\t\tthis.fmChorus = 1;\r\n\t\t\tthis.imute = 0;\r\n\t\t\tthis.ipan = 4;\r\n\t\t\tthis.octoff = 0;\r\n\t\t\tthis.chorus = 0;\r\n\t\t\tthis.volume = 0;\r\n\t\t\tthis.algorithm = 0;\r\n\t\t\tthis.feedbackType = 0;\r\n\t\t\tthis.feedbackAmplitude = 0;\r\n\t\t\tthis.feedbackEnvelope = 1;\r\n\t\t\tfor (let i: number = 0; i < this.operators.length; i++) {\r\n\t\t\t\tthis.operators[i].reset(i);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tpublic setTypeAndReset(type: InstrumentType): void {\r\n\t\t\tthis.type = type;\r\n\t\t\tswitch (type) {\r\n\t\t\t\tcase InstrumentType.chip:\r\n\t\t\t\t\tthis.wave = 1;\r\n\t\t\t\t\tthis.filter = 1;\r\n\t\t\t\t\tthis.transition = 1;\r\n\t\t\t\t\tthis.effect = 0;\r\n\t\t\t\t\tthis.harm = 0;\r\n\t\t\t\t\tthis.imute = 0;\r\n\t\t\t\t\tthis.ipan = 4;\r\n\t\t\t\t\tthis.octoff = 0;\r\n\t\t\t\t\tthis.chorus = 0;\r\n\t\t\t\t\tthis.volume = 0;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t// @TODO: Investigate whether this being incorrect leads to\r\n\t\t\t\t// any observable issues.\r\n\t\t\t\tcase InstrumentType.fm:\r\n\t\t\t\t\tthis.wave = 1;\r\n\t\t\t\t\tthis.transition = 1;\r\n\t\t\t\t\tthis.volume = 0;\r\n\t\t\t\t\tthis.imute = 0;\r\n\t\t\t\t\tthis.ipan = 4;\r\n\t\t\t\t\tthis.harm = 0;\r\n\t\t\t\t\tthis.octoff = 0;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase InstrumentType.noise:\r\n\t\t\t\t\tthis.transition = 1;\r\n\t\t\t\t\tthis.octoff = 0;\r\n\t\t\t\t\tthis.fmChorus = 1;\r\n\t\t\t\t\tthis.ipan = 4;\r\n\t\t\t\t\tthis.effect = 0;\r\n\t\t\t\t\tthis.algorithm = 0;\r\n\t\t\t\t\tthis.feedbackType = 0;\r\n\t\t\t\t\tthis.feedbackAmplitude = 0;\r\n\t\t\t\t\tthis.feedbackEnvelope = 1;\r\n\t\t\t\t\tthis.volume = 0;\r\n\t\t\t\t\tfor (let i: number = 0; i < this.operators.length; i++) {\r\n\t\t\t\t\t\tthis.operators[i].reset(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase InstrumentType.pwm:\r\n\t\t\t\t\tthis.wave = 1;\r\n\t\t\t\t\tthis.filter = 1;\r\n\t\t\t\t\tthis.transition = 1;\r\n\t\t\t\t\tthis.effect = 0;\r\n\t\t\t\t\tthis.harm = 0;\r\n\t\t\t\t\tthis.imute = 0;\r\n\t\t\t\t\tthis.ipan = 4;\r\n\t\t\t\t\tthis.octoff = 0;\r\n\t\t\t\t\tthis.chorus = 0;\r\n\t\t\t\t\tthis.volume = 0;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tpublic copy(other: Instrument): void {\r\n\t\t\tthis.type = other.type;\r\n\t\t\tthis.wave = other.wave;\r\n\t\t\tthis.filter = other.filter;\r\n\t\t\tthis.transition = other.transition;\r\n\t\t\tthis.effect = other.effect;\r\n\t\t\tthis.chorus = other.chorus;\r\n\t\t\tthis.volume = other.volume;\r\n\t\t\tthis.harm = other.harm;\r\n\t\t\tthis.fmChorus = other.fmChorus;\r\n\t\t\tthis.imute = other.imute;\r\n\t\t\tthis.ipan = other.ipan;\r\n\t\t\tthis.octoff = other.octoff;\r\n\t\t\tthis.algorithm = other.algorithm;\r\n\t\t\tthis.feedbackType = other.feedbackType;\r\n\t\t\tthis.feedbackAmplitude = other.feedbackAmplitude;\r\n\t\t\tthis.feedbackEnvelope = other.feedbackEnvelope;\r\n\t\t\tfor (let i: number = 0; i < this.operators.length; i++) {\r\n\t\t\t\tthis.operators[i].copy(other.operators[i]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/*public getChord(): Chord {\r\n\t\t\treturn this.type == InstrumentType.noise ? Config.harmDisplay[2] : Config.harmDisplay[this.harm];\r\n\t\t}*/\r\n\t}\r\n\r\n    export class Channel {\r\n\t\tpublic octave: number = 0;\r\n\t\tpublic readonly instruments: Instrument[] = [];\r\n\t\tpublic readonly patterns: Pattern[] = [];\r\n\t\tpublic readonly bars: number[] = [];\r\n\t}\r\n\t\r\n\texport class Pattern {\r\n\t\tpublic notes: Note[] = [];\r\n\t\tpublic instrument: number = 0;\r\n\t\t\r\n\t\tpublic cloneNotes(): Note[] {\r\n\t\t\tconst result: Note[] = [];\r\n\t\t\tfor (const oldNote of this.notes) {\r\n\t\t\t\tconst newNote: Note = makeNote(-1, oldNote.start, oldNote.end, 3);\r\n\t\t\t\tnewNote.pitches = oldNote.pitches.concat();\r\n\t\t\t\tnewNote.pins = [];\r\n\t\t\t\tfor (const oldPin of oldNote.pins) {\r\n\t\t\t\t\tnewNote.pins.push(makeNotePin(oldPin.interval, oldPin.time, oldPin.volume));\r\n\t\t\t\t}\r\n\t\t\t\tresult.push(newNote);\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\t\r\n\t\tpublic reset(): void {\r\n\t\t\tthis.notes.length = 0;\r\n\t\t\tthis.instrument = 0;\r\n\t\t}\r\n\t}\r\n\r\n    export class Song {\r\n\t\tprivate static readonly _format: string = \"NepBox\";\r\n\r\n\t\tprivate static readonly _oldestBeepboxVersion: number = 2;\r\n\t\tprivate static readonly _latestBeepboxVersion: number = 6;\r\n\t\tprivate static readonly _oldestNepBoxVersion: number = 1;\r\n\t\tprivate static readonly _latestNepBoxVersion: number = 1;\r\n\t\tprivate static readonly _variant = 0x6E; //\"N\" ~ nepbox\r\n\r\n\t\tprivate static readonly _base64CharCodeToInt: ReadonlyArray<number> = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,62,62,0,0,1,2,3,4,5,6,7,8,9,0,0,0,0,0,0,0,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,0,0,0,0,63,0,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,0,0,0,0,0]; // 62 could be represented by either \"-\" or \".\" for historical reasons. New songs should use \"-\".\r\n\t\tprivate static readonly _base64IntToCharCode: ReadonlyArray<number> = [48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,45,95];\r\n\t\t\r\n\t\tpublic scale: number;\r\n\t\tpublic setSongTheme: string;\r\n\t\tpublic key: number;\r\n\t\tpublic mix: number;\r\n\t\tpublic sampleRate: number;\r\n\t\tpublic tempo: number;\r\n\t\tpublic reverb: number;\r\n\t\tpublic blend: number;\r\n\t\tpublic riff: number;\r\n\t\tpublic detune: number;\r\n\t\tpublic muff: number;\r\n\t\tpublic beatsPerBar: number;\r\n\t\tpublic barCount: number;\r\n\t\tpublic patternsPerChannel: number;\r\n\t\tpublic partsPerBeat: number;\r\n\t\tpublic instrumentsPerChannel: number;\r\n\t\tpublic loopStart: number;\r\n\t\tpublic loopLength: number;\r\n\t\tpublic pitchChannelCount: number;\r\n\t\tpublic drumChannelCount: number;\r\n\t\tpublic readonly channels: Channel[] = [];\r\n\t\t\r\n\t\tconstructor(string?: string) {\r\n\t\t\tif (string != undefined) {\r\n\t\t\t\tthis.fromBase64String(string);\r\n\t\t\t} else {\r\n\t\t\t\tthis.initToDefault(true);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tpublic getChannelCount(): number {\r\n\t\t\treturn this.pitchChannelCount + this.drumChannelCount;\r\n\t\t}\r\n\r\n\t\tpublic getChannelUnusedCount(): number {\r\n\t\t\treturn (Config.pitchChannelCountMax + Config.drumChannelCountMax) - (this.pitchChannelCount + this.drumChannelCount);\r\n\t\t}\r\n\r\n\t\tpublic getTimeSig(): string {\r\n\t\t\treturn this.beatsPerBar + \"/\" + this.partsPerBeat + \" with \" + this.barCount + \" bars.\";\r\n\t\t}\r\n\r\n\t\tpublic getScaleNKey(): string {\r\n\t\t\treturn ' \"' + Config.scales[this.scale].name + '\" and your key is ' + Config.keys[this.key].name;\r\n\t\t}\r\n\t\t\r\n\t\tpublic getChannelIsDrum(channel: number): boolean {\r\n\t\t\treturn (channel >= this.pitchChannelCount);\r\n\t\t}\r\n\t\t\r\n\t\tpublic getChannelColorDim(channel: number): string {\r\n\t\t\treturn channel < this.pitchChannelCount ? Config.pitchChannelColorsDim[channel] : Config.drumChannelColorsDim[channel - this.pitchChannelCount];\r\n\t\t}\r\n\t\tpublic getChannelColorBright(channel: number): string {\r\n\t\t\treturn channel < this.pitchChannelCount ? Config.pitchChannelColorsBright[channel] : Config.drumChannelColorsBright[channel - this.pitchChannelCount];\r\n\t\t}\r\n\t\tpublic getNoteColorDim(channel: number): string {\r\n\t\t\treturn channel < this.pitchChannelCount ? Config.pitchNoteColorsDim[channel] : Config.drumNoteColorsDim[channel - this.pitchChannelCount];\r\n\t\t}\r\n\t\tpublic getNoteColorBright(channel: number): string {\r\n\t\t\treturn channel < this.pitchChannelCount ? Config.pitchNoteColorsBright[channel] : Config.drumNoteColorsBright[channel - this.pitchChannelCount];\r\n\t\t}\r\n\t\t\r\n\t\tpublic initToDefault(andResetChannels: boolean = true): void {\r\n\t\t\tthis.scale = 0;\r\n\t\t\tthis.setSongTheme = \"none\";\r\n\t\t\tthis.key = Config.keys.map(key=>key.name).indexOf(\"C\");\r\n\t\t\tthis.mix = 1;\r\n\t\t\tthis.sampleRate = 2;\r\n\t\t\tthis.loopStart = 0;\r\n\t\t\tthis.loopLength = 4;\r\n\t\t\tthis.tempo = 151;\r\n\t\t\tthis.reverb = 0;\r\n\t\t\tthis.blend = 0;\r\n\t\t\tthis.riff = 0;\r\n\t\t\tthis.detune = 0;\r\n\t\t\tthis.muff = 0;\r\n\t\t\tthis.beatsPerBar = 8;\r\n\t\t\tthis.barCount = 16;\r\n\t\t\tthis.patternsPerChannel = 8;\r\n\t\t\tthis.partsPerBeat = 4;\r\n\t\t\tthis.instrumentsPerChannel = 1;\r\n\t\t\t\r\n\t\t\tif (andResetChannels) {\r\n\t\t\t\tthis.pitchChannelCount = 4;\r\n\t\t\t\tthis.drumChannelCount = 1;\r\n\t\t\t\tfor (let channelIndex = 0; channelIndex < this.getChannelCount(); channelIndex++) {\r\n\t\t\t\t\tif (this.channels.length <= channelIndex) {\r\n\t\t\t\t\t\tthis.channels[channelIndex] = new Channel();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst channel: Channel = this.channels[channelIndex];\r\n\t\t\t\t\tchannel.octave = 4 - channelIndex; // [4, 3, 2, 1, 0]; Descending octaves with drums at zero in last channel.\r\n\t\t\t\t\r\n\t\t\t\t\tfor (let pattern = 0; pattern < this.patternsPerChannel; pattern++) {\r\n\t\t\t\t\t\tif (channel.patterns.length <= pattern) {\r\n\t\t\t\t\t\t\tchannel.patterns[pattern] = new Pattern();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tchannel.patterns[pattern].reset();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tchannel.patterns.length = this.patternsPerChannel;\r\n\t\t\t\t\r\n\t\t\t\t\tfor (let instrument = 0; instrument < this.instrumentsPerChannel; instrument++) {\r\n\t\t\t\t\t\tif (channel.instruments.length <= instrument) {\r\n\t\t\t\t\t\t\tchannel.instruments[instrument] = new Instrument();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tchannel.instruments[instrument].reset();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tchannel.instruments.length = this.instrumentsPerChannel;\r\n\t\t\t\t\r\n\t\t\t\t\tfor (let bar = 0; bar < this.barCount; bar++) {\r\n\t\t\t\t\t\tchannel.bars[bar] = bar < 4 ? 1 : 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tchannel.bars.length = this.barCount;\r\n\t\t\t\t}\r\n\t\t\t\tthis.channels.length = this.getChannelCount();\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tpublic toBase64String(): string {\r\n\t\t\tlet bits: BitFieldWriter;\r\n\t\t\tlet buffer: number[] = [];\r\n\t\t\t\r\n\t\t\tconst base64IntToCharCode: ReadonlyArray<number> = Song._base64IntToCharCode;\r\n\t\t\t\r\n\t\t\tbuffer.push(Song._variant);\r\n\t\t\tbuffer.push(base64IntToCharCode[Song._latestNepBoxVersion]);\r\n\r\n\r\n\r\n\t\t\tbuffer.push(SongTagCode.channelCount, base64IntToCharCode[this.pitchChannelCount], base64IntToCharCode[this.drumChannelCount]);\r\n\r\n\t\t\tbuffer.push(SongTagCode.setSongTheme);\r\n\t\t\tvar encodedSongTheme: string = encodeURIComponent(this.setSongTheme);\r\n        \tbuffer.push(base64IntToCharCode[encodedSongTheme.length >> 6], base64IntToCharCode[encodedSongTheme.length & 0x3f]);\r\n\t\t\t// Actual encoded string follows\r\n\t\t\tfor (let i: number = 0; i < encodedSongTheme.length; i++) {\r\n\t\t\t\tbuffer.push(encodedSongTheme.charCodeAt(i));\r\n\t\t\t}\r\n\r\n\t\t\tbuffer.push(SongTagCode.scale, base64IntToCharCode[this.scale]);\r\n\t\t\tbuffer.push(SongTagCode.mix, base64IntToCharCode[this.mix]);\r\n\t\t\tbuffer.push(SongTagCode.sampleRate, base64IntToCharCode[this.sampleRate]);\r\n\t\t\tbuffer.push(SongTagCode.key, base64IntToCharCode[this.key]);\r\n\t\t\tbuffer.push(SongTagCode.loopStart, base64IntToCharCode[this.loopStart >> 6], base64IntToCharCode[this.loopStart & 0x3f]);\r\n\t\t\tbuffer.push(SongTagCode.loopEnd, base64IntToCharCode[(this.loopLength - 1) >> 6], base64IntToCharCode[(this.loopLength - 1) & 0x3f]);\r\n\t\t\tbuffer.push(SongTagCode.tempo, base64IntToCharCode[this.tempo >> 6], base64IntToCharCode[this.tempo & 63]);\r\n\t\t\tbuffer.push(SongTagCode.reverb, base64IntToCharCode[this.reverb]);\r\n\t\t\tbuffer.push(SongTagCode.blend, base64IntToCharCode[this.blend]);\r\n\t\t\tbuffer.push(SongTagCode.riff, base64IntToCharCode[this.riff]);\r\n\t\t\tbuffer.push(SongTagCode.detune, base64IntToCharCode[this.detune]);\r\n\t\t\tbuffer.push(SongTagCode.muff, base64IntToCharCode[this.muff]);\r\n\t\t\tbuffer.push(SongTagCode.beatCount, base64IntToCharCode[this.beatsPerBar - 1]);\r\n\t\t\tbuffer.push(SongTagCode.barCount, base64IntToCharCode[(this.barCount - 1) >> 6], base64IntToCharCode[(this.barCount - 1) & 0x3f]);\r\n\t\t\tbuffer.push(SongTagCode.patternCount, base64IntToCharCode[this.patternsPerChannel - 1]);\r\n\t\t\tbuffer.push(SongTagCode.instrumentCount, base64IntToCharCode[this.instrumentsPerChannel - 1]);\r\n\t\t\tbuffer.push(SongTagCode.rhythm, base64IntToCharCode[Config.partCounts.indexOf(this.partsPerBeat)]);\r\n\t\t\t\r\n\t\t\tbuffer.push(SongTagCode.channelOctave);\r\n\t\t\tfor (let channel: number = 0; channel < this.getChannelCount(); channel++) {\r\n\t\t\t\tbuffer.push(base64IntToCharCode[this.channels[channel].octave]);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfor (let channel: number = 0; channel < this.getChannelCount(); channel++) {\r\n\t\t\t\tfor (let i: number = 0; i < this.instrumentsPerChannel; i++) {\r\n\t\t\t\t\tconst instrument: Instrument = this.channels[channel].instruments[i];\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (channel < this.pitchChannelCount) {\r\n\t\t\t\t\t\tbuffer.push(SongTagCode.startInstrument, base64IntToCharCode[instrument.type]);\r\n\t\t\t\t\t\tif (instrument.type == InstrumentType.chip) {\r\n\t\t\t\t\t\t\t// chip\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.wave, base64IntToCharCode[instrument.wave]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.filter, base64IntToCharCode[instrument.filter]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.transition, base64IntToCharCode[instrument.transition]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.effect, base64IntToCharCode[instrument.effect]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.harm, base64IntToCharCode[instrument.harm]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.imute, base64IntToCharCode[instrument.imute]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.ipan, base64IntToCharCode[instrument.ipan]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.octoff, base64IntToCharCode[instrument.octoff]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.chorus,base64IntToCharCode[instrument.chorus]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.volume, base64IntToCharCode[instrument.volume]);\r\n\t\t\t\t\t\t} else if (instrument.type == InstrumentType.fm) {\r\n\t\t\t\t\t\t\t// FM\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.transition, base64IntToCharCode[instrument.transition]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.effect, base64IntToCharCode[instrument.effect]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.octoff, base64IntToCharCode[instrument.octoff]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.fmChorus, base64IntToCharCode[instrument.fmChorus]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.imute, base64IntToCharCode[instrument.imute]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.ipan, base64IntToCharCode[instrument.ipan]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.algorithm, base64IntToCharCode[instrument.algorithm]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.feedbackType, base64IntToCharCode[instrument.feedbackType]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.feedbackAmplitude, base64IntToCharCode[instrument.feedbackAmplitude]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.feedbackEnvelope, base64IntToCharCode[instrument.feedbackEnvelope]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.volume, base64IntToCharCode[instrument.volume]);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.operatorFrequencies);\r\n\t\t\t\t\t\t\tfor (let o: number = 0; o < Config.operatorCount; o++) {\r\n\t\t\t\t\t\t\t\tbuffer.push(base64IntToCharCode[instrument.operators[o].frequency]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.operatorAmplitudes);\r\n\t\t\t\t\t\t\tfor (let o: number = 0; o < Config.operatorCount; o++) {\r\n\t\t\t\t\t\t\t\tbuffer.push(base64IntToCharCode[instrument.operators[o].amplitude]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.operatorEnvelopes);\r\n\t\t\t\t\t\t\tfor (let o: number = 0; o < Config.operatorCount; o++) {\r\n\t\t\t\t\t\t\t\tbuffer.push(base64IntToCharCode[instrument.operators[o].envelope]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (instrument.type == InstrumentType.pwm) {\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.wave, base64IntToCharCode[instrument.wave]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.filter, base64IntToCharCode[instrument.filter]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.transition, base64IntToCharCode[instrument.transition]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.effect, base64IntToCharCode[instrument.effect]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.harm, base64IntToCharCode[instrument.harm]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.imute, base64IntToCharCode[instrument.imute]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.ipan, base64IntToCharCode[instrument.ipan]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.octoff, base64IntToCharCode[instrument.octoff]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.chorus, base64IntToCharCode[instrument.chorus]);\r\n\t\t\t\t\t\t\tbuffer.push(SongTagCode.volume, base64IntToCharCode[instrument.volume]);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthrow new Error(\"Unknown instrument type.\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// NOISE\r\n\t\t\t\t\t\tbuffer.push(SongTagCode.startInstrument, base64IntToCharCode[InstrumentType.noise]);\r\n\t\t\t\t\t\tbuffer.push(SongTagCode.wave, base64IntToCharCode[instrument.wave]);\r\n\t\t\t\t\t\tbuffer.push(SongTagCode.transition, base64IntToCharCode[instrument.transition]);\r\n\t\t\t\t\t\tbuffer.push(SongTagCode.volume, base64IntToCharCode[instrument.volume]);\r\n\t\t\t\t\t\tbuffer.push(SongTagCode.imute, base64IntToCharCode[instrument.imute]);\r\n\t\t\t\t\t\tbuffer.push(SongTagCode.harm, base64IntToCharCode[instrument.harm]);\r\n\t\t\t\t\t\tbuffer.push(SongTagCode.octoff, base64IntToCharCode[instrument.octoff]);\r\n\t\t\t\t\t\tbuffer.push(SongTagCode.ipan, base64IntToCharCode[instrument.ipan]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tbuffer.push(SongTagCode.bars);\r\n\t\t\tbits = new BitFieldWriter();\r\n\t\t\tlet neededBits: number = 0;\r\n\t\t\twhile ((1 << neededBits) < this.patternsPerChannel + 1) neededBits++;\r\n\t\t\tfor (let channel: number = 0; channel < this.getChannelCount(); channel++) for (let i: number = 0; i < this.barCount; i++) {\r\n\t\t\t\tbits.write(neededBits, this.channels[channel].bars[i]);\r\n\t\t\t}\r\n\t\t\tbits.encodeBase64(base64IntToCharCode, buffer);\r\n\t\t\t\r\n\t\t\tbuffer.push(SongTagCode.patterns);\r\n\t\t\tbits = new BitFieldWriter();\r\n\t\t\tlet neededInstrumentBits: number = 0;\r\n\t\t\twhile ((1 << neededInstrumentBits) < this.instrumentsPerChannel) neededInstrumentBits++;\r\n\t\t\tfor (let channel: number = 0; channel < this.getChannelCount(); channel++) {\r\n\t\t\t\tconst isDrum: boolean = this.getChannelIsDrum(channel);\r\n\t\t\t\tconst octaveOffset: number = isDrum ? 0 : this.channels[channel].octave * 12;\r\n\t\t\t\tlet lastPitch: number = (isDrum ? 4 : 12) + octaveOffset;\r\n\t\t\t\tconst recentPitches: number[] = isDrum ? [4,6,7,2,3,8,0,10] : [12, 19, 24, 31, 36, 7, 0];\r\n\t\t\t\tconst recentShapes: string[] = [];\r\n\t\t\t\tfor (let i: number = 0; i < recentPitches.length; i++) {\r\n\t\t\t\t\trecentPitches[i] += octaveOffset;\r\n\t\t\t\t}\r\n\t\t\t\tfor (const p of this.channels[channel].patterns) {\r\n\t\t\t\t\tbits.write(neededInstrumentBits, p.instrument);\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (p.notes.length > 0) {\r\n\t\t\t\t\t\tbits.write(1, 1);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlet curPart: number = 0;\r\n\t\t\t\t\t\tfor (const t of p.notes) {\r\n\t\t\t\t\t\t\tif (t.start > curPart) {\r\n\t\t\t\t\t\t\t\tbits.write(2, 0); // rest\r\n\t\t\t\t\t\t\t\tbits.writePartDuration(t.start - curPart);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tconst shapeBits: BitFieldWriter = new BitFieldWriter();\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// 0: 1 pitch, 10: 2 pitches, 110: 3 pitches, 111: 4 pitches\r\n\t\t\t\t\t\t\tfor (let i: number = 1; i < t.pitches.length; i++) shapeBits.write(1,1);\r\n\t\t\t\t\t\t\tif (t.pitches.length < 4) shapeBits.write(1,0);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tshapeBits.writePinCount(t.pins.length - 1);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tshapeBits.write(2, t.pins[0].volume); // volume\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tlet shapePart: number = 0;\r\n\t\t\t\t\t\t\tlet startPitch: number = t.pitches[0];\r\n\t\t\t\t\t\t\tlet currentPitch: number = startPitch;\r\n\t\t\t\t\t\t\tconst pitchBends: number[] = [];\r\n\t\t\t\t\t\t\tfor (let i: number = 1; i < t.pins.length; i++) {\r\n\t\t\t\t\t\t\t\tconst pin: NotePin = t.pins[i];\r\n\t\t\t\t\t\t\t\tconst nextPitch: number = startPitch + pin.interval;\r\n\t\t\t\t\t\t\t\tif (currentPitch != nextPitch) {\r\n\t\t\t\t\t\t\t\t\tshapeBits.write(1, 1);\r\n\t\t\t\t\t\t\t\t\tpitchBends.push(nextPitch);\r\n\t\t\t\t\t\t\t\t\tcurrentPitch = nextPitch;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tshapeBits.write(1, 0);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tshapeBits.writePartDuration(pin.time - shapePart);\r\n\t\t\t\t\t\t\t\tshapePart = pin.time;\r\n\t\t\t\t\t\t\t\tshapeBits.write(2, pin.volume);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tconst shapeString: string = String.fromCharCode.apply(null, shapeBits.encodeBase64(base64IntToCharCode, []));\r\n\t\t\t\t\t\t\tconst shapeIndex: number = recentShapes.indexOf(shapeString);\r\n\t\t\t\t\t\t\tif (shapeIndex == -1) {\r\n\t\t\t\t\t\t\t\tbits.write(2, 1); // new shape\r\n\t\t\t\t\t\t\t\tbits.concat(shapeBits);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tbits.write(1, 1); // old shape\r\n\t\t\t\t\t\t\t\tbits.writeLongTail(0, 0, shapeIndex);\r\n\t\t\t\t\t\t\t\trecentShapes.splice(shapeIndex, 1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\trecentShapes.unshift(shapeString);\r\n\t\t\t\t\t\t\tif (recentShapes.length > 10) recentShapes.pop();\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tconst allPitches: number[] = t.pitches.concat(pitchBends);\r\n\t\t\t\t\t\t\tfor (let i: number = 0; i < allPitches.length; i++) {\r\n\t\t\t\t\t\t\t\tconst pitch: number = allPitches[i];\r\n\t\t\t\t\t\t\t\tconst pitchIndex: number = recentPitches.indexOf(pitch);\r\n\t\t\t\t\t\t\t\tif (pitchIndex == -1) {\r\n\t\t\t\t\t\t\t\t\tlet interval: number = 0;\r\n\t\t\t\t\t\t\t\t\tlet pitchIter: number = lastPitch;\r\n\t\t\t\t\t\t\t\t\tif (pitchIter < pitch) {\r\n\t\t\t\t\t\t\t\t\t\twhile (pitchIter != pitch) {\r\n\t\t\t\t\t\t\t\t\t\t\tpitchIter++;\r\n\t\t\t\t\t\t\t\t\t\t\tif (recentPitches.indexOf(pitchIter) == -1) interval++;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\twhile (pitchIter != pitch) {\r\n\t\t\t\t\t\t\t\t\t\t\tpitchIter--;\r\n\t\t\t\t\t\t\t\t\t\t\tif (recentPitches.indexOf(pitchIter) == -1) interval--;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tbits.write(1, 0);\r\n\t\t\t\t\t\t\t\t\tbits.writePitchInterval(interval);\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tbits.write(1, 1);\r\n\t\t\t\t\t\t\t\t\tbits.write(3, pitchIndex);\r\n\t\t\t\t\t\t\t\t\trecentPitches.splice(pitchIndex, 1);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\trecentPitches.unshift(pitch);\r\n\t\t\t\t\t\t\t\tif (recentPitches.length > 8) recentPitches.pop();\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tif (i == t.pitches.length - 1) {\r\n\t\t\t\t\t\t\t\t\tlastPitch = t.pitches[0];\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tlastPitch = pitch;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcurPart = t.end;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (curPart < this.beatsPerBar * this.partsPerBeat) {\r\n\t\t\t\t\t\t\tbits.write(2, 0); // rest\r\n\t\t\t\t\t\t\tbits.writePartDuration(this.beatsPerBar * this.partsPerBeat - curPart);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbits.write(1, 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet stringLength: number = bits.lengthBase64();\r\n\t\t\tlet digits: number[] = [];\r\n\t\t\twhile (stringLength > 0) {\r\n\t\t\t\tdigits.unshift(base64IntToCharCode[stringLength & 0x3f]);\r\n\t\t\t\tstringLength = stringLength >> 6;\r\n\t\t\t}\r\n\t\t\tbuffer.push(base64IntToCharCode[digits.length]);\r\n\t\t\tArray.prototype.push.apply(buffer, digits); // append digits to buffer.\r\n\t\t\tbits.encodeBase64(base64IntToCharCode, buffer);\r\n\t\t\t\r\n\t\t\t// HACK: This breaks for strings longer than 65535. \r\n\t\t\tif (buffer.length >= 65535) throw new Error(\"Song hash code too long.\");\r\n\t\t\treturn String.fromCharCode.apply(null, buffer);\r\n\t\t}\r\n\t\t\r\n\t\tpublic fromBase64String(compressed: string): void {\r\n\t\t\tif (compressed == null || compressed == \"\") {\r\n\t\t\t\tthis.initToDefault(true);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet charIndex: number = 0;\r\n\t\t\t// skip whitespace.\r\n\t\t\twhile (compressed.charCodeAt(charIndex) <= CharCode.SPACE) charIndex++;\r\n\t\t\t// skip hash mark.\r\n\t\t\tif (compressed.charCodeAt(charIndex) == CharCode.HASH) charIndex++;\r\n\t\t\t// if it starts with curly brace, treat it as JSON.\r\n\t\t\tif (compressed.charCodeAt(charIndex) == CharCode.LEFT_CURLY_BRACE) {\r\n\t\t\t\tthis.fromJsonObject(JSON.parse(charIndex == 0 ? compressed : compressed.substring(charIndex)));\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst variantTest: number = compressed.charCodeAt(charIndex);\r\n        \tlet fromOld: boolean;\r\n        \tlet fromNepBox: boolean;\r\n\r\n\t\t\t// Detect variant here. If version doesn't match known variant, assume it is a vanilla string which does not report variant.\r\n\t\t\tif (variantTest == 0x6E) { //\"n\"\r\n\t\t\t\tfromOld = false;\r\n\t\t\t\tfromNepBox = true;\r\n\t\t\t\tcharIndex++;\r\n\t\t\t} else {\r\n\t\t\t\tfromOld = true;\r\n\t\t\t\tfromNepBox = false;\r\n\t\t\t}\r\n\r\n\t\t\tconst version: number = Song._base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\tif (fromOld && (version == -1 || version > Song._latestBeepboxVersion || version < Song._oldestBeepboxVersion)) return;\r\n\t\t\tif (fromNepBox && (version == -1 || version > Song._latestNepBoxVersion || version < Song._oldestNepBoxVersion)) return;\r\n\t\t\t//const beforeTwo:   boolean = version < 2;\r\n\t\t\tconst beforeThree: boolean = version < 3;\r\n\t\t\tconst beforeFour:  boolean = version < 4;\r\n\t\t\tconst beforeFive:  boolean = version < 5;\r\n\t\t\tconst beforeSix:   boolean = version < 6;\r\n\t\t\tconst base64CharCodeToInt: ReadonlyArray<number> = Song._base64CharCodeToInt;\r\n\t\t\tthis.initToDefault((fromOld && beforeSix) || (fromNepBox));\r\n\t\t\t\r\n\t\t\tif (fromOld && beforeThree) {\r\n\t\t\t\t// Originally, the only instrument transition was \"seamless\" and the only drum wave was \"retro\".\r\n\t\t\t\tfor (const channel of this.channels) channel.instruments[0].transition = 0;\r\n\t\t\t\tthis.channels[3].instruments[0].wave = 0;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tlet instrumentChannelIterator: number = 0;\r\n\t\t\tlet instrumentIndexIterator: number = -1;\r\n\t\t\t\r\n\t\t\twhile (charIndex < compressed.length) {\r\n\t\t\t\tconst command: number = compressed.charCodeAt(charIndex++);\r\n\t\t\t\tlet channel: number;\r\n\t\t\t\tif (command == SongTagCode.channelCount) {\r\n\t\t\t\t\tthis.pitchChannelCount = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t\tthis.drumChannelCount  = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t\tthis.pitchChannelCount = clamp(Config.pitchChannelCountMin, Config.pitchChannelCountMax + 1, this.pitchChannelCount);\r\n\t\t\t\t\tthis.drumChannelCount = clamp(Config.drumChannelCountMin, Config.drumChannelCountMax + 1, this.drumChannelCount);\r\n\t\t\t\t\tfor (let channelIndex = this.channels.length; channelIndex < this.getChannelCount(); channelIndex++) {\r\n\t\t\t\t\t\tthis.channels[channelIndex] = new Channel();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.channels.length = this.getChannelCount();\r\n\t\t\t\t} else if (command == SongTagCode.scale) {\r\n\t\t\t\t\tthis.scale = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t\tif ((fromOld && beforeThree) && this.scale == 10) this.scale = 11;\r\n\t\t\t\t} else if (command == SongTagCode.mix) {\r\n\t\t\t\t\tthis.mix = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t} else if (command == SongTagCode.key) {\r\n\t\t\t\t\t\tthis.key = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t} else if (command == SongTagCode.setSongTheme) {\r\n\t\t\t\t\tif (fromOld) {\r\n\t\t\t\t\t\tvar themeIndex = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t\t\tvar themes = [\"none\", \"modbox2\", \"artic\", \"Cinnamon Roll\", \"Ocean\", \"rainbow\", \"float\", \"windows\", \"grassland\", \"dessert\", \"kahootiest\", \"beambit\", \"egg\", \"Poniryoshka\", \"gameboy\", \"woodkid\", \"midnight\", \"snedbox\", \"unnamed\", \"piano\", \"halloween\", \"frozen\"];\r\n\t\t\t\t\t\tthis.setSongTheme = themes[themeIndex];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar songThemeLength = (base64CharCodeToInt[compressed.charCodeAt(charIndex++)] << 6) + base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t\t\tthis.setSongTheme = decodeURIComponent(compressed.substring(charIndex, charIndex + songThemeLength));\r\n\t\t\t\t\t\tcharIndex += songThemeLength;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (command == SongTagCode.loopStart) {\r\n\t\t\t\t\tif (fromOld && beforeFive) {\r\n\t\t\t\t\t\tthis.loopStart = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.loopStart = (base64CharCodeToInt[compressed.charCodeAt(charIndex++)] << 6) + base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (command == SongTagCode.loopEnd) {\r\n\t\t\t\t\tif (fromOld && beforeFive) {\r\n\t\t\t\t\t\tthis.loopLength = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.loopLength = (base64CharCodeToInt[compressed.charCodeAt(charIndex++)] << 6) + base64CharCodeToInt[compressed.charCodeAt(charIndex++)] + 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (command == SongTagCode.tempo) {\r\n\t\t\t\t\tif (fromOld) {\r\n\t\t\t\t\t\tif (beforeFour) {\r\n\t\t\t\t\t\t\tthis.tempo = [1, 4, 7, 10][base64CharCodeToInt[compressed.charCodeAt(charIndex++)]];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.tempo = [88, 95, 103, 111, 120, 130, 140, 151, 163, 176, 190, 206, 222, 240, 259][base64CharCodeToInt[compressed.charCodeAt(charIndex++)]];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.tempo = (base64CharCodeToInt[compressed.charCodeAt(charIndex++)] << 6) + base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.tempo = clamp(Config.tempoMin, Config.tempoMax, this.tempo);\r\n\t\t\t\t} else if (command == SongTagCode.reverb) {\r\n\t\t\t\t\tthis.reverb = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t\tthis.reverb = clamp(0, Config.reverbRange, this.reverb);\r\n\t\t\t\t} else if (command == SongTagCode.blend) {\r\n\t\t\t\t\tthis.blend = clamp(0, Config.blendRange, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t} else if (command == SongTagCode.riff) {\r\n\t\t\t\t\tthis.riff = clamp(0, Config.riffRange, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t} else if (command == SongTagCode.sampleRate) {\r\n\t\t\t\t\tthis.sampleRate = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t} else if (command == SongTagCode.detune) {\r\n\t\t\t\t\tthis.detune = clamp(0, Config.detuneRange, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t} else if (command == SongTagCode.muff) {\r\n\t\t\t\t\tthis.muff = clamp(0, Config.muffRange, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t} else if (command == SongTagCode.beatCount) {\r\n\t\t\t\t\tif (fromOld && beforeThree) {\r\n\t\t\t\t\t\tthis.beatsPerBar = [6, 7, 8, 9, 10][base64CharCodeToInt[compressed.charCodeAt(charIndex++)]];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.beatsPerBar = base64CharCodeToInt[compressed.charCodeAt(charIndex++)] + 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.beatsPerBar = Math.max(Config.beatsPerBarMin, Math.min(Config.beatsPerBarMax, this.beatsPerBar));\r\n\t\t\t\t} else if (command == SongTagCode.barCount) {\r\n\t\t\t\t\tthis.barCount = (base64CharCodeToInt[compressed.charCodeAt(charIndex++)] << 6) + base64CharCodeToInt[compressed.charCodeAt(charIndex++)] + 1;\r\n\t\t\t\t\tthis.barCount = Math.max(Config.barCountMin, Math.min(Config.barCountMax, this.barCount));\r\n\t\t\t\t\tfor (let channel = 0; channel < this.getChannelCount(); channel++) {\r\n\t\t\t\t\t\tfor (let bar = this.channels[channel].bars.length; bar < this.barCount; bar++) {\r\n\t\t\t\t\t\t\tthis.channels[channel].bars[bar] = 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.channels[channel].bars.length = this.barCount;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (command == SongTagCode.patternCount) {\r\n\t\t\t\t\tthis.patternsPerChannel = base64CharCodeToInt[compressed.charCodeAt(charIndex++)] + 1;\r\n\t\t\t\t\tthis.patternsPerChannel = Math.max(1, Math.min(Config.barCountMax, this.patternsPerChannel));\r\n\t\t\t\t\tfor (let channel = 0; channel < this.getChannelCount(); channel++) {\r\n\t\t\t\t\t\tfor (let pattern = this.channels[channel].patterns.length; pattern < this.patternsPerChannel; pattern++) {\r\n\t\t\t\t\t\t\tthis.channels[channel].patterns[pattern] = new Pattern();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.channels[channel].patterns.length = this.patternsPerChannel;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (command == SongTagCode.instrumentCount) {\r\n\t\t\t\t\tthis.instrumentsPerChannel = base64CharCodeToInt[compressed.charCodeAt(charIndex++)] + 1;\r\n\t\t\t\t\tthis.instrumentsPerChannel = Math.max(Config.instrumentsPerChannelMin, Math.min(Config.instrumentsPerChannelMax, this.instrumentsPerChannel));\r\n\t\t\t\t\tfor (let channel = 0; channel < this.getChannelCount(); channel++) {\r\n\t\t\t\t\t\tfor (let instrument = this.channels[channel].instruments.length; instrument < this.instrumentsPerChannel; instrument++) {\r\n\t\t\t\t\t\t\tthis.channels[channel].instruments[instrument] = new Instrument();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.channels[channel].instruments.length = this.instrumentsPerChannel;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (command == SongTagCode.rhythm) {\r\n\t\t\t\t\tthis.partsPerBeat = Config.partCounts[base64CharCodeToInt[compressed.charCodeAt(charIndex++)]];\r\n\t\t\t\t} else if (command == SongTagCode.channelOctave) {\r\n\t\t\t\t\tif (fromOld && beforeThree) {\r\n\t\t\t\t\t\tchannel = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t\t\tthis.channels[channel].octave = clamp(0, 5, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tfor (channel = 0; channel < this.getChannelCount(); channel++) {\r\n\t\t\t\t\t\t\tthis.channels[channel].octave = clamp(0, 5, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (command == SongTagCode.startInstrument) {\r\n\t\t\t\t\tinstrumentIndexIterator++;\r\n\t\t\t\t\tif (instrumentIndexIterator >= this.instrumentsPerChannel) {\r\n\t\t\t\t\t\tinstrumentChannelIterator++;\r\n\t\t\t\t\t\tinstrumentIndexIterator = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst isPitchChannel: boolean = instrumentChannelIterator < this.pitchChannelCount;\r\n\t\t\t\t\tconst instrument: Instrument = this.channels[instrumentChannelIterator].instruments[instrumentIndexIterator];\r\n\t\t\t\t\tconst rawInstrumentType: number = clamp(0, 4, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\tlet instrumentType: number = rawInstrumentType;\r\n\t\t\t\t\tif (instrumentType == InstrumentType.noise && isPitchChannel) {\r\n\t\t\t\t\t\tinstrumentType = InstrumentType.pwm;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tinstrument.setTypeAndReset(instrumentType);\r\n\t\t\t\t} else if (command == SongTagCode.wave) {\r\n\t\t\t\t\tif (fromOld && beforeThree) {\r\n\t\t\t\t\t\tchannel = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t\t\tthis.channels[channel].instruments[0].wave = clamp(0, Config.waveNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\t} else if (fromOld && beforeSix) {\r\n\t\t\t\t\t\tfor (channel = 0; channel < this.getChannelCount(); channel++) {\r\n\t\t\t\t\t\t\tconst isDrums = (channel >= this.pitchChannelCount);\r\n\t\t\t\t\t\t\tfor (let i: number = 0; i < this.instrumentsPerChannel; i++) {\r\n\t\t\t\t\t\t\t\tthis.channels[channel].instruments[i].wave = clamp(0, isDrums ? Config.drumNames.length : Config.waveNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconst isDrums = (instrumentChannelIterator >= this.pitchChannelCount);\r\n\t\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].wave = clamp(0, isDrums ? Config.drumNames.length : Config.waveNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (command == SongTagCode.filter) {\r\n\t\t\t\t\tif (fromOld && beforeThree) {\r\n\t\t\t\t\t\tchannel = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t\t\tthis.channels[channel].instruments[0].filter = [1, 3, 4, 5][clamp(0, Config.filterNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)])];\r\n\t\t\t\t\t} else if (fromOld && beforeSix) {\r\n\t\t\t\t\t\tfor (channel = 0; channel < this.getChannelCount(); channel++) {\r\n\t\t\t\t\t\t\tfor (let i: number = 0; i < this.instrumentsPerChannel; i++) {\r\n\t\t\t\t\t\t\t\tthis.channels[channel].instruments[i].filter = clamp(0, Config.filterNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)] + 1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].filter = clamp(0, Config.filterNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (command == SongTagCode.transition) {\r\n\t\t\t\t\tif (fromOld && beforeThree) {\r\n\t\t\t\t\t\tchannel = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t\t\tthis.channels[channel].instruments[0].transition = clamp(0, Config.transitionNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\t} else if (fromOld && beforeSix) {\r\n\t\t\t\t\t\tfor (channel = 0; channel < this.getChannelCount(); channel++) {\r\n\t\t\t\t\t\t\tfor (let i: number = 0; i < this.instrumentsPerChannel; i++) {\r\n\t\t\t\t\t\t\t\tthis.channels[channel].instruments[i].transition = clamp(0, Config.transitionNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].transition = clamp(0, Config.transitionNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (command == SongTagCode.effect) {\r\n\t\t\t\t\tif (fromOld && beforeThree) {\r\n\t\t\t\t\t\tchannel = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t\t\tlet effect: number = clamp(0, Config.effectNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\t\tif (effect == 1) effect = 3;\r\n\t\t\t\t\t\telse if (effect == 3) effect = 5;\r\n\t\t\t\t\t\tthis.channels[channel].instruments[0].effect = effect;\r\n\t\t\t\t\t} else if (fromOld && beforeSix) {\r\n\t\t\t\t\t\tfor (channel = 0; channel < this.getChannelCount(); channel++) {\r\n\t\t\t\t\t\t\tfor (let i: number = 0; i < this.instrumentsPerChannel; i++) {\r\n\t\t\t\t\t\t\t\tthis.channels[channel].instruments[i].effect = clamp(0, Config.effectNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].effect = clamp(0, Config.effectNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (command == SongTagCode.chorus) {\r\n\t\t\t\t\tif (fromOld && beforeThree) {\r\n\t\t\t\t\t\tchannel = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t\t\tthis.channels[channel].instruments[0].chorus = clamp(0, Config.chorusNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\t} else if (fromOld && beforeSix) {\r\n\t\t\t\t\t\tfor (channel = 0; channel < this.getChannelCount(); channel++) {\r\n\t\t\t\t\t\t\tfor (let i: number = 0; i < this.instrumentsPerChannel; i++) {\r\n\t\t\t\t\t\t\t\tthis.channels[channel].instruments[i].chorus = clamp(0, Config.chorusNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].chorus = clamp(0, Config.chorusNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (command == SongTagCode.harm) {\r\n\t\t\t\t\t// Harmony was added in this commit: https://github.com/ModdedBeepbox/modded-beepbox-2.3/commit/cd1cc3d1891eda506e77e7619822ec2a48f375f2\r\n\t\t\t\t\t// _latestVersion was 5 in that commit, so the beforeThree\r\n\t\t\t\t\t// if in the reading code shouldn't ever run. Thus, it has\r\n\t\t\t\t\t// been omitted here.\r\n\t\t\t\t\tif (fromOld && beforeSix) {\r\n\t\t\t\t\t\tfor (channel = 0; channel < this.getChannelCount(); channel++) {\r\n\t\t\t\t\t\t\tfor (let i: number = 0; i < this.instrumentsPerChannel; i++) {\r\n\t\t\t\t\t\t\t\tthis.channels[channel].instruments[i].harm = clamp(0, Config.harmNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].harm = clamp(0, Config.harmNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (command == SongTagCode.fmChorus) {\r\n\t\t\t\t\t// FM chorus was added in this commit: https://github.com/ModdedBeepbox/beta/commit/5c47acd9e5892709596d81df987a496f468b7115\r\n\t\t\t\t\t// Smaller diff: https://github.com/ModdedBeepbox/beta/compare/5427a7c491aae9fef15576bbc33a0d43ca18f758..5c47acd9e5892709596d81df987a496f468b7115\r\n\t\t\t\t\t// _latestVersion remained 6 before and after this, and the\r\n\t\t\t\t\t// tag code was never used for anything else previously, so\r\n\t\t\t\t\t// no backwards compatibility code is needed here.\r\n\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].fmChorus = clamp(0, Config.fmChorusNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t} else if (command == SongTagCode.imute) {\r\n\t\t\t\t\t// Muting was added in this commit: https://github.com/ModdedBeepbox/3.0/commit/f177e34831ab85c58e0492ae47a5df80e709d9b4\r\n\t\t\t\t\t// _latestVersion remained 6 before and after this, and the\r\n\t\t\t\t\t// tag code was never used for anything else previously, so\r\n\t\t\t\t\t// no backwards compatibility code is needed here.\r\n\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].imute = clamp(0, Config.imuteNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t} else if (command == SongTagCode.ipan) {\r\n\t\t\t\t\t// @TODO: Add SongTagCode.oldIpan = CharCode.M? Normally it\r\n\t\t\t\t\t// will be ignored if present on songs made before Oct 22, 2018\r\n\t\t\t\t\t// or so.\r\n\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].ipan = clamp(0, Config.ipanValues.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t} else if (command == SongTagCode.octoff) {\r\n\t\t\t\t\t// Octave offset was first added in this commit: https://github.com/ModdedBeepbox/3.0/commit/54bdad302110cbde72b18f041091e53e3c35c189 (see BeepBox_files/5_channel.js)\r\n\t\t\t\t\t// It used CharCode.VERTICAL_LINE as the tag code value.\r\n\t\t\t\t\t// Later, it was changed to use CharCode.B in this commit: https://github.com/ModdedBeepbox/3.0/commit/84b9a7608c22addf01af2acebee6d5f6c65a5122\r\n\t\t\t\t\t// _latestVersion was 5, and the only major difference here\r\n\t\t\t\t\t// is that the octave offsets were pushed for every channel\r\n\t\t\t\t\t// one after another.\r\n\t\t\t\t\t// The beforeThree if was never needed.\r\n\t\t\t\t\tif (fromOld && beforeSix) {\r\n\t\t\t\t\t\tfor (channel = 0; channel < this.getChannelCount(); channel++) {\r\n\t\t\t\t\t\t\tfor (let i: number = 0; i < this.instrumentsPerChannel; i++) {\r\n\t\t\t\t\t\t\t\tthis.channels[channel].instruments[i].octoff = clamp(0, Config.octoffNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].octoff = clamp(0, Config.octoffNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (command == SongTagCode.volume) {\r\n\t\t\t\t\tif (fromOld && beforeThree) {\r\n\t\t\t\t\t\tchannel = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t\t\tthis.channels[channel].instruments[0].volume = clamp(0, Config.volumeNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\t} else if (fromOld && beforeSix) {\r\n\t\t\t\t\t\tfor (channel = 0; channel < this.getChannelCount(); channel++) {\r\n\t\t\t\t\t\t\tfor (let i: number = 0; i < this.instrumentsPerChannel; i++) {\r\n\t\t\t\t\t\t\t\tthis.channels[channel].instruments[i].volume = clamp(0, Config.volumeNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].volume = clamp(0, Config.volumeNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (command == SongTagCode.algorithm) {\r\n\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].algorithm = clamp(0, Config.operatorAlgorithmNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t} else if (command == SongTagCode.feedbackType) {\r\n\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].feedbackType = clamp(0, Config.operatorFeedbackNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t} else if (command == SongTagCode.feedbackAmplitude) {\r\n\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].feedbackAmplitude = clamp(0, Config.operatorAmplitudeMax + 1, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t} else if (command == SongTagCode.feedbackEnvelope) {\r\n\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].feedbackEnvelope = clamp(0, Config.operatorEnvelopeNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t} else if (command == SongTagCode.operatorFrequencies) {\r\n\t\t\t\t\tfor (let o: number = 0; o < Config.operatorCount; o++) {\r\n\t\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].operators[o].frequency = clamp(0, Config.operatorFrequencyNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (command == SongTagCode.operatorAmplitudes) {\r\n\t\t\t\t\tfor (let o: number = 0; o < Config.operatorCount; o++) {\r\n\t\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].operators[o].amplitude = clamp(0, Config.operatorAmplitudeMax + 1, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (command == SongTagCode.operatorEnvelopes) {\r\n\t\t\t\t\tfor (let o: number = 0; o < Config.operatorCount; o++) {\r\n\t\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].operators[o].envelope = clamp(0, Config.operatorEnvelopeNames.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (command == SongTagCode.bars) {\r\n\t\t\t\t\tlet subStringLength: number;\r\n\t\t\t\t\tif (fromOld && beforeThree) {\r\n\t\t\t\t\t\tchannel = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t\t\tconst barCount: number = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t\t\tsubStringLength = Math.ceil(barCount * 0.5);\r\n\t\t\t\t\t\tconst bits: BitFieldReader = new BitFieldReader(base64CharCodeToInt, compressed, charIndex, charIndex + subStringLength);\r\n\t\t\t\t\t\tfor (let i: number = 0; i < barCount; i++) {\r\n\t\t\t\t\t\t\tthis.channels[channel].bars[i] = bits.read(3) + 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (fromOld && beforeFive) {\r\n\t\t\t\t\t\tlet neededBits: number = 0;\r\n\t\t\t\t\t\twhile ((1 << neededBits) < this.patternsPerChannel) neededBits++;\r\n\t\t\t\t\t\tsubStringLength = Math.ceil(this.getChannelCount() * this.barCount * neededBits / 6);\r\n\t\t\t\t\t\tconst bits: BitFieldReader = new BitFieldReader(base64CharCodeToInt, compressed, charIndex, charIndex + subStringLength);\r\n\t\t\t\t\t\tfor (channel = 0; channel < this.getChannelCount(); channel++) {\r\n\t\t\t\t\t\t\tfor (let i: number = 0; i < this.barCount; i++) {\r\n\t\t\t\t\t\t\t\tthis.channels[channel].bars[i] = bits.read(neededBits) + 1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlet neededBits: number = 0;\r\n\t\t\t\t\t\twhile ((1 << neededBits) < this.patternsPerChannel + 1) neededBits++;\r\n\t\t\t\t\t\tsubStringLength = Math.ceil(this.getChannelCount() * this.barCount * neededBits / 6);\r\n\t\t\t\t\t\tconst bits: BitFieldReader = new BitFieldReader(base64CharCodeToInt, compressed, charIndex, charIndex + subStringLength);\r\n\t\t\t\t\t\tfor (channel = 0; channel < this.getChannelCount(); channel++) {\r\n\t\t\t\t\t\t\tfor (let i: number = 0; i < this.barCount; i++) {\r\n\t\t\t\t\t\t\t\tthis.channels[channel].bars[i] = bits.read(neededBits);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcharIndex += subStringLength;\r\n\t\t\t\t} else if (command == SongTagCode.patterns) {\r\n\t\t\t\t\tlet bitStringLength: number = 0;\r\n\t\t\t\t\tif (fromOld && beforeThree) {\r\n\t\t\t\t\t\tchannel = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// The old format used the next character to represent the number of patterns in the channel, which is usually eight, the default. \r\n\t\t\t\t\t\tcharIndex++; //let patternCount: number = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tbitStringLength = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t\t\tbitStringLength = bitStringLength << 6;\r\n\t\t\t\t\t\tbitStringLength += base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tchannel = 0;\r\n\t\t\t\t\t\tlet bitStringLengthLength: number = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t\t\twhile (bitStringLengthLength > 0) {\r\n\t\t\t\t\t\t\tbitStringLength = bitStringLength << 6;\r\n\t\t\t\t\t\t\tbitStringLength += base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\r\n\t\t\t\t\t\t\tbitStringLengthLength--;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst bits: BitFieldReader = new BitFieldReader(base64CharCodeToInt, compressed, charIndex, charIndex + bitStringLength);\r\n\t\t\t\t\tcharIndex += bitStringLength;\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet neededInstrumentBits: number = 0;\r\n\t\t\t\t\twhile ((1 << neededInstrumentBits) < this.instrumentsPerChannel) neededInstrumentBits++;\r\n\t\t\t\t\twhile (true) {\r\n\t\t\t\t\t\tconst isDrum: boolean = this.getChannelIsDrum(channel);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tconst octaveOffset: number = isDrum ? 0 : this.channels[channel].octave * 12;\r\n\t\t\t\t\t\tlet note: Note | null = null;\r\n\t\t\t\t\t\tlet pin: NotePin | null = null;\r\n\t\t\t\t\t\tlet lastPitch: number = (isDrum ? 4 : 12) + octaveOffset;\r\n\t\t\t\t\t\tconst recentPitches: number[] = isDrum ? [4,6,7,2,3,8,0,10] : [12, 19, 24, 31, 36, 7, 0];\r\n\t\t\t\t\t\tconst recentShapes: any[] = [];\r\n\t\t\t\t\t\tfor (let i: number = 0; i < recentPitches.length; i++) {\r\n\t\t\t\t\t\t\trecentPitches[i] += octaveOffset;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (let i: number = 0; i < this.patternsPerChannel; i++) {\r\n\t\t\t\t\t\t\tconst newPattern: Pattern = this.channels[channel].patterns[i];\r\n\t\t\t\t\t\t\tnewPattern.reset();\r\n\t\t\t\t\t\t\tnewPattern.instrument = bits.read(neededInstrumentBits);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (((fromOld && !beforeThree) || fromNepBox) && bits.read(1) == 0) continue;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tlet curPart: number = 0;\r\n\t\t\t\t\t\t\tconst newNotes: Note[] = newPattern.notes;\r\n\t\t\t\t\t\t\twhile (curPart < this.beatsPerBar * this.partsPerBeat) {\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tconst useOldShape: boolean = bits.read(1) == 1;\r\n\t\t\t\t\t\t\t\tlet newNote: boolean = false;\r\n\t\t\t\t\t\t\t\tlet shapeIndex: number = 0;\r\n\t\t\t\t\t\t\t\tif (useOldShape) {\r\n\t\t\t\t\t\t\t\t\tshapeIndex = bits.readLongTail(0, 0);\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tnewNote = bits.read(1) == 1;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tif (!useOldShape && !newNote) {\r\n\t\t\t\t\t\t\t\t\tconst restLength: number = bits.readPartDuration();\r\n\t\t\t\t\t\t\t\t\tcurPart += restLength;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tlet shape: any;\r\n\t\t\t\t\t\t\t\t\tlet pinObj: any;\r\n\t\t\t\t\t\t\t\t\tlet pitch: number;\r\n\t\t\t\t\t\t\t\t\tif (useOldShape) {\r\n\t\t\t\t\t\t\t\t\t\tshape = recentShapes[shapeIndex];\r\n\t\t\t\t\t\t\t\t\t\trecentShapes.splice(shapeIndex, 1);\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tshape = {};\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tshape.pitchCount = 1;\r\n\t\t\t\t\t\t\t\t\t\twhile (shape.pitchCount < 4 && bits.read(1) == 1) shape.pitchCount++;\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tshape.pinCount = bits.readPinCount();\r\n\t\t\t\t\t\t\t\t\t\tshape.initialVolume = bits.read(2);\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tshape.pins = [];\r\n\t\t\t\t\t\t\t\t\t\tshape.length = 0;\r\n\t\t\t\t\t\t\t\t\t\tshape.bendCount = 0;\r\n\t\t\t\t\t\t\t\t\t\tfor (let j: number = 0; j < shape.pinCount; j++) {\r\n\t\t\t\t\t\t\t\t\t\t\tpinObj = {};\r\n\t\t\t\t\t\t\t\t\t\t\tpinObj.pitchBend = bits.read(1) == 1;\r\n\t\t\t\t\t\t\t\t\t\t\tif (pinObj.pitchBend) shape.bendCount++;\r\n\t\t\t\t\t\t\t\t\t\t\tshape.length += bits.readPartDuration();\r\n\t\t\t\t\t\t\t\t\t\t\tpinObj.time = shape.length;\r\n\t\t\t\t\t\t\t\t\t\t\tpinObj.volume = bits.read(2);\r\n\t\t\t\t\t\t\t\t\t\t\tshape.pins.push(pinObj);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\trecentShapes.unshift(shape);\r\n\t\t\t\t\t\t\t\t\tif (recentShapes.length > 10) recentShapes.pop();\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tnote = makeNote(0,curPart,curPart + shape.length, shape.initialVolume);\r\n\t\t\t\t\t\t\t\t\tnote.pitches = [];\r\n\t\t\t\t\t\t\t\t\tnote.pins.length = 1;\r\n\t\t\t\t\t\t\t\t\tconst pitchBends: number[] = [];\r\n\t\t\t\t\t\t\t\t\tfor (let j: number = 0; j < shape.pitchCount + shape.bendCount; j++) {\r\n\t\t\t\t\t\t\t\t\t\tconst useOldPitch: boolean = bits.read(1) == 1;\r\n\t\t\t\t\t\t\t\t\t\tif (!useOldPitch) {\r\n\t\t\t\t\t\t\t\t\t\t\tconst interval: number = bits.readPitchInterval();\r\n\t\t\t\t\t\t\t\t\t\t\tpitch = lastPitch;\r\n\t\t\t\t\t\t\t\t\t\t\tlet intervalIter: number = interval;\r\n\t\t\t\t\t\t\t\t\t\t\twhile (intervalIter > 0) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tpitch++;\r\n\t\t\t\t\t\t\t\t\t\t\t\twhile (recentPitches.indexOf(pitch) != -1) pitch++;\r\n\t\t\t\t\t\t\t\t\t\t\t\tintervalIter--;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\twhile (intervalIter < 0) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tpitch--;\r\n\t\t\t\t\t\t\t\t\t\t\t\twhile (recentPitches.indexOf(pitch) != -1) pitch--;\r\n\t\t\t\t\t\t\t\t\t\t\t\tintervalIter++;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\tconst pitchIndex: number = bits.read(3);\r\n\t\t\t\t\t\t\t\t\t\t\tpitch = recentPitches[pitchIndex];\r\n\t\t\t\t\t\t\t\t\t\t\trecentPitches.splice(pitchIndex, 1);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\trecentPitches.unshift(pitch);\r\n\t\t\t\t\t\t\t\t\t\tif (recentPitches.length > 8) recentPitches.pop();\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tif (j < shape.pitchCount) {\r\n\t\t\t\t\t\t\t\t\t\t\tnote.pitches.push(pitch);\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\tpitchBends.push(pitch);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tif (j == shape.pitchCount - 1) {\r\n\t\t\t\t\t\t\t\t\t\t\tlastPitch = note.pitches[0];\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\tlastPitch = pitch;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tpitchBends.unshift(note.pitches[0]);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tfor (const pinObj of shape.pins) {\r\n\t\t\t\t\t\t\t\t\t\tif (pinObj.pitchBend) pitchBends.shift();\r\n\t\t\t\t\t\t\t\t\t\tpin = makeNotePin(pitchBends[0] - note.pitches[0], pinObj.time, pinObj.volume);\r\n\t\t\t\t\t\t\t\t\t\tnote.pins.push(pin);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tcurPart = note.end;\r\n\t\t\t\t\t\t\t\t\tnewNotes.push(note);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (fromOld && beforeThree) {\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tchannel++;\r\n\t\t\t\t\t\t\tif (channel >= this.getChannelCount()) break;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} // while (true)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tpublic toJsonObject(enableIntro: boolean = true, loopCount: number = 1, enableOutro: boolean = true): Object {\r\n\t\t\tconst channelArray: Object[] = [];\r\n\t\t\tfor (let channel: number = 0; channel < this.getChannelCount(); channel++) {\r\n\t\t\t\tconst instrumentArray: Object[] = [];\r\n\t\t\t\tconst isDrum: boolean = this.getChannelIsDrum(channel);\r\n\t\t\t\tfor (let i: number = 0; i < this.instrumentsPerChannel; i++) {\r\n\t\t\t\t\tconst instrument: Instrument = this.channels[channel].instruments[i];\r\n\t\t\t\t\tif (isDrum) {\r\n\t\t\t\t\t\tinstrumentArray.push({\r\n\t\t\t\t\t\t\ttype: Config.instrumentTypeNames[InstrumentType.noise],\r\n\t\t\t\t\t\t\tvolume: (5 - instrument.volume) * 20,\r\n\t\t\t\t\t\t\timute: Config.imuteNames[instrument.imute],\r\n\t\t\t\t\t\t\twave: Config.drumNames[instrument.wave],\r\n\t\t\t\t\t\t\ttransition: Config.transitionNames[instrument.transition],\r\n\t\t\t\t\t\t\toctoff: Config.octoffNames[instrument.octoff],\r\n\t\t\t\t\t\t\tipan: Config.ipanValues[instrument.ipan],\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (instrument.type == InstrumentType.chip) {\r\n\t\t\t\t\t\t\tinstrumentArray.push({\r\n\t\t\t\t\t\t\t\ttype: Config.instrumentTypeNames[instrument.type],\r\n\t\t\t\t\t\t\t\tvolume: (5 - instrument.volume) * 20,\r\n\t\t\t\t\t\t\t\twave: Config.waveNames[instrument.wave],\r\n\t\t\t\t\t\t\t\ttransition: Config.transitionNames[instrument.transition],\r\n\t\t\t\t\t\t\t\tfilter: Config.filterNames[instrument.filter],\r\n\t\t\t\t\t\t\t\tchorus: Config.chorusNames[instrument.chorus],\r\n\t\t\t\t\t\t\t\teffect: Config.effectNames[instrument.effect],\r\n\t\t\t\t\t\t\t\tharm: Config.harmNames[instrument.harm],\r\n\t\t\t\t\t\t\t\timute: Config.imuteNames[instrument.imute],\r\n\t\t\t\t\t\t\t\toctoff: Config.octoffNames[instrument.octoff],\r\n\t\t\t\t\t\t\t\tipan: Config.ipanValues[instrument.ipan],\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else if (instrument.type == InstrumentType.fm) {\r\n\t\t\t\t\t\t\tconst operatorArray: Object[] = [];\r\n\t\t\t\t\t\t\tfor (const operator of instrument.operators) {\r\n\t\t\t\t\t\t\t\toperatorArray.push({\r\n\t\t\t\t\t\t\t\t\tfrequency: Config.operatorFrequencyNames[operator.frequency],\r\n\t\t\t\t\t\t\t\t\tamplitude: operator.amplitude,\r\n\t\t\t\t\t\t\t\t\tenvelope: Config.operatorEnvelopeNames[operator.envelope],\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tinstrumentArray.push({\r\n\t\t\t\t\t\t\t\ttype: Config.instrumentTypeNames[instrument.type],\r\n\t\t\t\t\t\t\t\tvolume: (5 - instrument.volume) * 20,\r\n\t\t\t\t\t\t\t\ttransition: Config.transitionNames[instrument.transition],\r\n\t\t\t\t\t\t\t\teffect: Config.effectNames[instrument.effect],\r\n\t\t\t\t\t\t\t\toctoff: Config.octoffNames[instrument.octoff],\r\n\t\t\t\t\t\t\t\tfmChorus: Config.fmChorusNames[instrument.fmChorus],\r\n\t\t\t\t\t\t\t\talgorithm: Config.operatorAlgorithmNames[instrument.algorithm],\r\n\t\t\t\t\t\t\t\tfeedbackType: Config.operatorFeedbackNames[instrument.feedbackType],\r\n\t\t\t\t\t\t\t\tfeedbackAmplitude: instrument.feedbackAmplitude,\r\n\t\t\t\t\t\t\t\tfeedbackEnvelope: Config.operatorEnvelopeNames[instrument.feedbackEnvelope],\r\n\t\t\t\t\t\t\t\toperators: operatorArray,\r\n\t\t\t\t\t\t\t\tipan: Config.ipanValues[instrument.ipan],\r\n\t\t\t\t\t\t\t\timute: Config.imuteNames[instrument.imute],\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else if (instrument.type == InstrumentType.pwm) {\r\n\t\t\t\t\t\t\tinstrumentArray.push({\r\n\t\t\t\t\t\t\t\t// This uses the wrong instrument type in order\r\n\t\t\t\t\t\t\t\t// to make JSON exports compatible with\r\n\t\t\t\t\t\t\t\t// https://thestarworld.github.io/modboxfixed/\r\n\t\t\t\t\t\t\t\ttype: Config.instrumentTypeNames[InstrumentType.noise],\r\n\t\t\t\t\t\t\t\tvolume: (5 - instrument.volume) * 20,\r\n\t\t\t\t\t\t\t\twave: Config.pwmwaveNames[instrument.wave],\r\n\t\t\t\t\t\t\t\ttransition: Config.transitionNames[instrument.transition],\r\n\t\t\t\t\t\t\t\tfilter: Config.filterNames[instrument.filter],\r\n\t\t\t\t\t\t\t\tchorus: Config.chorusNames[instrument.chorus],\r\n\t\t\t\t\t\t\t\teffect: Config.effectNames[instrument.effect],\r\n\t\t\t\t\t\t\t\tharm: Config.harmNames[instrument.harm],\r\n\t\t\t\t\t\t\t\timute: Config.imuteNames[instrument.imute],\r\n\t\t\t\t\t\t\t\toctoff: Config.octoffNames[instrument.octoff],\r\n\t\t\t\t\t\t\t\tipan: Config.ipanValues[instrument.ipan],\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthrow new Error(\"Unrecognized instrument type\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tconst patternArray: Object[] = [];\r\n\t\t\t\tfor (const pattern of this.channels[channel].patterns) {\r\n\t\t\t\t\tconst noteArray: Object[] = [];\r\n\t\t\t\t\tfor (const note of pattern.notes) {\r\n\t\t\t\t\t\tconst pointArray: Object[] = [];\r\n\t\t\t\t\t\tfor (const pin of note.pins) {\r\n\t\t\t\t\t\t\tpointArray.push({\r\n\t\t\t\t\t\t\t\ttick: pin.time + note.start,\r\n\t\t\t\t\t\t\t\tpitchBend: pin.interval,\r\n\t\t\t\t\t\t\t\tvolume: Math.round(pin.volume * 100 / 3),\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tnoteArray.push({\r\n\t\t\t\t\t\t\tpitches: note.pitches,\r\n\t\t\t\t\t\t\tpoints: pointArray,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tpatternArray.push({\r\n\t\t\t\t\t\tinstrument: pattern.instrument + 1,\r\n\t\t\t\t\t\tnotes: noteArray, \r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tconst sequenceArray: number[] = [];\r\n\t\t\t\tif (enableIntro) for (let i: number = 0; i < this.loopStart; i++) {\r\n\t\t\t\t\tsequenceArray.push(this.channels[channel].bars[i]);\r\n\t\t\t\t}\r\n\t\t\t\tfor (let l: number = 0; l < loopCount; l++) for (let i: number = this.loopStart; i < this.loopStart + this.loopLength; i++) {\r\n\t\t\t\t\tsequenceArray.push(this.channels[channel].bars[i]);\r\n\t\t\t\t}\r\n\t\t\t\tif (enableOutro) for (let i: number = this.loopStart + this.loopLength; i < this.barCount; i++) {\r\n\t\t\t\t\tsequenceArray.push(this.channels[channel].bars[i]);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tchannelArray.push({\r\n\t\t\t\t\ttype: isDrum ? \"drum\" : \"pitch\",\r\n\t\t\t\t\toctaveScrollBar: this.channels[channel].octave,\r\n\t\t\t\t\tinstruments: instrumentArray,\r\n\t\t\t\t\tpatterns: patternArray,\r\n\t\t\t\t\tsequence: sequenceArray,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn {\r\n\t\t\t\tformat: Song._format,\r\n\t\t\t\tversion: Song._latestNepBoxVersion,\r\n\t\t\t\ttheme: this.setSongTheme,\r\n\t\t\t\tscale: Config.scales[this.scale].name,\r\n\t\t\t\tmix: Config.mixNames[this.mix],\r\n\t\t\t\tsampleRate: Config.sampleRateNames[this.sampleRate],\r\n\t\t\t\tkey: Config.keys[this.key].name,\r\n\t\t\t\tintroBars: this.loopStart,\r\n\t\t\t\tloopBars: this.loopLength,\r\n\t\t\t\tbeatsPerBar: this.beatsPerBar,\r\n\t\t\t\tticksPerBeat: this.partsPerBeat,\r\n\t\t\t\tbeatsPerMinute: this.getBeatsPerMinute(), // represents tempo\r\n\t\t\t\treverb: this.reverb,\r\n\t\t\t\tblend: this.blend,\r\n\t\t\t\triff: this.riff,\r\n\t\t\t\tdetune: this.detune,\r\n\t\t\t\tmuff: this.muff,\r\n\t\t\t\t//outroBars: this.barCount - this.loopStart - this.loopLength; // derive this from bar arrays?\r\n\t\t\t\t//patternCount: this.patternsPerChannel, // derive this from pattern arrays?\r\n\t\t\t\t//instrumentsPerChannel: this.instrumentsPerChannel, //derive this from instrument arrays?\r\n\t\t\t\tchannels: channelArray,\r\n\t\t\t};\r\n\t\t}\r\n\t\t\r\n\t\tpublic fromJsonObject(jsonObject: any): void {\r\n\t\t\tthis.initToDefault(true);\r\n\t\t\tif (!jsonObject) return;\r\n\t\t\tconst format: any = jsonObject.format;\r\n\t\t\tconst version: any = jsonObject.version;\r\n\t\t\tif (version > Song._format) return;\r\n\t\t\t\r\n\t\t\tthis.scale = 11; // default to expert.\r\n\t\t\tif (jsonObject.scale != undefined) {\r\n\t\t\t\tif (format == \"BeepBox\") {\r\n\t\t\t\tconst oldScaleNames: Dictionary<number> = {\"romani :)\": 8, \"romani :(\": 9};\r\n\t\t\t\tconst scale: number = oldScaleNames[jsonObject.scale] != undefined ? oldScaleNames[jsonObject.scale] : Config.scales.map(scale=>scale.name).indexOf(jsonObject.scale);\r\n\t\t\t\tif (scale != -1) this.scale = scale;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.scale = Config.scales.map(scale=>scale.name).indexOf(jsonObject[\"scale\"]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (jsonObject.theme != undefined) {\r\n\t\t\t\tif (format == \"BeepBox\") {\r\n\t\t\t\t\tif ((jsonObject[\"theme\"] != \"Nepbox\") && (jsonObject[\"theme\"] != \"Laffey\") && (jsonObject[\"theme\"] != \"ModBox\")) {\r\n\t\t\t\t\t\tvar themes = [\"none\", \"modbox2\", \"artic\", \"Cinnamon Roll\", \"Ocean\", \"rainbow\", \"float\", \"windows\", \"grassland\", \"dessert\", \"kahootiest\", \"beambit\", \"egg\", \"Poniryoshka\", \"gameboy\", \"woodkid\", \"midnight\", \"snedbox\", \"unnamed\", \"piano\", \"halloween\", \"frozen\"];\r\n\t\t\t\t\t\tvar themeIndex = Config.oldThemeNames.indexOf(jsonObject[\"theme\"]);\r\n\t\t\t\t\t\tthis.setSongTheme = themes[themeIndex];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar themes = [\"none\", \"nepbox\", \"laffey\"];\r\n\t\t\t\t\t\tvar oldThemes = [\"ModBox\", \"Nepbox\", \"Laffey\"];\r\n\t\t\t\t\t\tvar themeIndex = oldThemes.indexOf(jsonObject[\"theme\"]);\r\n\t\t\t\t\t\tthis.setSongTheme = themes[themeIndex];\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\tthis.setSongTheme = jsonObject[\"theme\"];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (jsonObject.mix != undefined) {\r\n\t\t\t\tthis.mix = Config.mixNames.indexOf(jsonObject.mix);\r\n\t\t\t\tif (this.mix == -1) this.mix = 1;\r\n\t\t\t}\r\n\r\n\t\t\tif (jsonObject.sampleRate != undefined) {\r\n\t\t\t\tthis.sampleRate = Config.sampleRateNames.indexOf(jsonObject.sampleRate);\r\n\t\t\t\tif (this.sampleRate == -1) this.sampleRate = 2;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (jsonObject.key != undefined) {\r\n\t\t\t\tif (format == \"BeepBox\") {\r\n\t\t\t\t\tif (typeof(jsonObject.key) == \"number\") {\r\n\t\t\t\t\t\tthis.key = Config.oldKeys.length - 1 - (((jsonObject.key + 1200) >>> 0) % Config.oldKeys.length);\r\n\t\t\t\t\t} else if (typeof(jsonObject.key) == \"string\") {\r\n\t\t\t\t\t\tthis.key = Config.keys.map(key=>key.name).indexOf(jsonObject.key);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.key = Config.keys.map(key=>key.name).indexOf(jsonObject.key);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (jsonObject.beatsPerMinute != undefined) {\r\n\t\t\t\tthis.tempo = jsonObject.beatsPerMinute;\r\n\t\t\t\tthis.tempo = clamp(Config.tempoMin, Config.tempoMax, this.tempo);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (jsonObject.reverb != undefined) {\r\n\t\t\t\tthis.reverb = clamp(0, Config.reverbRange, jsonObject.reverb | 0);\r\n\t\t\t}\r\n\r\n\t\t\tif (jsonObject.blend != undefined) {\r\n\t\t\t\tthis.blend = clamp(0, Config.blendRange, jsonObject.blend | 0);\r\n\t\t\t}\r\n\r\n\t\t\tif (jsonObject.riff != undefined) {\r\n\t\t\t\tthis.riff = clamp(0, Config.riffRange, jsonObject.riff | 0);\r\n\t\t\t}\r\n\r\n\t\t\tif (jsonObject.detune != undefined) {\r\n\t\t\t\tthis.detune = clamp(0, Config.detuneRange, jsonObject.detune | 0);\r\n\t\t\t}\r\n\r\n\t\t\tif (jsonObject.muff != undefined) {\r\n\t\t\t\tthis.muff = clamp(0, Config.muffRange, jsonObject.muff | 0);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (jsonObject.beatsPerBar != undefined) {\r\n\t\t\t\tthis.beatsPerBar = Math.max(Config.beatsPerBarMin, Math.min(Config.beatsPerBarMax, jsonObject.beatsPerBar | 0));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (jsonObject.ticksPerBeat != undefined) {\r\n\t\t\t\tthis.partsPerBeat = jsonObject.ticksPerBeat | 0;\r\n\t\t\t\tif (Config.partCounts.indexOf(this.partsPerBeat) == -1) {\r\n\t\t\t\t\tthis.partsPerBeat = Config.partCounts[Config.partCounts.length - 1];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tlet maxInstruments: number = 1;\r\n\t\t\tlet maxPatterns: number = 1;\r\n\t\t\tlet maxBars: number = 1;\r\n\t\t\tif (jsonObject.channels) {\r\n\t\t\t\tfor (const channelObject of jsonObject.channels) {\r\n\t\t\t\t\tif (channelObject.instruments) maxInstruments = Math.max(maxInstruments, channelObject.instruments.length | 0);\r\n\t\t\t\t\tif (channelObject.patterns) maxPatterns = Math.max(maxPatterns, channelObject.patterns.length | 0);\r\n\t\t\t\t\tif (channelObject.sequence) maxBars = Math.max(maxBars, channelObject.sequence.length | 0);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.instrumentsPerChannel = maxInstruments;\r\n\t\t\tthis.patternsPerChannel = maxPatterns;\r\n\t\t\tthis.barCount = maxBars;\r\n\t\t\t\r\n\t\t\tif (jsonObject.introBars != undefined) {\r\n\t\t\t\tthis.loopStart = clamp(0, this.barCount, jsonObject.introBars | 0);\r\n\t\t\t}\r\n\t\t\tif (jsonObject.loopBars != undefined) {\r\n\t\t\t\tthis.loopLength = clamp(1, this.barCount - this.loopStart + 1, jsonObject.loopBars | 0);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tlet pitchChannelCount = 0;\r\n\t\t\tlet drumChannelCount = 0;\r\n\t\t\tif (jsonObject.channels) {\r\n\t\t\t\tfor (let channel: number = 0; channel < jsonObject.channels.length; channel++) {\r\n\t\t\t\t\tlet channelObject: any = jsonObject.channels[channel];\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (this.channels.length <= channel) this.channels[channel] = new Channel();\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (channelObject.octaveScrollBar != undefined) {\r\n\t\t\t\t\t\tthis.channels[channel].octave = clamp(0, 5, channelObject.octaveScrollBar | 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tfor (let i: number = this.channels[channel].instruments.length; i < this.instrumentsPerChannel; i++) {\r\n\t\t\t\t\t\tthis.channels[channel].instruments[i] = new Instrument();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.channels[channel].instruments.length = this.instrumentsPerChannel;\r\n\t\t\t\t\t\r\n\t\t\t\t\tfor (let i: number = this.channels[channel].patterns.length; i < this.patternsPerChannel; i++) {\r\n\t\t\t\t\t\tthis.channels[channel].patterns[i] = new Pattern();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.channels[channel].patterns.length = this.patternsPerChannel;\r\n\t\t\t\t\t\r\n\t\t\t\t\tfor (let i: number = 0; i < this.barCount; i++) {\r\n\t\t\t\t\t\tthis.channels[channel].bars[i] = 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.channels[channel].bars.length = this.barCount;\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet isDrum: boolean = false;\r\n\t\t\t\t\tif (channelObject.type) {\r\n\t\t\t\t\t\tisDrum = (channelObject.type == \"drum\");\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// for older files, assume drums are channel 3.\r\n\t\t\t\t\t\tisDrum = (channel >= 3);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (isDrum) drumChannelCount++; else pitchChannelCount++;\r\n\t\t\t\t\t\r\n\t\t\t\t\tfor (let i: number = 0; i < this.instrumentsPerChannel; i++) {\r\n\t\t\t\t\t\tconst instrument: Instrument = this.channels[channel].instruments[i];\r\n\t\t\t\t\t\tlet instrumentObject: any = undefined;\r\n\t\t\t\t\t\tif (channelObject.instruments) instrumentObject = channelObject.instruments[i];\r\n\t\t\t\t\t\tif (instrumentObject == undefined) instrumentObject = {};\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tconst oldTransitionNames: Dictionary<number> = {\"binary\": 0};\r\n\t\t\t\t\t\tconst transitionObject = instrumentObject.transition || instrumentObject.envelope; // the transition property used to be called envelope, so try that too.\r\n\t\t\t\t\t\tinstrument.transition = oldTransitionNames[transitionObject] != undefined ? oldTransitionNames[transitionObject] : Config.transitionNames.indexOf(transitionObject);\r\n\t\t\t\t\t\tif (instrument.transition == -1) instrument.transition = 1;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (isDrum) {\r\n\t\t\t\t\t\t\tif (instrumentObject.volume != undefined) {\r\n\t\t\t\t\t\t\t\tinstrument.volume = clamp(0, Config.volumeNames.length, Math.round(5 - (instrumentObject.volume | 0) / 20));\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tinstrument.volume = 0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tinstrument.wave = Config.drumNames.indexOf(instrumentObject.wave);\r\n\t\t\t\t\t\t\tif (instrument.wave == -1) instrument.wave = 1;\r\n\t\t\t\t\t\t\tinstrument.imute = Config.imuteNames.indexOf(instrumentObject.imute);\r\n\t\t\t\t\t\t\tif (instrument.imute == -1) instrument.imute = 0;\r\n\t\t\t\t\t\t\tinstrument.ipan = Config.ipanValues.indexOf(instrumentObject.ipan);\r\n\t\t\t\t\t\t\tif (instrument.ipan == -1) instrument.ipan = 4;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tinstrument.type = Config.instrumentTypeNames.indexOf(instrumentObject.type);\r\n\t\t\t\t\t\t\tif (instrument.type == null) instrument.type = InstrumentType.chip;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (instrument.type == InstrumentType.chip) {\r\n\t\t\t\t\t\t\t\tif (instrumentObject.volume != undefined) {\r\n\t\t\t\t\t\t\t\t\tinstrument.volume = clamp(0, Config.volumeNames.length, Math.round(5 - (instrumentObject.volume | 0) / 20));\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tinstrument.volume = 0;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tinstrument.wave = Config.waveNames.indexOf(instrumentObject.wave);\r\n\t\t\t\t\t\t\t\tif (instrument.wave == -1) instrument.wave = 1;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tconst oldFilterNames: Dictionary<number> = {\"sustain sharp\": 1, \"sustain medium\": 2, \"sustain soft\": 3, \"decay sharp\": 4};\r\n\t\t\t\t\t\t\t\tinstrument.filter = oldFilterNames[instrumentObject.filter] != undefined ? oldFilterNames[instrumentObject.filter] : Config.filterNames.indexOf(instrumentObject.filter);\r\n\t\t\t\t\t\t\t\tif (instrument.filter == -1) instrument.filter = 0;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tinstrument.chorus = Config.chorusNames.indexOf(instrumentObject.chorus);\r\n\t\t\t\t\t\t\t\tif (instrument.chorus == -1) instrument.chorus = 0;\r\n\t\t\t\t\t\t\t\tinstrument.effect = Config.effectNames.indexOf(instrumentObject.effect);\r\n\t\t\t\t\t\t\t\tif (instrument.effect == -1) instrument.effect = 0;\r\n\t\t\t\t\t\t\t\tinstrument.harm = Config.harmNames.indexOf(instrumentObject.harm);\r\n\t\t\t\t\t\t\t\tif (instrument.harm == -1) instrument.harm = 0;\r\n\t\t\t\t\t\t\t\tinstrument.octoff = Config.octoffNames.indexOf(instrumentObject.octoff);\r\n\t\t\t\t\t\t\t\tif (instrument.octoff == -1) instrument.octoff = 0;\r\n\t\t\t\t\t\t\t\tinstrument.imute = Config.imuteNames.indexOf(instrumentObject.imute);\r\n\t\t\t\t\t\t\t\tif (instrument.imute == -1) instrument.imute = 0;\r\n\t\t\t\t\t\t\t\tinstrument.ipan = Config.ipanValues.indexOf(instrumentObject.ipan);\r\n\t\t\t\t\t\t\t\tif (instrument.ipan == -1) instrument.ipan = 4;\r\n\t\t\t\t\t\t\t} else if (\r\n\t\t\t\t\t\t\t\tinstrument.type == InstrumentType.pwm\r\n\t\t\t\t\t\t\t\t|| instrument.type == InstrumentType.noise\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tif (instrument.type == InstrumentType.noise) {\r\n\t\t\t\t\t\t\t\t\tinstrument.type = InstrumentType.pwm;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (instrumentObject.volume != undefined) {\r\n\t\t\t\t\t\t\t\t\tinstrument.volume = clamp(0, Config.volumeNames.length, Math.round(5 - (instrumentObject.volume | 0) / 20));\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tinstrument.volume = 0;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tinstrument.wave = Config.pwmwaveNames.indexOf(instrumentObject.wave);\r\n\t\t\t\t\t\t\t\tif (instrument.wave == -1) instrument.wave = 1;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tconst oldFilterNames: Dictionary<number> = {\"sustain sharp\": 1, \"sustain medium\": 2, \"sustain soft\": 3, \"decay sharp\": 4};\r\n\t\t\t\t\t\t\t\tinstrument.filter = oldFilterNames[instrumentObject.filter] != undefined ? oldFilterNames[instrumentObject.filter] : Config.filterNames.indexOf(instrumentObject.filter);\r\n\t\t\t\t\t\t\t\tif (instrument.filter == -1) instrument.filter = 0;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tinstrument.chorus = Config.chorusNames.indexOf(instrumentObject.chorus);\r\n\t\t\t\t\t\t\t\tif (instrument.chorus == -1) instrument.chorus = 0;\r\n\t\t\t\t\t\t\t\tinstrument.effect = Config.effectNames.indexOf(instrumentObject.effect);\r\n\t\t\t\t\t\t\t\tif (instrument.effect == -1) instrument.effect = 0;\r\n\t\t\t\t\t\t\t\tinstrument.harm = Config.harmNames.indexOf(instrumentObject.harm);\r\n\t\t\t\t\t\t\t\tif (instrument.harm == -1) instrument.harm = 0;\r\n\t\t\t\t\t\t\t\tinstrument.octoff = Config.octoffNames.indexOf(instrumentObject.octoff);\r\n\t\t\t\t\t\t\t\tif (instrument.octoff == -1) instrument.octoff = 0;\r\n\t\t\t\t\t\t\t\tinstrument.imute = Config.imuteNames.indexOf(instrumentObject.imute);\r\n\t\t\t\t\t\t\t\tif (instrument.imute == -1) instrument.imute = 0;\r\n\t\t\t\t\t\t\t\tinstrument.ipan = Config.ipanValues.indexOf(instrumentObject.ipan);\r\n\t\t\t\t\t\t\t\tif (instrument.ipan == -1) instrument.ipan = 4;\r\n\t\t\t\t\t\t\t} else if (instrument.type == InstrumentType.fm) {\r\n\t\t\t\t\t\t\t\tinstrument.effect = Config.effectNames.indexOf(instrumentObject.effect);\r\n\t\t\t\t\t\t\t\tif (instrument.effect == -1) instrument.effect = 0;\r\n\r\n\t\t\t\t\t\t\t\tinstrument.octoff = Config.octoffNames.indexOf(instrumentObject.octoff);\r\n\t\t\t\t\t\t\t\tif (instrument.octoff == -1) instrument.octoff = 0;\r\n\r\n\t\t\t\t\t\t\t\tinstrument.fmChorus = Config.fmChorusNames.indexOf(instrumentObject.fmChorus);\r\n\t\t\t\t\t\t\t\tif (instrument.fmChorus == -1) instrument.fmChorus = 0;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tinstrument.algorithm = Config.operatorAlgorithmNames.indexOf(instrumentObject.algorithm);\r\n\t\t\t\t\t\t\t\tif (instrument.algorithm == -1) instrument.algorithm = 0;\r\n\t\t\t\t\t\t\t\tinstrument.feedbackType = Config.operatorFeedbackNames.indexOf(instrumentObject.feedbackType);\r\n\t\t\t\t\t\t\t\tif (instrument.feedbackType == -1) instrument.feedbackType = 0;\r\n\t\t\t\t\t\t\t\tif (instrumentObject.feedbackAmplitude != undefined) {\r\n\t\t\t\t\t\t\t\t\tinstrument.feedbackAmplitude = clamp(0, Config.operatorAmplitudeMax + 1, instrumentObject.feedbackAmplitude | 0);\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tinstrument.feedbackAmplitude = 0;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tinstrument.feedbackEnvelope = Config.operatorEnvelopeNames.indexOf(instrumentObject.feedbackEnvelope);\r\n\t\t\t\t\t\t\t\tif (instrument.feedbackEnvelope == -1) instrument.feedbackEnvelope = 0;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tfor (let j: number = 0; j < Config.operatorCount; j++) {\r\n\t\t\t\t\t\t\t\t\tconst operator: Operator = instrument.operators[j];\r\n\t\t\t\t\t\t\t\t\tlet operatorObject: any = undefined;\r\n\t\t\t\t\t\t\t\t\tif (instrumentObject.operators) operatorObject = instrumentObject.operators[j];\r\n\t\t\t\t\t\t\t\t\tif (operatorObject == undefined) operatorObject = {};\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\toperator.frequency = Config.operatorFrequencyNames.indexOf(operatorObject.frequency);\r\n\t\t\t\t\t\t\t\t\tif (operator.frequency == -1) operator.frequency = 0;\r\n\t\t\t\t\t\t\t\t\tif (operatorObject.amplitude != undefined) {\r\n\t\t\t\t\t\t\t\t\t\toperator.amplitude = clamp(0, Config.operatorAmplitudeMax + 1, operatorObject.amplitude | 0);\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\toperator.amplitude = 0;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\toperator.envelope = Config.operatorEnvelopeNames.indexOf(operatorObject.envelope);\r\n\t\t\t\t\t\t\t\t\tif (operator.envelope == -1) operator.envelope = 0;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tinstrument.ipan = Config.ipanValues.indexOf(instrumentObject.ipan);\r\n\t\t\t\t\t\t\t\tif (instrument.ipan == -1) instrument.ipan = 4;\r\n\t\t\t\t\t\t\t\tinstrument.imute = Config.imuteNames.indexOf(instrumentObject.imute);\r\n\t\t\t\t\t\t\t\tif (instrument.imute == -1) instrument.imute = 0;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthrow new Error(\"Unrecognized instrument type.\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t\tfor (let i: number = 0; i < this.patternsPerChannel; i++) {\r\n\t\t\t\t\t\tconst pattern: Pattern = this.channels[channel].patterns[i];\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tlet patternObject: any = undefined;\r\n\t\t\t\t\t\tif (channelObject.patterns) patternObject = channelObject.patterns[i];\r\n\t\t\t\t\t\tif (patternObject == undefined) continue;\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tpattern.instrument = clamp(0, this.instrumentsPerChannel, (patternObject.instrument | 0) - 1);\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tif (patternObject.notes && patternObject.notes.length > 0) {\r\n\t\t\t\t\t\t\tconst maxNoteCount: number = Math.min(this.beatsPerBar * this.partsPerBeat, patternObject.notes.length >>> 0);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t///@TODO: Consider supporting notes specified in any timing order, sorting them and truncating as necessary. \r\n\t\t\t\t\t\t\tlet tickClock: number = 0;\r\n\t\t\t\t\t\t\tfor (let j: number = 0; j < patternObject.notes.length; j++) {\r\n\t\t\t\t\t\t\t\tif (j >= maxNoteCount) break;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tconst noteObject = patternObject.notes[j];\r\n\t\t\t\t\t\t\t\tif (!noteObject || !noteObject.pitches || !(noteObject.pitches.length >= 1) || !noteObject.points || !(noteObject.points.length >= 2)) {\r\n\t\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tconst note: Note = makeNote(0, 0, 0, 0);\r\n\t\t\t\t\t\t\t\tnote.pitches = [];\r\n\t\t\t\t\t\t\t\tnote.pins = [];\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tfor (let k: number = 0; k < noteObject.pitches.length; k++) {\r\n\t\t\t\t\t\t\t\t\tconst pitch: number = noteObject.pitches[k] | 0;\r\n\t\t\t\t\t\t\t\t\tif (note.pitches.indexOf(pitch) != -1) continue;\r\n\t\t\t\t\t\t\t\t\tnote.pitches.push(pitch);\r\n\t\t\t\t\t\t\t\t\tif (note.pitches.length >= 4) break;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (note.pitches.length < 1) continue;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tlet noteClock: number = tickClock;\r\n\t\t\t\t\t\t\t\tlet startInterval: number = 0;\r\n\t\t\t\t\t\t\t\tfor (let k: number = 0; k < noteObject.points.length; k++) {\r\n\t\t\t\t\t\t\t\t\tconst pointObject: any = noteObject.points[k];\r\n\t\t\t\t\t\t\t\t\tif (pointObject == undefined || pointObject.tick == undefined) continue;\r\n\t\t\t\t\t\t\t\t\tconst interval: number = (pointObject.pitchBend == undefined) ? 0 : (pointObject.pitchBend | 0);\r\n\t\t\t\t\t\t\t\t\tconst time: number = pointObject.tick | 0;\r\n\t\t\t\t\t\t\t\t\tconst volume: number = (pointObject.volume == undefined) ? 3 : Math.max(0, Math.min(3, Math.round((pointObject.volume | 0) * 3 / 100)));\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tif (time > this.beatsPerBar * this.partsPerBeat) continue;\r\n\t\t\t\t\t\t\t\t\tif (note.pins.length == 0) {\r\n\t\t\t\t\t\t\t\t\t\tif (time < noteClock) continue;\r\n\t\t\t\t\t\t\t\t\t\tnote.start = time;\r\n\t\t\t\t\t\t\t\t\t\tstartInterval = interval;\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tif (time <= noteClock) continue;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tnoteClock = time;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tnote.pins.push(makeNotePin(interval - startInterval, time - note.start, volume));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (note.pins.length < 2) continue;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tnote.end = note.pins[note.pins.length - 1].time + note.start;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tconst maxPitch: number = isDrum ? Config.drumCount - 1 : Config.maxPitch;\r\n\t\t\t\t\t\t\t\tlet lowestPitch: number = maxPitch;\r\n\t\t\t\t\t\t\t\tlet highestPitch: number = 0;\r\n\t\t\t\t\t\t\t\tfor (let k: number = 0; k < note.pitches.length; k++) {\r\n\t\t\t\t\t\t\t\t\tnote.pitches[k] += startInterval;\r\n\t\t\t\t\t\t\t\t\tif (note.pitches[k] < 0 || note.pitches[k] > maxPitch) {\r\n\t\t\t\t\t\t\t\t\t\tnote.pitches.splice(k, 1);\r\n\t\t\t\t\t\t\t\t\t\tk--;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (note.pitches[k] < lowestPitch) lowestPitch = note.pitches[k];\r\n\t\t\t\t\t\t\t\t\tif (note.pitches[k] > highestPitch) highestPitch = note.pitches[k];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (note.pitches.length < 1) continue;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tfor (let k: number = 0; k < note.pins.length; k++) {\r\n\t\t\t\t\t\t\t\t\tconst pin: NotePin = note.pins[k];\r\n\t\t\t\t\t\t\t\t\tif (pin.interval + lowestPitch < 0) pin.interval = -lowestPitch;\r\n\t\t\t\t\t\t\t\t\tif (pin.interval + highestPitch > maxPitch) pin.interval = maxPitch - highestPitch;\r\n\t\t\t\t\t\t\t\t\tif (k >= 2) {\r\n\t\t\t\t\t\t\t\t\t\tif (pin.interval == note.pins[k-1].interval && \r\n\t\t\t\t\t\t\t\t\t\t\tpin.interval == note.pins[k-2].interval && \r\n\t\t\t\t\t\t\t\t\t\t\tpin.volume == note.pins[k-1].volume && \r\n\t\t\t\t\t\t\t\t\t\t\tpin.volume == note.pins[k-2].volume)\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tnote.pins.splice(k-1, 1);\r\n\t\t\t\t\t\t\t\t\t\t\tk--;\r\n\t\t\t\t\t\t\t\t\t\t}    \r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tpattern.notes.push(note);\r\n\t\t\t\t\t\t\t\ttickClock = note.end;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t\tfor (let i: number = 0; i < this.barCount; i++) {\r\n\t\t\t\t\t\tthis.channels[channel].bars[i] = channelObject.sequence ? Math.min(this.patternsPerChannel, channelObject.sequence[i] >>> 0) : 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.pitchChannelCount = pitchChannelCount;\r\n\t\t\tthis.drumChannelCount = drumChannelCount;\r\n\t\t\tthis.channels.length = this.getChannelCount();\r\n\t\t}\r\n\t\t\r\n\t\tpublic getPattern(channel: number, bar: number): Pattern | null {\r\n\t\t\tconst patternIndex: number = this.channels[channel].bars[bar];\r\n\t\t\tif (patternIndex == 0) return null;\r\n\t\t\treturn this.channels[channel].patterns[patternIndex - 1];\r\n\t\t}\r\n\t\t\r\n\t\tpublic getPatternInstrument(channel: number, bar: number): number {\r\n\t\t\tconst pattern: Pattern | null = this.getPattern(channel, bar);\r\n\t\t\treturn pattern == null ? 0 : pattern.instrument;\r\n\t\t}\r\n\r\n\t\tpublic getPatternInstrumentMute(channel: number, bar: number): number {\r\n\t\t\tconst pattern: Pattern | null = this.getPattern(channel, bar);\r\n\t\t\tconst instrumentIndex: number = this.getPatternInstrument(channel, bar);\r\n\t\t\tconst instrument: Instrument = this.channels[channel].instruments[instrumentIndex];\r\n\t\t\treturn pattern == null ? 0 : instrument.imute;\r\n\t\t}\r\n\r\n\t\tpublic getPatternInstrumentVolume(channel: number, bar: number): number {\r\n\t\t\tconst pattern: Pattern | null = this.getPattern(channel, bar);\r\n\t\t\tconst instrumentIndex: number = this.getPatternInstrument(channel, bar);\r\n\t\t\tconst instrument: Instrument = this.channels[channel].instruments[instrumentIndex];\r\n\t\t\treturn pattern == null ? 0 : instrument.volume;\r\n\t\t}\r\n\t\t\r\n\t\tpublic getBeatsPerMinute(): number {\r\n\t\t\treturn this.tempo;\r\n\t\t}\r\n\t\t\r\n\t\tprivate readonly _fingerprint: Array<string | number> = [];\r\n\t\tpublic getChannelFingerprint(bar: number): string {\r\n\t\t\tconst channelCount: number = this.getChannelCount();\r\n\t\t\tlet charCount: number = 0;\r\n\t\t\tfor (let channel: number = 0; channel < channelCount; channel++) {\r\n\t\t\t\tif (channel < this.pitchChannelCount) {\r\n\t\t\t\t\tconst instrumentIndex: number = this.getPatternInstrument(channel, bar);\r\n\t\t\t\t\tconst instrument: Instrument = this.channels[channel].instruments[instrumentIndex];\r\n\t\t\t\t\tif (instrument.type == InstrumentType.chip) {\r\n\t\t\t\t\t\tthis._fingerprint[charCount++] = \"c\";\r\n\t\t\t\t\t} else if (instrument.type == InstrumentType.fm) {\r\n\t\t\t\t\t\tthis._fingerprint[charCount++] = \"f\"\r\n\t\t\t\t\t\tthis._fingerprint[charCount++] = instrument.algorithm;\r\n\t\t\t\t\t\tthis._fingerprint[charCount++] = instrument.feedbackType;\r\n\t\t\t\t\t} else if (instrument.type == InstrumentType.pwm) {\r\n\t\t\t\t\t\tthis._fingerprint[charCount++] = \"p\";\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthrow new Error(\"Unknown instrument type.\");\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._fingerprint[charCount++] = \"d\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._fingerprint.length = charCount;\r\n\t\t\treturn this._fingerprint.join(\"\");\r\n\t\t}\r\n\t}","/*\r\nCopyright (C) 2018 John Nesky\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\n\r\n\texport class Change {\r\n\t\tprivate _noop: boolean = true;\r\n\t\t\r\n\t\tprotected _didSomething(): void {\r\n\t\t\tthis._noop = false;\r\n\t\t}\r\n\t\t\r\n\t\tpublic isNoop(): boolean {\r\n\t\t\treturn this._noop;\r\n\t\t}\r\n\r\n\t\tpublic commit(): void {}\r\n\t}\r\n\t\r\n\texport class UndoableChange extends Change {\r\n\t\tprivate _reversed: boolean;\r\n\t\tprivate _doneForwards: boolean;\r\n\t\tconstructor(reversed: boolean) {\r\n\t\t\tsuper();\r\n\t\t\tthis._reversed = reversed;\r\n\t\t\tthis._doneForwards = !reversed;\r\n\t\t}\r\n\t\t\r\n\t\tpublic undo(): void {\r\n\t\t\tif (this._reversed) {\r\n\t\t\t\tthis._doForwards();\r\n\t\t\t\tthis._doneForwards = true;\r\n\t\t\t} else {\r\n\t\t\t\tthis._doBackwards();\r\n\t\t\t\tthis._doneForwards = false;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tpublic redo(): void {\r\n\t\t\tif (this._reversed) {\r\n\t\t\t\tthis._doBackwards();\r\n\t\t\t\tthis._doneForwards = false;\r\n\t\t\t} else {\r\n\t\t\t\tthis._doForwards();\r\n\t\t\t\tthis._doneForwards = true;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// isDoneForwards() returns whether or not the Change was most recently \r\n\t\t// performed forwards or backwards. If the change created something, do not \r\n\t\t// delete it in the change destructor unless the Change was performed \r\n\t\t// backwards: \r\n\t\tprotected _isDoneForwards(): boolean {\r\n\t\t\treturn this._doneForwards;\r\n\t\t}\r\n\t\t\r\n\t\tprotected _doForwards(): void {\r\n\t\t\tthrow new Error(\"Change.doForwards(): Override me.\");\r\n\t\t}\r\n\t\t\r\n\t\tprotected _doBackwards(): void {\r\n\t\t\tthrow new Error(\"Change.doBackwards(): Override me.\");\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeGroup extends Change {\r\n\t\tconstructor() {\r\n\t\t\tsuper();\r\n\t\t}\r\n\t\t\r\n\t\tpublic append(change: Change): void {\r\n\t\t\tif (change.isNoop()) return;\r\n\t\t\tthis._didSomething();\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeSequence extends UndoableChange {\r\n\t\tprivate _changes: UndoableChange[];\r\n\t\tconstructor(changes?: UndoableChange[]) {\r\n\t\t\tsuper(false);\r\n\t\t\tif (changes == undefined) {\r\n\t\t\t\tthis._changes = [];\r\n\t\t\t} else {\r\n\t\t\t\tthis._changes = changes.concat();\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tpublic append(change: UndoableChange): void {\r\n\t\t\tif (change.isNoop()) return;\r\n\t\t\tthis._changes[this._changes.length] = change;\r\n\t\t\tthis._didSomething();\r\n\t\t}\r\n\t\t\r\n\t\tprotected _doForwards(): void {\r\n\t\t\tfor (let i: number = 0; i < this._changes.length; i++) {\r\n\t\t\t\tthis._changes[i].redo();\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tprotected _doBackwards(): void {\r\n\t\t\tfor (let i: number = this._changes.length-1; i >= 0 ; i--) {\r\n\t\t\t\tthis._changes[i].undo();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n","/*\r\nCopyright (C) 2018 John Nesky\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\nimport { SongDocument } from \"./SongDocument\";\r\nimport { Change, UndoableChange, ChangeSequence, ChangeGroup } from \"./Change\";\r\nimport { NotePin, Note, Song, Pattern, makeNotePin, Instrument, Channel } from \"../synth/song\";\r\nimport { InstrumentType, Config } from \"../synth/SynthConfig\";\r\n\r\n\texport class ChangePins extends UndoableChange {\r\n\t\tprotected _oldStart: number;\r\n\t\tprotected _newStart: number;\r\n\t\tprotected _oldEnd: number;\r\n\t\tprotected _newEnd: number;\r\n\t\tprotected _oldPins: NotePin[];\r\n\t\tprotected _newPins: NotePin[];\r\n\t\tprotected _oldPitches: number[];\r\n\t\tprotected _newPitches: number[];\r\n\t\tconstructor(protected _doc: SongDocument, protected _note: Note) {\r\n\t\t\tsuper(false);\r\n\t\t\tthis._oldStart = this._note.start;\r\n\t\t\tthis._oldEnd   = this._note.end;\r\n\t\t\tthis._newStart = this._note.start;\r\n\t\t\tthis._newEnd   = this._note.end;\r\n\t\t\tthis._oldPins = this._note.pins;\r\n\t\t\tthis._newPins = [];\r\n\t\t\tthis._oldPitches = this._note.pitches;\r\n\t\t\tthis._newPitches = [];\r\n\t\t}\r\n\t\t\r\n\t\tprotected _finishSetup(): void {\r\n\t\t\tfor (let i: number = 0; i < this._newPins.length - 1; ) {\r\n\t\t\t\tif (this._newPins[i].time >= this._newPins[i+1].time) {\r\n\t\t\t\t\tthis._newPins.splice(i, 1);\r\n\t\t\t\t} else {\r\n\t\t\t\t\ti++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfor (let i: number = 1; i < this._newPins.length - 1; ) {\r\n\t\t\t\tif (this._newPins[i-1].interval == this._newPins[i].interval && \r\n\t\t\t\t    this._newPins[i].interval == this._newPins[i+1].interval && \r\n\t\t\t\t    this._newPins[i-1].volume == this._newPins[i].volume && \r\n\t\t\t\t    this._newPins[i].volume == this._newPins[i+1].volume)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis._newPins.splice(i, 1);\r\n\t\t\t\t} else {\r\n\t\t\t\t\ti++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst firstInterval: number = this._newPins[0].interval;\r\n\t\t\tconst firstTime: number = this._newPins[0].time;\r\n\t\t\tfor (let i: number = 0; i < this._oldPitches.length; i++) {\r\n\t\t\t\tthis._newPitches[i] = this._oldPitches[i] + firstInterval;\r\n\t\t\t}\r\n\t\t\tfor (let i: number = 0; i < this._newPins.length; i++) {\r\n\t\t\t\tthis._newPins[i].interval -= firstInterval;\r\n\t\t\t\tthis._newPins[i].time -= firstTime;\r\n\t\t\t}\r\n\t\t\tthis._newStart = this._oldStart + firstTime;\r\n\t\t\tthis._newEnd   = this._newStart + this._newPins[this._newPins.length-1].time;\r\n\t\t\t\r\n\t\t\tthis._doForwards();\r\n\t\t\tthis._didSomething();\r\n\t\t}\r\n\t\t\r\n\t\tprotected _doForwards(): void {\r\n\t\t\tthis._note.pins = this._newPins;\r\n\t\t\tthis._note.pitches = this._newPitches;\r\n\t\t\tthis._note.start = this._newStart;\r\n\t\t\tthis._note.end = this._newEnd;\r\n\t\t\tthis._doc.notifier.changed();\r\n\t\t}\r\n\t\t\r\n\t\tprotected _doBackwards(): void {\r\n\t\t\tthis._note.pins = this._oldPins;\r\n\t\t\tthis._note.pitches = this._oldPitches;\r\n\t\t\tthis._note.start = this._oldStart;\r\n\t\t\tthis._note.end = this._oldEnd;\r\n\t\t\tthis._doc.notifier.changed();\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeInstrumentType extends Change {\r\n\t\tconstructor(doc: SongDocument, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tconst oldValue: number = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].type;\r\n\t\t\tif (oldValue != newValue) {\r\n\t\t\t\tdoc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].type = newValue;\r\n\t\t\t\tif (newValue == InstrumentType.chip) {\r\n\t\t\t\t\t// This is technically not necessary, so long as there are\r\n\t\t\t\t\t// more chip waves than pwm waves, but might as well have\r\n\t\t\t\t\t// it here for safety.\r\n\t\t\t\t\tconst instrument: Instrument = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()];\r\n\t\t\t\t\tinstrument.wave = Math.max(0, Math.min(Config.waves.length - 1, instrument.wave));\r\n\t\t\t\t} else if (newValue == InstrumentType.pwm) {\r\n\t\t\t\t\t// When going from chip to pwm, if there are more chip\r\n\t\t\t\t\t// waves than pwm waves, .wave can be invalid.\r\n\t\t\t\t\tconst instrument: Instrument = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()];\r\n\t\t\t\t\tinstrument.wave = Math.max(0, Math.min(Config.pwmwaves.length - 1, instrument.wave));\r\n\t\t\t\t}\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeTransition extends Change {\r\n\t\tconstructor(doc: SongDocument, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tconst oldValue: number = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].transition;\r\n\t\t\tif (oldValue != newValue) {\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t\tdoc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].transition = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangePattern extends Change {\r\n\t\tconstructor(doc: SongDocument, public oldValue: number, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tif (newValue > doc.song.patternsPerChannel) throw new Error(\"invalid pattern\");\r\n\t\t\tdoc.song.channels[doc.channel].bars[doc.bar] = newValue;\r\n\t\t\tdoc.notifier.changed();\r\n\t\t\tif (oldValue != newValue) this._didSomething();\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeBarCount extends Change {\r\n\t\tconstructor(doc: SongDocument, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tif (doc.song.barCount != newValue) {\r\n\t\t\t\tfor (let channel: number = 0; channel < doc.song.getChannelCount(); channel++) {\r\n\t\t\t\t\tfor (let bar: number = doc.song.barCount; bar < newValue; bar++) {\r\n\t\t\t\t\t\tdoc.song.channels[channel].bars[bar] = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdoc.song.channels[channel].bars.length = newValue;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tlet newBar: number = doc.bar;\r\n\t\t\t\tlet newBarScrollPos: number = doc.barScrollPos;\r\n\t\t\t\tlet newLoopStart: number = doc.song.loopStart;\r\n\t\t\t\tlet newLoopLength: number = doc.song.loopLength;\r\n\t\t\t\tif (doc.song.barCount > newValue) {\r\n\t\t\t\t\tnewBar = Math.min(newBar, newValue - 1);\r\n\t\t\t\t\tnewBarScrollPos = Math.max(0, Math.min(newValue - doc.trackVisibleBars, newBarScrollPos));\r\n\t\t\t\t\tnewLoopLength = Math.min(newValue, newLoopLength);\r\n\t\t\t\t\tnewLoopStart = Math.min(newValue - newLoopLength, newLoopStart);\r\n\t\t\t\t}\r\n\t\t\t\tdoc.bar = newBar;\r\n\t\t\t\tdoc.barScrollPos = newBarScrollPos;\r\n\t\t\t\tdoc.song.loopStart = newLoopStart;\r\n\t\t\t\tdoc.song.loopLength = newLoopLength;\r\n\t\t\t\tdoc.song.barCount = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\t\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeInsertBars extends Change {\r\n\t\tconstructor(doc: SongDocument, start: number, count: number) {\r\n\t\t\tsuper();\r\n\t\t\t\r\n\t\t\tconst newLength: number = Math.min(Config.barCountMax, doc.song.barCount + count);\r\n\t\t\tcount = newLength - doc.song.barCount;\r\n\t\t\tif (count == 0) return;\r\n\t\t\t\r\n\t\t\tfor (const channel of doc.song.channels) {\r\n\t\t\t\twhile (channel.bars.length < newLength) {\r\n\t\t\t\t\tchannel.bars.splice(start, 0, 0);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdoc.song.barCount = newLength;\r\n\t\t\t\r\n\t\t\tdoc.bar += count;\r\n\t\t\tdoc.barScrollPos += count;\r\n\t\t\tif (doc.song.loopStart >= start) {\r\n\t\t\t\tdoc.song.loopStart += count;\r\n\t\t\t} else if (doc.song.loopStart + doc.song.loopLength >= start) {\r\n\t\t\t\tdoc.song.loopLength += count;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdoc.notifier.changed();\r\n\t\t\tthis._didSomething();\r\n\t\t}\r\n\t}\r\n\r\n\texport class ChangeDeleteBars extends Change {\r\n\t\tconstructor(doc: SongDocument, start: number, count: number) {\r\n\t\t\tsuper();\r\n\t\t\t\r\n\t\t\tfor (const channel of doc.song.channels) {\r\n\t\t\t\tchannel.bars.splice(start, count);\r\n\t\t\t\tif (channel.bars.length == 0) channel.bars.push(0);\r\n\t\t\t}\r\n\t\t\tdoc.song.barCount = Math.max(1, doc.song.barCount - count);\r\n\t\t\t\r\n\t\t\tdoc.bar = Math.max(0, doc.bar - count);\r\n\t\t\tdoc.barScrollPos = Math.max(0, doc.barScrollPos - count);\r\n\t\t\tif (doc.song.loopStart >= start) {\r\n\t\t\t\tdoc.song.loopStart = Math.max(0, doc.song.loopStart - count);\r\n\t\t\t} else if (doc.song.loopStart + doc.song.loopLength > start) {\r\n\t\t\t\tdoc.song.loopLength -= count;\r\n\t\t\t}\r\n\t\t\tdoc.song.loopLength = Math.max(1, Math.min(doc.song.barCount - doc.song.loopStart, doc.song.loopLength));\r\n\t\t\t\r\n\t\t\tdoc.notifier.changed();\r\n\t\t\tthis._didSomething();\r\n\t\t}\r\n\t}\r\n\r\n\texport class ChangeChannelCount extends Change {\r\n\t\tconstructor(doc: SongDocument, newPitchChannelCount: number, newDrumChannelCount: number) {\r\n\t\t\tsuper();\r\n\t\t\tif (doc.song.pitchChannelCount != newPitchChannelCount || doc.song.drumChannelCount != newDrumChannelCount) {\r\n\t\t\t\tconst newChannels: Channel[] = [];\r\n\t\t\t\t\r\n\t\t\t\tfor (let i: number = 0; i < newPitchChannelCount; i++) {\r\n\t\t\t\t\tconst channel = i;\r\n\t\t\t\t\tconst oldChannel = i;\r\n\t\t\t\t\tif (i < doc.song.pitchChannelCount) {\r\n\t\t\t\t\t\tnewChannels[channel] = doc.song.channels[oldChannel]\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnewChannels[channel] = new Channel();\r\n\t\t\t\t\t\tnewChannels[channel].octave = 2;\r\n\t\t\t\t\t\tfor (let j: number = 0; j < doc.song.instrumentsPerChannel; j++) newChannels[channel].instruments[j] = new Instrument();\r\n\t\t\t\t\t\tfor (let j: number = 0; j < doc.song.patternsPerChannel; j++) newChannels[channel].patterns[j] = new Pattern();\r\n\t\t\t\t\t\tfor (let j: number = 0; j < doc.song.barCount; j++) newChannels[channel].bars[j] = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (let i: number = 0; i < newDrumChannelCount; i++) {\r\n\t\t\t\t\tconst channel = i + newPitchChannelCount;\r\n\t\t\t\t\tconst oldChannel = i + doc.song.pitchChannelCount;\r\n\t\t\t\t\tif (i < doc.song.drumChannelCount) {\r\n\t\t\t\t\t\tnewChannels[channel] = doc.song.channels[oldChannel]\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnewChannels[channel] = new Channel();\r\n\t\t\t\t\t\tnewChannels[channel].octave = 0;\r\n\t\t\t\t\t\tfor (let j: number = 0; j < doc.song.instrumentsPerChannel; j++) newChannels[channel].instruments[j] = new Instrument();\r\n\t\t\t\t\t\tfor (let j: number = 0; j < doc.song.patternsPerChannel; j++) newChannels[channel].patterns[j] = new Pattern();\r\n\t\t\t\t\t\tfor (let j: number = 0; j < doc.song.barCount; j++) newChannels[channel].bars[j] = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tdoc.song.pitchChannelCount = newPitchChannelCount;\r\n\t\t\t\tdoc.song.drumChannelCount = newDrumChannelCount;\r\n\t\t\t\tfor (let channel: number = 0; channel < doc.song.getChannelCount(); channel++) {\r\n\t\t\t\t\tdoc.song.channels[channel] = newChannels[channel];\r\n\t\t\t\t}\r\n\t\t\t\tdoc.song.channels.length = doc.song.getChannelCount();\r\n\t\t\t\t\r\n\t\t\t\tdoc.channel = Math.min(doc.channel, newPitchChannelCount + newDrumChannelCount - 1);\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\t\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeBeatsPerBar extends Change {\r\n\t\tconstructor(doc: SongDocument, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tif (doc.song.beatsPerBar != newValue) {\r\n\t\t\t\tif (doc.song.beatsPerBar > newValue) {\r\n\t\t\t\t\tconst sequence: ChangeSequence = new ChangeSequence();\r\n\t\t\t\t\tfor (let i: number = 0; i < doc.song.getChannelCount(); i++) {\r\n\t\t\t\t\t\tfor (let j: number = 0; j < doc.song.channels[i].patterns.length; j++) {\r\n\t\t\t\t\t\t\tsequence.append(new ChangeNoteTruncate(doc, doc.song.channels[i].patterns[j], newValue * doc.song.partsPerBeat, doc.song.beatsPerBar * doc.song.partsPerBeat));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tdoc.song.beatsPerBar = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeChannelOrder extends Change {\r\n\t\tconstructor(doc: SongDocument, selectionMin: number, selectionMax: number, offset: number) {\r\n\t\t\tsuper();\r\n\t\t\tdoc.song.channels.splice(selectionMin + offset, 0, ...doc.song.channels.splice(selectionMin, selectionMax - selectionMin + 1));\r\n\t\t\tdoc.notifier.changed();\r\n\t\t\tthis._didSomething();\r\n\t\t}\r\n\t}\r\n\r\n\texport class ChangeAddChannel extends ChangeGroup {\r\n\t\tconstructor(doc: SongDocument, index: number, isNoise: boolean) {\r\n\t\t\tsuper();\r\n\t\t\tconst newPitchChannelCount: number = doc.song.pitchChannelCount + (isNoise ? 0 : 1);\r\n\t\t\tconst newNoiseChannelCount: number = doc.song.drumChannelCount + (isNoise ? 1 : 0);\r\n\t\t\tif (newPitchChannelCount <= Config.pitchChannelCountMax && newNoiseChannelCount <= Config.drumChannelCountMax) {\r\n\t\t\t\tconst addedChannelIndex: number = isNoise ? doc.song.pitchChannelCount + doc.song.drumChannelCount : doc.song.pitchChannelCount;\r\n\t\t\t\tthis.append(new ChangeChannelCount(doc, newPitchChannelCount, newNoiseChannelCount));\r\n\t\t\t\tthis.append(new ChangeChannelOrder(doc, index, addedChannelIndex - 1, 1));\r\n\t\t\t}\r\n\t\t\tdoc.notifier.changed();\r\n\t\t\tthis._didSomething();\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeRemoveChannel extends ChangeGroup {\r\n\t\tconstructor(doc: SongDocument, minIndex: number, maxIndex: number) {\r\n\t\t\tsuper();\r\n\t\t\twhile (maxIndex >= minIndex) {\r\n\t\t\t\tconst isNoise: boolean = doc.song.getChannelIsDrum(maxIndex);\r\n\t\t\t\tdoc.song.channels.splice(maxIndex, 1);\r\n\t\t\t\tif (isNoise) {\r\n\t\t\t\t\tdoc.song.drumChannelCount--;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t\tdoc.song.pitchChannelCount--;\r\n\t\t\t\t}\r\n\t\t\t\tmaxIndex--;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (doc.song.pitchChannelCount < Config.pitchChannelCountMin) {\r\n\t\t\t\tthis.append(new ChangeChannelCount(doc, Config.pitchChannelCountMin, doc.song.drumChannelCount));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.append(new ChangeChannelBar(doc, Math.max(0, minIndex - 1), doc.bar));\r\n\t\t\t\r\n\t\t\tthis._didSomething();\r\n\t\t\tdoc.notifier.changed();\r\n\t\t}\r\n\t}\r\n\r\n\texport class ChangeChannelBar extends Change {\r\n\t\tconstructor(doc: SongDocument, newChannel: number, newBar: number) {\r\n\t\t\tsuper();\r\n\t\t\tconst oldChannel: number = doc.channel;\r\n\t\t\tconst oldBar: number = doc.bar;\r\n\t\t\tdoc.channel = newChannel;\r\n\t\t\tdoc.bar = newBar;\r\n\t\t\tdoc.barScrollPos = Math.min(doc.bar, Math.max(doc.bar - (doc.trackVisibleBars - 1), doc.barScrollPos));\r\n\t\t\tdoc.notifier.changed();\r\n\t\t\tif (oldChannel != newChannel || oldBar != newBar) {\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeChorus extends Change {\r\n\t\tconstructor(doc: SongDocument, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tconst oldValue: number = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].chorus;\r\n\t\t\tif (oldValue != newValue) {\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t\tdoc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].chorus = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeEffect extends Change {\r\n\t\tconstructor(doc: SongDocument, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tconst oldValue: number = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].effect;\r\n\t\t\tif (oldValue != newValue) {\r\n\t\t\t\tdoc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].effect = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeHarm extends Change {\r\n\t\tconstructor(doc: SongDocument, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tconst oldValue: number = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].harm;\r\n\t\t\tif (oldValue != newValue) {\r\n\t\t\t\tdoc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].harm = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\texport class ChangeFMChorus extends Change {\r\n\t\tconstructor(doc: SongDocument, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tconst oldValue: number = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].fmChorus;\r\n\t\t\tif (oldValue != newValue) {\r\n\t\t\t\tdoc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].fmChorus = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeOctoff extends Change {\r\n\t\tconstructor(doc: SongDocument, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tconst oldValue: number = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].octoff;\r\n\t\t\tif (oldValue != newValue) {\r\n\t\t\t\tdoc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].octoff = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeImute extends Change {\r\n\t\tconstructor(doc: SongDocument, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tconst oldValue: number = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].imute;\r\n\t\t\tif (oldValue != newValue) {\r\n\t\t\t\tdoc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].imute = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\texport class ChangeAllImute extends Change {\r\n\t\tconstructor(doc: SongDocument, newValue: number, index: number) {\r\n\t\t\tsuper();\r\n\t\t\tconst oldValue: number = doc.song.channels[doc.channel].instruments[index].imute;\r\n\t\t\tif (oldValue != newValue) {\r\n\t\t\t\tdoc.song.channels[doc.channel].instruments[index].imute = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\texport class ChangeSoloChannels extends Change {\r\n\t\tconstructor(doc: SongDocument, newValue: number, curChannel: number, curInstrument: number) {\r\n\t\t\tsuper();\r\n\t\t\tconst oldValue: number = doc.song.channels[curChannel].instruments[curInstrument].imute;\r\n\t\t\tif (oldValue != newValue) {\r\n\t\t\t\tdoc.song.channels[curChannel].instruments[curInstrument].imute = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeIpan extends Change {\r\n\t\tconstructor(doc: SongDocument, oldValue: number, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tif (oldValue != newValue) {\r\n\t\t\t\tdoc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].ipan = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeFilter extends Change {\r\n\t\tconstructor(doc: SongDocument, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tconst oldValue: number = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].filter;\r\n\t\t\tif (oldValue != newValue) {\r\n\t\t\t\tdoc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].filter = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeAlgorithm extends Change {\r\n\t\tconstructor(doc: SongDocument, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tconst oldValue: number = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].algorithm;\r\n\t\t\tif (oldValue != newValue) {\r\n\t\t\t\tdoc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].algorithm = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeFeedbackType extends Change {\r\n\t\tconstructor(doc: SongDocument, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tconst oldValue: number = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].feedbackType;\r\n\t\t\tif (oldValue != newValue) {\r\n\t\t\t\tdoc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].feedbackType = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeFeedbackEnvelope extends Change {\r\n\t\tconstructor(doc: SongDocument, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tconst oldValue: number = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].feedbackEnvelope;\r\n\t\t\tif (oldValue != newValue) {\r\n\t\t\t\tdoc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].feedbackEnvelope = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeOperatorEnvelope extends Change {\r\n\t\tconstructor(doc: SongDocument, operatorIndex: number, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tconst oldValue: number = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].operators[operatorIndex].envelope;\r\n\t\t\tif (oldValue != newValue) {\r\n\t\t\t\tdoc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].operators[operatorIndex].envelope = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeOperatorFrequency extends Change {\r\n\t\tconstructor(doc: SongDocument, operatorIndex: number, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tconst oldValue: number = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].operators[operatorIndex].frequency;\r\n\t\t\tif (oldValue != newValue) {\r\n\t\t\t\tdoc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].operators[operatorIndex].frequency = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeOperatorAmplitude extends Change {\r\n\t\tconstructor(doc: SongDocument, operatorIndex: number, oldValue: number, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tdoc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].operators[operatorIndex].amplitude = newValue;\r\n\t\t\tdoc.notifier.changed();\r\n\t\t\tif (oldValue != newValue) this._didSomething();\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeFeedbackAmplitude extends Change {\r\n\t\tconstructor(doc: SongDocument, oldValue: number, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tdoc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].feedbackAmplitude = newValue;\r\n\t\t\tdoc.notifier.changed();\r\n\t\t\tif (oldValue != newValue) this._didSomething();\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeInstrumentsPerChannel extends Change {\r\n\t\tconstructor(doc: SongDocument, newInstrumentsPerChannel: number) {\r\n\t\t\tsuper();\r\n\t\t\tif (doc.song.instrumentsPerChannel != newInstrumentsPerChannel) {\r\n\t\t\t\tfor (let channel: number = 0; channel < doc.song.getChannelCount(); channel++) {\r\n\t\t\t\t\tconst sampleInstrument: Instrument = doc.song.channels[channel].instruments[doc.song.instrumentsPerChannel - 1];\r\n\t\t\t\t\tfor (let j: number = doc.song.instrumentsPerChannel; j < newInstrumentsPerChannel; j++) {\r\n\t\t\t\t\t\tconst newInstrument: Instrument = new Instrument();\r\n\t\t\t\t\t\tnewInstrument.copy(sampleInstrument);\r\n\t\t\t\t\t\tdoc.song.channels[channel].instruments[j] = newInstrument;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdoc.song.channels[channel].instruments.length = newInstrumentsPerChannel;\r\n\t\t\t\t\tfor (let j: number = 0; j < doc.song.patternsPerChannel; j++) {\r\n\t\t\t\t\t\tif (doc.song.channels[channel].patterns[j].instrument >= newInstrumentsPerChannel) {\r\n\t\t\t\t\t\t\tdoc.song.channels[channel].patterns[j].instrument = 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tdoc.song.instrumentsPerChannel = newInstrumentsPerChannel;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeKey extends Change {\r\n\t\tconstructor(doc: SongDocument, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tif (doc.song.key != newValue) {\r\n\t\t\t\tdoc.song.key = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeSongTheme extends Change {\r\n\t\tconstructor(doc: SongDocument, oldValue: string, newValue: string) {\r\n\t\t\tsuper();\r\n\t\t\tif (newValue.length > 30) {\r\n\t\t\t\tnewValue = newValue.substring(0, 30);\r\n\t\t\t}\r\n\r\n\t\t\tdoc.song.setSongTheme = newValue;\r\n\t\t\tdoc.notifier.changed();\r\n\t\t\tif (oldValue != newValue) this._didSomething();\r\n\t\t}\r\n\t}\r\n\r\n\texport class ChangeLoop extends Change {\r\n\t\tconstructor(private _doc: SongDocument, public oldStart: number, public oldLength: number, public newStart: number, public newLength: number) {\r\n\t\t\tsuper();\r\n\t\t\tthis._doc.song.loopStart = this.newStart;\r\n\t\t\tthis._doc.song.loopLength = this.newLength;\r\n\t\t\tthis._doc.notifier.changed();\r\n\t\t\tif (this.oldStart != this.newStart || this.oldLength != this.newLength) {\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangePitchAdded extends UndoableChange {\r\n\t\tprivate _doc: SongDocument;\r\n\t\tprivate _note: Note;\r\n\t\tprivate _pitch: number;\r\n\t\tprivate _index: number;\r\n\t\tconstructor(doc: SongDocument, note: Note, pitch: number, index: number, deletion: boolean = false) {\r\n\t\t\tsuper(deletion);\r\n\t\t\tthis._doc = doc;\r\n\t\t\tthis._note = note;\r\n\t\t\tthis._pitch = pitch;\r\n\t\t\tthis._index = index;\r\n\t\t\tthis._didSomething();\r\n\t\t\tthis.redo();\r\n\t\t}\r\n\t\t\r\n\t\tprotected _doForwards(): void {\r\n\t\t\tthis._note.pitches.splice(this._index, 0, this._pitch);\r\n\t\t\tthis._doc.notifier.changed();\r\n\t\t}\r\n\t\t\r\n\t\tprotected _doBackwards(): void {\r\n\t\t\tthis._note.pitches.splice(this._index, 1);\r\n\t\t\tthis._doc.notifier.changed();\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeOctave extends Change {\r\n\t\tconstructor(doc: SongDocument, public oldValue: number, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tdoc.song.channels[doc.channel].octave = newValue;\r\n\t\t\tdoc.notifier.changed();\r\n\t\t\tif (oldValue != newValue) this._didSomething();\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangePartsPerBeat extends ChangeGroup {\r\n\t\tconstructor(doc: SongDocument, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tif (doc.song.partsPerBeat != newValue) {\r\n\t\t\t\tfor (let i: number = 0; i < doc.song.getChannelCount(); i++) {\r\n\t\t\t\t\tfor (let j: number = 0; j < doc.song.channels[i].patterns.length; j++) {\r\n\t\t\t\t\t\tthis.append(new ChangeRhythm(doc, doc.song.channels[i].patterns[j], doc.song.partsPerBeat, newValue));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tdoc.song.partsPerBeat = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangePaste extends ChangeGroup {\r\n\t\tconstructor(doc: SongDocument, pattern: Pattern, notes: Note[], newBeatsPerBar: number, newPartsPerBeat: number) {\r\n\t\t\tsuper();\r\n\t\t\tpattern.notes = notes;\r\n\t\t\t\r\n\t\t\tif (doc.song.partsPerBeat != newPartsPerBeat) {\r\n\t\t\t\tthis.append(new ChangeRhythm(doc, pattern, newPartsPerBeat, doc.song.partsPerBeat));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (doc.song.beatsPerBar != newBeatsPerBar) {\r\n\t\t\t\tthis.append(new ChangeNoteTruncate(doc, pattern, doc.song.beatsPerBar * doc.song.partsPerBeat, newBeatsPerBar * doc.song.partsPerBeat));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdoc.notifier.changed();\r\n\t\t\tthis._didSomething();\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangePatternInstrument extends Change {\r\n\t\tconstructor(doc: SongDocument, newValue: number, pattern: Pattern) {\r\n\t\t\tsuper();\r\n\t\t\tif (pattern.instrument != newValue) {\r\n\t\t\t\tpattern.instrument = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangePatternsPerChannel extends Change {\r\n\t\tconstructor(doc: SongDocument, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tif (doc.song.patternsPerChannel != newValue) {\r\n\t\t\t\tfor (let i: number = 0; i < doc.song.getChannelCount(); i++) {\r\n\t\t\t\t\tconst channelBars: number[] = doc.song.channels[i].bars;\r\n\t\t\t\t\tconst channelPatterns: Pattern[] = doc.song.channels[i].patterns;\r\n\t\t\t\t\tfor (let j: number = 0; j < channelBars.length; j++) {\r\n\t\t\t\t\t\tif (channelBars[j] > newValue) channelBars[j] = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (let j: number = channelPatterns.length; j < newValue; j++) {\r\n\t\t\t\t\t\tchannelPatterns[j] = new Pattern();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tchannelPatterns.length = newValue;\r\n\t\t\t\t}\r\n\t\t\t\tdoc.song.patternsPerChannel = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeEnsurePatternExists extends UndoableChange {\r\n\t\tprivate _doc: SongDocument;\r\n\t\tprivate _bar: number;\r\n\t\tprivate _channel: number;\r\n\t\tprivate _patternIndex: number;\r\n\t\tprivate _patternOldNotes: Note[] | null = null;\r\n\t\tprivate _oldPatternCount: number;\r\n\t\tprivate _newPatternCount: number;\r\n\r\n\t\tconstructor(doc: SongDocument) {\r\n\t\t\tsuper(false);\r\n\t\t\tconst song: Song = doc.song;\r\n\t\t\tif (song.channels[doc.channel].bars[doc.bar] != 0) return;\r\n\r\n\t\t\tthis._doc = doc;\r\n\t\t\tthis._bar = doc.bar;\r\n\t\t\tthis._channel = doc.channel;\r\n\t\t\tthis._oldPatternCount = song.patternsPerChannel;\r\n\t\t\tthis._newPatternCount = song.patternsPerChannel;\r\n\r\n\t\t\tlet firstEmptyUnusedIndex: number | null = null;\r\n\t\t\tlet firstUnusedIndex: number | null = null;\r\n\t\t\tfor (let patternIndex: number = 1; patternIndex <= song.patternsPerChannel; patternIndex++) {\r\n\t\t\t\tlet used = false;\r\n\t\t\t\tfor (let barIndex: number = 0; barIndex < song.barCount; barIndex++) {\r\n\t\t\t\t\tif (song.channels[doc.channel].bars[barIndex] == patternIndex) {\r\n\t\t\t\t\t\tused = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (used) continue;\r\n\t\t\t\tif (firstUnusedIndex == null) {\r\n\t\t\t\t\tfirstUnusedIndex = patternIndex;\r\n\t\t\t\t}\r\n\t\t\t\tconst pattern: Pattern = song.channels[doc.channel].patterns[patternIndex - 1];\r\n\t\t\t\tif (pattern.notes.length == 0) {\r\n\t\t\t\t\tfirstEmptyUnusedIndex = patternIndex;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (firstEmptyUnusedIndex != null) {\r\n\t\t\t\tthis._patternIndex = firstEmptyUnusedIndex;\r\n\t\t\t} else if (song.patternsPerChannel < song.barCount) {\r\n\t\t\t\tthis._newPatternCount = song.patternsPerChannel + 1;\r\n\t\t\t\tthis._patternIndex = song.patternsPerChannel + 1;\r\n\t\t\t} else if (firstUnusedIndex != null) {\r\n\t\t\t\tthis._patternIndex = firstUnusedIndex;\r\n\t\t\t\tthis._patternOldNotes = song.channels[doc.channel].patterns[firstUnusedIndex - 1].notes;\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error();\r\n\t\t\t}\r\n\r\n\t\t\tthis._didSomething();\r\n\t\t\tthis._doForwards();\r\n\t\t}\r\n\r\n\t\tprotected _doForwards(): void {\r\n\t\t\tconst song: Song = this._doc.song;\r\n\t\t\tfor (let j: number = song.patternsPerChannel; j < this._newPatternCount; j++) {\r\n\t\t\t\tfor (let i: number = 0; i < song.getChannelCount(); i++) {\r\n\t\t\t\t\tsong.channels[i].patterns[j] = new Pattern();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tsong.patternsPerChannel = this._newPatternCount;\r\n\t\t\tconst pattern: Pattern = song.channels[this._channel].patterns[this._patternIndex - 1];\r\n\t\t\tpattern.notes = [];\r\n\t\t\tsong.channels[this._channel].bars[this._bar] = this._patternIndex;\r\n\t\t\tthis._doc.notifier.changed();\r\n\t\t}\r\n\r\n\t\tprotected _doBackwards(): void {\r\n\t\t\tconst song: Song = this._doc.song;\r\n\t\t\tconst pattern: Pattern = song.channels[this._channel].patterns[this._patternIndex - 1];\r\n\t\t\tif (this._patternOldNotes != null) pattern.notes = this._patternOldNotes;\r\n\t\t\tsong.channels[this._channel].bars[this._bar] = 0;\r\n\t\t\tfor (let i: number = 0; i < song.getChannelCount(); i++) {\r\n\t\t\t\tsong.channels[i].patterns.length = this._oldPatternCount;\r\n\t\t\t}\r\n\t\t\tsong.patternsPerChannel = this._oldPatternCount;\r\n\t\t\tthis._doc.notifier.changed();\r\n\t\t}\r\n\t}\r\n\r\n\texport class ChangePinTime extends ChangePins {\r\n\t\tconstructor(doc: SongDocument, note: Note, pinIndex: number, shiftedTime: number) {\r\n\t\t\tsuper(doc, note);\r\n\t\t\t\r\n\t\t\tshiftedTime -= this._oldStart;\r\n\t\t\tconst originalTime: number = this._oldPins[pinIndex].time;\r\n\t\t\tconst skipStart: number = Math.min(originalTime, shiftedTime);\r\n\t\t\tconst skipEnd: number = Math.max(originalTime, shiftedTime);\r\n\t\t\tlet setPin: boolean = false;\r\n\t\t\tfor (let i: number = 0; i < this._oldPins.length; i++) {\r\n\t\t\t\tconst oldPin: NotePin = note.pins[i];\r\n\t\t\t\tconst time: number = oldPin.time;\r\n\t\t\t\tif (time < skipStart) {\r\n\t\t\t\t\tthis._newPins.push(makeNotePin(oldPin.interval, time, oldPin.volume));\r\n\t\t\t\t} else if (time > skipEnd) {\r\n\t\t\t\t\tif (!setPin) {\r\n\t\t\t\t\t\tthis._newPins.push(makeNotePin(this._oldPins[pinIndex].interval, shiftedTime, this._oldPins[pinIndex].volume));\r\n\t\t\t\t\t\tsetPin = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._newPins.push(makeNotePin(oldPin.interval, time, oldPin.volume));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!setPin) {\r\n\t\t\t\tthis._newPins.push(makeNotePin(this._oldPins[pinIndex].interval, shiftedTime, this._oldPins[pinIndex].volume));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._finishSetup();\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangePitchBend extends ChangePins {\r\n\t\tconstructor(doc: SongDocument, note: Note, bendStart: number, bendEnd: number, bendTo: number, pitchIndex: number) {\r\n\t\t\tsuper(doc, note);\r\n\t\t\t\r\n\t\t\tbendStart -= this._oldStart;\r\n\t\t\tbendEnd   -= this._oldStart;\r\n\t\t\tbendTo    -= note.pitches[pitchIndex];\r\n\t\t\t\r\n\t\t\tlet setStart: boolean = false;\r\n\t\t\tlet setEnd: boolean   = false;\r\n\t\t\tlet prevInterval: number = 0;\r\n\t\t\tlet prevVolume: number = 3;\r\n\t\t\tlet persist: boolean = true;\r\n\t\t\tlet i: number;\r\n\t\t\tlet direction: number;\r\n\t\t\tlet stop: number;\r\n\t\t\tlet push: (item: NotePin)=>void;\r\n\t\t\tif (bendEnd > bendStart) {\r\n\t\t\t\ti = 0;\r\n\t\t\t\tdirection = 1;\r\n\t\t\t\tstop = note.pins.length;\r\n\t\t\t\tpush = (item: NotePin)=>{ this._newPins.push(item); };\r\n\t\t\t} else {\r\n\t\t\t\ti = note.pins.length - 1;\r\n\t\t\t\tdirection = -1;\r\n\t\t\t\tstop = -1;\r\n\t\t\t\tpush = (item: NotePin)=>{ this._newPins.unshift(item); };\r\n\t\t\t}\r\n\t\t\tfor (; i != stop; i += direction) {\r\n\t\t\t\tconst oldPin: NotePin = note.pins[i];\r\n\t\t\t\tconst time: number = oldPin.time;\r\n\t\t\t\tfor (;;) {\r\n\t\t\t\t\tif (!setStart) {\r\n\t\t\t\t\t\tif (time * direction <= bendStart * direction) {\r\n\t\t\t\t\t\t\tprevInterval = oldPin.interval;\r\n\t\t\t\t\t\t\tprevVolume = oldPin.volume;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (time * direction < bendStart * direction) {\r\n\t\t\t\t\t\t\tpush(makeNotePin(oldPin.interval, time, oldPin.volume));\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tpush(makeNotePin(prevInterval, bendStart, prevVolume));\r\n\t\t\t\t\t\t\tsetStart = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (!setEnd) {\r\n\t\t\t\t\t\tif (time * direction <= bendEnd * direction) {\r\n\t\t\t\t\t\t\tprevInterval = oldPin.interval;\r\n\t\t\t\t\t\t\tprevVolume = oldPin.volume;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (time * direction < bendEnd * direction) {\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tpush(makeNotePin(bendTo, bendEnd, prevVolume));\r\n\t\t\t\t\t\t\tsetEnd = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (time * direction == bendEnd * direction) {\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (oldPin.interval != prevInterval) persist = false;\r\n\t\t\t\t\t\t\tpush(makeNotePin(persist ? bendTo : oldPin.interval, time, oldPin.volume));\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!setEnd) {\r\n\t\t\t\tpush(makeNotePin(bendTo, bendEnd, prevVolume));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._finishSetup();\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeRhythm extends ChangeSequence {\r\n\t\tconstructor(doc: SongDocument, bar: Pattern, oldPartsPerBeat: number, newPartsPerBeat: number) {\r\n\t\t\tsuper();\r\n\t\t\tlet changeRhythm: (oldTime:number)=>number;\r\n\t\t\t\r\n\t\t\tif (oldPartsPerBeat > newPartsPerBeat) {\r\n\t\t\t\tchangeRhythm = (oldTime: number)=> Math.ceil(oldTime * newPartsPerBeat / oldPartsPerBeat);\r\n\t\t\t} else if (oldPartsPerBeat < newPartsPerBeat) {\r\n\t\t\t\tchangeRhythm = (oldTime: number)=> Math.floor(oldTime * newPartsPerBeat / oldPartsPerBeat);\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(\"ChangeRhythm couldn't handle rhythm change from \" + oldPartsPerBeat + \" to \" + newPartsPerBeat + \".\");\r\n\t\t\t}\r\n\t\t\tlet i: number = 0;\r\n\t\t\twhile (i < bar.notes.length) {\r\n\t\t\t\tconst note: Note = bar.notes[i];\r\n\t\t\t\tif (changeRhythm(note.start) >= changeRhythm(note.end)) {\r\n\t\t\t\t\tthis.append(new ChangeNoteAdded(doc, bar, note, i, true));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.append(new ChangeRhythmNote(doc, note, changeRhythm));\r\n\t\t\t\t\ti++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeRhythmNote extends ChangePins {\r\n\t\tconstructor(doc: SongDocument, note: Note, changeRhythm: (oldTime:number)=>number) {\r\n\t\t\tsuper(doc, note);\r\n\t\t\t\r\n\t\t\tfor (const oldPin of this._oldPins) {\r\n\t\t\t\tthis._newPins.push(makeNotePin(oldPin.interval, changeRhythm(oldPin.time + this._oldStart) - this._oldStart, oldPin.volume));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._finishSetup();\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeScale extends Change {\r\n\t\tconstructor(doc: SongDocument, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tif (doc.song.scale != newValue) {\r\n\t\t\t\tdoc.song.scale = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeMix extends Change {\r\n\t\tconstructor(doc: SongDocument, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tif (doc.song.mix != newValue) {\r\n\t\t\t\tdoc.song.mix = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeSampleRate extends Change {\r\n\t\tconstructor(doc: SongDocument, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tif (doc.song.sampleRate != newValue) {\r\n\t\t\t\tdoc.song.sampleRate = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeSong extends Change {\r\n\t\tconstructor(doc: SongDocument, newHash: string) {\r\n\t\t\tsuper();\r\n\t\t\tdoc.song.fromBase64String(newHash);\r\n\t\t\tdoc.channel = Math.min(doc.channel, doc.song.getChannelCount() - 1);\r\n\t\t\tdoc.bar = Math.max(0, Math.min(doc.song.barCount - 1, doc.bar));\r\n\t\t\tdoc.barScrollPos = Math.max(0, Math.min(doc.song.barCount - doc.trackVisibleBars, doc.barScrollPos));\r\n\t\t\tdoc.barScrollPos = Math.min(doc.bar, Math.max(doc.bar - (doc.trackVisibleBars - 1), doc.barScrollPos));\r\n\t\t\tdoc.notifier.changed();\r\n\t\t\tthis._didSomething();\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeTempo extends Change {\r\n\t\tconstructor(doc: SongDocument, oldValue: number, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tdoc.song.tempo = newValue;\r\n\t\t\tdoc.notifier.changed();\r\n\t\t\tif (oldValue != newValue) this._didSomething();\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeReverb extends Change {\r\n\t\tconstructor(doc: SongDocument, oldValue: number, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tdoc.song.reverb = newValue;\r\n\t\t\tdoc.notifier.changed();\r\n\t\t\tif (oldValue != newValue) this._didSomething();\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeBlend extends Change {\r\n\t\tconstructor(doc: SongDocument, oldValue: number, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tdoc.song.blend = newValue;\r\n\t\t\tdoc.notifier.changed();\r\n\t\t\tif (oldValue != newValue) this._didSomething();\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeRiff extends Change {\r\n\t\tconstructor(doc: SongDocument, oldValue: number, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tdoc.song.riff = newValue;\r\n\t\t\tdoc.notifier.changed();\r\n\t\t\tif (oldValue != newValue) this._didSomething();\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeDetune extends Change {\r\n\t\tconstructor(doc: SongDocument, oldValue: number, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tdoc.song.detune = newValue;\r\n\t\t\tdoc.notifier.changed();\r\n\t\t\tif (oldValue != newValue) this._didSomething();\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeMuff extends Change {\r\n\t\tconstructor(doc: SongDocument, oldValue: number, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tdoc.song.muff = newValue;\r\n\t\t\tdoc.notifier.changed();\r\n\t\t\tif (oldValue != newValue) this._didSomething();\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeNoteAdded extends UndoableChange {\r\n\t\tprivate _doc: SongDocument;\r\n\t\tprivate _pattern: Pattern;\r\n\t\tprivate _note: Note;\r\n\t\tprivate _index: number;\r\n\t\tconstructor(doc: SongDocument, pattern: Pattern, note: Note, index: number, deletion: boolean = false) {\r\n\t\t\tsuper(deletion);\r\n\t\t\tthis._doc = doc;\r\n\t\t\tthis._pattern = pattern;\r\n\t\t\tthis._note = note;\r\n\t\t\tthis._index = index;\r\n\t\t\tthis._didSomething();\r\n\t\t\tthis.redo();\r\n\t\t}\r\n\t\t\r\n\t\tprotected _doForwards(): void {\r\n\t\t\tthis._pattern.notes.splice(this._index, 0, this._note);\r\n\t\t\tthis._doc.notifier.changed();\r\n\t\t}\r\n\t\t\r\n\t\tprotected _doBackwards(): void {\r\n\t\t\tthis._pattern.notes.splice(this._index, 1);\r\n\t\t\tthis._doc.notifier.changed();\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeNoteLength extends ChangePins {\r\n\t\tconstructor(doc: SongDocument, note: Note, truncStart: number, truncEnd: number) {\r\n\t\t\tsuper(doc, note);\r\n\t\t\t\r\n\t\t\ttruncStart -= this._oldStart;\r\n\t\t\ttruncEnd   -= this._oldStart;\r\n\t\t\tlet setStart: boolean = false;\r\n\t\t\tlet prevVolume: number = this._oldPins[0].volume;\r\n\t\t\tlet prevInterval: number = this._oldPins[0].interval;\r\n\t\t\tlet pushLastPin: boolean = true;\r\n\t\t\tlet i: number;\r\n\t\t\tfor (i = 0; i < this._oldPins.length; i++) {\r\n\t\t\t\tconst oldPin: NotePin = this._oldPins[i];\r\n\t\t\t\tif (oldPin.time < truncStart) {\r\n\t\t\t\t\tprevVolume = oldPin.volume;\r\n\t\t\t\t\tprevInterval = oldPin.interval;\r\n\t\t\t\t} else if (oldPin.time <= truncEnd) {\r\n\t\t\t\t\tif (oldPin.time > truncStart && !setStart) {\r\n\t\t\t\t\t\tthis._newPins.push(makeNotePin(prevInterval, truncStart, prevVolume));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._newPins.push(makeNotePin(oldPin.interval, oldPin.time, oldPin.volume));\r\n\t\t\t\t\tsetStart = true;\r\n\t\t\t\t\tif (oldPin.time == truncEnd) {\r\n\t\t\t\t\t\tpushLastPin = false;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t} \r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (pushLastPin) this._newPins.push(makeNotePin(this._oldPins[i].interval, truncEnd, this._oldPins[i].volume));\r\n\t\t\t\r\n\t\t\tthis._finishSetup();\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeNoteTruncate extends ChangeSequence {\r\n\t\tconstructor(doc: SongDocument, pattern: Pattern, start: number, end: number, skipNote?: Note) {\r\n\t\t\tsuper();\r\n\t\t\tlet i: number = 0;\r\n\t\t\twhile (i < pattern.notes.length) {\r\n\t\t\t\tconst note: Note = pattern.notes[i];\r\n\t\t\t\tif (note == skipNote && skipNote != undefined) {\r\n\t\t\t\t\ti++;\r\n\t\t\t\t} else if (note.end <= start) {\r\n\t\t\t\t\ti++;\r\n\t\t\t\t} else if (note.start >= end) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t} else if (note.start < start) {\r\n\t\t\t\t\tthis.append(new ChangeNoteLength(doc, note, note.start, start));\r\n\t\t\t\t\ti++;\r\n\t\t\t\t} else if (note.end > end) {\r\n\t\t\t\t\tthis.append(new ChangeNoteLength(doc, note, end, note.end));\r\n\t\t\t\t\ti++;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.append(new ChangeNoteAdded(doc, pattern, note, i, true));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeTransposeNote extends UndoableChange {\r\n\t\tprotected _doc: SongDocument;\r\n\t\tprotected _note: Note;\r\n\t\tprotected _oldStart: number;\r\n\t\tprotected _newStart: number;\r\n\t\tprotected _oldEnd: number;\r\n\t\tprotected _newEnd: number;\r\n\t\tprotected _oldPins: NotePin[];\r\n\t\tprotected _newPins: NotePin[];\r\n\t\tprotected _oldPitches: number[];\r\n\t\tprotected _newPitches: number[];\r\n\t\tconstructor(doc: SongDocument, note: Note, upward: boolean) {\r\n\t\t\tsuper(false);\r\n\t\t\tthis._doc = doc;\r\n\t\t\tthis._note = note;\r\n\t\t\tthis._oldPins = note.pins;\r\n\t\t\tthis._newPins = [];\r\n\t\t\tthis._oldPitches = note.pitches;\r\n\t\t\tthis._newPitches = [];\r\n\t\t\t\r\n\t\t\tconst maxPitch: number = (doc.song.getChannelIsDrum(doc.channel) ? Config.drumCount - 1 : Config.maxPitch);\r\n\t\t\t\r\n\t\t\tfor (let i: number = 0; i < this._oldPitches.length; i++) {\r\n\t\t\t\tlet pitch: number = this._oldPitches[i];\r\n\t\t\t\tif (upward) {\r\n\t\t\t\t\tfor (let j: number = pitch + 1; j <= maxPitch; j++) {\r\n\t\t\t\t\t\tif (doc.song.getChannelIsDrum(doc.channel) || Config.scales[doc.song.scale].flags[j%12]) {\r\n\t\t\t\t\t\t\tpitch = j;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfor (let j: number = pitch - 1; j >= 0; j--) {\r\n\t\t\t\t\t\tif (doc.song.getChannelIsDrum(doc.channel) || Config.scales[doc.song.scale].flags[j%12]) {\r\n\t\t\t\t\t\t\tpitch = j;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tlet foundMatch: boolean = false;\r\n\t\t\t\tfor (let j: number = 0; j < this._newPitches.length; j++) {\r\n\t\t\t\t\tif (this._newPitches[j] == pitch) {\r\n\t\t\t\t\t\tfoundMatch = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!foundMatch) this._newPitches.push(pitch);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tlet min: number = 0;\r\n\t\t\tlet max: number = maxPitch;\r\n\t\t\t\r\n\t\t\tfor (let i: number = 1; i < this._newPitches.length; i++) {\r\n\t\t\t\tconst diff: number = this._newPitches[0] - this._newPitches[i];\r\n\t\t\t\tif (min < diff) min = diff;\r\n\t\t\t\tif (max > diff + maxPitch) max = diff + maxPitch;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfor (const oldPin of this._oldPins) {\r\n\t\t\t\tlet interval: number = oldPin.interval + this._oldPitches[0];\r\n\t\t\t\t\r\n\t\t\t\tif (interval < min) interval = min;\r\n\t\t\t\tif (interval > max) interval = max;\r\n\t\t\t\tif (upward) {\r\n\t\t\t\t\tfor (let i: number = interval + 1; i <= max; i++) {\r\n\t\t\t\t\t\tif (doc.song.getChannelIsDrum(doc.channel) || Config.scales[doc.song.scale].flags[i%12]) {\r\n\t\t\t\t\t\t\tinterval = i;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfor (let i: number = interval - 1; i >= min; i--) {\r\n\t\t\t\t\t\tif (doc.song.getChannelIsDrum(doc.channel) || Config.scales[doc.song.scale].flags[i%12]) {\r\n\t\t\t\t\t\t\tinterval = i;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tinterval -= this._newPitches[0];\r\n\t\t\t\tthis._newPins.push(makeNotePin(interval, oldPin.time, oldPin.volume));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (this._newPins[0].interval != 0) throw new Error(\"wrong pin start interval\");\r\n\t\t\t\r\n\t\t\tfor (let i: number = 1; i < this._newPins.length - 1; ) {\r\n\t\t\t\tif (this._newPins[i-1].interval == this._newPins[i].interval && \r\n\t\t\t\t    this._newPins[i].interval == this._newPins[i+1].interval && \r\n\t\t\t\t    this._newPins[i-1].volume == this._newPins[i].volume && \r\n\t\t\t\t    this._newPins[i].volume == this._newPins[i+1].volume)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis._newPins.splice(i, 1);\r\n\t\t\t\t} else {\r\n\t\t\t\t\ti++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._doForwards();\r\n\t\t\tthis._didSomething();\r\n\t\t}\r\n\t\t\r\n\t\tprotected _doForwards(): void {\r\n\t\t\tthis._note.pins = this._newPins;\r\n\t\t\tthis._note.pitches = this._newPitches;\r\n\t\t\tthis._doc.notifier.changed();\r\n\t\t}\r\n\t\t\r\n\t\tprotected _doBackwards(): void {\r\n\t\t\tthis._note.pins = this._oldPins;\r\n\t\t\tthis._note.pitches = this._oldPitches;\r\n\t\t\tthis._doc.notifier.changed();\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeTranspose extends ChangeSequence {\r\n\t\tconstructor(doc: SongDocument, pattern: Pattern, upward: boolean) {\r\n\t\t\tsuper();\r\n\t\t\tfor (let i: number = 0; i < pattern.notes.length; i++) {\r\n\t\t\t\tthis.append(new ChangeTransposeNote(doc, pattern.notes[i], upward));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeVolume extends Change {\r\n\t\tconstructor(doc: SongDocument, oldValue: number, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tdoc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].volume = newValue;\r\n\t\t\tdoc.notifier.changed();\r\n\t\t\tif (oldValue != newValue) this._didSomething();\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeVolumeBend extends UndoableChange {\r\n\t\tprivate _doc: SongDocument;\r\n\t\tprivate _note: Note;\r\n\t\tprivate _oldPins: NotePin[];\r\n\t\tprivate _newPins: NotePin[];\r\n\t\tconstructor(doc: SongDocument, note: Note, bendPart: number, bendVolume: number, bendInterval: number) {\r\n\t\t\tsuper(false);\r\n\t\t\tthis._doc = doc;\r\n\t\t\tthis._note = note;\r\n\t\t\tthis._oldPins = note.pins;\r\n\t\t\tthis._newPins = [];\r\n\t\t\t\r\n\t\t\tlet inserted: boolean = false;\r\n\t\t\t\r\n\t\t\tfor (const pin of note.pins) {\r\n\t\t\t\tif (pin.time < bendPart) {\r\n\t\t\t\t\tthis._newPins.push(pin);\r\n\t\t\t\t} else if (pin.time == bendPart) {\r\n\t\t\t\t\tthis._newPins.push(makeNotePin(bendInterval, bendPart, bendVolume));\r\n\t\t\t\t\tinserted = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (!inserted) {\r\n\t\t\t\t\t\tthis._newPins.push(makeNotePin(bendInterval, bendPart, bendVolume));\r\n\t\t\t\t\t\tinserted = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._newPins.push(pin);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfor (let i: number = 1; i < this._newPins.length - 1; ) {\r\n\t\t\t\tif (this._newPins[i-1].interval == this._newPins[i].interval && \r\n\t\t\t\t    this._newPins[i].interval == this._newPins[i+1].interval && \r\n\t\t\t\t    this._newPins[i-1].volume == this._newPins[i].volume && \r\n\t\t\t\t    this._newPins[i].volume == this._newPins[i+1].volume)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis._newPins.splice(i, 1);\r\n\t\t\t\t} else {\r\n\t\t\t\t\ti++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._doForwards();\r\n\t\t\tthis._didSomething();\r\n\t\t}\r\n\t\t\r\n\t\tprotected _doForwards(): void {\r\n\t\t\tthis._note.pins = this._newPins;\r\n\t\t\tthis._doc.notifier.changed();\r\n\t\t}\r\n\t\t\r\n\t\tprotected _doBackwards(): void {\r\n\t\t\tthis._note.pins = this._oldPins;\r\n\t\t\tthis._doc.notifier.changed();\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class ChangeWave extends Change {\r\n\t\tconstructor(doc: SongDocument, newValue: number) {\r\n\t\t\tsuper();\r\n\t\t\tif (doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].wave != newValue) {\r\n\t\t\t\tdoc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].wave = newValue;\r\n\t\t\t\tdoc.notifier.changed();\r\n\t\t\t\tthis._didSomething();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n","// Copyright (c) 2012-2022 John Nesky and contributing authors, distributed under the MIT license, see accompanying the LICENSE.md file.\r\n\r\nimport { HTML } from \"imperative-html/dist/esm/elements-strict\";\r\nimport {DictionaryArray, BeepBoxOption, toNameMap} from \"../synth/SynthConfig\";\r\nimport { Song } from \"../synth/song\";\r\n\r\nexport interface ChannelColors extends BeepBoxOption {\r\n    readonly secondaryChannel: string;\r\n    readonly primaryChannel: string;\r\n    readonly secondaryNote: string;\r\n    readonly primaryNote: string;\r\n}\r\n\r\n\r\nexport class ColorConfig {\r\n\tpublic static colorLookup: Map<number, ChannelColors> = new Map<number, ChannelColors>();\r\n\tpublic static usesPianoScheme: boolean = false;\r\n\tprivate static readonly _themeMap: {[K: string]: string} = {\r\n\t\t\"default\": `\r\n            :root {\r\n\t\t\t\t--page-margin: black;\r\n\t\t\t\t--editor-background: black;\r\n\t\t\t\t--hover-preview: white;\r\n\t\t\t\t--playhead: white;\r\n\t\t\t\t--primary-text: white;\r\n\t\t\t\t--secondary-text: #999;\r\n\t\t\t\t--inverted-text: black;\r\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\r\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\r\n\t\t\t\t--loop-accent: #9900cc;\r\n\t\t\t\t--link-accent: #98f;\r\n\t\t\t\t--ui-widget-background: #363636;\r\n\t\t\t\t--ui-widget-focus: #777;\r\n\t\t\t\t--pitch-background: #444;\r\n\t\t\t\t--tonic: #864;\r\n\t\t\t\t--fifth-note: #468;\r\n                --volume-icon: #777777;\r\n\t\t\t\t--octave-scrollbar: #444;\r\n\t\t\t\t--scrollbar-octave: #864;\r\n\t\t\t\t--channel-box: #444;\r\n\r\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\r\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\r\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\r\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\r\n\t\t\t\t--pitch2-secondary-channel: #439143;\r\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\r\n\t\t\t\t--pitch2-secondary-note:    #439143;\r\n\t\t\t\t--pitch2-primary-note:      #44ff44;\r\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\r\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\r\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\r\n\t\t\t\t--pitch3-primary-note:      #ffff25;\r\n\t\t\t\t--pitch4-secondary-channel: #c75000;\r\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\r\n\t\t\t\t--pitch4-secondary-note:    #c75000;\r\n\t\t\t\t--pitch4-primary-note:      #ff9752;\r\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\r\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\r\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\r\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\r\n\t\t\t\t--pitch6-secondary-channel: #552377;\r\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\r\n\t\t\t\t--pitch6-secondary-note:    #552377;\r\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\r\n\t\t\t\t--pitch7-secondary-channel: #221b89;\r\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\r\n\t\t\t\t--pitch7-secondary-note:    #221b89;\r\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\r\n\t\t\t\t--pitch8-secondary-channel: #00995f;\r\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\r\n\t\t\t\t--pitch8-secondary-note:    #00995f;\r\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\r\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\r\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\r\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\r\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\r\n\t\t\t\t--pitch10-secondary-channel:#b25915;\r\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\r\n\t\t\t\t--pitch10-secondary-note:   #b25915;\r\n\t\t\t\t--pitch10-primary-note:     #d85d00;\r\n\r\n\t\t\t\t--pitch11-secondary-channel:#891a60;\r\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\r\n\t\t\t\t--pitch11-secondary-note:   #891a60;\r\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\r\n\r\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\r\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\r\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\r\n\t\t\t\t--pitch12-primary-note:     #c26afc;\r\n\r\n\t\t\t\t--noise1-secondary-channel: #991010;\r\n\t\t\t\t--noise1-primary-channel:   #ff1616;\r\n\t\t\t\t--noise1-secondary-note:    #991010;\r\n\t\t\t\t--noise1-primary-note:      #ff1616;\r\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\r\n\t\t\t\t--noise2-primary-channel:   #ffffff;\r\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\r\n\t\t\t\t--noise2-primary-note:      #ffffff;\r\n\t\t\t\t--noise3-secondary-channel: #5869BD;\r\n\t\t\t\t--noise3-primary-channel:   #768dfc;\r\n\t\t\t\t--noise3-secondary-note:    #5869BD;\r\n\t\t\t\t--noise3-primary-note:      #768dfc;\r\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\r\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\r\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\r\n\t\t\t\t--noise4-primary-note:      #a5ff00;\r\n            }\r\n        `,\r\n\t\t\"nepbox\": `\r\n            :root {\r\n\t\t\t\t--page-margin: black;\r\n\t\t\t\t--editor-background: black;\r\n\t\t\t\t--hover-preview: white;\r\n\t\t\t\t--playhead: white;\r\n\t\t\t\t--primary-text: #00fff5;\r\n\t\t\t\t--secondary-text: #999;\r\n\t\t\t\t--inverted-text: black;\r\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\r\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\r\n\t\t\t\t--loop-accent: #00fff5;\r\n\t\t\t\t--link-accent: #98f;\r\n\t\t\t\t--ui-widget-background: #363636;\r\n\t\t\t\t--ui-widget-focus: #777;\r\n\t\t\t\t--pitch-background: #0a2d44;\r\n\t\t\t\t--tonic: #9150ff;\r\n\t\t\t\t--fifth-note: #990000;\r\n                --volume-icon: #00fff5;\r\n\t\t\t\t--octave-scrollbar: #484848;\r\n\t\t\t\t--scrollbar-octave: #9150ff;\r\n\t\t\t\t--channel-box: #444;\r\n\r\n\t\t\t\t--pitch1-secondary-channel: #c13cbf;\r\n\t\t\t\t--pitch1-primary-channel: #f75dff;\r\n\t\t\t\t--pitch1-secondary-note: #b930a2;\r\n\t\t\t\t--pitch1-primary-note: #fca5ff;\r\n\t\t\t\t--pitch2-secondary-channel: #800000;\r\n\t\t\t\t--pitch2-primary-channel: #f00;\r\n\t\t\t\t--pitch2-secondary-note: #8c2121;\r\n\t\t\t\t--pitch2-primary-note: #ff5252;\r\n\t\t\t\t--pitch3-secondary-channel: #004bb3;\r\n\t\t\t\t--pitch3-primary-channel: #1792ff;\r\n\t\t\t\t--pitch3-secondary-note: #005cb3;\r\n\t\t\t\t--pitch3-primary-note: #00ffe9;\r\n\t\t\t\t--pitch4-secondary-channel: #a48800;\r\n\t\t\t\t--pitch4-primary-channel: #fb0;\r\n\t\t\t\t--pitch4-secondary-note: #9c4100;\r\n\t\t\t\t--pitch4-primary-note: #ffd84e;\r\n\t\t\t\t--pitch5-secondary-channel: #6c0000;\r\n\t\t\t\t--pitch5-primary-channel:   #ff3e3e;\r\n\t\t\t\t--pitch5-secondary-note:    #6c0000;\r\n\t\t\t\t--pitch5-primary-note:      #ff3e3e;\r\n\t\t\t\t--pitch6-secondary-channel:#d25a00;\r\n\t\t\t\t--pitch6-primary-channel:  #fdff00;\r\n\t\t\t\t--pitch6-secondary-note:   #d25a00;\r\n\t\t\t\t--pitch6-primary-note:     #fdff00;\r\n\t\t\t\t--pitch7-secondary-channel: #046000;\r\n\t\t\t\t--pitch7-primary-channel:   #0c79ff;\r\n\t\t\t\t--pitch7-secondary-note:    #046000;\r\n\t\t\t\t--pitch7-primary-note:      #0c79ff;\r\n\t\t\t\t--pitch8-secondary-channel:#3b2bae;\r\n\t\t\t\t--pitch8-primary-channel:  #d85d00;\r\n\t\t\t\t--pitch8-secondary-note:   #3b2bae;\r\n\t\t\t\t--pitch8-primary-note:     #d85d00;\r\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\r\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\r\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\r\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\r\n\t\t\t\t--pitch10-secondary-channel:#b25915;\r\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\r\n\t\t\t\t--pitch10-secondary-note:   #b25915;\r\n\t\t\t\t--pitch10-primary-note:     #d85d00;\r\n\t\t\t\t--pitch11-secondary-channel:#891a60;\r\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\r\n\t\t\t\t--pitch11-secondary-note:   #891a60;\r\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\r\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\r\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\r\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\r\n\t\t\t\t--pitch12-primary-note:     #c26afc;\r\n\t\t\t\t--noise1-secondary-channel: #868686;\r\n\t\t\t\t--noise1-primary-channel: #fff;\r\n\t\t\t\t--noise1-secondary-note: #868686;\r\n\t\t\t\t--noise1-primary-note: #fff;\r\n\t\t\t\t--noise2-secondary-channel: #805300;\r\n\t\t\t\t--noise2-primary-channel: #ff8c00;\r\n\t\t\t\t--noise2-secondary-note: #6a3500;\r\n\t\t\t\t--noise2-primary-note: #a85400;\r\n\t\t\t\t--noise3-secondary-channel: #5869BD;\r\n\t\t\t\t--noise3-primary-channel:   #768dfc;\r\n\t\t\t\t--noise3-secondary-note:    #5869BD;\r\n\t\t\t\t--noise3-primary-note:      #768dfc;\r\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\r\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\r\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\r\n\t\t\t\t--noise4-primary-note:      #a5ff00;\r\n            }\r\n        `,\r\n\t\t\"laffey\": `\r\n\t\t\t:root {\r\n\t\t\t\t--page-margin: #000;\r\n\t\t\t\t--editor-background: #060606;\r\n\t\t\t\t--hover-preview: #fff;\r\n\t\t\t\t--playhead: rgb(0, 242, 255);\r\n\t\t\t\t--primary-text: #00fff5;\r\n\t\t\t\t--secondary-text: #a82f2f;\r\n\t\t\t\t--inverted-text: #000;\r\n\t\t\t\t--text-selection: rgba(98, 46, 164, .99);\r\n\t\t\t\t--box-selection-fill: #b74a4a;\r\n\r\n\t\t\t\t--loop-accent: #7744FF;\r\n\r\n\t\t\t\t--link-accent: #ff00e1;\r\n\t\t\t\t--ui-widget-background: #484848;\r\n\t\t\t\t--ui-widget-focus: #3e3e3e;\r\n\t\t\t\t--pitch-background: #444444;\r\n\r\n\t\t\t\t--tonic: #dbbeed;\r\n\t\t\t\t--pitch1-background: #1a2182; \r\n\t\t\t\t--pitch2-background: #1a2182; \r\n\t\t\t\t--pitch3-background: #1a2182; \r\n\t\t\t\t--pitch4-background: #1a2182;\r\n\t\t\t\t--pitch5-background: #1a2182; \r\n\t\t\t\t--pitch6-background: #1a2182; \r\n\t\t\t\t--fifth-note: #6b1313;\r\n\t\t\t\t--pitch8-background: #1a2182; \r\n\t\t\t\t--pitch9-background: #1a2182; \r\n\t\t\t\t--pitch10-background: #1a2182; \r\n\t\t\t\t--pitch11-background: #1a2182;\r\n\t\t\t\t--octave-scrollbar: #852929;\r\n\t\t\t\t--scrollbar-octave: #f2b3ff;\r\n\r\n\t\t\t\t--white-piano-key: #bababa;\r\n\t\t\t\t--black-piano-key: #444444;\r\n\r\n\t\t\t\t--noise-channel-limit: 2;\r\n\t\t\t\t--pitch1-secondary-channel: #c13cbf;\r\n\t\t\t\t--pitch1-primary-channel: #f75dff;\r\n\t\t\t\t--pitch1-secondary-note: #b930a2;\r\n\t\t\t\t--pitch1-primary-note: #fca5ff;\r\n\t\t\t\t--pitch2-secondary-channel: #800000;\r\n\t\t\t\t--pitch2-primary-channel: #f00;\r\n\t\t\t\t--pitch2-secondary-note: #8c2121;\r\n\t\t\t\t--pitch2-primary-note: #ff5252;\r\n\t\t\t\t--pitch3-secondary-channel: #004bb3;\r\n\t\t\t\t--pitch3-primary-channel: #1792ff;\r\n\t\t\t\t--pitch3-secondary-note: #005cb3;\r\n\t\t\t\t--pitch3-primary-note: #00ffe9;\r\n\t\t\t\t--pitch4-secondary-channel: #a48800;\r\n\t\t\t\t--pitch4-primary-channel: #fb0;\r\n\t\t\t\t--pitch4-secondary-note: #9c4100;\r\n\t\t\t\t--pitch4-primary-note: #ffd84e;\r\n\t\t\t\t--pitch5-secondary-channel: #6c0000;\r\n\t\t\t\t--pitch5-primary-channel:   #ff3e3e;\r\n\t\t\t\t--pitch5-secondary-note:    #6c0000;\r\n\t\t\t\t--pitch5-primary-note:      #ff3e3e;\r\n\t\t\t\t--pitch6-secondary-channel:#d25a00;\r\n\t\t\t\t--pitch6-primary-channel:  #fdff00;\r\n\t\t\t\t--pitch6-secondary-note:   #d25a00;\r\n\t\t\t\t--pitch6-primary-note:     #fdff00;\r\n\t\t\t\t--pitch7-secondary-channel: #046000;\r\n\t\t\t\t--pitch7-primary-channel:   #0c79ff;\r\n\t\t\t\t--pitch7-secondary-note:    #046000;\r\n\t\t\t\t--pitch7-primary-note:      #0c79ff;\r\n\t\t\t\t--pitch8-secondary-channel:#3b2bae;\r\n\t\t\t\t--pitch8-primary-channel:  #d85d00;\r\n\t\t\t\t--pitch8-secondary-note:   #3b2bae;\r\n\t\t\t\t--pitch8-primary-note:     #d85d00;\r\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\r\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\r\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\r\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\r\n\t\t\t\t--pitch10-secondary-channel:#b25915;\r\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\r\n\t\t\t\t--pitch10-secondary-note:   #b25915;\r\n\t\t\t\t--pitch10-primary-note:     #d85d00;\r\n\t\t\t\t--pitch11-secondary-channel:#891a60;\r\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\r\n\t\t\t\t--pitch11-secondary-note:   #891a60;\r\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\r\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\r\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\r\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\r\n\t\t\t\t--pitch12-primary-note:     #c26afc;\r\n\t\t\t\t--noise1-secondary-channel: #868686;\r\n\t\t\t\t--noise1-primary-channel: #fff;\r\n\t\t\t\t--noise1-secondary-note: #868686;\r\n\t\t\t\t--noise1-primary-note: #fff;\r\n\t\t\t\t--noise2-secondary-channel: #805300;\r\n\t\t\t\t--noise2-primary-channel: #ff8c00;\r\n\t\t\t\t--noise2-secondary-note: #6a3500;\r\n\t\t\t\t--noise2-primary-note: #a85400;\r\n\t\t\t\t--noise3-secondary-channel: #868686;\r\n\t\t\t\t--noise3-primary-channel: #fff;\r\n\t\t\t\t--noise3-secondary-note: #868686;\r\n\t\t\t\t--noise3-primary-note: #fff;\r\n\t\t\t\t--noise4-secondary-channel: #805300;\r\n\t\t\t\t--noise4-primary-channel: #ff8c00;\r\n\t\t\t\t--noise4-secondary-note: #6a3500;\r\n\t\t\t\t--noise4-primary-note: #a85400;\r\n\t\t\t\t}\r\n\t\t\t`,\r\n\t\t\"modbox2\": `\r\n            :root {\r\n                --page-margin: black;\r\n\t\t\t\t--editor-background: black;\r\n\t\t\t\t--hover-preview: white;\r\n\t\t\t\t--playhead: white;\r\n\t\t\t\t--primary-text: white;\r\n\t\t\t\t--secondary-text: #999;\r\n\t\t\t\t--inverted-text: black;\r\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\r\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\r\n\t\t\t\t--loop-accent: #00ff00;\r\n\t\t\t\t--link-accent: #98f;\r\n\t\t\t\t--ui-widget-background: #363636;\r\n\t\t\t\t--ui-widget-focus: #777;\r\n\t\t\t\t--pitch-background: #444;\r\n\t\t\t\t--tonic: #c4ffa3;\r\n\t\t\t\t--fifth-note: #96fffb;\r\n                --volume-icon: #c4ffa3;\r\n\t\t\t\t--octave-scrollbar: #00ff00;\r\n\t\t\t\t--scrollbar-octave: #fff;\r\n\t\t\t\t--channel-box: #444;\r\n\r\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\r\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\r\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\r\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\r\n\t\t\t\t--pitch2-secondary-channel: #439143;\r\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\r\n\t\t\t\t--pitch2-secondary-note:    #439143;\r\n\t\t\t\t--pitch2-primary-note:      #44ff44;\r\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\r\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\r\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\r\n\t\t\t\t--pitch3-primary-note:      #ffff25;\r\n\t\t\t\t--pitch4-secondary-channel: #c75000;\r\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\r\n\t\t\t\t--pitch4-secondary-note:    #c75000;\r\n\t\t\t\t--pitch4-primary-note:      #ff9752;\r\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\r\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\r\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\r\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\r\n\t\t\t\t--pitch6-secondary-channel: #552377;\r\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\r\n\t\t\t\t--pitch6-secondary-note:    #552377;\r\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\r\n\t\t\t\t--pitch7-secondary-channel: #221b89;\r\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\r\n\t\t\t\t--pitch7-secondary-note:    #221b89;\r\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\r\n\t\t\t\t--pitch8-secondary-channel: #00995f;\r\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\r\n\t\t\t\t--pitch8-secondary-note:    #00995f;\r\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\r\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\r\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\r\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\r\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\r\n\t\t\t\t--pitch10-secondary-channel:#b25915;\r\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\r\n\t\t\t\t--pitch10-secondary-note:   #b25915;\r\n\t\t\t\t--pitch10-primary-note:     #d85d00;\r\n\r\n\t\t\t\t--pitch11-secondary-channel:#891a60;\r\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\r\n\t\t\t\t--pitch11-secondary-note:   #891a60;\r\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\r\n\r\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\r\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\r\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\r\n\t\t\t\t--pitch12-primary-note:     #c26afc;\r\n\r\n\t\t\t\t--noise1-secondary-channel: #991010;\r\n\t\t\t\t--noise1-primary-channel:   #ff1616;\r\n\t\t\t\t--noise1-secondary-note:    #991010;\r\n\t\t\t\t--noise1-primary-note:      #ff1616;\r\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\r\n\t\t\t\t--noise2-primary-channel:   #ffffff;\r\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\r\n\t\t\t\t--noise2-primary-note:      #ffffff;\r\n\t\t\t\t--noise3-secondary-channel: #5869BD;\r\n\t\t\t\t--noise3-primary-channel:   #768dfc;\r\n\t\t\t\t--noise3-secondary-note:    #5869BD;\r\n\t\t\t\t--noise3-primary-note:      #768dfc;\r\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\r\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\r\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\r\n\t\t\t\t--noise4-primary-note:      #a5ff00;\r\n            }\r\n\t\t`,\r\n\t\t\"artic\": `\r\n\t\t:root {\r\n\t\t\t\t--page-margin: black;\r\n\t\t\t\t--editor-background: black;\r\n\t\t\t\t--hover-preview: white;\r\n\t\t\t\t--playhead: white;\r\n\t\t\t\t--primary-text: white;\r\n\t\t\t\t--secondary-text: #999;\r\n\t\t\t\t--inverted-text: black;\r\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\r\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\r\n\t\t\t\t--loop-accent: #ffffff;\r\n\t\t\t\t--link-accent: #98f;\r\n\t\t\t\t--ui-widget-background: #363636;\r\n\t\t\t\t--ui-widget-focus: #777;\r\n\t\t\t\t--pitch-background: #444;\r\n\t\t\t\t--tonic: #eafffe;\r\n\t\t\t\t--fifth-note: #b7f1ff;\r\n\t\t\t\t--octave-scrollbar: #a5eeff;\r\n\t\t\t\t--scrollbar-octave: #cefffd;\r\n\t\t\t\t--volume-icon: #42dcff;\t\r\n\r\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\r\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\r\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\r\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\r\n\t\t\t\t--pitch2-secondary-channel: #439143;\r\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\r\n\t\t\t\t--pitch2-secondary-note:    #439143;\r\n\t\t\t\t--pitch2-primary-note:      #44ff44;\r\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\r\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\r\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\r\n\t\t\t\t--pitch3-primary-note:      #ffff25;\r\n\t\t\t\t--pitch4-secondary-channel: #c75000;\r\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\r\n\t\t\t\t--pitch4-secondary-note:    #c75000;\r\n\t\t\t\t--pitch4-primary-note:      #ff9752;\r\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\r\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\r\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\r\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\r\n\t\t\t\t--pitch6-secondary-channel: #552377;\r\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\r\n\t\t\t\t--pitch6-secondary-note:    #552377;\r\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\r\n\t\t\t\t--pitch7-secondary-channel: #221b89;\r\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\r\n\t\t\t\t--pitch7-secondary-note:    #221b89;\r\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\r\n\t\t\t\t--pitch8-secondary-channel: #00995f;\r\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\r\n\t\t\t\t--pitch8-secondary-note:    #00995f;\r\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\r\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\r\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\r\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\r\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\r\n\t\t\t\t--pitch10-secondary-channel:#b25915;\r\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\r\n\t\t\t\t--pitch10-secondary-note:   #b25915;\r\n\t\t\t\t--pitch10-primary-note:     #d85d00;\r\n\t\t\t\t--pitch11-secondary-channel:#891a60;\r\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\r\n\t\t\t\t--pitch11-secondary-note:   #891a60;\r\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\r\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\r\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\r\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\r\n\t\t\t\t--pitch12-primary-note:     #c26afc;\r\n\t\t\t\t--noise1-secondary-channel: #991010;\r\n\t\t\t\t--noise1-primary-channel:   #ff1616;\r\n\t\t\t\t--noise1-secondary-note:    #991010;\r\n\t\t\t\t--noise1-primary-note:      #ff1616;\r\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\r\n\t\t\t\t--noise2-primary-channel:   #ffffff;\r\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\r\n\t\t\t\t--noise2-primary-note:      #ffffff;\r\n\t\t\t\t--noise3-secondary-channel: #5869BD;\r\n\t\t\t\t--noise3-primary-channel:   #768dfc;\r\n\t\t\t\t--noise3-secondary-note:    #5869BD;\r\n\t\t\t\t--noise3-primary-note:      #768dfc;\r\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\r\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\r\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\r\n\t\t\t\t--noise4-primary-note:      #a5ff00;\r\n\t\t\t\t}\r\n\t\t`,\r\n\t\t\"Cinnamon Roll\": `\r\n\t\t:root {\r\n\t\t\t\t--page-margin: black;\r\n\t\t\t\t--editor-background: black;\r\n\t\t\t\t--hover-preview: white;\r\n\t\t\t\t--playhead: white;\r\n\t\t\t\t--primary-text: white;\r\n\t\t\t\t--secondary-text: #999;\r\n\t\t\t\t--inverted-text: black;\r\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\r\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\r\n\t\t\t\t--loop-accent: #ba8418;\r\n\t\t\t\t--link-accent: #98f;\r\n\t\t\t\t--ui-widget-background: #363636;\r\n\t\t\t\t--ui-widget-focus: #777;\r\n\t\t\t\t--pitch-background: #444;\r\n\t\t\t\t--pitch1-background: #f5bb00;\r\n\t\t\t\t--pitch2-background: #f5bb00;\r\n\t\t\t\t--pitch3-background: #f5bb00;\r\n\t\t\t\t--pitch4-background: #f5bb00;\r\n\t\t\t\t--pitch5-background: #f5bb00;\r\n\t\t\t\t--pitch6-background: #f5bb00;\r\n\t\t\t\t--pitch8-background: #f5bb00;\r\n\t\t\t\t--pitch9-background: #f5bb00;\r\n\t\t\t\t--pitch10-background: #f5bb00;\r\n\t\t\t\t--pitch11-background: #f5bb00;\r\n\t\t\t\t--pitch12-background: #f5bb00;\r\n\t\t\t\t--tonic: #f5bb00;\r\n\t\t\t\t--fifth-note: #f5bb00;\r\n\t\t\t\t--volume-icon: #ba8418;\t\r\n\r\n\t\t\t\t--octave-scrollbar: #e59900;\r\n\t\t\t\t--scrollbar-octave: #ffff25;\r\n\r\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\r\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\r\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\r\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\r\n\t\t\t\t--pitch2-secondary-channel: #439143;\r\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\r\n\t\t\t\t--pitch2-secondary-note:    #439143;\r\n\t\t\t\t--pitch2-primary-note:      #44ff44;\r\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\r\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\r\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\r\n\t\t\t\t--pitch3-primary-note:      #ffff25;\r\n\t\t\t\t--pitch4-secondary-channel: #c75000;\r\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\r\n\t\t\t\t--pitch4-secondary-note:    #c75000;\r\n\t\t\t\t--pitch4-primary-note:      #ff9752;\r\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\r\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\r\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\r\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\r\n\t\t\t\t--pitch6-secondary-channel: #552377;\r\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\r\n\t\t\t\t--pitch6-secondary-note:    #552377;\r\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\r\n\t\t\t\t--pitch7-secondary-channel: #221b89;\r\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\r\n\t\t\t\t--pitch7-secondary-note:    #221b89;\r\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\r\n\t\t\t\t--pitch8-secondary-channel: #00995f;\r\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\r\n\t\t\t\t--pitch8-secondary-note:    #00995f;\r\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\r\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\r\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\r\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\r\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\r\n\t\t\t\t--pitch10-secondary-channel:#b25915;\r\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\r\n\t\t\t\t--pitch10-secondary-note:   #b25915;\r\n\t\t\t\t--pitch10-primary-note:     #d85d00;\r\n\t\t\t\t--pitch11-secondary-channel:#891a60;\r\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\r\n\t\t\t\t--pitch11-secondary-note:   #891a60;\r\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\r\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\r\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\r\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\r\n\t\t\t\t--pitch12-primary-note:     #c26afc;\r\n\t\t\t\t--noise1-secondary-channel: #991010;\r\n\t\t\t\t--noise1-primary-channel:   #ff1616;\r\n\t\t\t\t--noise1-secondary-note:    #991010;\r\n\t\t\t\t--noise1-primary-note:      #ff1616;\r\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\r\n\t\t\t\t--noise2-primary-channel:   #ffffff;\r\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\r\n\t\t\t\t--noise2-primary-note:      #ffffff;\r\n\t\t\t\t--noise3-secondary-channel: #5869BD;\r\n\t\t\t\t--noise3-primary-channel:   #768dfc;\r\n\t\t\t\t--noise3-secondary-note:    #5869BD;\r\n\t\t\t\t--noise3-primary-note:      #768dfc;\r\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\r\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\r\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\r\n\t\t\t\t--noise4-primary-note:      #a5ff00;\r\n\t\t\t\t}\r\n\t\t`,\r\n\t\t\"Ocean\": `\r\n\t\t:root {\r\n\t\t\t\t--page-margin: black;\r\n\t\t\t\t--editor-background: black;\r\n\t\t\t\t--hover-preview: white;\r\n\t\t\t\t--playhead: white;\r\n\t\t\t\t--primary-text: white;\r\n\t\t\t\t--secondary-text: #999;\r\n\t\t\t\t--inverted-text: black;\r\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\r\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\r\n\t\t\t\t--loop-accent: #5982ff;\r\n\t\t\t\t--link-accent: #98f;\r\n\t\t\t\t--ui-widget-background: #363636;\r\n\t\t\t\t--ui-widget-focus: #777;\r\n\t\t\t\t--pitch-background: #444;\r\n\t\t\t\t--tonic: #090b3a;\r\n\t\t\t\t--fifth-note: #3f669b;\r\n\t\t\t\t--volume-icon: #090b3a;\t\r\n\r\n\t\t\t\t--octave-scrollbar: #4449a3;\r\n\t\t\t\t--scrollbar-octave: #3dffdb;\r\n\r\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\r\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\r\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\r\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\r\n\t\t\t\t--pitch2-secondary-channel: #439143;\r\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\r\n\t\t\t\t--pitch2-secondary-note:    #439143;\r\n\t\t\t\t--pitch2-primary-note:      #44ff44;\r\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\r\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\r\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\r\n\t\t\t\t--pitch3-primary-note:      #ffff25;\r\n\t\t\t\t--pitch4-secondary-channel: #c75000;\r\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\r\n\t\t\t\t--pitch4-secondary-note:    #c75000;\r\n\t\t\t\t--pitch4-primary-note:      #ff9752;\r\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\r\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\r\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\r\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\r\n\t\t\t\t--pitch6-secondary-channel: #552377;\r\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\r\n\t\t\t\t--pitch6-secondary-note:    #552377;\r\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\r\n\t\t\t\t--pitch7-secondary-channel: #221b89;\r\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\r\n\t\t\t\t--pitch7-secondary-note:    #221b89;\r\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\r\n\t\t\t\t--pitch8-secondary-channel: #00995f;\r\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\r\n\t\t\t\t--pitch8-secondary-note:    #00995f;\r\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\r\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\r\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\r\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\r\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\r\n\t\t\t\t--pitch10-secondary-channel:#b25915;\r\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\r\n\t\t\t\t--pitch10-secondary-note:   #b25915;\r\n\t\t\t\t--pitch10-primary-note:     #d85d00;\r\n\t\t\t\t--pitch11-secondary-channel:#891a60;\r\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\r\n\t\t\t\t--pitch11-secondary-note:   #891a60;\r\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\r\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\r\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\r\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\r\n\t\t\t\t--pitch12-primary-note:     #c26afc;\r\n\t\t\t\t--noise1-secondary-channel: #991010;\r\n\t\t\t\t--noise1-primary-channel:   #ff1616;\r\n\t\t\t\t--noise1-secondary-note:    #991010;\r\n\t\t\t\t--noise1-primary-note:      #ff1616;\r\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\r\n\t\t\t\t--noise2-primary-channel:   #ffffff;\r\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\r\n\t\t\t\t--noise2-primary-note:      #ffffff;\r\n\t\t\t\t--noise3-secondary-channel: #5869BD;\r\n\t\t\t\t--noise3-primary-channel:   #768dfc;\r\n\t\t\t\t--noise3-secondary-note:    #5869BD;\r\n\t\t\t\t--noise3-primary-note:      #768dfc;\r\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\r\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\r\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\r\n\t\t\t\t--noise4-primary-note:      #a5ff00;\r\n\t\t\t\t}\r\n\t\t`,\r\n\t\t\"rainbow\": `\r\n\t\t:root {\r\n\t\t\t\t--page-margin: black;\r\n\t\t\t\t--editor-background: black;\r\n\t\t\t\t--hover-preview: white;\r\n\t\t\t\t--playhead: white;\r\n\t\t\t\t--primary-text: white;\r\n\t\t\t\t--secondary-text: #999;\r\n\t\t\t\t--inverted-text: black;\r\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\r\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\r\n\t\t\t\t--loop-accent: #ff0000;\r\n\t\t\t\t--link-accent: #98f;\r\n\t\t\t\t--ui-widget-background: #363636;\r\n\t\t\t\t--ui-widget-focus: #777;\r\n\r\n\t\t\t\t--pitch-background: #444; \r\n\t\t\t\t--tonic: #ffaaaa; \r\n\t\t\t\t--pitch1-background: #ffceaa; \r\n\t\t\t\t--pitch2-background: #ffdfaa; \r\n\t\t\t\t--pitch3-background: #fff5aa; \r\n\t\t\t\t--pitch4-background: #e8ffaa;\r\n\t\t\t\t--pitch5-background: #bfffb2; \r\n\t\t\t\t--pitch6-background: #b2ffc8; \r\n\t\t\t\t--fifth-note: #b2ffe4; \r\n\t\t\t\t--pitch8-background: #b2f3ff; \r\n\t\t\t\t--pitch9-background: #b2b3ff; \r\n\t\t\t\t--pitch10-background: #e0b2ff; \r\n\t\t\t\t--pitch11-background: #ffafe9; \r\n\t\t\t\t--octave-scrollbar: #43ff00; \r\n\t\t\t\t--volume-icon: #ff00cb;\t\r\n\r\n\t\t\t\t--octave-scrollbar: #43ff00;\r\n\t\t\t\t--scrollbar-octave: #0400ff;\r\n\r\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\r\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\r\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\r\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\r\n\t\t\t\t--pitch2-secondary-channel: #439143;\r\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\r\n\t\t\t\t--pitch2-secondary-note:    #439143;\r\n\t\t\t\t--pitch2-primary-note:      #44ff44;\r\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\r\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\r\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\r\n\t\t\t\t--pitch3-primary-note:      #ffff25;\r\n\t\t\t\t--pitch4-secondary-channel: #c75000;\r\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\r\n\t\t\t\t--pitch4-secondary-note:    #c75000;\r\n\t\t\t\t--pitch4-primary-note:      #ff9752;\r\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\r\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\r\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\r\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\r\n\t\t\t\t--pitch6-secondary-channel: #552377;\r\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\r\n\t\t\t\t--pitch6-secondary-note:    #552377;\r\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\r\n\t\t\t\t--pitch7-secondary-channel: #221b89;\r\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\r\n\t\t\t\t--pitch7-secondary-note:    #221b89;\r\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\r\n\t\t\t\t--pitch8-secondary-channel: #00995f;\r\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\r\n\t\t\t\t--pitch8-secondary-note:    #00995f;\r\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\r\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\r\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\r\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\r\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\r\n\t\t\t\t--pitch10-secondary-channel:#b25915;\r\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\r\n\t\t\t\t--pitch10-secondary-note:   #b25915;\r\n\t\t\t\t--pitch10-primary-note:     #d85d00;\r\n\t\t\t\t--pitch11-secondary-channel:#891a60;\r\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\r\n\t\t\t\t--pitch11-secondary-note:   #891a60;\r\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\r\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\r\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\r\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\r\n\t\t\t\t--pitch12-primary-note:     #c26afc;\r\n\t\t\t\t--noise1-secondary-channel: #991010;\r\n\t\t\t\t--noise1-primary-channel:   #ff1616;\r\n\t\t\t\t--noise1-secondary-note:    #991010;\r\n\t\t\t\t--noise1-primary-note:      #ff1616;\r\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\r\n\t\t\t\t--noise2-primary-channel:   #ffffff;\r\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\r\n\t\t\t\t--noise2-primary-note:      #ffffff;\r\n\t\t\t\t--noise3-secondary-channel: #5869BD;\r\n\t\t\t\t--noise3-primary-channel:   #768dfc;\r\n\t\t\t\t--noise3-secondary-note:    #5869BD;\r\n\t\t\t\t--noise3-primary-note:      #768dfc;\r\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\r\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\r\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\r\n\t\t\t\t--noise4-primary-note:      #a5ff00;\r\n\t\t\t\t}\r\n\t\t`,\r\n\t\t\"float\": `\r\n\t\t:root {\r\n\t\t\t\t--page-margin: black;\r\n\t\t\t\t--editor-background: black;\r\n\t\t\t\t--hover-preview: white;\r\n\t\t\t\t--playhead: white;\r\n\t\t\t\t--primary-text: white;\r\n\t\t\t\t--secondary-text: #999;\r\n\t\t\t\t--inverted-text: black;\r\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\r\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\r\n\t\t\t\t--loop-accent: #ff0000;\r\n\t\t\t\t--link-accent: #98f;\r\n\t\t\t\t--ui-widget-background: #363636;\r\n\t\t\t\t--ui-widget-focus: #777;\r\n\t\t\t\t--volume-icon: #878787;\t\r\n\r\n\t\t\t\t--pitch-background: #444; \r\n\t\t\t\t--tonic: #ffffff; \r\n\t\t\t\t--pitch1-background: #ededed;  \r\n\t\t\t\t--pitch2-background: #cecece;  \r\n\t\t\t\t--pitch3-background: #bababa;  \r\n\t\t\t\t--pitch4-background: #afafaf;\r\n\t\t\t\t--pitch5-background: #a5a5a5; \r\n\t\t\t\t--pitch6-background: #999999; \r\n\t\t\t\t--fifth-note: #8e8e8e; \r\n\t\t\t\t--pitch8-background: #828282; \r\n\t\t\t\t--pitch9-background: #777777; \r\n\t\t\t\t--pitch10-background: #565656; \r\n\t\t\t\t--pitch11-background: #282828; \r\n\t\t\t\t--octave-scrollbar: #ffffff; \r\n\t\t\t\t--scrollbar-octave: #c9c9c9;\r\n\r\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\r\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\r\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\r\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\r\n\t\t\t\t--pitch2-secondary-channel: #439143;\r\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\r\n\t\t\t\t--pitch2-secondary-note:    #439143;\r\n\t\t\t\t--pitch2-primary-note:      #44ff44;\r\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\r\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\r\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\r\n\t\t\t\t--pitch3-primary-note:      #ffff25;\r\n\t\t\t\t--pitch4-secondary-channel: #c75000;\r\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\r\n\t\t\t\t--pitch4-secondary-note:    #c75000;\r\n\t\t\t\t--pitch4-primary-note:      #ff9752;\r\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\r\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\r\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\r\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\r\n\t\t\t\t--pitch6-secondary-channel: #552377;\r\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\r\n\t\t\t\t--pitch6-secondary-note:    #552377;\r\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\r\n\t\t\t\t--pitch7-secondary-channel: #221b89;\r\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\r\n\t\t\t\t--pitch7-secondary-note:    #221b89;\r\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\r\n\t\t\t\t--pitch8-secondary-channel: #00995f;\r\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\r\n\t\t\t\t--pitch8-secondary-note:    #00995f;\r\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\r\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\r\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\r\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\r\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\r\n\t\t\t\t--pitch10-secondary-channel:#b25915;\r\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\r\n\t\t\t\t--pitch10-secondary-note:   #b25915;\r\n\t\t\t\t--pitch10-primary-note:     #d85d00;\r\n\t\t\t\t--pitch11-secondary-channel:#891a60;\r\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\r\n\t\t\t\t--pitch11-secondary-note:   #891a60;\r\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\r\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\r\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\r\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\r\n\t\t\t\t--pitch12-primary-note:     #c26afc;\r\n\t\t\t\t--noise1-secondary-channel: #991010;\r\n\t\t\t\t--noise1-primary-channel:   #ff1616;\r\n\t\t\t\t--noise1-secondary-note:    #991010;\r\n\t\t\t\t--noise1-primary-note:      #ff1616;\r\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\r\n\t\t\t\t--noise2-primary-channel:   #ffffff;\r\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\r\n\t\t\t\t--noise2-primary-note:      #ffffff;\r\n\t\t\t\t--noise3-secondary-channel: #5869BD;\r\n\t\t\t\t--noise3-primary-channel:   #768dfc;\r\n\t\t\t\t--noise3-secondary-note:    #5869BD;\r\n\t\t\t\t--noise3-primary-note:      #768dfc;\r\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\r\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\r\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\r\n\t\t\t\t--noise4-primary-note:      #a5ff00;\r\n\t\t\t\t}\r\n\t\t`,\r\n\t\t\"windows\": `\r\n\t\t:root {\r\n\t\t\t\t--page-margin: black;\r\n\t\t\t\t--editor-background: black;\r\n\t\t\t\t--hover-preview: white;\r\n\t\t\t\t--playhead: white;\r\n\t\t\t\t--primary-text: white;\r\n\t\t\t\t--secondary-text: #999;\r\n\t\t\t\t--inverted-text: black;\r\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\r\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\r\n\t\t\t\t--loop-accent: #ff0000;\r\n\t\t\t\t--link-accent: #98f;\r\n\t\t\t\t--ui-widget-background: #363636;\r\n\t\t\t\t--ui-widget-focus: #777;\r\n\t\t\t\t--volume-icon: #15a0db;\t\r\n\r\n\t\t\t\t--tonic: #da4e2a;\r\n\t\t\t\t--fifth-note: #5d9511;\r\n\t\t\t\t--pitch-background: #444;\r\n\r\n\t\t\t\t--octave-scrollbar: #295294; \r\n\t\t\t\t--scrollbar-octave: #fdd01d;\r\n\r\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\r\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\r\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\r\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\r\n\t\t\t\t--pitch2-secondary-channel: #439143;\r\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\r\n\t\t\t\t--pitch2-secondary-note:    #439143;\r\n\t\t\t\t--pitch2-primary-note:      #44ff44;\r\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\r\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\r\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\r\n\t\t\t\t--pitch3-primary-note:      #ffff25;\r\n\t\t\t\t--pitch4-secondary-channel: #c75000;\r\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\r\n\t\t\t\t--pitch4-secondary-note:    #c75000;\r\n\t\t\t\t--pitch4-primary-note:      #ff9752;\r\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\r\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\r\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\r\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\r\n\t\t\t\t--pitch6-secondary-channel: #552377;\r\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\r\n\t\t\t\t--pitch6-secondary-note:    #552377;\r\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\r\n\t\t\t\t--pitch7-secondary-channel: #221b89;\r\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\r\n\t\t\t\t--pitch7-secondary-note:    #221b89;\r\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\r\n\t\t\t\t--pitch8-secondary-channel: #00995f;\r\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\r\n\t\t\t\t--pitch8-secondary-note:    #00995f;\r\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\r\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\r\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\r\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\r\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\r\n\t\t\t\t--pitch10-secondary-channel:#b25915;\r\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\r\n\t\t\t\t--pitch10-secondary-note:   #b25915;\r\n\t\t\t\t--pitch10-primary-note:     #d85d00;\r\n\t\t\t\t--pitch11-secondary-channel:#891a60;\r\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\r\n\t\t\t\t--pitch11-secondary-note:   #891a60;\r\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\r\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\r\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\r\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\r\n\t\t\t\t--pitch12-primary-note:     #c26afc;\r\n\t\t\t\t--noise1-secondary-channel: #991010;\r\n\t\t\t\t--noise1-primary-channel:   #ff1616;\r\n\t\t\t\t--noise1-secondary-note:    #991010;\r\n\t\t\t\t--noise1-primary-note:      #ff1616;\r\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\r\n\t\t\t\t--noise2-primary-channel:   #ffffff;\r\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\r\n\t\t\t\t--noise2-primary-note:      #ffffff;\r\n\t\t\t\t--noise3-secondary-channel: #5869BD;\r\n\t\t\t\t--noise3-primary-channel:   #768dfc;\r\n\t\t\t\t--noise3-secondary-note:    #5869BD;\r\n\t\t\t\t--noise3-primary-note:      #768dfc;\r\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\r\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\r\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\r\n\t\t\t\t--noise4-primary-note:      #a5ff00;\r\n\t\t\t\t}\r\n\t\t`,\r\n\t\t\"grassland\": `\r\n\t\t:root {\r\n\t\t\t\t--page-margin: black;\r\n\t\t\t\t--editor-background: black;\r\n\t\t\t\t--hover-preview: white;\r\n\t\t\t\t--playhead: white;\r\n\t\t\t\t--primary-text: white;\r\n\t\t\t\t--secondary-text: #999;\r\n\t\t\t\t--inverted-text: black;\r\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\r\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\r\n\t\t\t\t--loop-accent: #a0d168;\r\n\t\t\t\t--link-accent: #98f;\r\n\t\t\t\t--ui-widget-background: #363636;\r\n\t\t\t\t--ui-widget-focus: #777;\r\n\t\t\t\t--volume-icon: #74bc21;\t\r\n\r\n\t\t\t\t--tonic: #20330a;\r\n\t\t\t\t--fifth-note: #74bc21;\r\n\t\t\t\t--pitch-background: #444;\r\n\r\n\t\t\t\t--octave-scrollbar: #74bc21; \r\n\t\t\t\t--scrollbar-octave: #20330a;\r\n\r\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\r\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\r\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\r\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\r\n\t\t\t\t--pitch2-secondary-channel: #439143;\r\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\r\n\t\t\t\t--pitch2-secondary-note:    #439143;\r\n\t\t\t\t--pitch2-primary-note:      #44ff44;\r\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\r\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\r\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\r\n\t\t\t\t--pitch3-primary-note:      #ffff25;\r\n\t\t\t\t--pitch4-secondary-channel: #c75000;\r\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\r\n\t\t\t\t--pitch4-secondary-note:    #c75000;\r\n\t\t\t\t--pitch4-primary-note:      #ff9752;\r\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\r\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\r\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\r\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\r\n\t\t\t\t--pitch6-secondary-channel: #552377;\r\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\r\n\t\t\t\t--pitch6-secondary-note:    #552377;\r\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\r\n\t\t\t\t--pitch7-secondary-channel: #221b89;\r\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\r\n\t\t\t\t--pitch7-secondary-note:    #221b89;\r\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\r\n\t\t\t\t--pitch8-secondary-channel: #00995f;\r\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\r\n\t\t\t\t--pitch8-secondary-note:    #00995f;\r\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\r\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\r\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\r\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\r\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\r\n\t\t\t\t--pitch10-secondary-channel:#b25915;\r\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\r\n\t\t\t\t--pitch10-secondary-note:   #b25915;\r\n\t\t\t\t--pitch10-primary-note:     #d85d00;\r\n\t\t\t\t--pitch11-secondary-channel:#891a60;\r\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\r\n\t\t\t\t--pitch11-secondary-note:   #891a60;\r\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\r\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\r\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\r\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\r\n\t\t\t\t--pitch12-primary-note:     #c26afc;\r\n\t\t\t\t--noise1-secondary-channel: #991010;\r\n\t\t\t\t--noise1-primary-channel:   #ff1616;\r\n\t\t\t\t--noise1-secondary-note:    #991010;\r\n\t\t\t\t--noise1-primary-note:      #ff1616;\r\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\r\n\t\t\t\t--noise2-primary-channel:   #ffffff;\r\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\r\n\t\t\t\t--noise2-primary-note:      #ffffff;\r\n\t\t\t\t--noise3-secondary-channel: #5869BD;\r\n\t\t\t\t--noise3-primary-channel:   #768dfc;\r\n\t\t\t\t--noise3-secondary-note:    #5869BD;\r\n\t\t\t\t--noise3-primary-note:      #768dfc;\r\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\r\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\r\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\r\n\t\t\t\t--noise4-primary-note:      #a5ff00;\r\n\t\t\t\t}\r\n\t\t`,\r\n\t\t\"dessert\": `\r\n\t\t:root {\r\n\t\t\t\t--page-margin: black;\r\n\t\t\t\t--editor-background: black;\r\n\t\t\t\t--hover-preview: white;\r\n\t\t\t\t--playhead: white;\r\n\t\t\t\t--primary-text: white;\r\n\t\t\t\t--secondary-text: #999;\r\n\t\t\t\t--inverted-text: black;\r\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\r\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\r\n\t\t\t\t--loop-accent: #ff6254;\r\n\t\t\t\t--link-accent: #98f;\r\n\t\t\t\t--ui-widget-background: #363636;\r\n\t\t\t\t--ui-widget-focus: #777;\r\n\t\t\t\t--volume-icon: #ff0000;\t\r\n\r\n\t\t\t\t--tonic: #fffc5b;\r\n\t\t\t\t--fifth-note: #ff5e3a;\r\n\t\t\t\t--pitch-background: #444;\r\n\r\n\t\t\t\t--octave-scrollbar: #ff5e3a; \r\n\t\t\t\t--scrollbar-octave: #fffc5b;\r\n\r\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\r\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\r\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\r\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\r\n\t\t\t\t--pitch2-secondary-channel: #439143;\r\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\r\n\t\t\t\t--pitch2-secondary-note:    #439143;\r\n\t\t\t\t--pitch2-primary-note:      #44ff44;\r\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\r\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\r\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\r\n\t\t\t\t--pitch3-primary-note:      #ffff25;\r\n\t\t\t\t--pitch4-secondary-channel: #c75000;\r\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\r\n\t\t\t\t--pitch4-secondary-note:    #c75000;\r\n\t\t\t\t--pitch4-primary-note:      #ff9752;\r\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\r\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\r\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\r\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\r\n\t\t\t\t--pitch6-secondary-channel: #552377;\r\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\r\n\t\t\t\t--pitch6-secondary-note:    #552377;\r\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\r\n\t\t\t\t--pitch7-secondary-channel: #221b89;\r\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\r\n\t\t\t\t--pitch7-secondary-note:    #221b89;\r\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\r\n\t\t\t\t--pitch8-secondary-channel: #00995f;\r\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\r\n\t\t\t\t--pitch8-secondary-note:    #00995f;\r\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\r\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\r\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\r\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\r\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\r\n\t\t\t\t--pitch10-secondary-channel:#b25915;\r\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\r\n\t\t\t\t--pitch10-secondary-note:   #b25915;\r\n\t\t\t\t--pitch10-primary-note:     #d85d00;\r\n\t\t\t\t--pitch11-secondary-channel:#891a60;\r\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\r\n\t\t\t\t--pitch11-secondary-note:   #891a60;\r\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\r\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\r\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\r\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\r\n\t\t\t\t--pitch12-primary-note:     #c26afc;\r\n\t\t\t\t--noise1-secondary-channel: #991010;\r\n\t\t\t\t--noise1-primary-channel:   #ff1616;\r\n\t\t\t\t--noise1-secondary-note:    #991010;\r\n\t\t\t\t--noise1-primary-note:      #ff1616;\r\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\r\n\t\t\t\t--noise2-primary-channel:   #ffffff;\r\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\r\n\t\t\t\t--noise2-primary-note:      #ffffff;\r\n\t\t\t\t--noise3-secondary-channel: #5869BD;\r\n\t\t\t\t--noise3-primary-channel:   #768dfc;\r\n\t\t\t\t--noise3-secondary-note:    #5869BD;\r\n\t\t\t\t--noise3-primary-note:      #768dfc;\r\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\r\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\r\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\r\n\t\t\t\t--noise4-primary-note:      #a5ff00;\r\n\t\t\t\t}\r\n\t\t`,\r\n\t\t\"kahootiest\": `\r\n\t\t:root {\r\n\t\t\t\t--page-margin: black;\r\n\t\t\t\t--editor-background: black;\r\n\t\t\t\t--hover-preview: white;\r\n\t\t\t\t--playhead: white;\r\n\t\t\t\t--primary-text: white;\r\n\t\t\t\t--secondary-text: #999;\r\n\t\t\t\t--inverted-text: black;\r\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\r\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\r\n\t\t\t\t--loop-accent: #ff3355;\r\n\t\t\t\t--link-accent: #98f;\r\n\t\t\t\t--ui-widget-background: #363636;\r\n\t\t\t\t--ui-widget-focus: #777;\r\n\t\t\t\t--volume-icon: #66bf39;\t\r\n\r\n\t\t\t\t--tonic: #45a3e5;\r\n\t\t\t\t--fifth-note: #864cbf;\r\n\t\t\t\t--pitch-background: #444;\r\n\r\n\t\t\t\t--octave-scrollbar: #eb670f; \r\n\t\t\t\t--scrollbar-octave: #ff3355;\r\n\r\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\r\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\r\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\r\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\r\n\t\t\t\t--pitch2-secondary-channel: #439143;\r\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\r\n\t\t\t\t--pitch2-secondary-note:    #439143;\r\n\t\t\t\t--pitch2-primary-note:      #44ff44;\r\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\r\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\r\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\r\n\t\t\t\t--pitch3-primary-note:      #ffff25;\r\n\t\t\t\t--pitch4-secondary-channel: #c75000;\r\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\r\n\t\t\t\t--pitch4-secondary-note:    #c75000;\r\n\t\t\t\t--pitch4-primary-note:      #ff9752;\r\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\r\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\r\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\r\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\r\n\t\t\t\t--pitch6-secondary-channel: #552377;\r\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\r\n\t\t\t\t--pitch6-secondary-note:    #552377;\r\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\r\n\t\t\t\t--pitch7-secondary-channel: #221b89;\r\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\r\n\t\t\t\t--pitch7-secondary-note:    #221b89;\r\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\r\n\t\t\t\t--pitch8-secondary-channel: #00995f;\r\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\r\n\t\t\t\t--pitch8-secondary-note:    #00995f;\r\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\r\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\r\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\r\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\r\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\r\n\t\t\t\t--pitch10-secondary-channel:#b25915;\r\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\r\n\t\t\t\t--pitch10-secondary-note:   #b25915;\r\n\t\t\t\t--pitch10-primary-note:     #d85d00;\r\n\t\t\t\t--pitch11-secondary-channel:#891a60;\r\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\r\n\t\t\t\t--pitch11-secondary-note:   #891a60;\r\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\r\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\r\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\r\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\r\n\t\t\t\t--pitch12-primary-note:     #c26afc;\r\n\t\t\t\t--noise1-secondary-channel: #991010;\r\n\t\t\t\t--noise1-primary-channel:   #ff1616;\r\n\t\t\t\t--noise1-secondary-note:    #991010;\r\n\t\t\t\t--noise1-primary-note:      #ff1616;\r\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\r\n\t\t\t\t--noise2-primary-channel:   #ffffff;\r\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\r\n\t\t\t\t--noise2-primary-note:      #ffffff;\r\n\t\t\t\t--noise3-secondary-channel: #5869BD;\r\n\t\t\t\t--noise3-primary-channel:   #768dfc;\r\n\t\t\t\t--noise3-secondary-note:    #5869BD;\r\n\t\t\t\t--noise3-primary-note:      #768dfc;\r\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\r\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\r\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\r\n\t\t\t\t--noise4-primary-note:      #a5ff00;\r\n\t\t\t\t}\r\n\t\t`,\r\n\t\t\"beambit\": `\r\n\t\t:root {\r\n\t\t\t\t--page-margin: black;\r\n\t\t\t\t--editor-background: black;\r\n\t\t\t\t--hover-preview: white;\r\n\t\t\t\t--playhead: white;\r\n\t\t\t\t--primary-text: white;\r\n\t\t\t\t--secondary-text: #999;\r\n\t\t\t\t--inverted-text: black;\r\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\r\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\r\n\t\t\t\t--loop-accent: #fefe00;\r\n\t\t\t\t--link-accent: #98f;\r\n\t\t\t\t--ui-widget-background: #363636;\r\n\t\t\t\t--ui-widget-focus: #777;\r\n\t\t\t\t--volume-icon: #fefe00;\t\r\n\r\n\t\t\t\t--pitch-background: #444;\r\n\r\n\t\t\t\t--tonic: #fefe00;\r\n\t\t\t\t--pitch1-background: #111111; \r\n\t\t\t\t--pitch2-background: #111111; \r\n\t\t\t\t--pitch3-background: #111111; \r\n\t\t\t\t--pitch4-background: #fa0103;\r\n\t\t\t\t--pitch5-background: #111111; \r\n\t\t\t\t--pitch6-background: #111111; \r\n\t\t\t\t--fifth-note: #111111; \r\n\t\t\t\t--pitch8-background: #0001fc; \r\n\t\t\t\t--pitch9-background: #111111; \r\n\t\t\t\t--pitch10-background: #111111; \r\n\t\t\t\t--pitch11-background: #111111;\r\n\r\n\t\t\t\t--octave-scrollbar: #0001fc; \r\n\t\t\t\t--scrollbar-octave: #fa0103;\r\n\r\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\r\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\r\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\r\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\r\n\t\t\t\t--pitch2-secondary-channel: #439143;\r\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\r\n\t\t\t\t--pitch2-secondary-note:    #439143;\r\n\t\t\t\t--pitch2-primary-note:      #44ff44;\r\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\r\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\r\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\r\n\t\t\t\t--pitch3-primary-note:      #ffff25;\r\n\t\t\t\t--pitch4-secondary-channel: #c75000;\r\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\r\n\t\t\t\t--pitch4-secondary-note:    #c75000;\r\n\t\t\t\t--pitch4-primary-note:      #ff9752;\r\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\r\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\r\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\r\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\r\n\t\t\t\t--pitch6-secondary-channel: #552377;\r\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\r\n\t\t\t\t--pitch6-secondary-note:    #552377;\r\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\r\n\t\t\t\t--pitch7-secondary-channel: #221b89;\r\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\r\n\t\t\t\t--pitch7-secondary-note:    #221b89;\r\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\r\n\t\t\t\t--pitch8-secondary-channel: #00995f;\r\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\r\n\t\t\t\t--pitch8-secondary-note:    #00995f;\r\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\r\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\r\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\r\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\r\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\r\n\t\t\t\t--pitch10-secondary-channel:#b25915;\r\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\r\n\t\t\t\t--pitch10-secondary-note:   #b25915;\r\n\t\t\t\t--pitch10-primary-note:     #d85d00;\r\n\t\t\t\t--pitch11-secondary-channel:#891a60;\r\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\r\n\t\t\t\t--pitch11-secondary-note:   #891a60;\r\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\r\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\r\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\r\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\r\n\t\t\t\t--pitch12-primary-note:     #c26afc;\r\n\t\t\t\t--noise1-secondary-channel: #991010;\r\n\t\t\t\t--noise1-primary-channel:   #ff1616;\r\n\t\t\t\t--noise1-secondary-note:    #991010;\r\n\t\t\t\t--noise1-primary-note:      #ff1616;\r\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\r\n\t\t\t\t--noise2-primary-channel:   #ffffff;\r\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\r\n\t\t\t\t--noise2-primary-note:      #ffffff;\r\n\t\t\t\t--noise3-secondary-channel: #5869BD;\r\n\t\t\t\t--noise3-primary-channel:   #768dfc;\r\n\t\t\t\t--noise3-secondary-note:    #5869BD;\r\n\t\t\t\t--noise3-primary-note:      #768dfc;\r\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\r\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\r\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\r\n\t\t\t\t--noise4-primary-note:      #a5ff00;\r\n\t\t\t\t}\r\n\t\t`,\r\n\t\t\"egg\": `\r\n\t\t:root {\r\n\t\t\t\t--page-margin: black;\r\n\t\t\t\t--editor-background: black;\r\n\t\t\t\t--hover-preview: white;\r\n\t\t\t\t--playhead: white;\r\n\t\t\t\t--primary-text: white;\r\n\t\t\t\t--secondary-text: #999;\r\n\t\t\t\t--inverted-text: black;\r\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\r\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\r\n\t\t\t\t--loop-accent: #6b003a;\r\n\t\t\t\t--link-accent: #98f;\r\n\t\t\t\t--ui-widget-background: #363636;\r\n\t\t\t\t--ui-widget-focus: #777;\r\n\t\t\t\t--volume-icon: #f01d7a;\t\r\n\r\n\t\t\t\t--tonic: #fffafa;\r\n\t\t\t\t--fifth-note: #ff91ce;\r\n\t\t\t\t--pitch-background: #444;\r\n\r\n\t\t\t\t--octave-scrollbar: #ffb1f4; \r\n\t\t\t\t--scrollbar-octave: #b4001b;\r\n\r\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\r\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\r\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\r\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\r\n\t\t\t\t--pitch2-secondary-channel: #439143;\r\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\r\n\t\t\t\t--pitch2-secondary-note:    #439143;\r\n\t\t\t\t--pitch2-primary-note:      #44ff44;\r\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\r\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\r\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\r\n\t\t\t\t--pitch3-primary-note:      #ffff25;\r\n\t\t\t\t--pitch4-secondary-channel: #c75000;\r\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\r\n\t\t\t\t--pitch4-secondary-note:    #c75000;\r\n\t\t\t\t--pitch4-primary-note:      #ff9752;\r\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\r\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\r\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\r\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\r\n\t\t\t\t--pitch6-secondary-channel: #552377;\r\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\r\n\t\t\t\t--pitch6-secondary-note:    #552377;\r\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\r\n\t\t\t\t--pitch7-secondary-channel: #221b89;\r\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\r\n\t\t\t\t--pitch7-secondary-note:    #221b89;\r\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\r\n\t\t\t\t--pitch8-secondary-channel: #00995f;\r\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\r\n\t\t\t\t--pitch8-secondary-note:    #00995f;\r\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\r\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\r\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\r\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\r\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\r\n\t\t\t\t--pitch10-secondary-channel:#b25915;\r\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\r\n\t\t\t\t--pitch10-secondary-note:   #b25915;\r\n\t\t\t\t--pitch10-primary-note:     #d85d00;\r\n\t\t\t\t--pitch11-secondary-channel:#891a60;\r\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\r\n\t\t\t\t--pitch11-secondary-note:   #891a60;\r\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\r\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\r\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\r\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\r\n\t\t\t\t--pitch12-primary-note:     #c26afc;\r\n\t\t\t\t--noise1-secondary-channel: #991010;\r\n\t\t\t\t--noise1-primary-channel:   #ff1616;\r\n\t\t\t\t--noise1-secondary-note:    #991010;\r\n\t\t\t\t--noise1-primary-note:      #ff1616;\r\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\r\n\t\t\t\t--noise2-primary-channel:   #ffffff;\r\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\r\n\t\t\t\t--noise2-primary-note:      #ffffff;\r\n\t\t\t\t--noise3-secondary-channel: #5869BD;\r\n\t\t\t\t--noise3-primary-channel:   #768dfc;\r\n\t\t\t\t--noise3-secondary-note:    #5869BD;\r\n\t\t\t\t--noise3-primary-note:      #768dfc;\r\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\r\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\r\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\r\n\t\t\t\t--noise4-primary-note:      #a5ff00;\r\n\t\t\t\t}\r\n\t\t`,\r\n\t\t\"Poniryoshka\": `\r\n\t\t:root {\r\n\t\t\t\t--page-margin: black;\r\n\t\t\t\t--editor-background: black;\r\n\t\t\t\t--hover-preview: white;\r\n\t\t\t\t--playhead: white;\r\n\t\t\t\t--primary-text: white;\r\n\t\t\t\t--secondary-text: #999;\r\n\t\t\t\t--inverted-text: black;\r\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\r\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\r\n\t\t\t\t--loop-accent: #4b4b4b;\r\n\t\t\t\t--link-accent: #98f;\r\n\t\t\t\t--ui-widget-background: #363636;\r\n\t\t\t\t--ui-widget-focus: #777;\r\n\t\t\t\t--volume-icon: #ffc100;\t\r\n\r\n\t\t\t\t--tonic: #1a2844;\r\n\t\t\t\t--fifth-note: #dabbe6;\r\n\t\t\t\t--pitch4-background: #faf4c3;\r\n\t\t\t\t--pitch-background: #444;\r\n\r\n\t\t\t\t--octave-scrollbar: #5f4c99; \r\n\t\t\t\t--scrollbar-octave: #ff8291;\r\n\r\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\r\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\r\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\r\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\r\n\t\t\t\t--pitch2-secondary-channel: #439143;\r\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\r\n\t\t\t\t--pitch2-secondary-note:    #439143;\r\n\t\t\t\t--pitch2-primary-note:      #44ff44;\r\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\r\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\r\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\r\n\t\t\t\t--pitch3-primary-note:      #ffff25;\r\n\t\t\t\t--pitch4-secondary-channel: #c75000;\r\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\r\n\t\t\t\t--pitch4-secondary-note:    #c75000;\r\n\t\t\t\t--pitch4-primary-note:      #ff9752;\r\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\r\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\r\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\r\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\r\n\t\t\t\t--pitch6-secondary-channel: #552377;\r\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\r\n\t\t\t\t--pitch6-secondary-note:    #552377;\r\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\r\n\t\t\t\t--pitch7-secondary-channel: #221b89;\r\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\r\n\t\t\t\t--pitch7-secondary-note:    #221b89;\r\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\r\n\t\t\t\t--pitch8-secondary-channel: #00995f;\r\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\r\n\t\t\t\t--pitch8-secondary-note:    #00995f;\r\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\r\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\r\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\r\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\r\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\r\n\t\t\t\t--pitch10-secondary-channel:#b25915;\r\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\r\n\t\t\t\t--pitch10-secondary-note:   #b25915;\r\n\t\t\t\t--pitch10-primary-note:     #d85d00;\r\n\t\t\t\t--pitch11-secondary-channel:#891a60;\r\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\r\n\t\t\t\t--pitch11-secondary-note:   #891a60;\r\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\r\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\r\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\r\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\r\n\t\t\t\t--pitch12-primary-note:     #c26afc;\r\n\t\t\t\t--noise1-secondary-channel: #991010;\r\n\t\t\t\t--noise1-primary-channel:   #ff1616;\r\n\t\t\t\t--noise1-secondary-note:    #991010;\r\n\t\t\t\t--noise1-primary-note:      #ff1616;\r\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\r\n\t\t\t\t--noise2-primary-channel:   #ffffff;\r\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\r\n\t\t\t\t--noise2-primary-note:      #ffffff;\r\n\t\t\t\t--noise3-secondary-channel: #5869BD;\r\n\t\t\t\t--noise3-primary-channel:   #768dfc;\r\n\t\t\t\t--noise3-secondary-note:    #5869BD;\r\n\t\t\t\t--noise3-primary-note:      #768dfc;\r\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\r\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\r\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\r\n\t\t\t\t--noise4-primary-note:      #a5ff00;\r\n\t\t\t\t}\r\n\t\t`,\r\n\t\t\"gameboy\": `\r\n\t\t:root {\r\n\t\t\t\t--page-margin: black;\r\n\t\t\t\t--editor-background: black;\r\n\t\t\t\t--hover-preview: white;\r\n\t\t\t\t--playhead: white;\r\n\t\t\t\t--primary-text: white;\r\n\t\t\t\t--secondary-text: #999;\r\n\t\t\t\t--inverted-text: black;\r\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\r\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\r\n\t\t\t\t--loop-accent: #9bbc0f;\r\n\t\t\t\t--link-accent: #98f;\r\n\t\t\t\t--ui-widget-background: #363636;\r\n\t\t\t\t--ui-widget-focus: #777;\r\n\t\t\t\t--volume-icon: #8bac0f;\t\r\n\r\n\t\t\t\t--tonic: #9bbc0f; \r\n\t\t\t\t--pitch1-background: #9bbc0f; \r\n\t\t\t\t--pitch2-background: #9bbc0f; \r\n\t\t\t\t--pitch3-background: #9bbc0f; \r\n\t\t\t\t--pitch4-background: #9bbc0f;\r\n\t\t\t\t--pitch5-background: #9bbc0f; \r\n\t\t\t\t--pitch6-background: #306230; \r\n\t\t\t\t--fifth-note: #306230; \r\n\t\t\t\t--pitch8-background: #306230; \r\n\t\t\t\t--pitch9-background: #0f380f; \r\n\t\t\t\t--pitch10-background: #0f380f; \r\n\t\t\t\t--pitch11-background: #0f380f; \r\n\t\t\t\t--pitch-background: #444;\r\n\r\n\t\t\t\t--octave-scrollbar: #9bbc0f; \r\n\t\t\t\t--scrollbar-octave: #8bac0f;\r\n\r\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\r\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\r\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\r\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\r\n\t\t\t\t--pitch2-secondary-channel: #439143;\r\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\r\n\t\t\t\t--pitch2-secondary-note:    #439143;\r\n\t\t\t\t--pitch2-primary-note:      #44ff44;\r\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\r\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\r\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\r\n\t\t\t\t--pitch3-primary-note:      #ffff25;\r\n\t\t\t\t--pitch4-secondary-channel: #c75000;\r\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\r\n\t\t\t\t--pitch4-secondary-note:    #c75000;\r\n\t\t\t\t--pitch4-primary-note:      #ff9752;\r\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\r\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\r\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\r\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\r\n\t\t\t\t--pitch6-secondary-channel: #552377;\r\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\r\n\t\t\t\t--pitch6-secondary-note:    #552377;\r\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\r\n\t\t\t\t--pitch7-secondary-channel: #221b89;\r\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\r\n\t\t\t\t--pitch7-secondary-note:    #221b89;\r\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\r\n\t\t\t\t--pitch8-secondary-channel: #00995f;\r\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\r\n\t\t\t\t--pitch8-secondary-note:    #00995f;\r\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\r\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\r\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\r\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\r\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\r\n\t\t\t\t--pitch10-secondary-channel:#b25915;\r\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\r\n\t\t\t\t--pitch10-secondary-note:   #b25915;\r\n\t\t\t\t--pitch10-primary-note:     #d85d00;\r\n\t\t\t\t--pitch11-secondary-channel:#891a60;\r\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\r\n\t\t\t\t--pitch11-secondary-note:   #891a60;\r\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\r\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\r\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\r\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\r\n\t\t\t\t--pitch12-primary-note:     #c26afc;\r\n\t\t\t\t--noise1-secondary-channel: #991010;\r\n\t\t\t\t--noise1-primary-channel:   #ff1616;\r\n\t\t\t\t--noise1-secondary-note:    #991010;\r\n\t\t\t\t--noise1-primary-note:      #ff1616;\r\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\r\n\t\t\t\t--noise2-primary-channel:   #ffffff;\r\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\r\n\t\t\t\t--noise2-primary-note:      #ffffff;\r\n\t\t\t\t--noise3-secondary-channel: #5869BD;\r\n\t\t\t\t--noise3-primary-channel:   #768dfc;\r\n\t\t\t\t--noise3-secondary-note:    #5869BD;\r\n\t\t\t\t--noise3-primary-note:      #768dfc;\r\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\r\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\r\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\r\n\t\t\t\t--noise4-primary-note:      #a5ff00;\r\n\t\t\t\t}\r\n\t\t`,\r\n\t\t\"woodkid\": `\r\n\t\t:root {\r\n\t\t\t\t--page-margin: black;\r\n\t\t\t\t--editor-background: black;\r\n\t\t\t\t--hover-preview: white;\r\n\t\t\t\t--playhead: white;\r\n\t\t\t\t--primary-text: white;\r\n\t\t\t\t--secondary-text: #999;\r\n\t\t\t\t--inverted-text: black;\r\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\r\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\r\n\t\t\t\t--loop-accent: #e83c4e;\r\n\t\t\t\t--link-accent: #98f;\r\n\t\t\t\t--ui-widget-background: #363636;\r\n\t\t\t\t--ui-widget-focus: #777;\r\n\t\t\t\t--volume-icon: #ef3027;\t\r\n\r\n\t\t\t\t--tonic: #fff6fe;\r\n\t\t\t\t--pitch1-background: #41323b;\r\n\t\t\t\t--pitch2-background: #41323b;\r\n\t\t\t\t--pitch3-background: #41323b;\r\n\t\t\t\t--pitch4-background: #fff6fe;\r\n\t\t\t\t--pitch5-background: #41323b;\r\n\t\t\t\t--pitch6-background: #41323b;\r\n\t\t\t\t--fifth-note: #fff6fe;\r\n\t\t\t\t--pitch8-background: #41323b;\r\n\t\t\t\t--pitch9-background: #41323b;\r\n\t\t\t\t--pitch10-background: #41323b;\r\n\t\t\t\t--pitch11-background: #41323b;\r\n\t\t\t\t--pitch-background: #444;\r\n\r\n\t\t\t\t--octave-scrollbar: #ef3027; \r\n\t\t\t\t--scrollbar-octave: #ffedca;\r\n\r\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\r\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\r\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\r\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\r\n\t\t\t\t--pitch2-secondary-channel: #439143;\r\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\r\n\t\t\t\t--pitch2-secondary-note:    #439143;\r\n\t\t\t\t--pitch2-primary-note:      #44ff44;\r\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\r\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\r\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\r\n\t\t\t\t--pitch3-primary-note:      #ffff25;\r\n\t\t\t\t--pitch4-secondary-channel: #c75000;\r\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\r\n\t\t\t\t--pitch4-secondary-note:    #c75000;\r\n\t\t\t\t--pitch4-primary-note:      #ff9752;\r\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\r\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\r\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\r\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\r\n\t\t\t\t--pitch6-secondary-channel: #552377;\r\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\r\n\t\t\t\t--pitch6-secondary-note:    #552377;\r\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\r\n\t\t\t\t--pitch7-secondary-channel: #221b89;\r\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\r\n\t\t\t\t--pitch7-secondary-note:    #221b89;\r\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\r\n\t\t\t\t--pitch8-secondary-channel: #00995f;\r\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\r\n\t\t\t\t--pitch8-secondary-note:    #00995f;\r\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\r\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\r\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\r\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\r\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\r\n\t\t\t\t--pitch10-secondary-channel:#b25915;\r\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\r\n\t\t\t\t--pitch10-secondary-note:   #b25915;\r\n\t\t\t\t--pitch10-primary-note:     #d85d00;\r\n\t\t\t\t--pitch11-secondary-channel:#891a60;\r\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\r\n\t\t\t\t--pitch11-secondary-note:   #891a60;\r\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\r\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\r\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\r\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\r\n\t\t\t\t--pitch12-primary-note:     #c26afc;\r\n\t\t\t\t--noise1-secondary-channel: #991010;\r\n\t\t\t\t--noise1-primary-channel:   #ff1616;\r\n\t\t\t\t--noise1-secondary-note:    #991010;\r\n\t\t\t\t--noise1-primary-note:      #ff1616;\r\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\r\n\t\t\t\t--noise2-primary-channel:   #ffffff;\r\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\r\n\t\t\t\t--noise2-primary-note:      #ffffff;\r\n\t\t\t\t--noise3-secondary-channel: #5869BD;\r\n\t\t\t\t--noise3-primary-channel:   #768dfc;\r\n\t\t\t\t--noise3-secondary-note:    #5869BD;\r\n\t\t\t\t--noise3-primary-note:      #768dfc;\r\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\r\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\r\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\r\n\t\t\t\t--noise4-primary-note:      #a5ff00;\r\n\t\t\t\t}\r\n\t\t`,\r\n\t\t\"midnight\": `\r\n\t\t:root {\r\n\t\t\t\t--page-margin: black;\r\n\t\t\t\t--editor-background: black;\r\n\t\t\t\t--hover-preview: white;\r\n\t\t\t\t--playhead: white;\r\n\t\t\t\t--primary-text: white;\r\n\t\t\t\t--secondary-text: #999;\r\n\t\t\t\t--inverted-text: black;\r\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\r\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\r\n\t\t\t\t--loop-accent: #445566;\r\n\t\t\t\t--link-accent: #98f;\r\n\t\t\t\t--ui-widget-background: #363636;\r\n\t\t\t\t--ui-widget-focus: #777;\r\n\t\t\t\t--volume-icon: #aa5599;\t\r\n\r\n\t\t\t\t--tonic: #222222;\r\n\t\t\t\t--pitch1-background: #222222;\r\n\t\t\t\t--pitch2-background: #222222;\r\n\t\t\t\t--pitch3-background: #222222;\r\n\t\t\t\t--pitch4-background: #222222;\r\n\t\t\t\t--pitch5-background: #222222;\r\n\t\t\t\t--pitch6-background:#222222;\r\n\t\t\t\t--fifth-note: #444444;\r\n\t\t\t\t--pitch8-background: #222222;\r\n\t\t\t\t--pitch9-background: #222222;\r\n\t\t\t\t--pitch10-background: #222222;\r\n\t\t\t\t--pitch11-background: #222222;\r\n\t\t\t\t--pitch-background: #444;\r\n\r\n\t\t\t\t--octave-scrollbar: #444444; \r\n\t\t\t\t--scrollbar-octave: #aa5599;\r\n\r\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\r\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\r\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\r\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\r\n\t\t\t\t--pitch2-secondary-channel: #439143;\r\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\r\n\t\t\t\t--pitch2-secondary-note:    #439143;\r\n\t\t\t\t--pitch2-primary-note:      #44ff44;\r\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\r\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\r\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\r\n\t\t\t\t--pitch3-primary-note:      #ffff25;\r\n\t\t\t\t--pitch4-secondary-channel: #c75000;\r\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\r\n\t\t\t\t--pitch4-secondary-note:    #c75000;\r\n\t\t\t\t--pitch4-primary-note:      #ff9752;\r\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\r\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\r\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\r\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\r\n\t\t\t\t--pitch6-secondary-channel: #552377;\r\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\r\n\t\t\t\t--pitch6-secondary-note:    #552377;\r\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\r\n\t\t\t\t--pitch7-secondary-channel: #221b89;\r\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\r\n\t\t\t\t--pitch7-secondary-note:    #221b89;\r\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\r\n\t\t\t\t--pitch8-secondary-channel: #00995f;\r\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\r\n\t\t\t\t--pitch8-secondary-note:    #00995f;\r\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\r\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\r\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\r\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\r\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\r\n\t\t\t\t--pitch10-secondary-channel:#b25915;\r\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\r\n\t\t\t\t--pitch10-secondary-note:   #b25915;\r\n\t\t\t\t--pitch10-primary-note:     #d85d00;\r\n\t\t\t\t--pitch11-secondary-channel:#891a60;\r\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\r\n\t\t\t\t--pitch11-secondary-note:   #891a60;\r\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\r\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\r\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\r\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\r\n\t\t\t\t--pitch12-primary-note:     #c26afc;\r\n\t\t\t\t--noise1-secondary-channel: #991010;\r\n\t\t\t\t--noise1-primary-channel:   #ff1616;\r\n\t\t\t\t--noise1-secondary-note:    #991010;\r\n\t\t\t\t--noise1-primary-note:      #ff1616;\r\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\r\n\t\t\t\t--noise2-primary-channel:   #ffffff;\r\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\r\n\t\t\t\t--noise2-primary-note:      #ffffff;\r\n\t\t\t\t--noise3-secondary-channel: #5869BD;\r\n\t\t\t\t--noise3-primary-channel:   #768dfc;\r\n\t\t\t\t--noise3-secondary-note:    #5869BD;\r\n\t\t\t\t--noise3-primary-note:      #768dfc;\r\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\r\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\r\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\r\n\t\t\t\t--noise4-primary-note:      #a5ff00;\r\n\t\t\t\t}\r\n\t\t`,\r\n\t\t\"snedbox\": `\r\n\t\t:root {\r\n\t\t\t--page-margin: black;\r\n\t\t\t--editor-background: black;\r\n\t\t\t--hover-preview: white;\r\n\t\t\t--playhead: white;\r\n\t\t\t--primary-text: white;\r\n\t\t\t--secondary-text: #999;\r\n\t\t\t--inverted-text: black;\r\n\t\t\t--text-selection: rgba(119,68,255,0.99);\r\n\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\r\n\t\t\t--loop-accent: #a53a3d;\r\n\t\t\t--link-accent: #98f;\r\n\t\t\t--ui-widget-background: #363636;\r\n\t\t\t--ui-widget-focus: #777;\r\n\t\t\t--pitch-background: #444;\r\n\t\t\t--tonic: #864;\r\n\t\t\t--fifth-note: #60389b;\r\n\t\t\t--pitch4-background: #10997e;\r\n\t\t\t--volume-icon: #a53a3d;\r\n\t\t\t--octave-scrollbar: #444;\r\n\t\t\t--scrollbar-octave: #a53a3d;\r\n\t\t\t--channel-box: #444;\r\n\r\n\t\t\t--pitch1-secondary-channel: #0099a1;\r\n\t\t\t--pitch1-primary-channel:   #25f3ff;\r\n\t\t\t--pitch1-secondary-note:    #0099a1;\r\n\t\t\t--pitch1-primary-note:      #25f3ff;\r\n\t\t\t--pitch2-secondary-channel: #439143;\r\n\t\t\t--pitch2-primary-channel:   #44ff44;\r\n\t\t\t--pitch2-secondary-note:    #439143;\r\n\t\t\t--pitch2-primary-note:      #44ff44;\r\n\t\t\t--pitch3-secondary-channel: #a1a100;\r\n\t\t\t--pitch3-primary-channel:   #ffff25;\r\n\t\t\t--pitch3-secondary-note:    #a1a100;\r\n\t\t\t--pitch3-primary-note:      #ffff25;\r\n\t\t\t--pitch4-secondary-channel: #c75000;\r\n\t\t\t--pitch4-primary-channel:   #ff9752;\r\n\t\t\t--pitch4-secondary-note:    #c75000;\r\n\t\t\t--pitch4-primary-note:      #ff9752;\r\n\t\t\t--pitch5-secondary-channel: #d020d0;\r\n\t\t\t--pitch5-primary-channel:   #FF90FF;\r\n\t\t\t--pitch5-secondary-note:    #d020d0;\r\n\t\t\t--pitch5-primary-note:      #ff90ff;\r\n\t\t\t--pitch6-secondary-channel: #552377;\r\n\t\t\t--pitch6-primary-channel:   #9f31ea;\r\n\t\t\t--pitch6-secondary-note:    #552377;\r\n\t\t\t--pitch6-primary-note:      #9f31ea;\r\n\t\t\t--pitch7-secondary-channel: #221b89;\r\n\t\t\t--pitch7-primary-channel:   #2b6aff;\r\n\t\t\t--pitch7-secondary-note:    #221b89;\r\n\t\t\t--pitch7-primary-note:      #2b6aff;\r\n\t\t\t--pitch8-secondary-channel: #00995f;\r\n\t\t\t--pitch8-primary-channel:   #00ff9f;\r\n\t\t\t--pitch8-secondary-note:    #00995f;\r\n\t\t\t--pitch8-primary-note:      #00ff9f;\r\n\t\t\t--pitch9-secondary-channel: #d6b03e;\r\n\t\t\t--pitch9-primary-channel:   #ffbf00;\r\n\t\t\t--pitch9-secondary-note:    #d6b03e;\r\n\t\t\t--pitch9-primary-note:      #ffbf00;\r\n\t\t\t--pitch10-secondary-channel:#b25915;\r\n\t\t\t--pitch10-primary-channel:  #d85d00;\r\n\t\t\t--pitch10-secondary-note:   #b25915;\r\n\t\t\t--pitch10-primary-note:     #d85d00;\r\n\r\n\t\t\t--pitch11-secondary-channel:#891a60;\r\n\t\t\t--pitch11-primary-channel:  #ff00a1;\r\n\t\t\t--pitch11-secondary-note:   #891a60;\r\n\t\t\t--pitch11-primary-note:     #ff00a1;\r\n\r\n\t\t\t--pitch12-secondary-channel:#965cbc;\r\n\t\t\t--pitch12-primary-channel:  #c26afc;\r\n\t\t\t--pitch12-secondary-note:   #965cbc;\r\n\t\t\t--pitch12-primary-note:     #c26afc;\r\n\r\n\t\t\t--noise1-secondary-channel: #991010;\r\n\t\t\t--noise1-primary-channel:   #ff1616;\r\n\t\t\t--noise1-secondary-note:    #991010;\r\n\t\t\t--noise1-primary-note:      #ff1616;\r\n\t\t\t--noise2-secondary-channel: #aaaaaa;\r\n\t\t\t--noise2-primary-channel:   #ffffff;\r\n\t\t\t--noise2-secondary-note:    #aaaaaa;\r\n\t\t\t--noise2-primary-note:      #ffffff;\r\n\t\t\t--noise3-secondary-channel: #5869BD;\r\n\t\t\t--noise3-primary-channel:   #768dfc;\r\n\t\t\t--noise3-secondary-note:    #5869BD;\r\n\t\t\t--noise3-primary-note:      #768dfc;\r\n\t\t\t--noise4-secondary-channel: #7c9b42;\r\n\t\t\t--noise4-primary-channel:   #a5ff00;\r\n\t\t\t--noise4-secondary-note:    #7c9b42;\r\n\t\t\t--noise4-primary-note:      #a5ff00;\r\n\t\t}\r\n\t`,\r\n\t\"unnamed\": `\r\n\t:root {\r\n\t\t\t--page-margin: black;\r\n\t\t\t--editor-background: black;\r\n\t\t\t--hover-preview: white;\r\n\t\t\t--playhead: white;\r\n\t\t\t--primary-text: white;\r\n\t\t\t--secondary-text: #999;\r\n\t\t\t--inverted-text: black;\r\n\t\t\t--text-selection: rgba(119,68,255,0.99);\r\n\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\r\n\t\t\t--loop-accent: #ffffff;\r\n\t\t\t--link-accent: #98f;\r\n\t\t\t--ui-widget-background: #363636;\r\n\t\t\t--ui-widget-focus: #777;\r\n\t\t\t--pitch-background: #444;\r\n\t\t\t--pitch1-background: #ffffa0;\r\n\t\t\t--pitch2-background: #ffffa0;\r\n\t\t\t--pitch3-background: #ffffa0;\r\n\t\t\t--pitch4-background: #ffffa0;\r\n\t\t\t--pitch5-background: #ffffa0;\r\n\t\t\t--pitch6-background: #ffffa0;\r\n\t\t\t--pitch8-background: #ffffa0;\r\n\t\t\t--pitch9-background: #ffffa0;\r\n\t\t\t--pitch10-background: #ffffa0;\r\n\t\t\t--pitch11-background: #ffffa0;\r\n\t\t\t--pitch12-background: #ffffa0;\r\n\t\t\t--tonic: #ffffa0;\r\n\t\t\t--fifth-note: #ffffa0;\r\n\t\t\t--volume-icon: #ffffff;\t\r\n\r\n\t\t\t--octave-scrollbar: #ffffff;\r\n\t\t\t--scrollbar-octave: #ffffff;\r\n\r\n\t\t\t--pitch1-secondary-channel: #0099a1;\r\n\t\t\t--pitch1-primary-channel:   #25f3ff;\r\n\t\t\t--pitch1-secondary-note:    #0099a1;\r\n\t\t\t--pitch1-primary-note:      #25f3ff;\r\n\t\t\t--pitch2-secondary-channel: #439143;\r\n\t\t\t--pitch2-primary-channel:   #44ff44;\r\n\t\t\t--pitch2-secondary-note:    #439143;\r\n\t\t\t--pitch2-primary-note:      #44ff44;\r\n\t\t\t--pitch3-secondary-channel: #a1a100;\r\n\t\t\t--pitch3-primary-channel:   #ffff25;\r\n\t\t\t--pitch3-secondary-note:    #a1a100;\r\n\t\t\t--pitch3-primary-note:      #ffff25;\r\n\t\t\t--pitch4-secondary-channel: #c75000;\r\n\t\t\t--pitch4-primary-channel:   #ff9752;\r\n\t\t\t--pitch4-secondary-note:    #c75000;\r\n\t\t\t--pitch4-primary-note:      #ff9752;\r\n\t\t\t--pitch5-secondary-channel: #d020d0;\r\n\t\t\t--pitch5-primary-channel:   #FF90FF;\r\n\t\t\t--pitch5-secondary-note:    #d020d0;\r\n\t\t\t--pitch5-primary-note:      #ff90ff;\r\n\t\t\t--pitch6-secondary-channel: #552377;\r\n\t\t\t--pitch6-primary-channel:   #9f31ea;\r\n\t\t\t--pitch6-secondary-note:    #552377;\r\n\t\t\t--pitch6-primary-note:      #9f31ea;\r\n\t\t\t--pitch7-secondary-channel: #221b89;\r\n\t\t\t--pitch7-primary-channel:   #2b6aff;\r\n\t\t\t--pitch7-secondary-note:    #221b89;\r\n\t\t\t--pitch7-primary-note:      #2b6aff;\r\n\t\t\t--pitch8-secondary-channel: #00995f;\r\n\t\t\t--pitch8-primary-channel:   #00ff9f;\r\n\t\t\t--pitch8-secondary-note:    #00995f;\r\n\t\t\t--pitch8-primary-note:      #00ff9f;\r\n\t\t\t--pitch9-secondary-channel: #d6b03e;\r\n\t\t\t--pitch9-primary-channel:   #ffbf00;\r\n\t\t\t--pitch9-secondary-note:    #d6b03e;\r\n\t\t\t--pitch9-primary-note:      #ffbf00;\r\n\t\t\t--pitch10-secondary-channel:#b25915;\r\n\t\t\t--pitch10-primary-channel:  #d85d00;\r\n\t\t\t--pitch10-secondary-note:   #b25915;\r\n\t\t\t--pitch10-primary-note:     #d85d00;\r\n\t\t\t--pitch11-secondary-channel:#891a60;\r\n\t\t\t--pitch11-primary-channel:  #ff00a1;\r\n\t\t\t--pitch11-secondary-note:   #891a60;\r\n\t\t\t--pitch11-primary-note:     #ff00a1;\r\n\t\t\t--pitch12-secondary-channel:#965cbc;\r\n\t\t\t--pitch12-primary-channel:  #c26afc;\r\n\t\t\t--pitch12-secondary-note:   #965cbc;\r\n\t\t\t--pitch12-primary-note:     #c26afc;\r\n\t\t\t--noise1-secondary-channel: #991010;\r\n\t\t\t--noise1-primary-channel:   #ff1616;\r\n\t\t\t--noise1-secondary-note:    #991010;\r\n\t\t\t--noise1-primary-note:      #ff1616;\r\n\t\t\t--noise2-secondary-channel: #aaaaaa;\r\n\t\t\t--noise2-primary-channel:   #ffffff;\r\n\t\t\t--noise2-secondary-note:    #aaaaaa;\r\n\t\t\t--noise2-primary-note:      #ffffff;\r\n\t\t\t--noise3-secondary-channel: #5869BD;\r\n\t\t\t--noise3-primary-channel:   #768dfc;\r\n\t\t\t--noise3-secondary-note:    #5869BD;\r\n\t\t\t--noise3-primary-note:      #768dfc;\r\n\t\t\t--noise4-secondary-channel: #7c9b42;\r\n\t\t\t--noise4-primary-channel:   #a5ff00;\r\n\t\t\t--noise4-secondary-note:    #7c9b42;\r\n\t\t\t--noise4-primary-note:      #a5ff00;\r\n\t\t\t}\r\n\t`,\r\n\t\"piano\": `\r\n\t:root {\r\n\t\t\t--page-margin: black;\r\n\t\t\t--editor-background: black;\r\n\t\t\t--hover-preview: white;\r\n\t\t\t--playhead: white;\r\n\t\t\t--primary-text: white;\r\n\t\t\t--secondary-text: #999;\r\n\t\t\t--inverted-text: black;\r\n\t\t\t--text-selection: rgba(119,68,255,0.99);\r\n\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\r\n\t\t\t--loop-accent: #ffffff;\r\n\t\t\t--link-accent: #98f;\r\n\t\t\t--ui-widget-background: #363636;\r\n\t\t\t--ui-widget-focus: #777;\r\n\r\n\t\t\t--use-piano-scheme: true;\r\n\r\n\t\t\t--pitch-background: #444;\r\n\t\t\t--volume-icon: #ff0000;\t\r\n\r\n\t\t\t--tonic: #ffffff;\r\n\t\t\t--white-tonic: #fff;\r\n\t\t\t--black-tonic: #222;\r\n\t\t\t--fifth-note: #7a7a7a;\r\n\r\n\t\t\t--octave-scrollbar: #211616;\r\n\t\t\t--scrollbar-octave: #ff4c4c;\r\n\t\t\t--pitch-white-key: #bfbfbf;\r\n\t\t\t--pitch-black-key: #7a7a7a;\r\n\r\n\t\t\t--pitch1-secondary-channel: #0099a1;\r\n\t\t\t--pitch1-primary-channel:   #25f3ff;\r\n\t\t\t--pitch1-secondary-note:    #0099a1;\r\n\t\t\t--pitch1-primary-note:      #25f3ff;\r\n\t\t\t--pitch2-secondary-channel: #439143;\r\n\t\t\t--pitch2-primary-channel:   #44ff44;\r\n\t\t\t--pitch2-secondary-note:    #439143;\r\n\t\t\t--pitch2-primary-note:      #44ff44;\r\n\t\t\t--pitch3-secondary-channel: #a1a100;\r\n\t\t\t--pitch3-primary-channel:   #ffff25;\r\n\t\t\t--pitch3-secondary-note:    #a1a100;\r\n\t\t\t--pitch3-primary-note:      #ffff25;\r\n\t\t\t--pitch4-secondary-channel: #c75000;\r\n\t\t\t--pitch4-primary-channel:   #ff9752;\r\n\t\t\t--pitch4-secondary-note:    #c75000;\r\n\t\t\t--pitch4-primary-note:      #ff9752;\r\n\t\t\t--pitch5-secondary-channel: #d020d0;\r\n\t\t\t--pitch5-primary-channel:   #FF90FF;\r\n\t\t\t--pitch5-secondary-note:    #d020d0;\r\n\t\t\t--pitch5-primary-note:      #ff90ff;\r\n\t\t\t--pitch6-secondary-channel: #552377;\r\n\t\t\t--pitch6-primary-channel:   #9f31ea;\r\n\t\t\t--pitch6-secondary-note:    #552377;\r\n\t\t\t--pitch6-primary-note:      #9f31ea;\r\n\t\t\t--pitch7-secondary-channel: #221b89;\r\n\t\t\t--pitch7-primary-channel:   #2b6aff;\r\n\t\t\t--pitch7-secondary-note:    #221b89;\r\n\t\t\t--pitch7-primary-note:      #2b6aff;\r\n\t\t\t--pitch8-secondary-channel: #00995f;\r\n\t\t\t--pitch8-primary-channel:   #00ff9f;\r\n\t\t\t--pitch8-secondary-note:    #00995f;\r\n\t\t\t--pitch8-primary-note:      #00ff9f;\r\n\t\t\t--pitch9-secondary-channel: #d6b03e;\r\n\t\t\t--pitch9-primary-channel:   #ffbf00;\r\n\t\t\t--pitch9-secondary-note:    #d6b03e;\r\n\t\t\t--pitch9-primary-note:      #ffbf00;\r\n\t\t\t--pitch10-secondary-channel:#b25915;\r\n\t\t\t--pitch10-primary-channel:  #d85d00;\r\n\t\t\t--pitch10-secondary-note:   #b25915;\r\n\t\t\t--pitch10-primary-note:     #d85d00;\r\n\t\t\t--pitch11-secondary-channel:#891a60;\r\n\t\t\t--pitch11-primary-channel:  #ff00a1;\r\n\t\t\t--pitch11-secondary-note:   #891a60;\r\n\t\t\t--pitch11-primary-note:     #ff00a1;\r\n\t\t\t--pitch12-secondary-channel:#965cbc;\r\n\t\t\t--pitch12-primary-channel:  #c26afc;\r\n\t\t\t--pitch12-secondary-note:   #965cbc;\r\n\t\t\t--pitch12-primary-note:     #c26afc;\r\n\t\t\t--noise1-secondary-channel: #991010;\r\n\t\t\t--noise1-primary-channel:   #ff1616;\r\n\t\t\t--noise1-secondary-note:    #991010;\r\n\t\t\t--noise1-primary-note:      #ff1616;\r\n\t\t\t--noise2-secondary-channel: #aaaaaa;\r\n\t\t\t--noise2-primary-channel:   #ffffff;\r\n\t\t\t--noise2-secondary-note:    #aaaaaa;\r\n\t\t\t--noise2-primary-note:      #ffffff;\r\n\t\t\t--noise3-secondary-channel: #5869BD;\r\n\t\t\t--noise3-primary-channel:   #768dfc;\r\n\t\t\t--noise3-secondary-note:    #5869BD;\r\n\t\t\t--noise3-primary-note:      #768dfc;\r\n\t\t\t--noise4-secondary-channel: #7c9b42;\r\n\t\t\t--noise4-primary-channel:   #a5ff00;\r\n\t\t\t--noise4-secondary-note:    #7c9b42;\r\n\t\t\t--noise4-primary-note:      #a5ff00;\r\n\t\t\t}\r\n\t`,\r\n\t\"halloween\": `\r\n\t:root {\r\n\t\t\t\t--page-margin: black;\r\n\t\t\t\t--editor-background: black;\r\n\t\t\t\t--hover-preview: white;\r\n\t\t\t\t--playhead: white;\r\n\t\t\t\t--primary-text: white;\r\n\t\t\t\t--secondary-text: #999;\r\n\t\t\t\t--inverted-text: black;\r\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\r\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\r\n\t\t\t\t--loop-accent: #9e2200;\r\n\t\t\t\t--link-accent: #98f;\r\n\t\t\t\t--ui-widget-background: #363636;\r\n\t\t\t\t--ui-widget-focus: #777;\r\n\t\t\t\t--volume-icon: #9e2200;\t\r\n\r\n\t\t\t\t--tonic: #681701;\r\n\t\t\t\t--pitch1-background: #754a3f;\r\n\t\t\t\t--pitch2-background: #754a3f;\r\n\t\t\t\t--pitch3-background: #754a3f;\r\n\t\t\t\t--pitch4-background: #754a3f;\r\n\t\t\t\t--pitch5-background: #754a3f;\r\n\t\t\t\t--pitch6-background:#754a3f;\r\n\t\t\t\t--fifth-note: #914300;\r\n\t\t\t\t--pitch8-background: #754a3f;\r\n\t\t\t\t--pitch9-background: #754a3f;\r\n\t\t\t\t--pitch10-background: #754a3f;\r\n\t\t\t\t--pitch11-background: #754a3f;\r\n\t\t\t\t--pitch-background: #444;\r\n\r\n\t\t\t\t--octave-scrollbar: #9e2200; \r\n\t\t\t\t--scrollbar-octave: #701800;\r\n\r\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\r\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\r\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\r\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\r\n\t\t\t\t--pitch2-secondary-channel: #439143;\r\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\r\n\t\t\t\t--pitch2-secondary-note:    #439143;\r\n\t\t\t\t--pitch2-primary-note:      #44ff44;\r\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\r\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\r\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\r\n\t\t\t\t--pitch3-primary-note:      #ffff25;\r\n\t\t\t\t--pitch4-secondary-channel: #c75000;\r\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\r\n\t\t\t\t--pitch4-secondary-note:    #c75000;\r\n\t\t\t\t--pitch4-primary-note:      #ff9752;\r\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\r\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\r\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\r\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\r\n\t\t\t\t--pitch6-secondary-channel: #552377;\r\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\r\n\t\t\t\t--pitch6-secondary-note:    #552377;\r\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\r\n\t\t\t\t--pitch7-secondary-channel: #221b89;\r\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\r\n\t\t\t\t--pitch7-secondary-note:    #221b89;\r\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\r\n\t\t\t\t--pitch8-secondary-channel: #00995f;\r\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\r\n\t\t\t\t--pitch8-secondary-note:    #00995f;\r\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\r\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\r\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\r\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\r\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\r\n\t\t\t\t--pitch10-secondary-channel:#b25915;\r\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\r\n\t\t\t\t--pitch10-secondary-note:   #b25915;\r\n\t\t\t\t--pitch10-primary-note:     #d85d00;\r\n\t\t\t\t--pitch11-secondary-channel:#891a60;\r\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\r\n\t\t\t\t--pitch11-secondary-note:   #891a60;\r\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\r\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\r\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\r\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\r\n\t\t\t\t--pitch12-primary-note:     #c26afc;\r\n\t\t\t\t--noise1-secondary-channel: #991010;\r\n\t\t\t\t--noise1-primary-channel:   #ff1616;\r\n\t\t\t\t--noise1-secondary-note:    #991010;\r\n\t\t\t\t--noise1-primary-note:      #ff1616;\r\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\r\n\t\t\t\t--noise2-primary-channel:   #ffffff;\r\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\r\n\t\t\t\t--noise2-primary-note:      #ffffff;\r\n\t\t\t\t--noise3-secondary-channel: #5869BD;\r\n\t\t\t\t--noise3-primary-channel:   #768dfc;\r\n\t\t\t\t--noise3-secondary-note:    #5869BD;\r\n\t\t\t\t--noise3-primary-note:      #768dfc;\r\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\r\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\r\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\r\n\t\t\t\t--noise4-primary-note:      #a5ff00;\r\n\t\t\t}\r\n\t`,\r\n\t\"frozen\": `\r\n\t:root {\r\n\t\t\t\t--page-margin: black;\r\n\t\t\t\t--editor-background: black;\r\n\t\t\t\t--hover-preview: white;\r\n\t\t\t\t--playhead: white;\r\n\t\t\t\t--primary-text: white;\r\n\t\t\t\t--secondary-text: #999;\r\n\t\t\t\t--inverted-text: black;\r\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\r\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\r\n\t\t\t\t--loop-accent: #38ef17;\r\n\t\t\t\t--link-accent: #98f;\r\n\t\t\t\t--ui-widget-background: #363636;\r\n\t\t\t\t--ui-widget-focus: #777;\r\n\t\t\t\t--volume-icon: #ed2d2d;\t\r\n\r\n\t\t\t\t--tonic: #88bce8; \r\n\t\t\t\t--pitch1-background: #99c8ef; \r\n\t\t\t\t--pitch2-background: #abd3f4; \r\n\t\t\t\t--pitch3-background: #b8d7f2; \r\n\t\t\t\t--pitch4-background: #cbe0f2;\r\n\t\t\t\t--pitch5-background: #e5f0f9; \r\n\t\t\t\t--pitch6-background: #ffffff; \r\n\t\t\t\t--fifth-note: #e5f0f9; \r\n\t\t\t\t--pitch8-background: #cbe0f2; \r\n\t\t\t\t--pitch9-background: #b8d7f2; \r\n\t\t\t\t--pitch10-background: #abd3f4; \r\n\t\t\t\t--pitch11-background: #99c8ef;\r\n\t\t\t\t--pitch-background: #444;\r\n\r\n\t\t\t\t--octave-scrollbar: #ffffff; \r\n\t\t\t\t--scrollbar-octave: #ed2d2d;\r\n\r\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\r\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\r\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\r\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\r\n\t\t\t\t--pitch2-secondary-channel: #439143;\r\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\r\n\t\t\t\t--pitch2-secondary-note:    #439143;\r\n\t\t\t\t--pitch2-primary-note:      #44ff44;\r\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\r\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\r\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\r\n\t\t\t\t--pitch3-primary-note:      #ffff25;\r\n\t\t\t\t--pitch4-secondary-channel: #c75000;\r\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\r\n\t\t\t\t--pitch4-secondary-note:    #c75000;\r\n\t\t\t\t--pitch4-primary-note:      #ff9752;\r\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\r\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\r\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\r\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\r\n\t\t\t\t--pitch6-secondary-channel: #552377;\r\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\r\n\t\t\t\t--pitch6-secondary-note:    #552377;\r\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\r\n\t\t\t\t--pitch7-secondary-channel: #221b89;\r\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\r\n\t\t\t\t--pitch7-secondary-note:    #221b89;\r\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\r\n\t\t\t\t--pitch8-secondary-channel: #00995f;\r\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\r\n\t\t\t\t--pitch8-secondary-note:    #00995f;\r\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\r\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\r\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\r\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\r\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\r\n\t\t\t\t--pitch10-secondary-channel:#b25915;\r\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\r\n\t\t\t\t--pitch10-secondary-note:   #b25915;\r\n\t\t\t\t--pitch10-primary-note:     #d85d00;\r\n\t\t\t\t--pitch11-secondary-channel:#891a60;\r\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\r\n\t\t\t\t--pitch11-secondary-note:   #891a60;\r\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\r\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\r\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\r\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\r\n\t\t\t\t--pitch12-primary-note:     #c26afc;\r\n\t\t\t\t--noise1-secondary-channel: #991010;\r\n\t\t\t\t--noise1-primary-channel:   #ff1616;\r\n\t\t\t\t--noise1-secondary-note:    #991010;\r\n\t\t\t\t--noise1-primary-note:      #ff1616;\r\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\r\n\t\t\t\t--noise2-primary-channel:   #ffffff;\r\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\r\n\t\t\t\t--noise2-primary-note:      #ffffff;\r\n\t\t\t\t--noise3-secondary-channel: #5869BD;\r\n\t\t\t\t--noise3-primary-channel:   #768dfc;\r\n\t\t\t\t--noise3-secondary-note:    #5869BD;\r\n\t\t\t\t--noise3-primary-note:      #768dfc;\r\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\r\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\r\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\r\n\t\t\t\t--noise4-primary-note:      #a5ff00;\r\n\t\t\t}\r\n\t`,\r\n\t}\r\n\r\n    public static readonly pageMargin: string = \"var(--page-margin, black)\";\r\n    public static readonly editorBackground: string = \"var(--editor-background, black)\";\r\n    public static readonly hoverPreview: string = \"var(--hover-preview, white)\";\r\n    public static readonly playhead: string = \"var(--playhead, white)\";\r\n    public static readonly primaryText: string = \"var(--primary-text, white)\";\r\n    public static readonly secondaryText: string = \"var(--secondary-text, #999)\";\r\n    public static readonly invertedText: string = \"var(--inverted-text, black)\";\r\n    public static readonly textSelection: string = \"var(--text-selection, rgba(119,68,255,0.99))\";\r\n    public static readonly boxSelectionFill: string = \"var(--box-selection-fill, rgba(255,255,255,0.2))\";\r\n    public static readonly loopAccent: string = \"var(--loop-accent, #9900cc)\";\r\n    public static readonly linkAccent: string = \"var(--link-accent, #98f)\";\r\n    public static readonly uiWidgetBackground: string = \"var(--ui-widget-background, #444)\";\r\n    public static readonly uiWidgetFocus: string = \"var(--ui-widget-focus)\";\r\n    public static readonly pitchBackground: string = \"var(--pitch-background, #444)\";\r\n    public static readonly tonic: string = \"var(--tonic, #864)\";\r\n    public static readonly fifthNote: string = \"var(--fifth-note, #468)\";\r\n\r\n\tpublic static readonly pitch1Background: string = \"var(--pitch1-background, var(--pitch-background, #444))\";\r\n\tpublic static readonly pitch2Background: string = \"var(--pitch2-background, var(--pitch-background, #444))\";\r\n\tpublic static readonly pitch3Background: string = \"var(--pitch3-background, var(--pitch-background, #444))\";\r\n\tpublic static readonly pitch4Background: string = \"var(--pitch4-background, var(--pitch-background, #444))\";\r\n\tpublic static readonly pitch5Background: string = \"var(--pitch5-background, var(--pitch-background, #444))\";\r\n\tpublic static readonly pitch6Background: string = \"var(--pitch6-background, var(--pitch-background, #444))\";\r\n\t// no need for a 7th since that's the --fifth-note's job\r\n\tpublic static readonly pitch8Background: string = \"var(--pitch8-background, var(--pitch-background, #444))\";\r\n\tpublic static readonly pitch9Background: string = \"var(--pitch9-background, var(--pitch-background, #444))\";\r\n\tpublic static readonly pitch10Background: string = \"var(--pitch10-background, var(--pitch-background, #444))\";\r\n\tpublic static readonly pitch11Background: string = \"var(--pitch11-background, var(--pitch-background, #444))\";\r\n    public static readonly volumeIcon: string = \"var(--volume-icon, #777777)\";\r\n\tpublic static readonly octaveScrollbar: string = \"var(--octave-scrollbar, #444444)\";\r\n\tpublic static readonly scrollbarOctave: string = \"var(--scrollbar-octave, #886644)\";\r\n\tpublic static readonly channelBox: string = \"var(--channel-box, #444444)\";\r\n\tpublic static readonly blackPianoKey: string = \"var(--black-piano-key, #444)\";\r\n\tpublic static readonly whitePianoKey: string = \"var(--white-piano-key, #bbb)\";\r\n\t\r\n\tpublic static readonly pitchChannels: DictionaryArray<ChannelColors> = toNameMap([\r\n        {\r\n            name: \"pitch1\", // cyan\r\n            secondaryChannel: \"var(--pitch1-secondary-channel)\",\r\n            primaryChannel: \"var(--pitch1-primary-channel)\",\r\n            secondaryNote: \"var(--pitch1-secondary-note)\",\r\n            primaryNote: \"var(--pitch1-primary-note)\",\r\n        }, {\r\n            name: \"pitch2\", // yellow\r\n            secondaryChannel: \"var(--pitch2-secondary-channel)\",\r\n            primaryChannel: \"var(--pitch2-primary-channel)\",\r\n            secondaryNote: \"var(--pitch2-secondary-note)\",\r\n            primaryNote: \"var(--pitch2-primary-note)\",\r\n        }, {\r\n            name: \"pitch3\", // orange\r\n            secondaryChannel: \"var(--pitch3-secondary-channel)\",\r\n            primaryChannel: \"var(--pitch3-primary-channel)\",\r\n            secondaryNote: \"var(--pitch3-secondary-note)\",\r\n            primaryNote: \"var(--pitch3-primary-note)\",\r\n        }, {\r\n            name: \"pitch4\", // green\r\n            secondaryChannel: \"var(--pitch4-secondary-channel)\",\r\n            primaryChannel: \"var(--pitch4-primary-channel)\",\r\n            secondaryNote: \"var(--pitch4-secondary-note)\",\r\n            primaryNote: \"var(--pitch4-primary-note)\",\r\n        }, {\r\n            name: \"pitch5\", // magenta\r\n            secondaryChannel: \"var(--pitch5-secondary-channel)\",\r\n            primaryChannel: \"var(--pitch5-primary-channel)\",\r\n            secondaryNote: \"var(--pitch5-secondary-note)\",\r\n            primaryNote: \"var(--pitch5-primary-note)\",\r\n        }, {\r\n            name: \"pitch6\", // blue\r\n            secondaryChannel: \"var(--pitch6-secondary-channel)\",\r\n            primaryChannel: \"var(--pitch6-primary-channel)\",\r\n            secondaryNote: \"var(--pitch6-secondary-note)\",\r\n            primaryNote: \"var(--pitch6-primary-note)\",\r\n        }, {\r\n            name: \"pitch7\", // olive\r\n            secondaryChannel: \"var(--pitch7-secondary-channel)\",\r\n            primaryChannel: \"var(--pitch7-primary-channel)\",\r\n            secondaryNote: \"var(--pitch7-secondary-note)\",\r\n            primaryNote: \"var(--pitch7-primary-note)\",\r\n        }, {\r\n            name: \"pitch8\", // red\r\n            secondaryChannel: \"var(--pitch8-secondary-channel)\",\r\n            primaryChannel: \"var(--pitch8-primary-channel)\",\r\n            secondaryNote: \"var(--pitch8-secondary-note)\",\r\n            primaryNote: \"var(--pitch8-primary-note)\",\r\n        }, {\r\n            name: \"pitch9\", // teal\r\n            secondaryChannel: \"var(--pitch9-secondary-channel)\",\r\n            primaryChannel: \"var(--pitch9-primary-channel)\",\r\n            secondaryNote: \"var(--pitch9-secondary-note)\",\r\n            primaryNote: \"var(--pitch9-primary-note)\",\r\n        }, {\r\n            name: \"pitch10\", // purple\r\n            secondaryChannel: \"var(--pitch10-secondary-channel)\",\r\n            primaryChannel: \"var(--pitch10-primary-channel)\",\r\n            secondaryNote: \"var(--pitch10-secondary-note)\",\r\n            primaryNote: \"var(--pitch10-primary-note)\",\r\n        },\r\n\t\t{\r\n            name: \"pitch11\", // teal\r\n            secondaryChannel: \"var(--pitch11-secondary-channel)\",\r\n            primaryChannel: \"var(--pitch11-primary-channel)\",\r\n            secondaryNote: \"var(--pitch11-secondary-note)\",\r\n            primaryNote: \"var(--pitch11-primary-note)\",\r\n        }, {\r\n            name: \"pitch12\", // purple\r\n            secondaryChannel: \"var(--pitch12-secondary-channel)\",\r\n            primaryChannel: \"var(--pitch12-primary-channel)\",\r\n            secondaryNote: \"var(--pitch12-secondary-note)\",\r\n            primaryNote: \"var(--pitch12-primary-note)\",\r\n        },\r\n    ]);\r\n\tpublic static readonly noiseChannels: DictionaryArray<ChannelColors> = toNameMap([\r\n        {\r\n            name: \"noise1\", // gray\r\n            secondaryChannel: \"var(--noise1-secondary-channel)\",\r\n            primaryChannel: \"var(--noise1-primary-channel)\",\r\n            secondaryNote: \"var(--noise1-secondary-note)\",\r\n            primaryNote: \"var(--noise1-primary-note)\",\r\n        }, {\r\n            name: \"noise2\", // brown\r\n            secondaryChannel: \"var(--noise2-secondary-channel)\",\r\n            primaryChannel: \"var(--noise2-primary-channel)\",\r\n            secondaryNote: \"var(--noise2-secondary-note)\",\r\n            primaryNote: \"var(--noise2-primary-note)\",\r\n        }, {\r\n            name: \"noise3\", // azure\r\n            secondaryChannel: \"var(--noise3-secondary-channel)\",\r\n            primaryChannel: \"var(--noise3-primary-channel)\",\r\n            secondaryNote: \"var(--noise3-secondary-note)\",\r\n            primaryNote: \"var(--noise3-primary-note)\",\r\n        }, {\r\n            name: \"noise4\", // purple\r\n            secondaryChannel: \"var(--noise4-secondary-channel)\",\r\n            primaryChannel: \"var(--noise4-primary-channel)\",\r\n            secondaryNote: \"var(--noise4-secondary-note)\",\r\n            primaryNote: \"var(--noise4-primary-note)\",\r\n        },\r\n    ]);\r\n\r\n\tpublic static getChannelColor(song: Song, channel: number): ChannelColors {\r\n\t\treturn channel < song.pitchChannelCount\r\n\t\t\t? ColorConfig.pitchChannels[channel % ColorConfig.pitchChannels.length]\r\n\t\t\t: ColorConfig.noiseChannels[(channel - song.pitchChannelCount) % ColorConfig.noiseChannels.length];\r\n\t}\r\n\t\tprivate static readonly _styleElement: HTMLStyleElement = document.head.appendChild(HTML.style({type: \"text/css\"}));\r\n\t\t\r\n\tpublic static setTheme(theme: string): void {\r\n\t\tthis._styleElement.textContent = this._themeMap[theme];\r\n\t\tthis.usesPianoScheme = (getComputedStyle(this._styleElement).getPropertyValue(\"--use-piano-scheme\").trim() == \"true\");\r\n\t\tconsole.log(\"use-piano-scheme: \"+this.usesPianoScheme);\r\n\t}\r\n}","/*\r\nCopyright (C) 2018 John Nesky\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\nimport { HTML, SVG } from \"imperative-html/dist/esm/elements-strict\";\r\nimport { SongDocument } from \"./SongDocument\";\r\nimport { Note, NotePin, makeNotePin, makeNote, Pattern } from \"../synth/song\";\r\nimport {Config} from \"../synth/SynthConfig\";\r\nimport { UndoableChange, ChangeSequence } from \"./Change\";\r\nimport { ChangeChannelBar, ChangeNoteAdded, ChangeNoteTruncate, ChangePinTime, ChangeVolumeBend, ChangePitchBend, ChangePitchAdded, ChangeEnsurePatternExists } from \"./changes\";\r\nimport { ColorConfig } from \"./ColorConfig\";\r\n\tconst {div} = HTML;\r\n\r\n\r\n\tfunction prettyNumber(value: number): string {\r\n\t\treturn value.toFixed(2).replace(/\\.?0*$/, \"\");\r\n\t}\r\n\t\r\n\tfunction makeEmptyReplacementElement(node: Node): Node {\r\n\t\tconst clone: Node = node.cloneNode(false);\r\n\t\tnode.parentNode!.replaceChild(clone, node);\r\n\t\treturn clone;\r\n\t}\r\n\t\r\n\tclass PatternCursor {\r\n\t\tpublic valid:        boolean = false;\r\n\t\tpublic prevNote:     Note | null = null;\r\n\t\tpublic curNote:      Note | null = null;\r\n\t\tpublic nextNote:     Note | null = null;\r\n\t\tpublic pitch:        number = 0;\r\n\t\tpublic pitchIndex:   number = -1;\r\n\t\tpublic curIndex:     number = 0;\r\n\t\tpublic start:        number = 0;\r\n\t\tpublic end:          number = 0;\r\n\t\tpublic part:         number = 0;\r\n\t\tpublic notePart:     number = 0;\r\n\t\tpublic nearPinIndex: number = 0;\r\n\t\tpublic pins:         NotePin[] = [];\r\n\t}\r\n\t\r\n\texport class PatternEditor {\r\n\t\tprivate readonly _svgNoteBackground: SVGPatternElement = <SVGPatternElement> SVG.pattern( {id: \"patternEditorNoteBackground\", x: \"0\", y: \"0\", width: \"64\", height: \"156\", patternUnits: \"userSpaceOnUse\"});\r\n\t\tprivate readonly _svgDrumBackground: SVGPatternElement = <SVGPatternElement> SVG.pattern( {id: \"patternEditorDrumBackground\", x: \"0\", y: \"0\", width: \"64\", height: \"40\", patternUnits: \"userSpaceOnUse\"});\r\n\t\tprivate readonly _svgBackground: SVGRectElement = <SVGRectElement> SVG.rect( {x: \"0\", y: \"0\", width: \"512\", height: \"481\", \"pointer-events\": \"none\", fill: \"url(#patternEditorNoteBackground)\"});\r\n\t\tprivate _svgNoteContainer: SVGSVGElement = <SVGSVGElement> SVG.svg();\r\n\t\tprivate readonly _svgPlayhead: SVGRectElement = <SVGRectElement> SVG.rect( {id: \"\", x: \"0\", y: \"0\", width: \"4\", height: \"481\", fill: \"white\", \"pointer-events\": \"none\"});\r\n\t\tprivate readonly _svgPreview: SVGPathElement = <SVGPathElement> SVG.path( {fill: \"none\", stroke: \"white\", \"stroke-width\": \"2\", \"pointer-events\": \"none\"});\r\n\t\tprivate readonly _svg: SVGSVGElement = <SVGSVGElement> SVG.svg( {style: \"touch-action: none; position: absolute;\", width: \"100%\", height: \"100%\", viewBox: \"0 0 512 481\", preserveAspectRatio: \"none\"}, [\r\n\t\t\tSVG.defs( undefined, [\r\n\t\t\t\tthis._svgNoteBackground,\r\n\t\t\t\tthis._svgDrumBackground,\r\n\t\t\t]),\r\n\t\t\tthis._svgBackground,\r\n\t\t\tthis._svgNoteContainer,\r\n\t\t\tthis._svgPreview,\r\n\t\t\tthis._svgPlayhead,\r\n\t\t]);\r\n\t\tpublic readonly container: HTMLDivElement = div({style: \"height: 100%; overflow:hidden; position: relative; flex-grow: 1;\"}, [this._svg]);\r\n\t\t\r\n\t\tprivate readonly _defaultPitchHeight: number = 13;\r\n\t\tprivate readonly _defaultDrumHeight: number = 40;\r\n\t\tprivate readonly _backgroundPitchRows: SVGRectElement[] = [];\r\n\t\tprivate readonly _backgroundDrumRow: SVGRectElement = <SVGRectElement> SVG.rect();\r\n\t\t// The below array is unused.\r\n\t\tpublic readonly _defaultPinChannels: NotePin[][] = [\r\n\t\t\t[makeNotePin(0, 0, 3), makeNotePin(0, 2, 3)],\r\n\t\t\t[makeNotePin(0, 0, 3), makeNotePin(0, 2, 3)],\r\n\t\t\t[makeNotePin(0, 0, 3), makeNotePin(0, 2, 3)],\r\n\t\t\t[makeNotePin(0, 0, 3), makeNotePin(0, 2, 0)],\r\n\t\t];\r\n\t\t\r\n\t\tprivate _editorWidth: number;\r\n\t\tprivate _editorHeight: number = 481;\r\n\t\tprivate _partWidth: number;\r\n\t\tprivate _pitchHeight: number;\r\n\t\tprivate _pitchCount: number;\r\n\t\tprivate _mouseX: number = 0;\r\n\t\tprivate _mouseY: number = 0;\r\n\t\tprivate _mouseDown: boolean = false;\r\n\t\tprivate _mouseOver: boolean = false;\r\n\t\tprivate _mouseDragging: boolean = false;\r\n\t\tprivate _mouseHorizontal: boolean = false;\r\n\t\tprivate _usingTouch: boolean = false;\r\n\t\tprivate _copiedPinChannels: NotePin[][] = [];\r\n\t\tprivate _copiedPins: NotePin[];\r\n\t\tprivate _mouseXStart: number = 0;\r\n\t\tprivate _mouseYStart: number = 0;\r\n\t\tpublic _mouseXPrev: number = 0;\r\n\t\tpublic _mouseYPrev: number = 0;\r\n\t\tprivate _dragTime: number = 0;\r\n\t\tprivate _dragPitch: number = 0;\r\n\t\tprivate _dragVolume: number = 0;\r\n\t\tprivate _dragVisible: boolean = false;\r\n\t\t//private _precise: boolean = false;\r\n\t\t//private _precisionX: number = 0;\r\n\t\tprivate _dragChange: UndoableChange | null = null;\r\n\t\tprivate _cursor: PatternCursor = new PatternCursor();\r\n\t\tprivate _pattern: Pattern | null = null;\r\n\t\tprivate _playheadX: number = 0.0;\r\n\t\tprivate _octaveOffset: number = 0;\r\n\t\tprivate _renderedWidth: number = -1;\r\n\t\tprivate _renderedBeatWidth: number = -1;\r\n\t\tprivate _renderedFifths: boolean = false;\r\n\t\tprivate _renderedACS: boolean = false;\r\n\t\tprivate _renderedPiano: boolean = false;\r\n\t\tprivate _renderedDrums: boolean = false;\r\n\t\tprivate _setKey: number = 1;\r\n\t\tprivate _renderedPartsPerBeat: number = -1;\r\n\t\tprivate _renderedPitchChannelCount: number = -1;\r\n\t\tprivate _renderedDrumChannelCount: number = -1;\r\n\t\tprivate _followPlayheadBar: number = -1;\r\n\t\t\r\n\t\tconstructor(private _doc: SongDocument) {\r\n\t\t\tfor (let i: number = 0; i < 12; i++) {\r\n\t\t\t\tconst y: number = (12 - i) % 12;\r\n\t\t\t\tconst rectangle: SVGRectElement = <SVGRectElement> SVG.rect();\r\n\t\t\t\trectangle.setAttribute(\"x\", \"1\");\r\n\t\t\t\trectangle.setAttribute(\"y\", \"\" + (y * this._defaultPitchHeight + 1));\r\n\t\t\t\trectangle.setAttribute(\"height\", \"\" + (this._defaultPitchHeight - 2));\r\n\t\t\t\trectangle.setAttribute(\"fill\", (i == 0) ? ColorConfig.tonic : ColorConfig.uiWidgetBackground);\r\n\t\t\t\tthis._svgNoteBackground.appendChild(rectangle);\r\n\t\t\t\tthis._backgroundPitchRows[i] = rectangle;\r\n\t\t\t}\r\n\r\n\t\t\tthis._svg.style.backgroundColor = ColorConfig.editorBackground;\r\n\r\n\t\t\tthis._backgroundDrumRow.setAttribute(\"x\", \"1\");\r\n\t\t\tthis._backgroundDrumRow.setAttribute(\"y\", \"1\");\r\n\t\t\tthis._backgroundDrumRow.setAttribute(\"height\", \"\" + (this._defaultDrumHeight - 2));\r\n\t\t\tthis._backgroundDrumRow.setAttribute(\"fill\", \"#444444\");\r\n\t\t\tthis._svgDrumBackground.appendChild(this._backgroundDrumRow);\r\n\t\t\t\r\n\t\t\tthis._doc.notifier.watch(this._documentChanged);\r\n\t\t\tthis._documentChanged();\r\n\t\t\tthis._updateCursorStatus();\r\n\t\t\tthis._updatePreview();\r\n\t\t\twindow.requestAnimationFrame(this._animatePlayhead);\r\n\t\t\tthis._svg.addEventListener(\"mousedown\", this._whenMousePressed);\r\n\t\t\tdocument.addEventListener(\"mousemove\", this._whenMouseMoved);\r\n\t\t\tdocument.addEventListener(\"mouseup\", this._whenCursorReleased);\r\n\t\t\tthis._svg.addEventListener(\"mouseover\", this._whenMouseOver);\r\n\t\t\tthis._svg.addEventListener(\"mouseout\", this._whenMouseOut);\r\n\t\t\t\r\n\t\t\tthis._svg.addEventListener(\"touchstart\", this._whenTouchPressed);\r\n\t\t\tthis._svg.addEventListener(\"touchmove\", this._whenTouchMoved);\r\n\t\t\tthis._svg.addEventListener(\"touchend\", this._whenCursorReleased);\r\n\t\t\tthis._svg.addEventListener(\"touchcancel\", this._whenCursorReleased);\r\n\t\t\t\r\n\t\t\tthis.resetCopiedPins();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _getMaxDivision(): number {\r\n\t\t\tif (this._doc.song.partsPerBeat % 3 == 0) {\r\n\t\t\t\t// Beat is divisible by 3.\r\n\t\t\t\treturn this._doc.song.partsPerBeat / 3;\r\n\t\t\t} else if (this._doc.song.partsPerBeat % 2 == 0) {\r\n\t\t\t\t// Beat is divisible by 2.\r\n\t\t\t\treturn this._doc.song.partsPerBeat / 2;\r\n\t\t\t}\r\n\t\t\treturn this._doc.song.partsPerBeat;\r\n\t\t}\r\n\t\t\r\n\t\tprivate _updateCursorStatus(): void {\r\n\t\t\t//if (this._pattern == null) return;\r\n\t\t\t\r\n\t\t\tthis._cursor = new PatternCursor();\r\n\t\t\t\r\n\t\t\tif (this._mouseX < 0 || this._mouseX > this._editorWidth || this._mouseY < 0 || this._mouseY > this._editorHeight) return;\r\n\t\t\t\r\n\t\t\tthis._cursor.part = Math.floor(Math.max(0, Math.min(this._doc.song.beatsPerBar * this._doc.song.partsPerBeat - 1, this._mouseX / this._partWidth)));\r\n\t\t\t\r\n\t\t\tif (this._pattern != null) {\r\n\t\t\t\tfor (const note of this._pattern.notes) {\r\n\t\t\t\t\tif (note.end <= this._cursor.part) {\r\n\t\t\t\t\t\tthis._cursor.prevNote = note;\r\n\t\t\t\t\t\tthis._cursor.curIndex++;\r\n\t\t\t\t\t} else if (note.start <= this._cursor.part && note.end > this._cursor.part) {\r\n\t\t\t\t\t\tthis._cursor.curNote = note;\r\n\t\t\t\t\t} else if (note.start > this._cursor.part) {\r\n\t\t\t\t\t\tthis._cursor.nextNote = note;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet mousePitch: number = this._findMousePitch(this._mouseY);\r\n\t\t\t\r\n\t\t\tif (this._cursor.curNote != null) {\r\n\t\t\t\tthis._cursor.start = this._cursor.curNote.start;\r\n\t\t\t\tthis._cursor.end   = this._cursor.curNote.end;\r\n\t\t\t\tthis._cursor.pins  = this._cursor.curNote.pins;\r\n\t\t\t\t\r\n\t\t\t\tlet interval: number = 0;\r\n\t\t\t\tlet error: number = 0;\r\n\t\t\t\tlet prevPin: NotePin;\r\n\t\t\t\tlet nextPin: NotePin = this._cursor.curNote.pins[0];\r\n\t\t\t\tfor (let j: number = 1; j < this._cursor.curNote.pins.length; j++) {\r\n\t\t\t\t\tprevPin = nextPin;\r\n\t\t\t\t\tnextPin = this._cursor.curNote.pins[j];\r\n\t\t\t\t\tconst leftSide:    number = this._partWidth * (this._cursor.curNote.start + prevPin.time);\r\n\t\t\t\t\tconst rightSide:   number = this._partWidth * (this._cursor.curNote.start + nextPin.time);\r\n\t\t\t\t\tif (this._mouseX > rightSide) continue;\r\n\t\t\t\t\tif (this._mouseX < leftSide) throw new Error();\r\n\t\t\t\t\tconst intervalRatio: number = (this._mouseX - leftSide) / (rightSide - leftSide);\r\n\t\t\t\t\tconst arc: number = Math.sqrt(1.0 / Math.sqrt(4.0) - Math.pow(intervalRatio - 0.5, 2.0)) - 0.5;\r\n\t\t\t\t\tconst bendHeight: number = Math.abs(nextPin.interval - prevPin.interval);\r\n\t\t\t\t\tinterval = prevPin.interval * (1.0 - intervalRatio) + nextPin.interval * intervalRatio;\r\n\t\t\t\t\terror = arc * bendHeight + 1.0;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tlet minInterval: number = Number.MAX_VALUE;\r\n\t\t\t\tlet maxInterval: number = -Number.MAX_VALUE;\r\n\t\t\t\tlet bestDistance: number = Number.MAX_VALUE;\r\n\t\t\t\tfor (const pin of this._cursor.curNote.pins) {\r\n\t\t\t\t\tif (minInterval > pin.interval) minInterval = pin.interval;\r\n\t\t\t\t\tif (maxInterval < pin.interval) maxInterval = pin.interval;\r\n\t\t\t\t\tconst pinDistance: number = Math.abs(this._cursor.curNote.start + pin.time - this._mouseX / this._partWidth);\r\n\t\t\t\t\tif (bestDistance > pinDistance) {\r\n\t\t\t\t\t\tbestDistance = pinDistance;\r\n\t\t\t\t\t\tthis._cursor.nearPinIndex = this._cursor.curNote.pins.indexOf(pin);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tmousePitch -= interval;\r\n\t\t\t\tthis._cursor.pitch = this._snapToPitch(mousePitch, -minInterval, (this._doc.song.getChannelIsDrum(this._doc.channel) ? Config.drumCount - 1 : Config.maxPitch) - maxInterval);\r\n\t\t\t\t\r\n\t\t\t\t// Snap to nearby existing note if present.\r\n\t\t\t\t// @TODO: Do this for all channels? ModBox excludes the 4th\r\n\t\t\t\t// channel for some unknown reason.\r\n\t\t\t\tif (this._doc.channel != 3/*!this._doc.song.getChannelIsDrum(this._doc.channel)*/) {\r\n\t\t\t\t\tlet nearest: number = error;\r\n\t\t\t\t\tfor (let i: number = 0; i < this._cursor.curNote.pitches.length; i++) {\r\n\t\t\t\t\t\tconst distance: number = Math.abs(this._cursor.curNote.pitches[i] - mousePitch + 0.5);\r\n\t\t\t\t\t\tif (distance > nearest) continue;\r\n\t\t\t\t\t\tnearest = distance;\r\n\t\t\t\t\t\tthis._cursor.pitch = this._cursor.curNote.pitches[i];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tfor (let i: number = 0; i < this._cursor.curNote.pitches.length; i++) {\r\n\t\t\t\t\tif (this._cursor.curNote.pitches[i] == this._cursor.pitch) {\r\n\t\t\t\t\t\tthis._cursor.pitchIndex = i;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis._cursor.pitch = this._snapToPitch(mousePitch, 0, Config.maxPitch);\r\n\t\t\t\tconst defaultLength: number = this._copiedPins[this._copiedPins.length-1].time;\r\n\t\t\t\tconst fullBeats: number = Math.floor(this._cursor.part / this._doc.song.partsPerBeat);\r\n\t\t\t\tconst maxDivision: number = this._getMaxDivision();\r\n\t\t\t\tconst modMouse: number = this._cursor.part % this._doc.song.partsPerBeat;\r\n\t\t\t\tif (defaultLength == 1) {\r\n\t\t\t\t\tthis._cursor.start = this._cursor.part;\r\n\t\t\t\t} else if (defaultLength > this._doc.song.partsPerBeat) {\r\n\t\t\t\t\tthis._cursor.start = fullBeats * this._doc.song.partsPerBeat;\r\n\t\t\t\t} else if (defaultLength == this._doc.song.partsPerBeat) {\r\n\t\t\t\t\tthis._cursor.start = fullBeats * this._doc.song.partsPerBeat;\r\n\t\t\t\t\tif (maxDivision < this._doc.song.partsPerBeat && modMouse > maxDivision) {\r\n\t\t\t\t\t\tthis._cursor.start += Math.floor(modMouse / maxDivision) * maxDivision;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._cursor.start = fullBeats * this._doc.song.partsPerBeat;\r\n\t\t\t\t\tlet division = this._doc.song.partsPerBeat % defaultLength == 0 ? defaultLength : Math.min(defaultLength, maxDivision);\r\n\t\t\t\t\twhile (division < maxDivision && this._doc.song.partsPerBeat % division != 0) {\r\n\t\t\t\t\t\tdivision++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._cursor.start += Math.floor(modMouse / division) * division;\r\n\t\t\t\t}\r\n\t\t\t\tthis._cursor.end = this._cursor.start + defaultLength;\r\n\t\t\t\tlet forceStart: number = 0;\r\n\t\t\t\tlet forceEnd: number = this._doc.song.beatsPerBar * this._doc.song.partsPerBeat;\r\n\t\t\t\tif (this._cursor.prevNote != null) {\r\n\t\t\t\t\tforceStart = this._cursor.prevNote.end;\r\n\t\t\t\t}\r\n\t\t\t\tif (this._cursor.nextNote != null) {\r\n\t\t\t\t\tforceEnd   = this._cursor.nextNote.start;\r\n\t\t\t\t}\r\n\t\t\t\tif (this._cursor.start < forceStart) {\r\n\t\t\t\t\tthis._cursor.start = forceStart;\r\n\t\t\t\t\tthis._cursor.end = this._cursor.start + defaultLength;\r\n\t\t\t\t\tif (this._cursor.end > forceEnd) {\r\n\t\t\t\t\t\tthis._cursor.end = forceEnd;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (this._cursor.end > forceEnd) {\r\n\t\t\t\t\tthis._cursor.end = forceEnd;\r\n\t\t\t\t\tthis._cursor.start = this._cursor.end - defaultLength;\r\n\t\t\t\t\tif (this._cursor.start < forceStart) {\r\n\t\t\t\t\t\tthis._cursor.start = forceStart;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (this._cursor.end - this._cursor.start == defaultLength) {\r\n\t\t\t\t\tthis._cursor.pins = this._copiedPins;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._cursor.pins = [];\r\n\t\t\t\t\tfor (const oldPin of this._copiedPins) {\r\n\t\t\t\t\t\tif (oldPin.time <= this._cursor.end - this._cursor.start) {\r\n\t\t\t\t\t\t\tthis._cursor.pins.push(makeNotePin(0, oldPin.time, oldPin.volume));\r\n\t\t\t\t\t\t\tif (oldPin.time == this._cursor.end - this._cursor.start) break;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis._cursor.pins.push(makeNotePin(0, this._cursor.end - this._cursor.start, oldPin.volume));\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._cursor.valid = true;\r\n\t\t}\r\n\t\t\r\n\t\tprivate _findMousePitch(pixelY: number): number {\r\n\t\t\treturn Math.max(0, Math.min(this._pitchCount - 1, this._pitchCount - (pixelY / this._pitchHeight))) + this._octaveOffset;\r\n\t\t}\r\n\t\t\r\n\t\tprivate _snapToPitch(guess: number, min: number, max: number): number {\r\n\t\t\tif (guess < min) guess = min;\r\n\t\t\tif (guess > max) guess = max;\r\n\t\t\tconst scale: ReadonlyArray<boolean> = Config.scales[this._doc.song.scale].flags;\r\n\t\t\tif (scale[Math.floor(guess) % 12] || this._doc.song.getChannelIsDrum(this._doc.channel)) {\r\n\t\t\t\treturn Math.floor(guess);\r\n\t\t\t} else {\r\n\t\t\t\tlet topPitch: number = Math.floor(guess) + 1;\r\n\t\t\t\tlet bottomPitch: number = Math.floor(guess) - 1;\r\n\t\t\t\twhile (!scale[topPitch % 12]) {\r\n\t\t\t\t\ttopPitch++;\r\n\t\t\t\t}\r\n\t\t\t\twhile (!scale[(bottomPitch) % 12]) {\r\n\t\t\t\t\tbottomPitch--;\r\n\t\t\t\t}\r\n\t\t\t\tif (topPitch > max) {\r\n\t\t\t\t\tif (bottomPitch < min) {\r\n\t\t\t\t\t\treturn min;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn bottomPitch;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (bottomPitch < min) {\r\n\t\t\t\t\treturn topPitch;\r\n\t\t\t\t}\r\n\t\t\t\tlet topRange: number = topPitch;\r\n\t\t\t\tlet bottomRange: number = bottomPitch + 1;\r\n\t\t\t\tif (topPitch % 12 == 0 || topPitch % 12 == 7) {\r\n\t\t\t\t\ttopRange -= 0.5;\r\n\t\t\t\t}\r\n\t\t\t\tif (bottomPitch % 12 == 0 || bottomPitch % 12 == 7) {\r\n\t\t\t\t\tbottomRange += 0.5;\r\n\t\t\t\t}\r\n\t\t\t\treturn guess - bottomRange > topRange - guess ? topPitch : bottomPitch;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tprivate _copyPins(note: Note): void {\r\n\t\t\tthis._copiedPins = [];\r\n\t\t\tfor (const oldPin of note.pins) {\r\n\t\t\t\tthis._copiedPins.push(makeNotePin(0, oldPin.time, oldPin.volume));\r\n\t\t\t}\r\n\t\t\tfor (let i: number = 1; i < this._copiedPins.length - 1; ) {\r\n\t\t\t\tif (this._copiedPins[i-1].volume == this._copiedPins[i].volume && \r\n\t\t\t\t    this._copiedPins[i].volume == this._copiedPins[i+1].volume)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis._copiedPins.splice(i, 1);\r\n\t\t\t\t} else {\r\n\t\t\t\t\ti++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._copiedPinChannels[this._doc.channel] = this._copiedPins;\r\n\t\t}\r\n\t\t\r\n\t\tpublic resetCopiedPins = (): void => {\r\n\t\t\tconst maxDivision: number = this._getMaxDivision();\r\n\t\t\tthis._copiedPinChannels.length = this._doc.song.getChannelCount();\r\n\t\t\tfor (let i: number = 0; i < this._doc.song.pitchChannelCount; i++) {\r\n\t\t\t\tthis._copiedPinChannels[i] = [makeNotePin(0, 0, 3), makeNotePin(0, maxDivision, 3)];\r\n\t\t\t}\r\n\t\t\tfor (let i: number = this._doc.song.pitchChannelCount; i < this._doc.song.getChannelCount(); i++) {\r\n\t\t\t\tthis._copiedPinChannels[i] = [makeNotePin(0, 0, 3), makeNotePin(0, maxDivision, 0)];\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tprivate _animatePlayhead = (timestamp: number): void => {\r\n\t\t\tconst playheadBar: number = Math.floor(this._doc.synth.playhead);\r\n\t\t\tif (this._doc.synth.playing && ((this._pattern != null && this._doc.song.getPattern(this._doc.channel, Math.floor(this._doc.synth.playhead)) == this._pattern) || Math.floor(this._doc.synth.playhead) == this._doc.bar)) {\r\n\t\t\t\tthis._svgPlayhead.setAttribute(\"visibility\", \"visible\");\r\n\t\t\t\tconst modPlayhead: number = this._doc.synth.playhead - playheadBar;\r\n\t\t\t\tif (Math.abs(modPlayhead - this._playheadX) > 0.1) {\r\n\t\t\t\t\tthis._playheadX = modPlayhead;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._playheadX += (modPlayhead - this._playheadX) * 0.2;\r\n\t\t\t\t}\r\n\t\t\t\tthis._svgPlayhead.setAttribute(\"x\", \"\" + prettyNumber(this._playheadX * this._editorWidth - 2));\r\n\t\t\t} else {\r\n\t\t\t\tthis._svgPlayhead.setAttribute(\"visibility\", \"hidden\"); \r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (this._doc.synth.playing && this._doc.prefs.autoFollow && this._followPlayheadBar != playheadBar) {\r\n\t\t\t\tnew ChangeChannelBar(this._doc, this._doc.channel, playheadBar);\r\n\t\t\t\tthis._doc.notifier.notifyWatchers();\r\n\t\t\t}\r\n\t\t\tthis._followPlayheadBar = playheadBar;\r\n\t\t\twindow.requestAnimationFrame(this._animatePlayhead);\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenMouseOver = (event: MouseEvent): void => {\r\n\t\t\tif (this._mouseOver) return;\r\n\t\t\tthis._mouseOver = true;\r\n\t\t\tthis._usingTouch = false;\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenMouseOut = (event: MouseEvent): void => {\r\n\t\t\tif (!this._mouseOver) return;\r\n\t\t\tthis._mouseOver = false;\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenMousePressed = (event: MouseEvent): void => {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\r\n    \t\tthis._mouseX = ((event.clientX || event.pageX) - boundingRect.left) * this._editorWidth / (boundingRect.right - boundingRect.left);\r\n\t\t    this._mouseY = ((event.clientY || event.pageY) - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\r\n\t\t    if (isNaN(this._mouseX)) this._mouseX = 0;\r\n\t\t    if (isNaN(this._mouseY)) this._mouseY = 0;\r\n\t\t\tthis._usingTouch = false;\r\n\t\t\tthis._whenCursorPressed();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenTouchPressed = (event: TouchEvent): void => {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\r\n\t\t\tthis._mouseX = (event.touches[0].clientX - boundingRect.left) * this._editorWidth / (boundingRect.right - boundingRect.left);\r\n\t\t\tthis._mouseY = (event.touches[0].clientY - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\r\n\t\t    if (isNaN(this._mouseX)) this._mouseX = 0;\r\n\t\t    if (isNaN(this._mouseY)) this._mouseY = 0;\r\n\t\t\tthis._usingTouch = true;\r\n\t\t\tthis._whenCursorPressed();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenCursorPressed(): void {\r\n\t\t\tthis._mouseDown = true;\r\n\t\t\tthis._mouseXStart = this._mouseX;\r\n\t\t\tthis._mouseYStart = this._mouseY;\r\n\t\t\tthis._mouseXPrev = this._mouseX;\r\n\t\t\tthis._mouseYPrev = this._mouseY;\r\n\t\t\tthis._updateCursorStatus();\r\n\t\t\tthis._updatePreview();\r\n\t\t\tthis._dragChange = new ChangeSequence();\r\n\t\t\tthis._doc.setProspectiveChange(this._dragChange);\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenMouseMoved = (event: MouseEvent): void => {\r\n\t\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\r\n    \t\tthis._mouseX = ((event.clientX || event.pageX) - boundingRect.left) * this._editorWidth / (boundingRect.right - boundingRect.left);\r\n\t\t    this._mouseY = ((event.clientY || event.pageY) - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\r\n\t\t    if (isNaN(this._mouseX)) this._mouseX = 0;\r\n\t\t    if (isNaN(this._mouseY)) this._mouseY = 0;\r\n\t\t\tthis._usingTouch = false;\r\n\t\t    this._whenCursorMoved();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenTouchMoved = (event: TouchEvent): void => {\r\n\t\t\tif (!this._mouseDown) return;\r\n\t\t\tevent.preventDefault();\r\n\t\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\r\n\t\t\tthis._mouseX = (event.touches[0].clientX - boundingRect.left) * this._editorWidth / (boundingRect.right - boundingRect.left);\r\n\t\t\tthis._mouseY = (event.touches[0].clientY - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\r\n\t\t    if (isNaN(this._mouseX)) this._mouseX = 0;\r\n\t\t    if (isNaN(this._mouseY)) this._mouseY = 0;\r\n\t\t    this._whenCursorMoved();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenCursorMoved(): void {\r\n\t\t\tlet start: number;\r\n\t\t\tlet end: number;\r\n\t\t\t\r\n\t\t\t// HACK: Undoable pattern changes rely on persistent instance\r\n\t\t\t// references. Loading song from hash via undo/redo breaks that,\r\n\t\t\t// so changes are no longer undoable and the cursor status may be\r\n\t\t\t// invalid. Abort further drag changes until the mouse is released.\r\n\t\t\tconst continuousState: boolean = this._doc.lastChangeWas(this._dragChange);\r\n\t\t\t\r\n\t\t\tif (this._mouseDown && this._cursor.valid && continuousState) {\r\n\t\t\t\tif (!this._mouseDragging) {\r\n\t\t\t\t\tconst dx: number = this._mouseX - this._mouseXStart;\r\n\t\t\t\t\tconst dy: number = this._mouseY - this._mouseYStart;\r\n\t\t\t\t\tif (Math.sqrt(dx * dx + dy * dy) > 5) {\r\n\t\t\t\t\t\tthis._mouseDragging = true;\r\n\t\t\t\t\t\tthis._mouseHorizontal = Math.abs(dx) >= Math.abs(dy);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (this._mouseDragging) {\r\n\t\t\t\t\tif (this._dragChange != null) {\r\n\t\t\t\t\t\tthis._dragChange.undo();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst currentPart: number = Math.floor(this._mouseX / this._partWidth);\r\n\t\t\t\t\tconst sequence: ChangeSequence = new ChangeSequence();\r\n\t\t\t\t\tthis._dragChange = sequence;\r\n\t\t\t\t\tthis._doc.setProspectiveChange(this._dragChange);\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (this._cursor.curNote == null) {\r\n\t\t\t\t\t\tlet backwards: boolean;\r\n\t\t\t\t\t\tlet directLength: number;\r\n\t\t\t\t\t\tif (currentPart < this._cursor.start) {\r\n\t\t\t\t\t\t\tbackwards = true;\r\n\t\t\t\t\t\t\tdirectLength = this._cursor.start - currentPart;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbackwards = false;\r\n\t\t\t\t\t\t\tdirectLength = currentPart - this._cursor.start + 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlet defaultLength: number = 1;\r\n\t\t\t\t\t\tfor (let i: number = 0; i <= this._doc.song.beatsPerBar * this._doc.song.partsPerBeat; i++) {\r\n\t\t\t\t\t\t\tif (i >= 5 &&\r\n\t\t\t\t\t\t\t    i % this._doc.song.partsPerBeat != 0 &&\r\n\t\t\t\t\t\t\t    i != this._doc.song.partsPerBeat * 3.0 / 2.0 &&\r\n\t\t\t\t\t\t\t    i != this._doc.song.partsPerBeat * 4.0 / 3.0 &&\r\n\t\t\t\t\t\t\t    i != this._doc.song.partsPerBeat * 5.0 / 3.0)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconst blessedLength: number = i;\r\n\t\t\t\t\t\t\tif (blessedLength == directLength) {\r\n\t\t\t\t\t\t\t\tdefaultLength = blessedLength;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (blessedLength < directLength) {\r\n\t\t\t\t\t\t\t\tdefaultLength = blessedLength;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (blessedLength > directLength) {\r\n\t\t\t\t\t\t\t\tif (defaultLength < directLength - 1) {\r\n\t\t\t\t\t\t\t\t\tdefaultLength = blessedLength;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t/*\r\n\t\t\t\t\t\tif (defaultLength < directLength) {\r\n\t\t\t\t\t\t\t// See if I can find a better match by snapping to an existing note...\r\n\t\t\t\t\t\t\t// E.G. in another channel\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t*/\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (backwards) {\r\n\t\t\t\t\t\t\tend = this._cursor.start;\r\n\t\t\t\t\t\t\tstart = end - defaultLength;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tstart = this._cursor.start;\r\n\t\t\t\t\t\t\tend = start + defaultLength;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (start < 0) start = 0;\r\n\t\t\t\t\t\tif (end > this._doc.song.beatsPerBar * this._doc.song.partsPerBeat) end = this._doc.song.beatsPerBar * this._doc.song.partsPerBeat;\r\n\t\t\t\t\t\tif (start < end) {\r\n\t\t\t\t\t\t\tsequence.append(new ChangeEnsurePatternExists(this._doc));\r\n\t\t\t\t\t\t\t\tconst pattern: Pattern | null = this._doc.getCurrentPattern();\r\n\t\t\t\t\t\t\t\tif (pattern == null) throw new Error();\r\n\t\t\t\t\t\t\t\tsequence.append(new ChangeNoteTruncate(this._doc, pattern, start, end));\r\n\t\t\t\t\t\t\tlet i: number;\r\n\t\t\t\t\t\t\tfor (i = 0; i < pattern.notes.length; i++) {\r\n\t\t\t\t\t\t\t\tif (pattern.notes[i].start >= end) break;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconst theNote: Note = makeNote(this._cursor.pitch, start, end, 3, this._doc.song.getChannelIsDrum(this._doc.channel));\r\n\t\t\t\t\t\t\tsequence.append(new ChangeNoteAdded(this._doc, pattern, theNote, i));\r\n\t\t\t\t\t\t\tthis._copyPins(theNote);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis._dragTime = backwards ? start : end;\r\n\t\t\t\t\t\t\tthis._dragPitch = this._cursor.pitch;\r\n\t\t\t\t\t\t\tthis._dragVolume = theNote.pins[backwards ? 0 : 1].volume;\r\n\t\t\t\t\t\t\tthis._dragVisible = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis._pattern = this._doc.getCurrentPattern();\r\n\t\t\t\t\t} else if (this._mouseHorizontal) {\r\n\t\t\t\t\t\tconst shift: number = Math.round((this._mouseX - this._mouseXStart) / this._partWidth);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tconst shiftedPin: NotePin = this._cursor.curNote.pins[this._cursor.nearPinIndex];\r\n\t\t\t\t\t\tlet shiftedTime: number = this._cursor.curNote.start + shiftedPin.time + shift;\r\n\t\t\t\t\t\tif (shiftedTime < 0) shiftedTime = 0;\r\n\t\t\t\t\t\tif (shiftedTime > this._doc.song.beatsPerBar * this._doc.song.partsPerBeat) shiftedTime = this._doc.song.beatsPerBar * this._doc.song.partsPerBeat;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (this._pattern == null) throw new Error();\r\n\r\n\t\t\t\t\t\tif (shiftedTime <= this._cursor.curNote.start && this._cursor.nearPinIndex == this._cursor.curNote.pins.length - 1 ||\r\n\t\t\t\t\t\t    shiftedTime >= this._cursor.curNote.end   && this._cursor.nearPinIndex == 0)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tsequence.append(new ChangeNoteAdded(this._doc, this._pattern, this._cursor.curNote, this._cursor.curIndex, true));\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis._dragVisible = false;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tstart = Math.min(this._cursor.curNote.start, shiftedTime);\r\n\t\t\t\t\t\t\tend   = Math.max(this._cursor.curNote.end,   shiftedTime);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis._dragTime = shiftedTime;\r\n\t\t\t\t\t\t\tthis._dragPitch = this._cursor.curNote.pitches[this._cursor.pitchIndex == -1 ? 0 : this._cursor.pitchIndex] + this._cursor.curNote.pins[this._cursor.nearPinIndex].interval;\r\n\t\t\t\t\t\t\tthis._dragVolume = this._cursor.curNote.pins[this._cursor.nearPinIndex].volume;\r\n\t\t\t\t\t\t\tthis._dragVisible = true;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (this._pattern == null) throw new Error();\r\n\r\n\t\t\t\t\t\t\tsequence.append(new ChangeNoteTruncate(this._doc, this._pattern, start, end, this._cursor.curNote));\r\n\t\t\t\t\t\t\tsequence.append(new ChangePinTime(this._doc, this._cursor.curNote, this._cursor.nearPinIndex, shiftedTime));\r\n\t\t\t\t\t\t\tthis._copyPins(this._cursor.curNote);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (this._cursor.pitchIndex == -1) {\r\n\t\t\t\t\t\tconst bendPart: number = Math.round(Math.max(this._cursor.curNote.start, Math.min(this._cursor.curNote.end, this._mouseX / this._partWidth))) - this._cursor.curNote.start;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlet prevPin: NotePin;\r\n\t\t\t\t\t\tlet nextPin: NotePin = this._cursor.curNote.pins[0];\r\n\t\t\t\t\t\tlet bendVolume: number = 0;\r\n\t\t\t\t\t\tlet bendInterval: number = 0;\r\n\t\t\t\t\t\tfor (let i: number = 1; i < this._cursor.curNote.pins.length; i++) {\r\n\t\t\t\t\t\t\tprevPin = nextPin;\r\n\t\t\t\t\t\t\tnextPin = this._cursor.curNote.pins[i];\r\n\t\t\t\t\t\t\tif (bendPart > nextPin.time) continue;\r\n\t\t\t\t\t\t\tif (bendPart < prevPin.time) throw new Error();\r\n\t\t\t\t\t\t\tconst volumeRatio: number = (bendPart - prevPin.time) / (nextPin.time - prevPin.time);\r\n\t\t\t\t\t\t\tbendVolume = Math.round(prevPin.volume * (1.0 - volumeRatio) + nextPin.volume * volumeRatio + ((this._mouseYStart - this._mouseY) / 20.0/*25.0*/));\r\n\t\t\t\t\t\t\tif (bendVolume < 0) bendVolume = 0;\r\n\t\t\t\t\t\t\tif (bendVolume > 3) bendVolume = 3;\r\n\t\t\t\t\t\t\tbendInterval = this._snapToPitch(prevPin.interval * (1.0 - volumeRatio) + nextPin.interval * volumeRatio + this._cursor.curNote.pitches[0], 0, Config.maxPitch) - this._cursor.curNote.pitches[0];\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tthis._dragTime = this._cursor.curNote.start + bendPart;\r\n\t\t\t\t\t\tthis._dragPitch = this._cursor.curNote.pitches[this._cursor.pitchIndex == -1 ? 0 : this._cursor.pitchIndex] + bendInterval;\r\n\t\t\t\t\t\tthis._dragVolume = bendVolume;\r\n\t\t\t\t\t\tthis._dragVisible = true;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tsequence.append(new ChangeVolumeBend(this._doc, this._cursor.curNote, bendPart, bendVolume, bendInterval));\r\n\t\t\t\t\t\tthis._copyPins(this._cursor.curNote);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis._dragVolume = this._cursor.curNote.pins[this._cursor.nearPinIndex].volume;\r\n\r\n\t\t\t\t\t\tif (this._pattern == null) throw new Error();\r\n\r\n\t\t\t\t\t\tlet bendStart: number;\r\n\t\t\t\t\t\tlet bendEnd: number;\r\n\t\t\t\t\t\tif (this._mouseX >= this._mouseXStart) {\r\n\t\t\t\t\t\t\tbendStart = this._cursor.part;\r\n\t\t\t\t\t\t\tbendEnd   = currentPart + 1;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbendStart = this._cursor.part + 1;\r\n\t\t\t\t\t\t\tbendEnd   = currentPart;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (bendEnd < 0) bendEnd = 0;\r\n\t\t\t\t\t\tif (bendEnd > this._doc.song.beatsPerBar * this._doc.song.partsPerBeat) bendEnd = this._doc.song.beatsPerBar * this._doc.song.partsPerBeat;\r\n\t\t\t\t\t\tif (bendEnd > this._cursor.curNote.end) {\r\n\t\t\t\t\t\t\tsequence.append(new ChangeNoteTruncate(this._doc, this._pattern, this._cursor.curNote.start, bendEnd, this._cursor.curNote));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (bendEnd < this._cursor.curNote.start) {\r\n\t\t\t\t\t\t\tsequence.append(new ChangeNoteTruncate(this._doc, this._pattern, bendEnd, this._cursor.curNote.end, this._cursor.curNote));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlet minPitch: number = Number.MAX_VALUE;\r\n\t\t\t\t\t\tlet maxPitch: number = -Number.MAX_VALUE;\r\n\t\t\t\t\t\tfor (const pitch of this._cursor.curNote.pitches) {\r\n\t\t\t\t\t\t\tif (minPitch > pitch) minPitch = pitch;\r\n\t\t\t\t\t\t\tif (maxPitch < pitch) maxPitch = pitch;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tminPitch -= this._cursor.curNote.pitches[this._cursor.pitchIndex];\r\n\t\t\t\t\t\tmaxPitch -= this._cursor.curNote.pitches[this._cursor.pitchIndex];\r\n\t\t\t\t\t\tconst bendTo: number = this._snapToPitch(this._findMousePitch(this._mouseY), -minPitch, (this._doc.song.getChannelIsDrum(this._doc.channel) ? Config.drumCount-1 : Config.maxPitch) - maxPitch);\r\n\t\t\t\t\t\tsequence.append(new ChangePitchBend(this._doc, this._cursor.curNote, bendStart, bendEnd, bendTo, this._cursor.pitchIndex));\r\n\t\t\t\t\t\tthis._copyPins(this._cursor.curNote);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tthis._dragTime = bendEnd;\r\n\t\t\t\t\t\tthis._dragPitch = bendTo;\r\n\t\t\t\t\t\tthis._dragVisible = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis._mouseXPrev = this._mouseX;\r\n\t\t\t\tthis._mouseYPrev = this._mouseY;\r\n\t\t\t} else {\r\n\t\t\t\tthis._updateCursorStatus();\r\n\t\t\t\tthis._updatePreview();\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenCursorReleased = (event: Event): void => {\r\n\t\t\tif (!this._cursor.valid) return;\r\n\t\t\tconst continuousState: boolean = this._doc.lastChangeWas(this._dragChange);\r\n\t\t\tif (this._mouseDragging && continuousState) {\r\n\t\t\t\tif (this._dragChange != null) {\r\n\t\t\t\t\tthis._doc.record(this._dragChange);\r\n\t\t\t\t\tthis._dragChange = null;\r\n\t\t\t\t}\r\n\t\t\t} else if (this._mouseDown && continuousState) {\r\n\t\t\t\tif (this._cursor.curNote == null) {\r\n\t\t\t\t\tconst note: Note = makeNote(this._cursor.pitch, this._cursor.start, this._cursor.end, 3, this._doc.song.getChannelIsDrum(this._doc.channel));\r\n\t\t\t\t\tnote.pins = [];\r\n\t\t\t\t\tfor (const oldPin of this._cursor.pins) {\r\n\t\t\t\t\t\tnote.pins.push(makeNotePin(0, oldPin.time, oldPin.volume));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst sequence: ChangeSequence = new ChangeSequence();\r\n\t\t\t\t\tsequence.append(new ChangeEnsurePatternExists(this._doc));\r\n\t\t\t\t\tconst pattern: Pattern | null = this._doc.getCurrentPattern();\r\n\t\t\t\t\tif (pattern == null) throw new Error();\r\n\t\t\t\t\tsequence.append(new ChangeNoteAdded(this._doc, pattern, note, this._cursor.curIndex));\r\n\t\t\t\t\tthis._doc.record(sequence);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (this._pattern == null) throw new Error();\r\n\t\t\t\t\tif (this._cursor.pitchIndex == -1) {\r\n\t\t\t\t\t\tconst sequence: ChangeSequence = new ChangeSequence();\r\n\t\t\t\t\t\tif (this._cursor.curNote.pitches.length == 4) {\r\n\t\t\t\t\t\t\tsequence.append(new ChangePitchAdded(this._doc, this._cursor.curNote, this._cursor.curNote.pitches[0], 0, true));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsequence.append(new ChangePitchAdded(this._doc, this._cursor.curNote, this._cursor.pitch, this._cursor.curNote.pitches.length));\r\n\t\t\t\t\t\tthis._doc.record(sequence);\r\n\t\t\t\t\t\tthis._copyPins(this._cursor.curNote);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (this._cursor.curNote.pitches.length == 1) {\r\n\t\t\t\t\t\t\tthis._doc.record(new ChangeNoteAdded(this._doc, this._pattern, this._cursor.curNote, this._cursor.curIndex, true));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis._doc.record(new ChangePitchAdded(this._doc, this._cursor.curNote, this._cursor.pitch, this._cursor.curNote.pitches.indexOf(this._cursor.pitch), true));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._mouseDown = false;\r\n\t\t\tthis._mouseDragging = false;\r\n\t\t\tthis._updateCursorStatus();\r\n\t\t\tthis._updatePreview();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _updatePreview(): void {\r\n\t\t\tif (this._usingTouch) {\r\n\t\t\t\tif (!this._mouseDown || !this._cursor.valid  || !this._mouseDragging || !this._dragVisible) {\r\n\t\t\t\t\tthis._svgPreview.setAttribute(\"visibility\", \"hidden\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._svgPreview.setAttribute(\"visibility\", \"visible\");\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst x: number = this._partWidth * this._dragTime;\r\n\t\t\t\t\tconst y: number = this._pitchToPixelHeight(this._dragPitch - this._octaveOffset);\r\n\t\t\t\t\tconst radius: number = this._pitchHeight / 2;\r\n\t\t\t\t\tconst width: number = 80;\r\n\t\t\t\t\tconst height: number = 60;\r\n\t\t\t\t\t//this._drawNote(this._svgPreview, this._cursor.pitch, this._cursor.start, this._cursor.pins, this._pitchHeight / 2 + 1, true, this._octaveOffset);\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet pathString: string = \"\";\r\n\t\t\t\t\t\r\n\t\t\t\t\tpathString += \"M \" + prettyNumber(x) + \" \" + prettyNumber(y - radius * (this._dragVolume / 3.0)) + \" \";\r\n\t\t\t\t\tpathString += \"L \" + prettyNumber(x) + \" \" + prettyNumber(y - radius * (this._dragVolume / 3.0) - height) + \" \";\r\n\t\t\t\t\tpathString += \"M \" + prettyNumber(x) + \" \" + prettyNumber(y + radius * (this._dragVolume / 3.0)) + \" \";\r\n\t\t\t\t\tpathString += \"L \" + prettyNumber(x) + \" \" + prettyNumber(y + radius * (this._dragVolume / 3.0) + height) + \" \";\r\n\t\t\t\t\tpathString += \"M \" + prettyNumber(x) + \" \" + prettyNumber(y - radius * (this._dragVolume / 3.0)) + \" \";\r\n\t\t\t\t\tpathString += \"L \" + prettyNumber(x + width) + \" \" + prettyNumber(y - radius * (this._dragVolume / 3.0)) + \" \";\r\n\t\t\t\t\tpathString += \"M \" + prettyNumber(x) + \" \" + prettyNumber(y + radius * (this._dragVolume / 3.0)) + \" \";\r\n\t\t\t\t\tpathString += \"L \" + prettyNumber(x + width) + \" \" + prettyNumber(y + radius * (this._dragVolume / 3.0)) + \" \";\r\n\t\t\t\t\tpathString += \"M \" + prettyNumber(x) + \" \" + prettyNumber(y - radius * (this._dragVolume / 3.0)) + \" \";\r\n\t\t\t\t\tpathString += \"L \" + prettyNumber(x - width) + \" \" + prettyNumber(y - radius * (this._dragVolume / 3.0)) + \" \";\r\n\t\t\t\t\tpathString += \"M \" + prettyNumber(x) + \" \" + prettyNumber(y + radius * (this._dragVolume / 3.0)) + \" \";\r\n\t\t\t\t\tpathString += \"L \" + prettyNumber(x - width) + \" \" + prettyNumber(y + radius * (this._dragVolume / 3.0)) + \" \";\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis._svgPreview.setAttribute(\"d\", pathString);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (!this._mouseOver || this._mouseDown || !this._cursor.valid) {\r\n\t\t\t\t\tthis._svgPreview.setAttribute(\"visibility\", \"hidden\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._svgPreview.setAttribute(\"visibility\", \"visible\");\r\n\t\t\t\t\tthis._drawNote(this._svgPreview, this._cursor.pitch, this._cursor.start, this._cursor.pins, this._pitchHeight / 2 + 1, true, this._octaveOffset);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\t\r\n\t\tprivate _documentChanged = (): void => {\r\n\t\t\tthis._editorWidth = this._doc.prefs.showLetters ? (this._doc.prefs.showScrollBar ? 460 : 480) : (this._doc.prefs.showScrollBar ? 492 : 512);\r\n\t\t\tthis._pattern = this._doc.getCurrentPattern();\r\n\t\t\tthis._partWidth = this._editorWidth / (this._doc.song.beatsPerBar * this._doc.song.partsPerBeat);\r\n\t\t\tthis._pitchHeight = this._doc.song.getChannelIsDrum(this._doc.channel) ? this._defaultDrumHeight : this._defaultPitchHeight;\r\n\t\t\tthis._pitchCount = this._doc.song.getChannelIsDrum(this._doc.channel) ? Config.drumCount : Config.pitchCount;\r\n\t\t\tthis._octaveOffset = this._doc.song.channels[this._doc.channel].octave * 12;\r\n\t\t\t\r\n\t\t\tif (this._renderedPartsPerBeat != this._doc.song.partsPerBeat || \r\n\t\t\t\tthis._renderedPitchChannelCount != this._doc.song.pitchChannelCount || \r\n\t\t\t\tthis._renderedDrumChannelCount != this._doc.song.drumChannelCount)\r\n\t\t\t{\r\n\t\t\t\tthis._renderedPartsPerBeat = this._doc.song.partsPerBeat;\r\n\t\t\t\tthis._renderedPitchChannelCount = this._doc.song.pitchChannelCount;\r\n\t\t\t\tthis._renderedDrumChannelCount = this._doc.song.drumChannelCount;\r\n\t\t\t\tthis.resetCopiedPins();\r\n\t\t\t}\r\n\t\t\t\r\n\r\n\r\n\t\t\tthis._copiedPins = this._copiedPinChannels[this._doc.channel];\r\n\t\t\t\r\n\t\t\tif (this._renderedWidth != this._editorWidth) {\r\n\t\t\t\tthis._renderedWidth = this._editorWidth;\r\n\t\t\t\t//this._svg.setAttribute(\"width\", \"\" + this._editorWidth);\r\n\t\t\t\tthis._svg.setAttribute(\"viewBox\", \"0 0 \" + this._editorWidth + \" 481\");\r\n\t\t\t\tthis._svgBackground.setAttribute(\"width\", \"\" + this._editorWidth);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst beatWidth = this._editorWidth / this._doc.song.beatsPerBar;\r\n\t\t\tif (this._renderedBeatWidth != beatWidth) {\r\n\t\t\t\tthis._renderedBeatWidth = beatWidth;\r\n\t\t\t\tthis._svgNoteBackground.setAttribute(\"width\", \"\" + beatWidth);\r\n\t\t\t\tthis._svgDrumBackground.setAttribute(\"width\", \"\" + beatWidth);\r\n\t\t\t\tthis._backgroundDrumRow.setAttribute(\"width\", \"\" + (beatWidth - 2));\r\n\t\t\t\tfor (let j: number = 0; j < 12; j++) {\r\n\t\t\t\t\tthis._backgroundPitchRows[j].setAttribute(\"width\", \"\" + (beatWidth - 2));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (!this._mouseDown) this._updateCursorStatus();\r\n\t\t\t\r\n\t\t\tthis._svgNoteContainer = <SVGSVGElement> makeEmptyReplacementElement(this._svgNoteContainer);\r\n\t\t\t\r\n\t\t\tthis._updatePreview();\r\n\t\t\r\n\t\t\tfor (let j: number = 0; j < 12; j++) {\r\n\t\t\t\tthis._backgroundPitchRows[j].style.visibility = Config.scales[this._doc.song.scale].flags[j] ? \"visible\" : \"hidden\";\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (this._doc.song.getChannelIsDrum(this._doc.channel)) {\r\n\t\t\t\tif (!this._renderedDrums) {\r\n\t\t\t\t\tthis._renderedDrums = true;\r\n\t\t\t\t\tthis._svgBackground.setAttribute(\"fill\", \"url(#patternEditorDrumBackground)\");\r\n\t\t\t\t\tthis._svgBackground.setAttribute(\"height\", \"\" + (this._defaultDrumHeight * Config.drumCount));\r\n\t\t\t\t\t//this._svg.setAttribute(\"height\", \"\" + (this._defaultDrumHeight * Config.drumCount));\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (this._renderedDrums) {\r\n\t\t\t\t\tthis._renderedDrums = false;\r\n\t\t\t\t\tthis._svgBackground.setAttribute(\"fill\", \"url(#patternEditorNoteBackground)\");\r\n\t\t\t\t\tthis._svgBackground.setAttribute(\"height\", \"\" + this._editorHeight);\r\n\t\t\t\t\t//this._svg.setAttribute(\"height\", \"\" + this._editorHeight);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (this._doc.prefs.showChannels) {\r\n\t\t\t\tfor (let channel: number = this._doc.song.getChannelCount() - 1; channel >= 0; channel--) {\r\n\t\t\t\t\tif (channel == this._doc.channel) continue;\r\n\t\t\t\t\tif (this._doc.song.getChannelIsDrum(channel) != this._doc.song.getChannelIsDrum(this._doc.channel)) continue;\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst pattern2: Pattern | null = this._doc.song.getPattern(channel, this._doc.bar);\r\n\t\t\t\t\tif (pattern2 == null) continue;\r\n\t\t\t\t\tfor (const note of pattern2.notes) {\r\n\t\t\t\t\t\tfor (const pitch of note.pitches) {\r\n\t\t\t\t\t\t\tconst notePath: SVGPathElement = <SVGPathElement> SVG.path();\r\n\t\t\t\t\t\t\tnotePath.setAttribute(\"fill\", ColorConfig.getChannelColor(this._doc.song, channel).secondaryNote);\r\n\t\t\t\t\t\t\tnotePath.setAttribute(\"pointer-events\", \"none\");\r\n\t\t\t\t\t\t\tthis._drawNote(notePath, pitch, note.start, note.pins, this._pitchHeight * 0.19, false, this._doc.song.channels[channel].octave * 12);\r\n\t\t\t\t\t\t\tthis._svgNoteContainer.appendChild(notePath);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (this._pattern != null) {\r\n\t\t\t\tfor (const note of this._pattern.notes) {\r\n\t\t\t\t\tfor (let i: number = 0; i < note.pitches.length; i++) {\r\n\t\t\t\t\t\tconst pitch: number = note.pitches[i];\r\n\t\t\t\t\t\tlet notePath = <SVGPathElement> SVG.path();\r\n\t\t\t\t\t\tnotePath.setAttribute(\"fill\", ColorConfig.getChannelColor(this._doc.song, this._doc.channel).secondaryChannel);\r\n\t\t\t\t\t\tnotePath.setAttribute(\"pointer-events\", \"none\");\r\n\t\t\t\t\t\tthis._drawNote(notePath, pitch, note.start, note.pins, this._pitchHeight / 2 + 1, false, this._octaveOffset);\r\n\t\t\t\t\t\tthis._svgNoteContainer.appendChild(notePath);\r\n\t\t\t\t\t\tnotePath = <SVGPathElement> SVG.path();\r\n\t\t\t\t\t\tnotePath.setAttribute(\"fill\", ColorConfig.getChannelColor(this._doc.song, this._doc.channel).primaryNote);\r\n\t\t\t\t\t\tnotePath.setAttribute(\"pointer-events\", \"none\");\r\n\t\t\t\t\t\tthis._drawNote(notePath, pitch, note.start, note.pins, this._pitchHeight / 2 + 1, true, this._octaveOffset);\r\n\t\t\t\t\t\tthis._svgNoteContainer.appendChild(notePath);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (note.pitches.length > 1/* && !this._doc.song.getChannelIsDrum(this._doc.channel)*/) {\r\n\t\t\t\t\t\t\t// const instrumentType: InstrumentType = this._doc.song.channels[this._doc.channel].instruments[this._doc.getCurrentInstrument()].type;\r\n\t\t\t\t\t\t\t// if (instrumentType == InstrumentType.fm) {\r\n\t\t\t\t\t\t\t\tlet oscillatorLabel = <SVGTextElement> SVG.text();\r\n\t\t\t\t\t\t\t\toscillatorLabel.setAttribute(\"x\", \"\" + prettyNumber(this._partWidth * note.start + 2));\r\n\t\t\t\t\t\t\t\toscillatorLabel.setAttribute(\"y\", \"\" + prettyNumber(this._pitchToPixelHeight(pitch - this._octaveOffset)));\r\n\t\t\t\t\t\t\t\toscillatorLabel.setAttribute(\"width\", \"30\");\r\n\t\t\t\t\t\t\t\toscillatorLabel.setAttribute(\"fill\", \"black\");\r\n\t\t\t\t\t\t\t\toscillatorLabel.setAttribute(\"text-anchor\", \"start\");\r\n\t\t\t\t\t\t\t\toscillatorLabel.setAttribute(\"dominant-baseline\", \"central\");\r\n\t\t\t\t\t\t\t\toscillatorLabel.setAttribute(\"pointer-events\", \"none\");\r\n\t\t\t\t\t\t\t\toscillatorLabel.textContent = \"\" + (i + 1);\r\n\t\t\t\t\t\t\t\tthis._svgNoteContainer.appendChild(oscillatorLabel);\r\n\t\t\t\t\t\t\t// }\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\tpublic render(): void {\r\n\r\n\t\t\tif (this._doc.prefs.showMore == false) {\r\n\r\n\t\t\t\tif (this._renderedFifths != this._doc.prefs.showFifth) {\r\n\t\t\t\t\tthis._renderedFifths = this._doc.prefs.showFifth;\r\n\t\t\t\t\tthis._backgroundPitchRows[7].setAttribute(\"fill\", this._doc.prefs.showFifth ? ColorConfig.fifthNote : ColorConfig.pitchBackground);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this._renderedPiano == true) {\r\n\t\t\t\t\tthis._renderedPiano = false;\r\n\t\t\t\t}\r\n\t\t\tif (this._renderedACS != this._doc.prefs.showMore) {\r\n\t\t\t\tthis._backgroundPitchRows[0].setAttribute(\"fill\", ColorConfig.tonic);\r\n\t\t\t\tthis._backgroundPitchRows[1].setAttribute(\"fill\", this._doc.prefs.showMore ? ColorConfig.pitch1Background : ColorConfig.pitchBackground);\r\n\t\t\t\tthis._backgroundPitchRows[2].setAttribute(\"fill\", this._doc.prefs.showMore ? ColorConfig.pitch2Background : ColorConfig.pitchBackground);\r\n\t\t\t\tthis._backgroundPitchRows[3].setAttribute(\"fill\", this._doc.prefs.showMore ? ColorConfig.pitch3Background : ColorConfig.pitchBackground);\r\n\t\t\t\tthis._backgroundPitchRows[4].setAttribute(\"fill\", this._doc.prefs.showMore ? ColorConfig.pitch4Background : ColorConfig.pitchBackground);\r\n\t\t\t\tthis._backgroundPitchRows[5].setAttribute(\"fill\", this._doc.prefs.showMore ? ColorConfig.pitch5Background : ColorConfig.pitchBackground);\r\n\t\t\t\tthis._backgroundPitchRows[6].setAttribute(\"fill\", this._doc.prefs.showMore ? ColorConfig.pitch6Background : ColorConfig.pitchBackground);\r\n\t\t\t\tthis._backgroundPitchRows[7].setAttribute(\"fill\", this._doc.prefs.showFifth ? ColorConfig.fifthNote : ColorConfig.pitchBackground);\r\n\t\t\t\tthis._backgroundPitchRows[8].setAttribute(\"fill\", this._doc.prefs.showMore ? ColorConfig.pitch8Background : ColorConfig.pitchBackground);\r\n\t\t\t\tthis._backgroundPitchRows[9].setAttribute(\"fill\", this._doc.prefs.showMore ? ColorConfig.pitch9Background : ColorConfig.pitchBackground);\r\n\t\t\t\tthis._backgroundPitchRows[10].setAttribute(\"fill\", this._doc.prefs.showMore ? ColorConfig.pitch10Background : ColorConfig.pitchBackground);\r\n\t\t\t\tthis._backgroundPitchRows[11].setAttribute(\"fill\", this._doc.prefs.showMore ? ColorConfig.pitch11Background : ColorConfig.pitchBackground);\r\n\t\t\t\tthis._renderedACS = this._doc.prefs.showMore;\r\n\t\t\t\tconsole.log(\"this._renderedACS (acs disabled): \"+this._renderedACS);\r\n\t\t\t}\r\n\t\t\tthis._setKey = -1;\r\n\t\t} else {\r\n\t\t\tif (ColorConfig.usesPianoScheme == false) {\r\n\t\t\t\tif (this._renderedACS != this._doc.prefs.showMore || this._renderedPiano == true) {\r\n\t\t\t\t\tthis._backgroundPitchRows[0].setAttribute(\"fill\", this._doc.prefs.showMore ? ColorConfig.tonic : ColorConfig.tonic);\r\n\t\t\t\t\tthis._backgroundPitchRows[1].setAttribute(\"fill\", this._doc.prefs.showMore ? ColorConfig.pitch1Background :  ColorConfig.pitchBackground);\r\n\t\t\t\t\tthis._backgroundPitchRows[2].setAttribute(\"fill\", this._doc.prefs.showMore ? ColorConfig.pitch2Background :  ColorConfig.pitchBackground);\r\n\t\t\t\t\tthis._backgroundPitchRows[3].setAttribute(\"fill\", this._doc.prefs.showMore ? ColorConfig.pitch3Background :  ColorConfig.pitchBackground);\r\n\t\t\t\t\tthis._backgroundPitchRows[4].setAttribute(\"fill\", this._doc.prefs.showMore ? ColorConfig.pitch4Background :  ColorConfig.pitchBackground);\r\n\t\t\t\t\tthis._backgroundPitchRows[5].setAttribute(\"fill\", this._doc.prefs.showMore ? ColorConfig.pitch5Background :  ColorConfig.pitchBackground);\r\n\t\t\t\t\tthis._backgroundPitchRows[6].setAttribute(\"fill\", this._doc.prefs.showMore ? ColorConfig.pitch6Background :  ColorConfig.pitchBackground);\r\n\t\t\t\t\tthis._backgroundPitchRows[7].setAttribute(\"fill\", this._doc.prefs.showFifth ? ColorConfig.fifthNote : ColorConfig.pitchBackground);\r\n\t\t\t\t\tthis._backgroundPitchRows[8].setAttribute(\"fill\", this._doc.prefs.showMore ? ColorConfig.pitch8Background : ColorConfig.pitchBackground);\r\n\t\t\t\t\tthis._backgroundPitchRows[9].setAttribute(\"fill\", this._doc.prefs.showMore ? ColorConfig.pitch9Background : ColorConfig.pitchBackground);\r\n\t\t\t\t\tthis._backgroundPitchRows[10].setAttribute(\"fill\", this._doc.prefs.showMore ? ColorConfig.pitch10Background : ColorConfig.pitchBackground);\r\n\t\t\t\t\tthis._backgroundPitchRows[11].setAttribute(\"fill\", this._doc.prefs.showMore ? ColorConfig.pitch11Background : ColorConfig.pitchBackground);\r\n\t\t\t\t\tthis._renderedACS = this._doc.prefs.showMore;\r\n\t\t\t\t\tconsole.log(\"this._renderedACS (acs enabled): \"+this._renderedACS);\r\n\t\t\t\t} \r\n\t\t\t\tif (this._renderedPiano == true) {\r\n\t\t\t\t\tthis._renderedPiano = false;\r\n\t\t\t\t\tthis._setKey = -1;\r\n\t\t\t\t\tconsole.log(\"this._renderedACS (disabiling piano): \"+this._renderedACS);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (this._setKey != this._doc.song.key) {\r\n\t\t\t\t\t\tthis._setKey = this._doc.song.key;\r\n\t\t\t\t\t\tthis._renderedPiano = true;\r\n\t\t\t\t\t\tconsole.log(\"piano key\"+this._setKey);\r\n\t\t\t\t\t\tif ( (this._setKey == 0 ) || (this._setKey == 2 ) || (this._setKey == 4 ) || (this._setKey == 6 ) || (this._setKey == 7 ) || (this._setKey == 9 ) || (this._setKey == 11 )) {\r\n\t\t\t\t\t\t\tthis._backgroundPitchRows[0].setAttribute(\"fill\", this._doc.prefs.showMore ? \"var(--white-tonic, var(--pitch-white-key, var(--pitch-background)))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis._backgroundPitchRows[0].setAttribute(\"fill\", this._doc.prefs.showMore ? \"var(--black-tonic, var(--pitch-black-key, var(--pitch-background))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ((this._setKey == 0 ) || (this._setKey == 1 ) || (this._setKey == 3 ) || (this._setKey == 5 )|| (this._setKey == 7 ) ||(this._setKey == 8 ) || (this._setKey == 10)) {\r\n\t\t\t\t\t\t\tthis._backgroundPitchRows[1].setAttribute(\"fill\", this._doc.prefs.showMore ? \"var(--pitch-white-key, var(--pitch-background))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis._backgroundPitchRows[1].setAttribute(\"fill\", this._doc.prefs.showMore ? \"var(--pitch-black-key, var(--pitch-background))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ((this._setKey == 1 )||(this._setKey == 2 )||(this._setKey == 4 )||(this._setKey == 6 )||(this._setKey == 8 )||(this._setKey == 9 )||(this._setKey == 11)) {\r\n\t\t\t\t\t\t\tthis._backgroundPitchRows[2].setAttribute(\"fill\", this._doc.prefs.showMore ? \"var(--pitch-white-key, var(--pitch-background))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis._backgroundPitchRows[2].setAttribute(\"fill\", this._doc.prefs.showMore ? \"var(--pitch-black-key, var(--pitch-background))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ((this._setKey == 0 ) ||(this._setKey == 2 )||(this._setKey == 3 )||(this._setKey == 5 )||(this._setKey == 7 )||(this._setKey == 9 )||(this._setKey == 10)) {\r\n\t\t\t\t\t\t\tthis._backgroundPitchRows[3].setAttribute(\"fill\", this._doc.prefs.showMore ? \"var(--pitch-white-key, var(--pitch-background))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis._backgroundPitchRows[3].setAttribute(\"fill\", this._doc.prefs.showMore ? \"var(--pitch-black-key, var(--pitch-background))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ((this._setKey == 1) ||(this._setKey == 3 )||(this._setKey == 4 )||(this._setKey == 6 )||(this._setKey == 8 )||(this._setKey == 10 )||(this._setKey == 11)) {\r\n\t\t\t\t\t\t\tthis._backgroundPitchRows[4].setAttribute(\"fill\", this._doc.prefs.showMore ? \" var(--pitch-white-key, var(--pitch-background))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis._backgroundPitchRows[4].setAttribute(\"fill\", this._doc.prefs.showMore ? \" var(--pitch-black-key, var(--pitch-background))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ((this._setKey == 0 )||(this._setKey == 2 )||(this._setKey == 4 )||(this._setKey == 5 )||(this._setKey == 7 )||(this._setKey == 9 )||(this._setKey == 11)) {\r\n\t\t\t\t\t\t\tthis._backgroundPitchRows[5].setAttribute(\"fill\", this._doc.prefs.showMore ? \"var(--pitch-white-key, var(--pitch-background))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis._backgroundPitchRows[5].setAttribute(\"fill\", this._doc.prefs.showMore ? \"var(--pitch-black-key, var(--pitch-background))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ((this._setKey == 0 ) ||(this._setKey == 1 )||(this._setKey == 3 )||(this._setKey == 5 )||(this._setKey == 6 )||(this._setKey == 8 )||(this._setKey == 10)) {\r\n\t\t\t\t\t\t\tthis._backgroundPitchRows[6].setAttribute(\"fill\", this._doc.prefs.showMore ? \"var(--pitch-white-key, var(--pitch-background))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis._backgroundPitchRows[6].setAttribute(\"fill\", this._doc.prefs.showMore ? \"var(--pitch-black-key, var(--pitch-background))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ((this._setKey == 1) ||(this._setKey == 2) ||(this._setKey == 4 )||(this._setKey == 6 )||(this._setKey == 7 )||(this._setKey == 9 )||(this._setKey == 11)) {\r\n\t\t\t\t\t\t\tif (this._doc.prefs.showFifth == true) {\r\n\t\t\t\t\t\t\t\tthis._backgroundPitchRows[7].setAttribute(\"fill\", this._doc.prefs.showMore ? \"var(--white-fifth-note, var(--pitch-white-key, var(--pitch-background)))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis._backgroundPitchRows[7].setAttribute(\"fill\", this._doc.prefs.showMore ? \" var(--pitch-white-key, var(--pitch-background))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (this._doc.prefs.showFifth == true) {\r\n\t\t\t\t\t\t\t\tthis._backgroundPitchRows[7].setAttribute(\"fill\", this._doc.prefs.showMore ? \"var(--black-fifth-note, var(--pitch-black-key, var(--pitch-background)))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis._backgroundPitchRows[7].setAttribute(\"fill\", this._doc.prefs.showMore ? \"var(--pitch-black-key, var(--pitch-background))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ((this._setKey == 0 ) || (this._setKey == 2 ) || (this._setKey == 3 ) || (this._setKey == 5) || (this._setKey == 7) || (this._setKey == 8) || (this._setKey == 10)) {\r\n\t\t\t\t\t\t\tthis._backgroundPitchRows[8].setAttribute(\"fill\", this._doc.prefs.showMore ? \"var(--pitch-white-key, var(--pitch-background))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis._backgroundPitchRows[8].setAttribute(\"fill\", this._doc.prefs.showMore ? \"var(--pitch-black-key, var(--pitch-background))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ((this._setKey == 1 )|| (this._setKey ==3 )||(this._setKey == 4 )||(this._setKey == 6 )||(this._setKey == 8 )||(this._setKey == 9 )||(this._setKey == 11)) {\r\n\t\t\t\t\t\t\tthis._backgroundPitchRows[9].setAttribute(\"fill\", this._doc.prefs.showMore ? \"var(--pitch-white-key, var(--pitch-background))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis._backgroundPitchRows[9].setAttribute(\"fill\", this._doc.prefs.showMore ? \"var(--pitch-black-key, var(--pitch-background))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ((this._setKey == 0) ||(this._setKey == 2 )||(this._setKey == 4 )||(this._setKey == 5 )||(this._setKey == 7 )||(this._setKey == 9) ||(this._setKey == 10)) {\r\n\t\t\t\t\t\t\tthis._backgroundPitchRows[10].setAttribute(\"fill\", this._doc.prefs.showMore ? \"var(--pitch-white-key, var(--pitch-background))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis._backgroundPitchRows[10].setAttribute(\"fill\", this._doc.prefs.showMore ? \"var(--pitch-black-key, var(--pitch-background))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ((this._setKey == 1 )||(this._setKey == 3 )||(this._setKey == 5 )||(this._setKey == 6 )||(this._setKey == 8 )||(this._setKey == 10 )||(this._setKey == 11)) {\r\n\t\t\t\t\t\t\tthis._backgroundPitchRows[11].setAttribute(\"fill\", this._doc.prefs.showMore ? \"var(--pitch-white-key, var(--pitch-background))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis._backgroundPitchRows[11].setAttribute(\"fill\", this._doc.prefs.showMore ? \"var(--pitch-black-key, var(--pitch-background))\" : ColorConfig.pitchBackground);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\tif (this._renderedACS != this._doc.prefs.showMore) {\r\n\t\t\t\t\tthis._renderedACS = this._doc.prefs.showMore;\r\n\t\t\t\t\tconsole.log(\"this._renderedACS (in piano): \"+this._renderedACS);\r\n\t\t\t\t\t}\r\n\t\t\t\t} \r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t\tprivate _drawNote(svgElement: SVGPathElement, pitch: number, start: number, pins: NotePin[], radius: number, showVolume: boolean, offset: number): void {\r\n\t\t\tlet nextPin: NotePin = pins[0];\r\n\t\t\tlet pathString: string = \"M \" + prettyNumber(this._partWidth * (start + nextPin.time) + 1) + \" \" + prettyNumber(this._pitchToPixelHeight(pitch - offset) + radius * (showVolume ? nextPin.volume / 3.0 : 1.0)) + \" \";\r\n\t\t\tfor (let i: number = 1; i < pins.length; i++) {\r\n\t\t\t\tlet prevPin: NotePin = nextPin;\r\n\t\t\t\tnextPin = pins[i];\r\n\t\t\t\tlet prevSide: number = this._partWidth * (start + prevPin.time) + (i == 1 ? 1 : 0);\r\n\t\t\t\tlet nextSide: number = this._partWidth * (start + nextPin.time) - (i == pins.length - 1 ? 1 : 0);\r\n\t\t\t\tlet prevHeight: number = this._pitchToPixelHeight(pitch + prevPin.interval - offset);\r\n\t\t\t\tlet nextHeight: number = this._pitchToPixelHeight(pitch + nextPin.interval - offset);\r\n\t\t\t\tlet prevVolume: number = showVolume ? prevPin.volume / 3.0 : 1.0;\r\n\t\t\t\tlet nextVolume: number = showVolume ? nextPin.volume / 3.0 : 1.0;\r\n\t\t\t\tpathString += \"L \" + prettyNumber(prevSide) + \" \" + prettyNumber(prevHeight - radius * prevVolume) + \" \";\r\n\t\t\t\tif (prevPin.interval > nextPin.interval) pathString += \"L \" + prettyNumber(prevSide + 1) + \" \" + prettyNumber(prevHeight - radius * prevVolume) + \" \";\r\n\t\t\t\tif (prevPin.interval < nextPin.interval) pathString += \"L \" + prettyNumber(nextSide - 1) + \" \" + prettyNumber(nextHeight - radius * nextVolume) + \" \";\r\n\t\t\t\tpathString += \"L \" + prettyNumber(nextSide) + \" \" + prettyNumber(nextHeight - radius * nextVolume) + \" \";\r\n\t\t\t}\r\n\t\t\tfor (let i: number = pins.length - 2; i >= 0; i--) {\r\n\t\t\t\tlet prevPin: NotePin = nextPin;\r\n\t\t\t\tnextPin = pins[i];\r\n\t\t\t\tlet prevSide: number = this._partWidth * (start + prevPin.time) - (i == pins.length - 2 ? 1 : 0);\r\n\t\t\t\tlet nextSide: number = this._partWidth * (start + nextPin.time) + (i == 0 ? 1 : 0);\r\n\t\t\t\tlet prevHeight: number = this._pitchToPixelHeight(pitch + prevPin.interval - offset);\r\n\t\t\t\tlet nextHeight: number = this._pitchToPixelHeight(pitch + nextPin.interval - offset);\r\n\t\t\t\tlet prevVolume: number = showVolume ? prevPin.volume / 3.0 : 1.0;\r\n\t\t\t\tlet nextVolume: number = showVolume ? nextPin.volume / 3.0 : 1.0;\r\n\t\t\t\tpathString += \"L \" + prettyNumber(prevSide) + \" \" + prettyNumber(prevHeight + radius * prevVolume) + \" \";\r\n\t\t\t\tif (prevPin.interval < nextPin.interval) pathString += \"L \" + prettyNumber(prevSide - 1) + \" \" + prettyNumber(prevHeight + radius * prevVolume) + \" \";\r\n\t\t\t\tif (prevPin.interval > nextPin.interval) pathString += \"L \" + prettyNumber(nextSide + 1) + \" \" + prettyNumber(nextHeight + radius * nextVolume) + \" \";\r\n\t\t\t\tpathString += \"L \" + prettyNumber(nextSide) + \" \" + prettyNumber(nextHeight + radius * nextVolume) + \" \";\r\n\t\t\t}\r\n\t\t\tpathString += \"z\";\r\n\t\t\t\r\n\t\t\tsvgElement.setAttribute(\"d\", pathString);\r\n\t\t}\r\n\t\t\r\n\t\tprivate _pitchToPixelHeight(pitch: number): number {\r\n\t\t\treturn this._pitchHeight * (this._pitchCount - (pitch) - 0.5);\r\n\t\t}\r\n\t}\r\n\r\n","/*\r\nCopyright (C) 2018 John Nesky\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\nimport { HTML, SVG } from \"imperative-html/dist/esm/elements-strict\";\r\nimport { SongDocument } from \"./SongDocument\";\r\nimport { Pattern } from \"../synth/song\";\r\nimport { ChangePattern, ChangeChannelBar } from \"./changes\";\r\nimport { ColorConfig } from \"./ColorConfig\";\r\n\tconst {select, div, option} = HTML;\r\n\r\n\tclass Box {\r\n\t\tprivate readonly _label: SVGTextElement = SVG.text( {x: 16, y: 23, \"font-family\": \"sans-serif\", \"font-size\": 20, \"text-anchor\": \"middle\", \"font-weight\": \"bold\", fill: ColorConfig.invertedText}, \"1\");\r\n\t\tprivate readonly _rect = <SVGRectElement> SVG.rect( {width: 30, height: 27, x: 1, y: 1});\r\n\t\tprivate readonly _vol1 = <SVGRectElement> SVG.rect( {width: 6, height: 3, x: 24, y: 5});\r\n\t\tprivate readonly _volb = <SVGRectElement> SVG.rect( {width: 6, height: 18, x: 24, y: 5});\r\n\t\tpublic readonly container = <SVGSVGElement> SVG.svg(this._rect, this._volb, this._vol1, this._label);\r\n\t\tprivate _renderedIndex: number = 1;\r\n\t\tprivate _renderedDim: boolean = true;\r\n\t\t//private _renderedMute: boolean = true;\r\n\t\tprivate _renderedSelected: boolean = false;\r\n\t\tprivate _renderedColor: string = \"\";\r\n\t\tconstructor(channel: number, x: number, y: number, color: string, showVolume: boolean) {\r\n\t\t\tthis.container.setAttribute(\"x\", \"\" + (x * 32));\r\n\t\t\tthis.container.setAttribute(\"y\", \"\" + (y * 32));\r\n\t\t\tthis._rect.setAttribute(\"fill\", \"#444444\");\r\n\t\t\tthis._vol1.setAttribute(\"fill\", \"#444444\");\r\n\t\t\tthis._volb.setAttribute(\"fill\", \"#444444\");\r\n\t\t\tthis._label.setAttribute(\"fill\", color);\r\n\t\t}\r\n\t\t\r\n\t\tpublic setSquashed(squashed: boolean, y: number): void {\r\n\t\t\tif (squashed) {\r\n\t\t\t\tthis.container.setAttribute(\"y\", \"\" + (y * 27));\r\n\t\t\t\tthis._rect.setAttribute(\"height\", \"\" + 25);\r\n\t\t\t\tthis._vol1.setAttribute(\"height\", \"\" + 2.7);\r\n\t\t\t\tthis._volb.setAttribute(\"height\", \"\" + 18);\r\n\t\t\t\tthis._label.setAttribute(\"y\", \"\" + 21);\r\n\t\t\t} else {\r\n\t\t\t\tthis.container.setAttribute(\"y\", \"\" + (y * 32));\r\n\t\t\t\tthis._rect.setAttribute(\"height\", \"\" + 30);\r\n\t\t\t\tthis._vol1.setAttribute(\"height\", \"\" + 3);\r\n\t\t\t\tthis._volb.setAttribute(\"height\", \"\" + 18);\r\n\t\t\t\tthis._label.setAttribute(\"y\", \"\" + 23);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tpublic setIndex(index: number, dim: boolean, selected: boolean, y: number, color: string, volume: number, colorB: string, showVolume: boolean, mix: number): void {\r\n\t\t\tif (mix == 2) {\r\n\t\t\t\tthis._vol1.setAttribute(\"height\", \"\" + (18 - volume * 2));\r\n\t\t\t\tthis._vol1.setAttribute(\"y\", \"\" + (5 + volume * 2));\r\n\t\t\t} else {\r\n\t\t\t\tthis._vol1.setAttribute(\"height\", \"\" + (18 - volume * 3.6));\r\n\t\t\t\tthis._vol1.setAttribute(\"y\", \"\" + (5 + volume * 3.6));\r\n\t\t\t}\r\n\t\t\tif (this._renderedIndex != index) {\r\n\t\t\t\tif (!this._renderedSelected && ((index == 0) != (this._renderedIndex == 0))) {\r\n\t\t\t\t\tthis._rect.setAttribute(\"fill\", (index == 0) ? ColorConfig.editorBackground : ColorConfig.channelBox);\r\n\t\t\t\t\tthis._vol1.setAttribute(\"fill\", (index == 0) ? ColorConfig.editorBackground : ColorConfig.channelBox);\r\n\t\t\t\t\tthis._volb.setAttribute(\"fill\", (index == 0) ? ColorConfig.editorBackground : ColorConfig.channelBox);\r\n\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\tthis._renderedIndex = index;\r\n\t\t\t\tthis._label.innerHTML = String(index);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (this._renderedDim != dim || this._renderedColor != color) {\r\n\t\t\t\tthis._renderedDim = dim;\r\n\t\t\t\tif (selected) {\r\n\t\t\t\t\tthis._label.setAttribute(\"fill\", ColorConfig.invertedText);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._label.setAttribute(\"fill\", color);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (this._renderedSelected != selected || this._renderedColor != color) {\r\n\t\t\t\tthis._renderedSelected = selected;\r\n\t\t\t\tif (selected) {\r\n\t\t\t\t\tthis._rect.setAttribute(\"fill\", color);\r\n\t\t\t\t\tthis._vol1.setAttribute(\"fill\", color);\r\n\t\t\t\t\tthis._volb.setAttribute(\"fill\", color);\r\n\t\t\t\t\tthis._label.setAttribute(\"fill\", ColorConfig.invertedText);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._rect.setAttribute(\"fill\", (this._renderedIndex == 0) ? ColorConfig.editorBackground : ColorConfig.channelBox);\r\n\t\t\t\t\tthis._vol1.setAttribute(\"fill\", (this._renderedIndex == 0) ? ColorConfig.editorBackground : color);\r\n\t\t\t\t\tthis._volb.setAttribute(\"fill\", (this._renderedIndex == 0) ? ColorConfig.editorBackground : colorB);\r\n\t\t\t\t\tthis._label.setAttribute(\"fill\", color);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (showVolume) {\r\n\t\t\t\tthis._label.setAttribute(\"x\", \"12\");\r\n\t\t\t\tthis._vol1.style.visibility = \"visible\";\r\n\t\t\t\tthis._volb.style.visibility = \"visible\";\r\n\t\t\t} else {\r\n\t\t\t\tthis._label.setAttribute(\"x\", \"16\");\r\n\t\t\t\tthis._vol1.style.visibility = \"hidden\";\r\n\t\t\t\tthis._volb.style.visibility = \"hidden\";\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._renderedColor = color;\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class TrackEditor {\r\n\t\tprivate readonly _barWidth: number = 32;\r\n\t\tprivate readonly _svg = <SVGSVGElement> SVG.svg( {style: \"position: absolute;\", height: 128});\r\n\t\tprivate readonly _select: HTMLSelectElement = select({class: \"trackSelectBox\", style: \"width: 32px; height: 32px; background: none; border: none; appearance: none; color: transparent; position: absolute;\"});\r\n\t\tpublic readonly container: HTMLElement = div({style: \"height: 128px; position: relative; overflow:hidden;\"}, [this._svg, this._select]);\r\n\t\t\r\n\t\tprivate readonly _boxContainer = <SVGGElement> SVG.g();\r\n\t\tprivate readonly _playhead = <SVGRectElement> SVG.rect( {fill: \"white\", x: 0, y: 0, width: 4, height: 128});\r\n\t\tprivate readonly _boxHighlight = <SVGRectElement> SVG.rect( {fill: \"none\", stroke: \"white\", \"stroke-width\": 2, \"pointer-events\": \"none\", x: 1, y: 1, width: 30, height: 30});\r\n\t\tprivate readonly _upHighlight = <SVGPathElement> SVG.path( {fill: \"black\", stroke: \"black\", \"stroke-width\": 1, \"pointer-events\": \"none\"});\r\n\t\tprivate readonly _downHighlight = <SVGPathElement> SVG.path( {fill: \"black\", stroke: \"black\", \"stroke-width\": 1, \"pointer-events\": \"none\"});\r\n\t\t\r\n\t\tprivate readonly _grid: Box[][] = [];\r\n\t\tprivate _mouseX: number = 0;\r\n\t\tprivate _mouseY: number = 0;\r\n\t\tpublic _pattern: Pattern | null = null;\r\n\t\tprivate _mouseOver: boolean = false;\r\n\t\tpublic _digits: string = \"\";\r\n\t\tprivate _editorHeight: number = 128;\r\n\t\tprivate _channelHeight: number = 32;\r\n\t\tprivate _renderedChannelCount: number = 0;\r\n\t\tprivate _renderedBarCount: number = 0;\r\n\t\tprivate _renderedPatternCount: number = 0;\r\n\t\tprivate _renderedPlayhead: number = -1;\r\n\t\tprivate _renderedSquashed: boolean = false;\r\n\t\tprivate _changePattern: ChangePattern | null = null;\r\n\t\t\r\n\t\tconstructor(private _doc: SongDocument) {\r\n\t\t\tthis._svg.appendChild(this._boxContainer);\r\n\t\t\tthis._svg.appendChild(this._boxHighlight);\r\n\t\t\tthis._svg.appendChild(this._upHighlight);\r\n\t\t\tthis._svg.appendChild(this._downHighlight);\r\n\t\t\tthis._svg.appendChild(this._playhead);\r\n\t\t\tthis._svg.style.backgroundColor = ColorConfig.editorBackground;\r\n\r\n\t\t\twindow.requestAnimationFrame(this._animatePlayhead);\r\n\t\t\tthis._svg.addEventListener(\"mousedown\", this._whenMousePressed);\r\n\t\t\tdocument.addEventListener(\"mousemove\", this._whenMouseMoved);\r\n\t\t\tdocument.addEventListener(\"mouseup\", this._whenMouseReleased);\r\n\t\t\tthis._svg.addEventListener(\"mouseover\", this._whenMouseOver);\r\n\t\t\tthis._svg.addEventListener(\"mouseout\", this._whenMouseOut);\r\n\t\t\t\r\n\t\t\tthis._select.addEventListener(\"change\", this._whenSelectChanged);\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenSelectChanged = (): void => {\r\n\t\t\tthis._setPattern(this._select.selectedIndex);\r\n\t\t}\r\n\t\t\r\n\t\tprivate _animatePlayhead = (timestamp: number): void => {\r\n\t\t\tconst playhead = (this._barWidth * this._doc.synth.playhead - 2);\r\n\t\t\tif (this._renderedPlayhead != playhead) {\r\n\t\t\t\tthis._renderedPlayhead = playhead;\r\n\t\t\t\tthis._playhead.setAttribute(\"x\", \"\" + playhead);\r\n\t\t\t}\r\n\t\t\twindow.requestAnimationFrame(this._animatePlayhead);\r\n\t\t}\r\n\t\t\r\n\t\tpublic _setChannelBar(channel: number, bar: number): void {\r\n\t\t\tnew ChangeChannelBar(this._doc, channel, bar);\r\n\t\t\tthis._digits = \"\";\r\n\t\t\tthis._doc.forgetLastChange();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _setPattern(pattern: number): void {\r\n\t\t\tconst currentValue: number = this._doc.song.channels[this._doc.channel].bars[this._doc.bar];\r\n\t\t\tconst canReplaceLastChange: boolean = this._doc.lastChangeWas(this._changePattern);\r\n\t\t\tconst oldValue: number = canReplaceLastChange ? this._changePattern!.oldValue : currentValue;\r\n\t\t\tif (pattern != currentValue) {\r\n\t\t\t\tthis._changePattern = new ChangePattern(this._doc, oldValue, pattern);\r\n\t\t\t\tthis._doc.record(this._changePattern, canReplaceLastChange);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tpublic _nextDigit(digit: string): void {\r\n\t\t\tthis._digits += digit;\r\n\t\t\tlet parsed: number = parseInt(this._digits);\r\n\t\t\tif (parsed <= this._doc.song.patternsPerChannel) {\r\n\t\t\t\tthis._setPattern(parsed);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t\tthis._digits = digit;\r\n\t\t\tparsed = parseInt(this._digits);\r\n\t\t\tif (parsed <= this._doc.song.patternsPerChannel) {\r\n\t\t\t\tthis._setPattern(parsed);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._digits = \"\";\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenMouseOver = (event: MouseEvent): void => {\r\n\t\t\tif (this._mouseOver) return;\r\n\t\t\tthis._mouseOver = true;\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenMouseOut = (event: MouseEvent): void => {\r\n\t\t\tif (!this._mouseOver) return;\r\n\t\t\tthis._mouseOver = false;\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenMousePressed = (event: MouseEvent): void => {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\r\n    \t\tthis._mouseX = (event.clientX || event.pageX) - boundingRect.left;\r\n\t\t    this._mouseY = (event.clientY || event.pageY) - boundingRect.top;\r\n\t\t\tconst channel: number = Math.floor(Math.min(this._doc.song.getChannelCount() - 1, Math.max(0, this._mouseY / this._channelHeight)));\r\n\t\t\tconst bar: number = Math.floor(Math.min(this._doc.song.barCount - 1, Math.max(0, this._mouseX / this._barWidth)));\r\n\t\t\tif (this._doc.channel == channel && this._doc.bar == bar) {\r\n\t\t\t\tconst up: boolean = (this._mouseY % this._channelHeight) < this._channelHeight / 2;\r\n\t\t\t\tconst patternCount: number = this._doc.song.patternsPerChannel;\r\n\t\t\t\tthis._setPattern((this._doc.song.channels[channel].bars[bar] + (up ? 1 : patternCount)) % (patternCount + 1));\r\n\t\t\t} else {\r\n\t\t\t\tthis._setChannelBar(channel, bar);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenMouseMoved = (event: MouseEvent): void => {\r\n\t\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\r\n    \t\tthis._mouseX = (event.clientX || event.pageX) - boundingRect.left;\r\n\t\t    this._mouseY = (event.clientY || event.pageY) - boundingRect.top;\r\n\t\t\tthis._updatePreview();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenMouseReleased = (event: MouseEvent): void => {\r\n\t\t}\r\n\t\t\r\n\t\tprivate _updatePreview(): void {\r\n\t\t\tlet channel: number = Math.floor(Math.min(this._doc.song.getChannelCount() - 1, Math.max(0, this._mouseY / this._channelHeight)));\r\n\t\t\tlet bar: number = Math.floor(Math.min(this._doc.song.barCount - 1, Math.max(0, this._mouseX / this._barWidth)));\r\n\t\t\t\r\n\t\t\tconst wideScreen: boolean = window.innerWidth > 700;\r\n\t\t\tif (!wideScreen) {\r\n\t\t\t\tbar = this._doc.bar;\r\n\t\t\t\tchannel = this._doc.channel;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst selected: boolean = (bar == this._doc.bar && channel == this._doc.channel);\r\n\t\t\t\r\n\t\t\tif (this._mouseOver && !selected) {\r\n\t\t\t\tthis._boxHighlight.setAttribute(\"x\", \"\" + (1 + this._barWidth * bar));\r\n\t\t\t\tthis._boxHighlight.setAttribute(\"y\", \"\" + (1 + (this._channelHeight * channel)));\r\n\t\t\t\tthis._boxHighlight.setAttribute(\"height\", \"\" + (this._channelHeight - 2));\r\n\t\t\t\tthis._boxHighlight.style.visibility = \"visible\";\r\n\t\t\t} else {\r\n\t\t\t\tthis._boxHighlight.style.visibility = \"hidden\";\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif ((this._mouseOver || !wideScreen) && selected) {\r\n\t\t\t\tconst up: boolean = (this._mouseY % this._channelHeight) < this._channelHeight / 2;\r\n\t\t\t\tconst center: number = this._barWidth * (bar + 0.8);\r\n\t\t\t\tconst middle: number = this._channelHeight * (channel + 0.5);\r\n\t\t\t\tconst base: number = this._channelHeight * 0.1;\r\n\t\t\t\tconst tip: number = this._channelHeight * 0.4;\r\n\t\t\t\tconst width: number = this._channelHeight * 0.175;\r\n\t\t\t\t\r\n\t\t\t\tthis._upHighlight.setAttribute(\"fill\", up && wideScreen ? \"#fff\" : \"#000\");\r\n\t\t\t\tthis._downHighlight.setAttribute(\"fill\", !up && wideScreen ? \"#fff\" : \"#000\");\r\n\t\t\t\t\r\n\t\t\t\tthis._upHighlight.setAttribute(\"d\", `M ${center} ${middle - tip} L ${center + width} ${middle - base} L ${center - width} ${middle - base} z`);\r\n\t\t\t\tthis._downHighlight.setAttribute(\"d\", `M ${center} ${middle + tip} L ${center + width} ${middle + base} L ${center - width} ${middle + base} z`);\r\n\t\t\t\t\r\n\t\t\t\tthis._upHighlight.style.visibility = \"visible\";\r\n\t\t\t\tthis._downHighlight.style.visibility = \"visible\";\r\n\t\t\t} else {\r\n\t\t\t\tthis._upHighlight.style.visibility = \"hidden\";\r\n\t\t\t\tthis._downHighlight.style.visibility = \"hidden\";\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._select.style.left = (this._barWidth * this._doc.bar) + \"px\";\r\n\t\t\tthis._select.style.top = (this._channelHeight * this._doc.channel) + \"px\";\r\n\t\t\tthis._select.style.height = this._channelHeight + \"px\";\r\n\t\t\t\r\n\t\t\tconst patternCount: number = this._doc.song.patternsPerChannel;\r\n\t\t\tfor (let i: number = this._renderedPatternCount; i < patternCount; i++) {\r\n\t\t\t\tthis._select.appendChild(option({value:i}, i));\r\n\t\t\t}\r\n\t\t\tfor (let i: number = patternCount; i < this._renderedPatternCount; i++) {\r\n\t\t\t\tthis._select.removeChild(<Node> this._select.lastChild);\r\n\t\t\t}\r\n\t\t\tthis._renderedPatternCount = patternCount;\r\n\t\t\tconst selectedPattern: number = this._doc.song.channels[this._doc.channel].bars[this._doc.bar];\r\n\t\t\tif (this._select.selectedIndex != selectedPattern) this._select.selectedIndex = selectedPattern;\r\n\t\t}\r\n\t\t\r\n\t\tpublic render(): void {\r\n\t\t\tthis._pattern = this._doc.getCurrentPattern();\r\n\t\t\t\r\n\t\t\tconst wideScreen: boolean = window.innerWidth > 700;\r\n\t\t\tconst squashed: boolean = !wideScreen || this._doc.song.getChannelCount() > 5/*4*/ || (this._doc.song.barCount > this._doc.trackVisibleBars && this._doc.song.getChannelCount() > 3);\r\n\t\t\tthis._channelHeight = squashed ? 27 : 32;\r\n\t\t\t\r\n\t\t\tif (this._renderedChannelCount != this._doc.song.getChannelCount()) {\r\n\t\t\t\tfor (let y: number = this._renderedChannelCount; y < this._doc.song.getChannelCount(); y++) {\r\n\t\t\t\t\tthis._grid[y] = [];\r\n\t\t\t\t\tfor (let x: number = 0; x < this._renderedBarCount; x++) {\r\n\t\t\t\t\t\t//const box: Box = new Box(y, x, y, this._doc.song.getChannelColorDim(y), this._doc.showVolumeBar);\r\n\t\t\t\t\t\tconst box: Box = new Box(y, x, y, ColorConfig.getChannelColor(this._doc.song, y).secondaryChannel, this._doc.prefs.showVolumeBar);\r\n\t\t\t\t\t\tbox.setSquashed(squashed, y);\r\n\t\t\t\t\t\tthis._boxContainer.appendChild(box.container);\r\n\t\t\t\t\t\tthis._grid[y][x] = box;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tfor (let y: number = this._doc.song.getChannelCount(); y < this._renderedChannelCount; y++) {\r\n\t\t\t\t\tfor (let x: number = 0; x < this._renderedBarCount; x++) {\r\n\t\t\t\t\t\tthis._boxContainer.removeChild(this._grid[y][x].container);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tthis._grid.length = this._doc.song.getChannelCount();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (this._renderedBarCount < this._doc.song.barCount) {\r\n\t\t\t\tfor (let y: number = 0; y < this._doc.song.getChannelCount(); y++) {\r\n\t\t\t\t\tfor (let x: number = this._renderedBarCount; x < this._doc.song.barCount; x++) {\r\n\t\t\t\t\t\tconst box: Box = new Box(y, x, y, ColorConfig.getChannelColor(this._doc.song, y).secondaryChannel, this._doc.prefs.showVolumeBar);\r\n\t\t\t\t\t\tbox.setSquashed(squashed, y);\r\n\t\t\t\t\t\tthis._boxContainer.appendChild(box.container);\r\n\t\t\t\t\t\tthis._grid[y][x] = box;\r\n\t\t\t\t\t\t//SVG.text( {x: 16, y: 23, \"font-family\": \"sans-serif\", \"font-size\": 20, \"text-anchor\": \"middle\", \"font-weight\": \"bold\", fill: \"red\"});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (let x: number = this._doc.song.barCount; x < this._renderedBarCount; x++) {\r\n\t\t\t\t\t\tthis._boxContainer.removeChild(this._grid[y][x].container);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._grid[y].length = this._doc.song.barCount;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (this._renderedBarCount != this._doc.song.barCount) {\r\n\t\t\t\tthis._renderedBarCount = this._doc.song.barCount;\r\n\t\t\t\tconst editorWidth = 32 * this._doc.song.barCount;\r\n\t\t\t\tthis.container.style.width = editorWidth + \"px\";\r\n\t\t\t\tthis._svg.setAttribute(\"width\", editorWidth + \"\");\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (this._renderedSquashed != squashed) {\r\n\t\t\t\tfor (let y: number = 0; y < this._doc.song.getChannelCount(); y++) {\r\n\t\t\t\t\tfor (let x: number = 0; x < this._renderedBarCount; x++) {\r\n\t\t\t\t\t\tthis._grid[y][x].setSquashed(squashed, y);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (this._renderedSquashed != squashed || this._renderedChannelCount != this._doc.song.getChannelCount()) {\r\n\t\t\t\tthis._renderedSquashed = squashed;\r\n\t\t\t\tthis._renderedChannelCount = this._doc.song.getChannelCount();\r\n\t\t\t\tthis._editorHeight = this._doc.song.getChannelCount() * this._channelHeight;\r\n\t\t\t\tthis._svg.setAttribute(\"height\", \"\" + this._editorHeight);\r\n\t\t\t\tthis._playhead.setAttribute(\"height\", \"\" + this._editorHeight);\r\n\t\t\t\tthis.container.style.height = this._editorHeight + \"px\";\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfor (let j: number = 0; j < this._doc.song.getChannelCount(); j++) {\r\n\t\t\t\tfor (let i: number = 0; i < this._renderedBarCount; i++) {\r\n\t\t\t\t\tconst pattern: Pattern | null = this._doc.song.getPattern(j, i);\r\n\t\t\t\t\tconst patternMute: number = this._doc.song.getPatternInstrumentMute(j, i);\r\n\t\t\t\t\tconst patternVolume: number = this._doc.song.getPatternInstrumentVolume(j, i);\r\n\t\t\t\t\tconst selected: boolean = (i == this._doc.bar && j == this._doc.channel);\r\n\t\t\t\t\tconst dim: boolean = (pattern == null || pattern.notes.length == 0);\r\n\t\t\t\t\tconst mute: boolean = patternMute == 1;\r\n\t\t\t\t\tconst volume: number = patternVolume;\r\n\t\t\t\t\tconst box: Box = this._grid[j][i];\r\n\t\t\t\t\tif (i < this._doc.song.barCount) {\r\n\t\t\t\t\t\tbox.setIndex(\r\n\t\t\t\t\t\t\tthis._doc.song.channels[j].bars[i],\r\n\t\t\t\t\t\t\tdim,\r\n\t\t\t\t\t\t\tselected,\r\n\t\t\t\t\t\t\tj,\r\n\t\t\t\t\t\t\tdim && !selected && !mute ? ColorConfig.getChannelColor(this._doc.song, j).secondaryChannel : mute && !selected ? \"#161616\" : ColorConfig.getChannelColor(this._doc.song, j).primaryChannel,\r\n\t\t\t\t\t\t\tvolume,\r\n\t\t\t\t\t\t\tdim && !selected && !mute ? ColorConfig.getChannelColor(this._doc.song, j).secondaryChannel : mute && !selected ? \"#9b9b9b\" : ColorConfig.getChannelColor(this._doc.song, j).secondaryChannel,\r\n\t\t\t\t\t\t\tthis._doc.prefs.showVolumeBar,\r\n\t\t\t\t\t\t\tthis._doc.song.mix\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tbox.container.style.visibility = \"visible\";\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbox.container.style.visibility = \"hidden\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._updatePreview();\r\n\t\t}\r\n\t}\r\n\r\n","/*\r\nCopyright (C) 2018 John Nesky\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\nimport { HTML, SVG } from \"imperative-html/dist/esm/elements-strict\";\r\nimport { SongDocument } from \"./SongDocument\";\r\nimport { ChangeLoop } from \"./changes\";\r\nimport { ColorConfig } from \"./ColorConfig\";\r\n\tconst {div} = HTML;\r\n\r\n\r\n\tinterface Cursor {\r\n\t\tstartBar: number;\r\n\t\tmode: number;\r\n\t}\r\n\t\r\n\tinterface Endpoints {\r\n\t\tstart: number;\r\n\t\tlength: number;\r\n\t}\r\n\t\r\n\texport class LoopEditor {\r\n\t\tprivate readonly _barWidth: number = 32;\r\n\t\tprivate readonly _editorHeight: number = 20;\r\n\t\tprivate readonly _startMode:   number = 0;\r\n\t\tprivate readonly _endMode:     number = 1;\r\n\t\tprivate readonly _bothMode:    number = 2;\r\n\t\t\r\n\t\tprivate readonly _loop = <SVGPathElement> SVG.path( {fill: \"none\", stroke: ColorConfig.loopAccent, \"stroke-width\": 4});\r\n\t\tprivate readonly _highlight = <SVGPathElement> SVG.path( {fill: \"white\", \"pointer-events\": \"none\"});\r\n\t\t\r\n\t\tprivate readonly _svg = <SVGSVGElement> SVG.svg( {style: \"touch-action: pan-y; position: absolute;\", height: this._editorHeight}, [\r\n\t\t\tthis._loop,\r\n\t\t\tthis._highlight,\r\n\t\t]);\r\n\t\t\r\n\t\tpublic readonly container: HTMLElement = div({style: \"height: 20px; position: relative; margin: 5px 0;\"}, [this._svg]);\r\n\t\t\r\n\t\tprivate _change: ChangeLoop | null = null;\r\n\t\tprivate _cursor: Cursor = {startBar: -1, mode: -1};\r\n\t\tprivate _mouseX: number = 0;\r\n\t\tpublic _mouseY: number = 0;\r\n\t\tprivate _clientStartX: number = 0;\r\n\t\tprivate _clientStartY: number = 0;\r\n\t\tprivate _startedScrolling: boolean = false;\r\n\t\tprivate _draggingHorizontally: boolean = false;\r\n\t\tprivate _mouseDown: boolean = false;\r\n\t\tprivate _mouseOver: boolean = false;\r\n\t\tprivate _renderedLoopStart: number = -1;\r\n\t\tprivate _renderedLoopStop: number = -1;\r\n\t\tprivate _renderedBarCount: number = 0;\r\n\t\t\r\n\t\tconstructor(private _doc: SongDocument) {\r\n\t\t\tthis._updateCursorStatus();\r\n\t\t\tthis._render();\r\n\t\t\tthis._doc.notifier.watch(this._documentChanged);\r\n\t\t\t\r\n\t\t\tthis._svg.style.backgroundColor = ColorConfig.editorBackground;\r\n\r\n\t\t\tthis.container.addEventListener(\"mousedown\", this._whenMousePressed);\r\n\t\t\tdocument.addEventListener(\"mousemove\", this._whenMouseMoved);\r\n\t\t\tdocument.addEventListener(\"mouseup\", this._whenCursorReleased);\r\n\t\t\tthis.container.addEventListener(\"mouseover\", this._whenMouseOver);\r\n\t\t\tthis.container.addEventListener(\"mouseout\", this._whenMouseOut);\r\n\t\t\t\r\n\t\t\tthis.container.addEventListener(\"touchstart\", this._whenTouchPressed);\r\n\t\t\tthis.container.addEventListener(\"touchmove\", this._whenTouchMoved);\r\n\t\t\tthis.container.addEventListener(\"touchend\", this._whenTouchReleased);\r\n\t\t\tthis.container.addEventListener(\"touchcancel\", this._whenTouchReleased);\r\n\t\t}\r\n\t\t\r\n\t\tprivate _updateCursorStatus(): void {\r\n\t\t\tconst bar: number = this._mouseX / this._barWidth;\r\n\t\t\tthis._cursor.startBar = bar;\r\n\t\t\t\r\n\t\t\tif (bar > this._doc.song.loopStart - 0.25 && bar < this._doc.song.loopStart + this._doc.song.loopLength + 0.25) {\r\n\t\t\t\tif (bar - this._doc.song.loopStart < this._doc.song.loopLength * 0.5) {\r\n\t\t\t\t\tthis._cursor.mode = this._startMode;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._cursor.mode = this._endMode;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis._cursor.mode = this._bothMode;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tprivate _findEndPoints(middle: number): Endpoints {\r\n\t\t\tlet start: number = Math.round(middle - this._doc.song.loopLength / 2);\r\n\t\t\tlet end: number = start + this._doc.song.loopLength;\r\n\t\t\tif (start < 0) {\r\n\t\t\t\tend -= start;\r\n\t\t\t\tstart = 0;\r\n\t\t\t}\r\n\t\t\tif (end > this._doc.song.barCount) {\r\n\t\t\t\tstart -= end - this._doc.song.barCount;\r\n\t\t\t\tend = this._doc.song.barCount;\r\n\t\t\t}\r\n\t\t\treturn {start: start, length: end - start};\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenMouseOver = (event: MouseEvent): void => {\r\n\t\t\tif (this._mouseOver) return;\r\n\t\t\tthis._mouseOver = true;\r\n\t\t\tthis._updatePreview();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenMouseOut = (event: MouseEvent): void => {\r\n\t\t\tif (!this._mouseOver) return;\r\n\t\t\tthis._mouseOver = false;\r\n\t\t\tthis._updatePreview();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenMousePressed = (event: MouseEvent): void => {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tthis._mouseDown = true;\r\n\t\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\r\n    \t\tthis._mouseX = (event.clientX || event.pageX) - boundingRect.left;\r\n\t\t    this._mouseY = (event.clientY || event.pageY) - boundingRect.top;\r\n\t\t\tthis._updateCursorStatus();\r\n\t\t\tthis._updatePreview();\r\n\t\t\tthis._whenMouseMoved(event);\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenTouchPressed = (event: TouchEvent): void => {\r\n\t\t\t//event.preventDefault();\r\n\t\t\tthis._mouseDown = true;\r\n\t\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\r\n\t\t\tthis._mouseX = event.touches[0].clientX - boundingRect.left;\r\n\t\t\tthis._mouseY = event.touches[0].clientY - boundingRect.top;\r\n\t\t\tthis._updateCursorStatus();\r\n\t\t\tthis._updatePreview();\r\n\t\t\t//this._whenTouchMoved(event);\r\n\t\t\tthis._clientStartX = event.touches[0].clientX;\r\n\t\t\tthis._clientStartY = event.touches[0].clientY;\r\n\t\t\tthis._draggingHorizontally = false;\r\n\t\t\tthis._startedScrolling = false;\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenMouseMoved = (event: MouseEvent): void => {\r\n\t\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\r\n    \t\tthis._mouseX = (event.clientX || event.pageX) - boundingRect.left;\r\n\t\t    this._mouseY = (event.clientY || event.pageY) - boundingRect.top;\r\n\t\t    this._whenCursorMoved();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenTouchMoved = (event: TouchEvent): void => {\r\n\t\t\tif (!this._mouseDown) return;\r\n\t\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\r\n\t\t\tthis._mouseX = event.touches[0].clientX - boundingRect.left;\r\n\t\t\tthis._mouseY = event.touches[0].clientY - boundingRect.top;\r\n\t\t\t\r\n\t\t\tif (!this._draggingHorizontally && !this._startedScrolling) {\r\n\t\t\t\tif (Math.abs(event.touches[0].clientY - this._clientStartY) > 10) {\r\n\t\t\t\t\tthis._startedScrolling = true;\r\n\t\t\t\t} else if (Math.abs(event.touches[0].clientX - this._clientStartX) > 10) {\r\n\t\t\t\t\tthis._draggingHorizontally = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t    if (this._draggingHorizontally) {\r\n\t\t\t\tthis._whenCursorMoved();\r\n\t\t\t\tevent.preventDefault();\r\n\t\t    }\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenCursorMoved(): void {\r\n\t\t\tif (this._mouseDown) {\r\n\t\t\t\tlet oldStart: number = this._doc.song.loopStart;\r\n\t\t\t\tlet oldEnd: number = this._doc.song.loopStart + this._doc.song.loopLength;\r\n\t\t\t\tif (this._change != null && this._doc.lastChangeWas(this._change)) {\r\n\t\t\t\t\toldStart = this._change.oldStart;\r\n\t\t\t\t\toldEnd = oldStart + this._change.oldLength;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tconst bar: number = this._mouseX / this._barWidth;\r\n\t\t\t\tlet start: number;\r\n\t\t\t\tlet end: number;\r\n\t\t\t\tlet temp: number;\r\n\t\t\t\tif (this._cursor.mode == this._startMode) {\r\n\t\t\t\t\tstart = oldStart + Math.round(bar - this._cursor.startBar);\r\n\t\t\t\t\tend = oldEnd;\r\n\t\t\t\t\t// @TODO: clamp before ChangeLoop like ModBox?\r\n\t\t\t\t\tif (start < 0) start = 0;\r\n\t\t\t\t\tif (start >= this._doc.song.barCount) start = this._doc.song.barCount;\r\n\t\t\t\t\tif (start == end) {\r\n\t\t\t\t\t\tstart = end - 1;\r\n\t\t\t\t\t} else if (start > end) {\r\n\t\t\t\t\t\ttemp = start;\r\n\t\t\t\t\t\tstart = end;\r\n\t\t\t\t\t\tend = temp;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._change = new ChangeLoop(this._doc, oldStart, oldEnd - oldStart, start, end - start);\r\n\t\t\t\t} else if (this._cursor.mode == this._endMode) {\r\n\t\t\t\t\tstart = oldStart;\r\n\t\t\t\t\tend = oldEnd + Math.round(bar - this._cursor.startBar);\r\n\t\t\t\t\t// @TODO: clamp before ChangeLoop like ModBox?\r\n\t\t\t\t\tif (end < 0) end = 0;\r\n\t\t\t\t\tif (end >= this._doc.song.barCount) end = this._doc.song.barCount;\r\n\t\t\t\t\tif (end == start) {\r\n\t\t\t\t\t\tend = start + 1;\r\n\t\t\t\t\t} else if (end < start) {\r\n\t\t\t\t\t\ttemp = start;\r\n\t\t\t\t\t\tstart = end;\r\n\t\t\t\t\t\tend = temp;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._change = new ChangeLoop(this._doc, oldStart, oldEnd - oldStart, start, end - start);\r\n\t\t\t\t} else if (this._cursor.mode == this._bothMode) {\r\n\t\t\t\t\tconst endPoints: Endpoints = this._findEndPoints(bar);\r\n\t\t\t\t\tthis._change = new ChangeLoop(this._doc, oldStart, oldEnd - oldStart, endPoints.start, endPoints.length);\r\n\t\t\t\t}\r\n\t\t\t\tthis._doc.setProspectiveChange(this._change);\r\n\t\t\t} else {\r\n\t\t\t\tthis._updateCursorStatus();\r\n\t\t\t\tthis._updatePreview();\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenTouchReleased = (event: TouchEvent): void => {\r\n\t\t\tevent.preventDefault();\r\n\t\t    if (!this._startedScrolling) {\r\n\t\t\t\tthis._whenCursorMoved();\r\n\t\t\t\tthis._mouseOver = false;\r\n\t\t\t\tthis._whenCursorReleased(event);\r\n\t\t\t\tthis._updatePreview();\r\n\t\t    }\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenCursorReleased = (event: Event): void => {\r\n\t\t\tif (this._change != null) this._doc.record(this._change);\r\n\t\t\tthis._change = null;\r\n\t\t\tthis._mouseDown = false;\r\n\t\t\tthis._updateCursorStatus();\r\n\t\t\tthis._render();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _updatePreview(): void {\r\n\t\t\tconst showHighlight: boolean = this._mouseOver && !this._mouseDown;\r\n\t\t\tthis._highlight.style.visibility = showHighlight ? \"visible\" : \"hidden\";\r\n\t\t\t\r\n\t\t\tif (showHighlight) {\r\n\t\t\t\tconst radius: number = this._editorHeight / 2;\r\n\t\t\t\t\r\n\t\t\t\tlet highlightStart: number = (this._doc.song.loopStart) * this._barWidth;\r\n\t\t\t\tlet highlightStop: number = (this._doc.song.loopStart + this._doc.song.loopLength) * this._barWidth;\r\n\t\t\t\tif (this._cursor.mode == this._startMode) {\r\n\t\t\t\t\thighlightStop = (this._doc.song.loopStart) * this._barWidth + radius * 2;\r\n\t\t\t\t} else if (this._cursor.mode == this._endMode) {\r\n\t\t\t\t\thighlightStart = (this._doc.song.loopStart + this._doc.song.loopLength) * this._barWidth - radius * 2;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst endPoints: Endpoints = this._findEndPoints(this._cursor.startBar);\r\n\t\t\t\t\thighlightStart = (endPoints.start) * this._barWidth;\r\n\t\t\t\t\thighlightStop = (endPoints.start + endPoints.length) * this._barWidth;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tthis._highlight.setAttribute(\"d\",\r\n\t\t\t\t\t`M ${highlightStart + radius} ${4} ` +\r\n\t\t\t\t\t`L ${highlightStop - radius} ${4} ` +\r\n\t\t\t\t\t`A ${radius - 4} ${radius - 4} ${0} ${0} ${1} ${highlightStop - radius} ${this._editorHeight - 4} ` +\r\n\t\t\t\t\t`L ${highlightStart + radius} ${this._editorHeight - 4} ` +\r\n\t\t\t\t\t`A ${radius - 4} ${radius - 4} ${0} ${0} ${1} ${highlightStart + radius} ${4} ` +\r\n\t\t\t\t\t`z`\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tprivate _documentChanged = (): void => {\r\n\t\t\tthis._render();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _render(): void {\r\n\t\t\tconst radius: number = this._editorHeight / 2;\r\n\t\t\tconst loopStart: number = (this._doc.song.loopStart) * this._barWidth;\r\n\t\t\tconst loopStop: number = (this._doc.song.loopStart + this._doc.song.loopLength) * this._barWidth;\r\n\t\t\t\r\n\t\t\tif (this._renderedBarCount != this._doc.song.barCount) {\r\n\t\t\t\tthis._renderedBarCount = this._doc.song.barCount;\r\n\t\t\t\tconst editorWidth = 32 * this._doc.song.barCount;\r\n\t\t\t\tthis.container.style.width = editorWidth + \"px\";\r\n\t\t\t\tthis._svg.setAttribute(\"width\", editorWidth + \"\");\r\n\t\t\t}\r\n\r\n\t\t\tif (this._renderedLoopStart != loopStart || this._renderedLoopStop != loopStop) {\r\n\t\t\t\tthis._renderedLoopStart = loopStart;\r\n\t\t\t\tthis._renderedLoopStop = loopStop;\r\n\t\t\t\tthis._loop.setAttribute(\"d\",\r\n\t\t\t\t\t`M ${loopStart + radius} ${2} ` +\r\n\t\t\t\t\t`L ${loopStop - radius} ${2} ` +\r\n\t\t\t\t\t`A ${radius - 2} ${radius - 2} ${0} ${0} ${1} ${loopStop - radius} ${this._editorHeight - 2} ` +\r\n\t\t\t\t\t`L ${loopStart + radius} ${this._editorHeight - 2} ` +\r\n\t\t\t\t\t`A ${radius - 2} ${radius - 2} ${0} ${0} ${1} ${loopStart + radius} ${2} ` +\r\n\t\t\t\t\t`z`\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._updatePreview();\r\n\t\t}\r\n\t}\r\n\r\n","/*\r\nCopyright (C) 2018 John Nesky\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\nimport { HTML, SVG } from \"imperative-html/dist/esm/elements-strict\";\r\nimport { SongDocument } from \"./SongDocument\";\r\nconst {div} = HTML;\r\n\r\n\texport class BarScrollBar {\r\n\t\tprivate readonly _editorWidth: number = 512;\r\n\t\tprivate readonly _editorHeight: number = 20;\r\n\t\t\r\n\t\tprivate readonly _notches = <SVGSVGElement> SVG.svg( {\"pointer-events\": \"none\"});\r\n\t\tprivate readonly _handle = <SVGRectElement> SVG.rect( {fill: \"#444444\", x: 0, y: 2, width: 10, height: this._editorHeight - 4});\r\n\t\tprivate readonly _handleHighlight = <SVGRectElement> SVG.rect( {fill: \"none\", stroke: \"white\", \"stroke-width\": 2, \"pointer-events\": \"none\", x: 0, y: 1, width: 10, height: this._editorHeight - 2});\r\n\t\tprivate readonly _leftHighlight = <SVGPathElement> SVG.path( {fill: \"white\", \"pointer-events\": \"none\"});\r\n\t\tprivate readonly _rightHighlight = <SVGPathElement> SVG.path( {fill: \"white\", \"pointer-events\": \"none\"});\r\n\t\t\r\n\t\tprivate readonly _svg = <SVGSVGElement> SVG.svg( {style: \"background-color: #000000; touch-action: pan-y; position: absolute;\", width: this._editorWidth, height: this._editorHeight}, [\r\n\t\t\tthis._notches,\r\n\t\t\tthis._handle,\r\n\t\t\tthis._handleHighlight,\r\n\t\t\tthis._leftHighlight,\r\n\t\t\tthis._rightHighlight,\r\n\t\t]);\r\n\t\t\r\n\t\tpublic readonly container: HTMLElement = div({class: \"barScrollBar\", style: \"width: 512px; height: 20px; overflow: hidden; position: relative;\"}, [this._svg]);\r\n\t\t\r\n\t\tprivate _mouseX: number = 0;\r\n\t\tpublic _mouseY: number = 0;\r\n\t\tprivate _mouseDown: boolean = false;\r\n\t\tprivate _mouseOver: boolean = false;\r\n\t\tprivate _dragging: boolean = false;\r\n\t\tprivate _dragStart: number;\r\n\t\tprivate _barWidth: number;\r\n\t\tprivate _renderedNotchCount: number = -1;\r\n\t\tprivate _renderedBarPos: number = -1;\r\n\t\t\r\n\t\tconstructor(private _doc: SongDocument, private _trackContainer: HTMLDivElement) {\r\n\t\t\tconst center: number = this._editorHeight * 0.5;\r\n\t\t\tconst base: number = 20;\r\n\t\t\tconst tip: number = 9;\r\n\t\t\tconst arrowHeight: number = 6;\r\n\t\t\tthis._leftHighlight.setAttribute(\"d\", `M ${tip} ${center} L ${base} ${center + arrowHeight} L ${base} ${center - arrowHeight} z`);\r\n\t\t\tthis._rightHighlight.setAttribute(\"d\", `M ${this._editorWidth - tip} ${center} L ${this._editorWidth - base} ${center + arrowHeight} L ${this._editorWidth - base} ${center - arrowHeight} z`);\r\n\t\t\t\r\n\t\t\tthis.container.addEventListener(\"mousedown\", this._whenMousePressed);\r\n\t\t\tdocument.addEventListener(\"mousemove\", this._whenMouseMoved);\r\n\t\t\tdocument.addEventListener(\"mouseup\", this._whenCursorReleased);\r\n\t\t\tthis.container.addEventListener(\"mouseover\", this._whenMouseOver);\r\n\t\t\tthis.container.addEventListener(\"mouseout\", this._whenMouseOut);\r\n\t\t\t\r\n\t\t\tthis.container.addEventListener(\"touchstart\", this._whenTouchPressed);\r\n\t\t\tthis.container.addEventListener(\"touchmove\", this._whenTouchMoved);\r\n\t\t\tthis.container.addEventListener(\"touchend\", this._whenCursorReleased);\r\n\t\t\tthis.container.addEventListener(\"touchcancel\", this._whenCursorReleased);\r\n\t\t\t\r\n\t\t\t// Sorry, bypassing typescript type safety on this function because I want to use the new \"passive\" option.\r\n\t\t\t//this._trackContainer.addEventListener(\"scroll\", this._onScroll, {capture: false, passive: true});\r\n\t\t\t(<Function>this._trackContainer.addEventListener)(\"scroll\", this._onScroll, {capture: false, passive: true});\r\n\t\t}\r\n\t\t\r\n\t\tprivate _onScroll = (event: Event): void => {\r\n\t\t\tthis._doc.barScrollPos = (this._trackContainer.scrollLeft / 32);\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenMouseOver = (event: MouseEvent): void => {\r\n\t\t\tif (this._mouseOver) return;\r\n\t\t\tthis._mouseOver = true;\r\n\t\t\tthis._updatePreview();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenMouseOut = (event: MouseEvent): void => {\r\n\t\t\tif (!this._mouseOver) return;\r\n\t\t\tthis._mouseOver = false;\r\n\t\t\tthis._updatePreview();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenMousePressed = (event: MouseEvent): void => {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tthis._mouseDown = true;\r\n\t\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\r\n    \t\tthis._mouseX = (event.clientX || event.pageX) - boundingRect.left;\r\n\t\t    this._mouseY = (event.clientY || event.pageY) - boundingRect.top;\r\n\t\t\tthis._updatePreview();\r\n\t\t\tif (this._mouseX >= this._doc.barScrollPos * this._barWidth && this._mouseX <= (this._doc.barScrollPos + this._doc.trackVisibleBars) * this._barWidth) {\r\n\t\t\t\tthis._dragging = true;\r\n\t\t\t\tthis._dragStart = this._mouseX;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenTouchPressed = (event: TouchEvent): void => {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tthis._mouseDown = true;\r\n\t\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\r\n\t\t\tthis._mouseX = event.touches[0].clientX - boundingRect.left;\r\n\t\t\tthis._mouseY = event.touches[0].clientY - boundingRect.top;\r\n\t\t\tthis._updatePreview();\r\n\t\t\tif (this._mouseX >= this._doc.barScrollPos * this._barWidth && this._mouseX <= (this._doc.barScrollPos + this._doc.trackVisibleBars) * this._barWidth) {\r\n\t\t\t\tthis._dragging = true;\r\n\t\t\t\tthis._dragStart = this._mouseX;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenMouseMoved = (event: MouseEvent): void => {\r\n\t\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\r\n    \t\tthis._mouseX = (event.clientX || event.pageX) - boundingRect.left;\r\n\t\t    this._mouseY = (event.clientY || event.pageY) - boundingRect.top;\r\n\t\t    this._whenCursorMoved();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenTouchMoved = (event: TouchEvent): void => {\r\n\t\t\tif (!this._mouseDown) return;\r\n\t\t\tevent.preventDefault();\r\n\t\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\r\n\t\t\tthis._mouseX = event.touches[0].clientX - boundingRect.left;\r\n\t\t\tthis._mouseY = event.touches[0].clientY - boundingRect.top;\r\n\t\t    this._whenCursorMoved();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenCursorMoved(): void {\r\n\t\t\tif (this._dragging) {\r\n\t\t\t\twhile (this._mouseX - this._dragStart < -this._barWidth * 0.5) {\r\n\t\t\t\t\tif (this._doc.barScrollPos > 0) {\r\n\t\t\t\t\t\tthis._doc.barScrollPos--;\r\n\t\t\t\t\t\tthis._dragStart -= this._barWidth;\r\n\t\t\t\t\t\tthis._doc.notifier.changed();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\twhile (this._mouseX - this._dragStart > this._barWidth * 0.5) {\r\n\t\t\t\t\tif (this._doc.barScrollPos < this._doc.song.barCount - this._doc.trackVisibleBars) {\r\n\t\t\t\t\t\tthis._doc.barScrollPos++;\r\n\t\t\t\t\t\tthis._dragStart += this._barWidth;\r\n\t\t\t\t\t\tthis._doc.notifier.changed();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this._mouseOver) this._updatePreview();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenCursorReleased = (event: Event): void => {\r\n\t\t\tif (!this._dragging && this._mouseDown) {\r\n\t\t\t\tif (this._mouseX < (this._doc.barScrollPos + 8) * this._barWidth) {\r\n\t\t\t\t\tif (this._doc.barScrollPos > 0) this._doc.barScrollPos--;\r\n\t\t\t\t\tthis._doc.notifier.changed();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (this._doc.barScrollPos < this._doc.song.barCount - this._doc.trackVisibleBars) this._doc.barScrollPos++;\r\n\t\t\t\t\tthis._doc.notifier.changed();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._mouseDown = false;\r\n\t\t\tthis._dragging = false;\r\n\t\t\tthis._updatePreview();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _updatePreview(): void {\r\n\t\t\tconst showHighlight: boolean = this._mouseOver && !this._mouseDown;\r\n\t\t\tlet showleftHighlight: boolean = false;\r\n\t\t\tlet showRightHighlight: boolean = false;\r\n\t\t\tlet showHandleHighlight: boolean = false;\r\n\t\t\t\r\n\t\t\tif (showHighlight) {\r\n\t\t\t\tif (this._mouseX < this._doc.barScrollPos * this._barWidth) {\r\n\t\t\t\t\tshowleftHighlight = true;\r\n\t\t\t\t} else if (this._mouseX > (this._doc.barScrollPos + this._doc.trackVisibleBars) * this._barWidth) {\r\n\t\t\t\t\tshowRightHighlight = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tshowHandleHighlight = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._leftHighlight.style.visibility = showleftHighlight ? \"visible\" : \"hidden\";\r\n\t\t\tthis._rightHighlight.style.visibility = showRightHighlight ? \"visible\" : \"hidden\";\r\n\t\t\tthis._handleHighlight.style.visibility = showHandleHighlight ? \"visible\" : \"hidden\";\r\n\t\t}\r\n\t\t\r\n\t\tpublic render(): void {\r\n\t\t\tthis._barWidth = (this._editorWidth-1) / Math.max(this._doc.trackVisibleBars, this._doc.song.barCount);\r\n\t\t\t\r\n\t\t\tconst resized: boolean = this._renderedNotchCount != this._doc.song.barCount;\r\n\t\t\tif (resized) {\r\n\t\t\t\tthis._renderedNotchCount = this._doc.song.barCount;\r\n\t\t\t\t\r\n\t\t\t\twhile (this._notches.firstChild) this._notches.removeChild(this._notches.firstChild);\r\n\t\t\t\t\r\n\t\t\t\tfor (let i: number = 0; i <= this._doc.song.barCount; i++) {\r\n\t\t\t\t\tconst lineHeight: number = (i % 16 == 0) ? 0 : ((i % 4 == 0) ? this._editorHeight / 8 : this._editorHeight / 3);\r\n\t\t\t\t\tthis._notches.appendChild(SVG.rect( {fill: \"#444444\", x: i * this._barWidth - 1, y: lineHeight, width: 2, height: this._editorHeight - lineHeight * 2}));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (resized || this._renderedBarPos != this._doc.barScrollPos) {\r\n\t\t\t\tthis._renderedBarPos = this._doc.barScrollPos;\r\n\t\t\t\tthis._handle.setAttribute(\"x\", \"\" + (this._barWidth * this._doc.barScrollPos));\r\n\t\t\t\tthis._handle.setAttribute(\"width\", \"\" + (this._barWidth * this._doc.trackVisibleBars));\r\n\t\t\t\tthis._handleHighlight.setAttribute(\"x\", \"\" + (this._barWidth * this._doc.barScrollPos));\r\n\t\t\t\tthis._handleHighlight.setAttribute(\"width\", \"\" + (this._barWidth * this._doc.trackVisibleBars));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._updatePreview();\r\n\t\t\t\r\n\t\t\tthis._trackContainer.scrollLeft = this._doc.barScrollPos * 32;\r\n\t\t}\r\n\t}\r\n\r\n","/*\r\nCopyright (C) 2018 John Nesky\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\nimport { HTML, SVG } from \"imperative-html/dist/esm/elements-strict\";\r\nimport { SongDocument } from \"./SongDocument\";\r\nimport { ChangeOctave } from \"./changes\";\r\nimport { ColorConfig } from \"./ColorConfig\";\r\nimport { Piano } from \"./Piano\";\r\n\tconst {div} = HTML;\r\n\r\n\texport class OctaveScrollBar {\r\n\t\tprivate readonly _editorWidth: number = 20;\r\n\t\tprivate readonly _editorHeight: number = 481;\r\n\t\tprivate readonly _notchHeight: number = 4.0;\r\n\t\tprivate readonly _octaveCount: number = 7;\r\n\t\tprivate readonly _octaveHeight: number = (this._editorHeight - this._notchHeight) / this._octaveCount;\r\n\t\tprivate readonly _barHeight: number = (this._octaveHeight * 3 + this._notchHeight);\r\n\t\t\r\n\t\tprivate readonly _handle = <SVGRectElement> SVG.rect( {fill: ColorConfig.octaveScrollbar, x: 2, y: 0, width: this._editorWidth - 4, height: this._barHeight});\r\n\t\tprivate readonly _handleHighlight = <SVGRectElement> SVG.rect( {fill: \"none\", stroke: \"white\", \"stroke-width\": 2, \"pointer-events\": \"none\", x: 1, y: 0, width: this._editorWidth - 2, height: this._barHeight});\r\n\t\tprivate readonly _upHighlight = <SVGPathElement> SVG.path( {fill: \"white\", \"pointer-events\": \"none\"});\r\n\t\tprivate readonly _downHighlight = <SVGPathElement> SVG.path( {fill: \"white\", \"pointer-events\": \"none\"});\r\n\t\t\r\n\t\tprivate readonly _svg = <SVGSVGElement> SVG.svg( {style: \"touch-action: pan-x; position: absolute;\", width: this._editorWidth, height: \"100%\", viewBox: \"0 0 20 481\", preserveAspectRatio: \"none\"});\r\n\t\tpublic readonly container: HTMLDivElement = div({id: \"octaveScrollBarContainer\", style: \"width: 20px; height: 100%; overflow: hidden; position: relative; flex-shrink: 0;\"}, [this._svg]);\r\n\t\t\r\n\t\tpublic _mouseX: number = 0;\r\n\t\tprivate _mouseY: number = 0;\r\n\t\tprivate _mouseDown: boolean = false;\r\n\t\tprivate _mouseOver: boolean = false;\r\n\t\tprivate _dragging: boolean = false;\r\n\t\tprivate _dragStart: number;\r\n\t\tprivate _barBottom: number;\r\n\t\tprivate _renderedBarBottom: number = -1;\r\n\t\tprivate _change: ChangeOctave | null = null;\r\n\t\t\r\n\t\tconstructor(private _doc: SongDocument, private _piano: Piano) {\r\n\t\t\tthis._doc.notifier.watch(this._documentChanged);\r\n\t\t\tthis._documentChanged();\r\n\t\t\t\r\n\t\t\tthis._svg.appendChild(this._handle);\r\n\t\t\t\r\n\t\t\t// notches:\r\n\t\t\tfor (let i: number = 0; i <= this._octaveCount; i++) {\r\n\t\t\t\tthis._svg.appendChild(SVG.rect( {fill: ColorConfig.scrollbarOctave, x: 0, y: i * this._octaveHeight, width: this._editorWidth, height: this._notchHeight}));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._svg.appendChild(this._handleHighlight);\r\n\t\t\tthis._svg.appendChild(this._upHighlight);\r\n\t\t\tthis._svg.appendChild(this._downHighlight);\r\n\t\t\tthis._svg.style.backgroundColor = ColorConfig.editorBackground;\r\n\t\t\t\r\n\t\t\tconst center: number = this._editorWidth * 0.5;\r\n\t\t\tconst base: number = 20;\r\n\t\t\tconst tip: number = 9;\r\n\t\t\tconst arrowWidth: number = 6;\r\n\t\t\tthis._upHighlight.setAttribute(\"d\", `M ${center} ${tip} L ${center + arrowWidth} ${base} L ${center - arrowWidth} ${base} z`);\r\n\t\t\tthis._downHighlight.setAttribute(\"d\", `M ${center} ${this._editorHeight - tip} L ${center + arrowWidth} ${this._editorHeight - base} L ${center - arrowWidth} ${this._editorHeight - base} z`);\r\n\t\t\t\r\n\t\t\tthis.container.addEventListener(\"mousedown\", this._whenMousePressed);\r\n\t\t\tdocument.addEventListener(\"mousemove\", this._whenMouseMoved);\r\n\t\t\tdocument.addEventListener(\"mouseup\", this._whenCursorReleased);\r\n\t\t\tthis.container.addEventListener(\"mouseover\", this._whenMouseOver);\r\n\t\t\tthis.container.addEventListener(\"mouseout\", this._whenMouseOut);\r\n\t\t\t\r\n\t\t\tthis.container.addEventListener(\"touchstart\", this._whenTouchPressed);\r\n\t\t\tthis.container.addEventListener(\"touchmove\", this._whenTouchMoved);\r\n\t\t\tthis.container.addEventListener(\"touchend\", this._whenCursorReleased);\r\n\t\t\tthis.container.addEventListener(\"touchcancel\", this._whenCursorReleased);\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenMouseOver = (event: MouseEvent): void => {\r\n\t\t\tif (this._mouseOver) return;\r\n\t\t\tthis._mouseOver = true;\r\n\t\t\tthis._updatePreview();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenMouseOut = (event: MouseEvent): void => {\r\n\t\t\tif (!this._mouseOver) return;\r\n\t\t\tthis._mouseOver = false;\r\n\t\t\tthis._updatePreview();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenMousePressed = (event: MouseEvent): void => {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tthis._mouseDown = true;\r\n\t\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\r\n    \t\tthis._mouseX = (event.clientX || event.pageX) - boundingRect.left;\r\n\t\t    this._mouseY = ((event.clientY || event.pageY) - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\r\n\t\t    if (isNaN(this._mouseY)) this._mouseY = 0;\r\n\t\t\tif (this._doc.song.getChannelIsDrum(this._doc.channel)) return;\r\n\t\t\tthis._updatePreview();\r\n\t\t\t\r\n\t\t\tif (this._mouseY >= this._barBottom - this._barHeight && this._mouseY <= this._barBottom) {\r\n\t\t\t\tthis._dragging = true;\r\n\t\t\t\tthis._change = null;\r\n\t\t\t\tthis._dragStart = this._mouseY;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenTouchPressed = (event: TouchEvent): void => {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tthis._mouseDown = true;\r\n\t\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\r\n\t\t\tthis._mouseX = event.touches[0].clientX - boundingRect.left;\r\n\t\t\tthis._mouseY = (event.touches[0].clientY - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\r\n\t\t    if (isNaN(this._mouseY)) this._mouseY = 0;\r\n\t\t\tif (this._doc.song.getChannelIsDrum(this._doc.channel)) return;\r\n\t\t\tthis._updatePreview();\r\n\t\t\t\r\n\t\t\tif (this._mouseY >= this._barBottom - this._barHeight && this._mouseY <= this._barBottom) {\r\n\t\t\t\tthis._dragging = true;\r\n\t\t\t\tthis._change = null;\r\n\t\t\t\tthis._dragStart = this._mouseY;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenMouseMoved = (event: MouseEvent): void => {\r\n\t\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\r\n    \t\tthis._mouseX = (event.clientX || event.pageX) - boundingRect.left;\r\n\t\t    this._mouseY = ((event.clientY || event.pageY) - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\r\n\t\t    if (isNaN(this._mouseY)) this._mouseY = 0;\r\n\t\t    this._whenCursorMoved();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenTouchMoved = (event: TouchEvent): void => {\r\n\t\t\tif (!this._mouseDown) return;\r\n\t\t\tevent.preventDefault();\r\n\t\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\r\n\t\t\tthis._mouseX = event.touches[0].clientX - boundingRect.left;\r\n\t\t\tthis._mouseY = (event.touches[0].clientY - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\r\n\t\t    if (isNaN(this._mouseY)) this._mouseY = 0;\r\n\t\t    this._whenCursorMoved();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenCursorMoved(): void {\r\n\t\t\tif (this._doc.song.getChannelIsDrum(this._doc.channel)) return;\r\n\t\t\tif (this._dragging) {\r\n\t\t\t\tconst currentOctave: number = this._doc.song.channels[this._doc.channel].octave;\r\n\t\t\t\tconst continuingProspectiveChange: boolean = this._doc.lastChangeWas(this._change);\r\n\t\t\t\tconst oldValue: number = continuingProspectiveChange ? this._change!.oldValue : currentOctave;\r\n\t\t\t\t\r\n\t\t\t\tlet octave: number = currentOctave;\r\n\t\t\t\twhile (this._mouseY - this._dragStart < -this._octaveHeight * 0.5) {\r\n\t\t\t\t\tif (octave < 4) {\r\n\t\t\t\t\t\toctave++;\r\n\t\t\t\t\t\tthis._dragStart -= this._octaveHeight;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\twhile (this._mouseY - this._dragStart > this._octaveHeight * 0.5) {\r\n\t\t\t\t\tif (octave > 0) {\r\n\t\t\t\t\t\toctave--;\r\n\t\t\t\t\t\tthis._dragStart += this._octaveHeight;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tthis._change = new ChangeOctave(this._doc, oldValue, octave);\r\n\t\t\t\tthis._doc.setProspectiveChange(this._change);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (this._mouseOver) this._updatePreview();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenCursorReleased = (event: Event): void => {\r\n\t\t\tif (!this._doc.song.getChannelIsDrum(this._doc.channel) && this._mouseDown) {\r\n\t\t\t\tif (this._dragging) {\r\n\t\t\t\t\tif (this._change != null) this._doc.record(this._change);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst canReplaceLastChange: boolean = this._doc.lastChangeWas(this._change);\r\n\t\t\t\t\tconst oldValue: number = canReplaceLastChange ? this._change!.oldValue : this._doc.song.channels[this._doc.channel].octave;\r\n\t\t\t\t\tconst currentOctave: number = this._doc.song.channels[this._doc.channel].octave;\r\n\t\t\t\t\r\n\t\t\t\t\tif (this._mouseY < this._barBottom - this._barHeight * 0.5) {\r\n\t\t\t\t\t\tif (currentOctave < 4) {\r\n\t\t\t\t\t\t\tthis._change = new ChangeOctave(this._doc, oldValue, currentOctave + 1);\r\n\t\t\t\t\t\t\tthis._doc.record(this._change, canReplaceLastChange);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (currentOctave > 0) {\r\n\t\t\t\t\t\t\tthis._change = new ChangeOctave(this._doc, oldValue, currentOctave - 1);\r\n\t\t\t\t\t\t\tthis._doc.record(this._change, canReplaceLastChange);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._mouseDown = false;\r\n\t\t\tthis._dragging = false;\r\n\t\t\tthis._updatePreview();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _updatePreview(): void {\r\n\t\t\tconst showHighlight: boolean = this._mouseOver && !this._mouseDown;\r\n\t\t\tlet showUpHighlight: boolean = false;\r\n\t\t\tlet showDownHighlight: boolean = false;\r\n\t\t\tlet showHandleHighlight: boolean = false;\r\n\t\t\t\r\n\t\t\tif (showHighlight) {\r\n\t\t\t\tif (this._mouseY < this._barBottom - this._barHeight) {\r\n\t\t\t\t\tshowUpHighlight = true;\r\n\t\t\t\t} else if (this._mouseY > this._barBottom) {\r\n\t\t\t\t\tshowDownHighlight = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tshowHandleHighlight = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._upHighlight.style.visibility = showUpHighlight ? \"inherit\" : \"hidden\";\r\n\t\t\tthis._downHighlight.style.visibility = showDownHighlight ? \"inherit\" : \"hidden\";\r\n\t\t\tthis._handleHighlight.style.visibility = showHandleHighlight ? \"inherit\" : \"hidden\";\r\n\t\t}\r\n\t\t\r\n\t\tprivate _documentChanged = (): void => {\r\n\t\t\tthis._barBottom = this._editorHeight - (this._octaveHeight * this._doc.song.channels[this._doc.channel].octave);\r\n\t\t\tthis._render();\r\n\t\t\tthis._piano.forceRender();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _render(): void {\r\n\t\t\tthis._svg.style.visibility = (this._doc.song.getChannelIsDrum(this._doc.channel)) ? \"hidden\" : \"visible\";\r\n\t\t\tif (this._renderedBarBottom != this._barBottom) {\r\n\t\t\t\tthis._renderedBarBottom = this._barBottom;\r\n\t\t\t\tthis._handle.setAttribute(\"y\", \"\" + (this._barBottom - this._barHeight));\r\n\t\t\t\tthis._handleHighlight.setAttribute(\"y\", \"\" + (this._barBottom - this._barHeight));\r\n\t\t\t}\r\n\t\t\tthis._updatePreview();\r\n\t\t}\r\n\t}\r\n\r\n","/*\r\nCopyright (C) 2018 John Nesky\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\nimport { HTML } from \"imperative-html/dist/esm/elements-strict\";\r\nimport { SongDocument } from \"./SongDocument\";\r\nimport { Config } from \"../synth/SynthConfig\";\r\nimport { ColorConfig } from \"./ColorConfig\";\r\n\tconst {canvas, div} = HTML;\r\n\r\n\texport class Piano {\r\n\r\n\t\tprivate readonly _pianoContainer: HTMLDivElement = HTML.div({style: \"width: 100%; height: 100%; display: flex; flex-direction: column-reverse; align-items: stretch;\"});\r\n\t\tprivate readonly _drumContainer: HTMLDivElement = HTML.div({style: \"width: 100%; height: 100%; display: flex; flex-direction: column-reverse; align-items: stretch;\"});\r\n\t\tprivate readonly _preview: HTMLCanvasElement = canvas({width: \"32\", height: \"40\"});\r\n\t\tpublic readonly container: HTMLDivElement = div({style: \"width: 32px; height: 100%; overflow:hidden; position: relative; flex-shrink: 0; touch-action: none;\"}, [\r\n\t\t\tthis._pianoContainer,\r\n\t\t\tthis._drumContainer,\r\n\t\t\tthis._preview,\r\n\t\t]);\r\n\t\tprivate readonly _editorHeight: number = 481;\r\n\t\tprivate readonly _pianoKeys: HTMLDivElement[] = [];\r\n\t\tprivate readonly _pianoLabels: HTMLDivElement[] = [];\r\n\t\t\r\n\t\tprivate _pitchHeight: number;\r\n\t\tprivate _pitchCount: number;\r\n\t\tpublic _mouseX: number = 0;\r\n\t\tprivate _mouseY: number = 0;\r\n\t\tprivate _mouseDown: boolean = false;\r\n\t\tprivate _mouseOver: boolean = false;\r\n\t\tprivate _cursorPitch: number;\r\n\t\t//private _playedPitch: number = -1;\r\n\t\tprivate _renderedScale: number = -1;\r\n\t\tprivate _renderedDrums: boolean = false;\r\n\t\tprivate _renderedKey: number = -1;\r\n\t\tprivate _renderedPitchCount: number = -1;\r\n\t\tprivate readonly _renderedLiveInputPitches: number[] = [];\r\n\t\t\r\n\t\tconstructor(private _doc: SongDocument) {\r\n\t\t\tfor (let i: number = 0; i < Config.drumCount; i++) {\r\n\t\t\t\tconst scale: number = (1.0 - (i / Config.drumCount) * 0.35) * 100;\r\n\t\t\t\tthis._drumContainer.appendChild(HTML.div({class: \"drum-button\", style: `background-size: ${scale}% ${scale}%;`}));\r\n\t\t\t}\r\n\t\t\tthis._doc.notifier.watch(this._documentChanged);\r\n\t\t\tthis._documentChanged();\r\n\t\t\t\r\n\t\t\t//this.container.addEventListener(\"mousedown\", this._whenMousePressed);\r\n\t\t\tdocument.addEventListener(\"mousemove\", this._whenMouseMoved);\r\n\t\t\tdocument.addEventListener(\"mouseup\", this._whenMouseReleased);\r\n\t\t\tthis.container.addEventListener(\"mouseover\", this._whenMouseOver);\r\n\t\t\tthis.container.addEventListener(\"mouseout\", this._whenMouseOut);\r\n\t\t\t\r\n\t\t\t//this.container.addEventListener(\"touchstart\", this._whenTouchPressed);\r\n\t\t\tthis.container.addEventListener(\"touchmove\", this._whenTouchMoved);\r\n\t\t\tthis.container.addEventListener(\"touchend\", this._whenTouchReleased);\r\n\t\t\tthis.container.addEventListener(\"touchcancel\", this._whenTouchReleased);\r\n\t\t}\r\n\t\t\r\n\t\tpublic forceRender(): void {\r\n\t\t\tthis._renderedScale = -1;\r\n\t\t\tthis._documentChanged();\r\n\t\t}\r\n\r\n\t\tprivate _updateCursorPitch(): void {\r\n\t\tconst scale: ReadonlyArray<boolean> = Config.scales[this._doc.song.scale].flags;\r\n\t\tconst mousePitch: number = Math.max(0, Math.min(this._pitchCount-1, this._pitchCount - (this._mouseY / this._pitchHeight)));\r\n\t\tif (scale[Math.floor(mousePitch) % Config.pitchesPerOctave] || this._doc.song.getChannelIsDrum(this._doc.channel)) {\r\n\t\t\tthis._cursorPitch = Math.floor(mousePitch);\r\n\t\t} else {\r\n\t\t\tlet topPitch: number = Math.floor(mousePitch) + 1;\r\n\t\t\tlet bottomPitch: number = Math.floor(mousePitch) - 1;\r\n\t\t\twhile (!scale[topPitch % Config.pitchesPerOctave]) {\r\n\t\t\t\ttopPitch++;\r\n\t\t\t}\r\n\t\t\twhile (!scale[(bottomPitch) % Config.pitchesPerOctave]) {\r\n\t\t\t\tbottomPitch--;\r\n\t\t\t}\r\n\t\t\tlet topRange: number = topPitch;\r\n\t\t\tlet bottomRange: number = bottomPitch + 1;\r\n\t\t\tif (topPitch % Config.pitchesPerOctave == 0 || topPitch % Config.pitchesPerOctave == 7) {\r\n\t\t\t\ttopRange -= 0.5;\r\n\t\t\t}\r\n\t\t\tif (bottomPitch % Config.pitchesPerOctave == 0 || bottomPitch % Config.pitchesPerOctave == 7) {\r\n\t\t\t\tbottomRange += 0.5;\r\n\t\t\t}\r\n\t\t\tthis._cursorPitch = mousePitch - bottomRange > topRange - mousePitch ? topPitch : bottomPitch;\r\n\t\t}\r\n\t}\r\n\r\n\t\t/*private _playLiveInput(): void {\r\n\t\t\tconst currentPitch: number = this._cursorPitch + this._doc.song.channels[this._doc.channel].octave * 12;\r\n\t\t\tif (this._playedPitch == currentPitch) return;\r\n\t\t\tthis._playedPitch = currentPitch;\r\n\t\t\tthis._doc.synth.liveInputDuration = Number.MAX_SAFE_INTEGER;\r\n\t\t\tthis._doc.synth.liveInputPitches = [this._playedPitch];\r\n\t\t\tthis._doc.synth.liveInputStarted = true;\r\n\t\t}*/\r\n\t\t\r\n\t\tprivate _whenMouseOver = (event: MouseEvent): void => {\r\n\t\t\tif (this._mouseOver) return;\r\n\t\t\tthis._mouseOver = true;\r\n\t\t\tthis._updatePreview();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenMouseOut = (event: MouseEvent): void => {\r\n\t\t\tif (!this._mouseOver) return;\r\n\t\t\tthis._mouseOver = false;\r\n\t\t\tthis._updatePreview();\r\n\t\t}\r\n\t\t\r\n\t\t/*private _whenMousePressed = (event: MouseEvent): void => {\r\n\t\t\tevent.preventDefault();\r\n\t\t\t//this._doc.synth.maintainLiveInput();\r\n\t\t\tthis._mouseDown = true;\r\n\t\t\tconst boundingRect: ClientRect = this.container.getBoundingClientRect();\r\n\t\t\t//this._mouseX = (event.clientX || event.pageX) - boundingRect.left;\r\n\t\t\tthis._mouseY = ((event.clientY || event.pageY) - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\r\n\t\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\r\n\t\t\tthis._updateCursorPitch();\r\n\t\t\t//this._playLiveInput();\r\n\t\t\tthis._updatePreview();\r\n\t\t}*/\r\n\t\t\r\n\t\tprivate _whenMouseMoved = (event: MouseEvent): void => {\r\n\t\t\tconst boundingRect: ClientRect = this.container.getBoundingClientRect();\r\n    \t\tthis._mouseX = (event.clientX || event.pageX) - boundingRect.left;\r\n\t\t    this._mouseY = ((event.clientY || event.pageY) - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\r\n\t\t    if (isNaN(this._mouseY)) this._mouseY = 0;\r\n\t\t\tthis._updateCursorPitch();\r\n\t\t\tthis._doc.synth.pianoPitch[0] = this._cursorPitch + this._doc.song.channels[this._doc.channel].octave * 12;\r\n\t\t\tthis._updatePreview();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenMouseReleased = (event: MouseEvent): void => {\r\n\t\t\tthis._mouseDown = false;\r\n\t\t\tthis._doc.synth.pianoPressed = false;\r\n\t\t\tthis._updatePreview();\r\n\t\t}\r\n\t\t\r\n\t\t/*private _whenTouchPressed = (event: TouchEvent): void => {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tthis._mouseDown = true;\r\n\t\t\tconst boundingRect: ClientRect = this.container.getBoundingClientRect();\r\n\t\t\tthis._mouseX = event.touches[0].clientX - boundingRect.left;\r\n\t\t\tthis._mouseY = (event.touches[0].clientY - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\r\n\t\t    if (isNaN(this._mouseY)) this._mouseY = 0;\r\n\t\t\tthis._updateCursorPitch();\r\n\t\t\tthis._doc.synth.pianoPressed = true;\r\n\t\t\tthis._doc.synth.pianoPitch[0] = this._cursorPitch + this._doc.song.channels[this._doc.channel].octave * 12;\r\n\t\t}*/\r\n\t\t\r\n\t\tprivate _whenTouchMoved = (event: TouchEvent): void => {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tconst boundingRect: ClientRect = this.container.getBoundingClientRect();\r\n\t\t\tthis._mouseX = event.touches[0].clientX - boundingRect.left;\r\n\t\t\tthis._mouseY = (event.touches[0].clientY - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\r\n\t\t    if (isNaN(this._mouseY)) this._mouseY = 0;\r\n\t\t\tthis._updateCursorPitch();\r\n\t\t\tthis._doc.synth.pianoPitch[0] = this._cursorPitch + this._doc.song.channels[this._doc.channel].octave * 12;\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenTouchReleased = (event: TouchEvent): void => {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tthis._doc.synth.pianoPressed = false;\r\n\t\t}\r\n\t\t\r\n\t\tprivate _updatePreview(): void {\r\n\t\t\tthis._preview.style.visibility = (!this._mouseOver || this._mouseDown) ? \"hidden\" : \"visible\";\r\n\t\t\r\n\t\tif (this._mouseOver && !this._mouseDown) {\r\n\t\t\tconst boundingRect: ClientRect = this.container.getBoundingClientRect();\r\n\t\t\tconst pitchHeight: number = this._pitchHeight / (this._editorHeight / (boundingRect.bottom - boundingRect.top));\r\n\t\t\t\r\n\t\t\tthis._preview.style.left = \"0px\";\r\n\t\t\tthis._preview.style.top = pitchHeight * (this._pitchCount - this._cursorPitch - 1) + \"px\";\r\n\t\t\tthis._preview.style.height = pitchHeight + \"px\";\r\n\t\t}\r\n\t\t\r\n\t\t\tconst octaveOffset: number = this._doc.getBaseVisibleOctave(this._doc.channel) * Config.pitchesPerOctave;\r\n\t\t\tconst container: HTMLDivElement = this._doc.song.getChannelIsDrum(this._doc.channel) ? this._drumContainer : this._pianoContainer;\r\n\t\t\tconst children: HTMLCollection = container.children;\r\n\t\t\tfor (let i: number = 0; i < children.length; i++) {\r\n\t\t\t\tconst child: Element = children[i];\r\n\t\t\t\tif (this._renderedLiveInputPitches.indexOf(i + octaveOffset) == -1) {\r\n\t\t\t\t\tchild.classList.remove(\"pressed\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tchild.classList.add(\"pressed\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tprivate _documentChanged = (): void => {\r\n\t\t\tconst isDrum: boolean = this._doc.song.getChannelIsDrum(this._doc.channel);\r\n\t\t\tthis._pitchCount = isDrum ? Config.drumCount : this._doc.getVisiblePitchCount();\r\n\t\t\tthis._pitchHeight = this._editorHeight / this._pitchCount;\r\n\t\t\tthis._updateCursorPitch();\r\n\t\t\t//if (this._mouseDown) this._playLiveInput();\r\n\t\t\t\r\n\t\t\tif (!this._doc.prefs.showLetters) return;\r\n\t\t\tif (this._renderedScale == this._doc.song.scale && this._renderedKey == this._doc.song.key && this._renderedDrums == isDrum && this._renderedPitchCount == this._pitchCount) return;\r\n\t\t\t\r\n\t\t\tthis._renderedScale = this._doc.song.scale;\r\n\t\t\tthis._renderedKey = this._doc.song.key;\r\n\t\t\tthis._renderedDrums = isDrum;\r\n\t\t\t\r\n\t\t\tthis._pianoContainer.style.display = isDrum ? \"none\" : \"flex\";\r\n\t\t\tthis._drumContainer.style.display = isDrum ? \"flex\" : \"none\";\r\n\t\t\t\r\n\t\t\tif (!isDrum) {\r\n\t\t\t\tif (this._renderedPitchCount != this._pitchCount) {\r\n\t\t\t\t\tthis._pianoContainer.innerHTML = \"\";\r\n\t\t\t\t\tfor (let i: number = 0; i < this._pitchCount; i++) {\r\n\t\t\t\t\t\tconst pianoLabel: HTMLDivElement = HTML.div({class: \"piano-label\", style: \"font-weight: bold; -webkit-text-stroke-width: 0; font-size: 11px; font-family: sans-serif; position: absolute; padding-left: 15px;\"});\r\n\t\t\t\t\t\tconst pianoKey: HTMLDivElement = HTML.div({class: \"piano-button\", style: \"background: gray;\"}, pianoLabel);\r\n\t\t\t\t\t\tthis._pianoContainer.appendChild(pianoKey);\r\n\t\t\t\t\t\tthis._pianoLabels[i] = pianoLabel;\r\n\t\t\t\t\t\tthis._pianoKeys[i] = pianoKey;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._pianoLabels.length = this._pitchCount;\r\n\t\t\t\t\tthis._pianoKeys.length = this._pitchCount;\r\n\t\t\t\t\tthis._renderedPitchCount = this._pitchCount;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tfor (let j: number = 0; j < this._pitchCount; j++) {\r\n\t\t\t\t\tconst pitchNameIndex: number = (j + Config.keys[this._doc.song.key].basePitch) % Config.pitchesPerOctave;\r\n\t\t\t\t\tconst isWhiteKey: boolean = Config.keys[pitchNameIndex].isWhiteKey;\r\n\t\t\t\t\tthis._pianoKeys[j].style.background = isWhiteKey ? ColorConfig.whitePianoKey : ColorConfig.blackPianoKey;\r\n\t\t\t\t\tif (!Config.scales[this._doc.song.scale].flags[j % Config.pitchesPerOctave]) {\r\n\t\t\t\t\t\tthis._pianoKeys[j].classList.add(\"disabled\");\r\n\t\t\t\t\t\tthis._pianoLabels[j].style.display = \"none\";\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis._pianoKeys[j].classList.remove(\"disabled\");\r\n\t\t\t\t\t\tthis._pianoLabels[j].style.display = \"\";\r\n\t\t\t\t\t\tconst label: HTMLDivElement = this._pianoLabels[j];\r\n\t\t\t\t\t\tif ((j % 12) == 0) {\r\n\t\t\t\t\t\t\tlabel.style.transform = \"translate(-5px, 0px)\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tlabel.style.transform = \"translate(0px, 0px)\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlabel.style.color = Config.keys[pitchNameIndex].isWhiteKey ? \"black\" : \"white\";\r\n\t\t\t\t\t\tlabel.textContent = Piano.getPitchName(pitchNameIndex, j, this._doc.getBaseVisibleOctave(this._doc.channel));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._updatePreview();\r\n\t\t}\r\n\t\r\n\t\tpublic static getPitchName(pitchNameIndex: number, scaleIndex: number, baseVisibleOctave: number): string {\r\n\t\tlet text: string;\r\n\r\n\t\tif (Config.keys[pitchNameIndex].isWhiteKey) {\r\n\t\t\ttext = Config.keys[pitchNameIndex].name;\r\n\t\t} else {\r\n\t\t\tconst shiftDir: number = Config.blackKeyNameParents[scaleIndex % Config.pitchesPerOctave];\r\n\t\t\ttext = Config.keys[(pitchNameIndex + Config.pitchesPerOctave + shiftDir) % Config.pitchesPerOctave].name;\r\n\t\t\tif (shiftDir == 1) {\r\n\t\t\t\ttext += \"‚ô≠\";\r\n\t\t\t} else if (shiftDir == -1) {\r\n\t\t\t\ttext += \"‚ôØ\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (scaleIndex % 12 == 0) {\r\n\t\t\ttext += Math.floor(scaleIndex / 12) + baseVisibleOctave;\r\n\t\t}\r\n\r\n\t\treturn text;\r\n\t}\r\n\t\t\r\n\t}\r\n\r\n","/*\r\nCopyright (C) 2018 John Nesky\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\nimport { HTML } from \"imperative-html/dist/esm/elements-strict\";\r\nimport { Prompt } from \"./Prompt\";\r\nimport { SongDocument } from \"./SongDocument\";\r\n\tconst {button, div} = HTML;\r\n\r\n\t\texport class MixPrompt implements Prompt {\r\n\t\tprivate readonly _cancelButton: HTMLButtonElement = button({}, [div(\"Close\")]);\r\n\t\tpublic readonly container: HTMLDivElement = div({class: \"prompt\", style: \"width: 300px;\"}, [\r\n\t\t\tdiv({style: \"font-size: 2em\"}, [div(\"Mixing Styles\")]),\r\n\t\t\tdiv({style: \"text-align: left; margin: 0.5em 0;\"}, [\r\n\t\t\t\tdiv(\"Mixing styles are a way how changing how loud or soft different sounds are and can change the way different sounds blend and mix together. Using different mixing styles can drastically change your song.\")]),\r\n\t\t\tdiv({style: \"text-align: left; margin: 0.5em 0;\"}, [\r\n\t\t\t\tdiv(\"Type A Mixing is akin to mixing in vanilla Beepbox, Sandbox, and most other beepbox mods. In this mixing type, the drums are about twice as loud as in Type B mixing and the sound is generally a bit sharper and blends together differently.\")]),\r\n\t\t\tdiv({style: \"text-align: left; margin: 0.5em 0;\"}, [\r\n\t\t\t\tdiv(\"Type B Mixing is regular Modbox mixing.\")]),\r\n\t\t\tdiv({style: \"text-align: left; margin: 0.5em 0;\"}, [\r\n\t\t\t\tdiv(\"Type C Mixing is like Type B, save for a few upgrades. There are more volume options in Type C mixing, certain waves (acoustic bass, lyre, ramp pulse, and piccolo) are a bit quieter, the flatline wave is a bit louder, and blending works slightly differently.\")]),\r\n\t\t\tdiv({style: \"text-align: left; margin: 0.5em 0;\"}, [\r\n\t\t\t\tdiv(\"Type D Mixing includes slightly quieter drums from Type B, but also includes sharper sounds for regular notes in pitch channels.\")]),\r\n\t\t\tthis._cancelButton,\r\n\t\t]);\t\r\n\t\t\tconstructor(private _doc: SongDocument) {\r\n\t\t\t\tthis._cancelButton.addEventListener(\"click\", this._close);\r\n\t\t\t}\r\n\r\n\t\t\tprivate _close = (): void => { \r\n\t\t\t\tthis._doc.undo();\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t\tpublic cleanUp = (): void => { \r\n\t\t\t\tthis._cancelButton.removeEventListener(\"click\", this._close);\r\n\t\t\t};\r\n\t\t}\r\n\t","/*\r\nCopyright (C) 2018 John Nesky\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\nimport { HTML } from \"imperative-html/dist/esm/elements-strict\";\r\nimport { Prompt } from \"./Prompt\";\r\nimport { SongDocument } from \"./SongDocument\";\r\n\tconst {button, div} = HTML;\r\n\r\n\texport class ChorusPrompt implements Prompt {\r\n\t\tprivate readonly _cancelButton: HTMLButtonElement = button({}, [div(\"Close\")]);\r\n\t\t\r\n\t\tpublic readonly container: HTMLDivElement = div({class: \"prompt\", style: \"width: 250px;\"}, [\r\n\t\t\tdiv({style: \"font-size: 2em\"}, [div(\"Custom Harmony\")]),\r\n\t\t\tdiv({style: \"text-align: left;\"}, [div(\r\n\t\t\t\t'BeepBox \"chip\" instruments play two waves at once, each with their own pitch.')]),\r\n\t\t\tdiv({style: \"text-align: left;\" }, [div('By placing two notes one above another it will play two indivdual sounds. ' +\r\n\t\t\t'This replaces the \"arpeggio/trill\" effect, and gives you greater control over your harmony. ')]),\r\n\t\t\tdiv({ style: \"text-align: left;\" }, [\r\n\t\t\t\tdiv('In older versions of Modbox, union would not allow notes to harmonize properly and needed a special harmonic chorus in order to work. This has been patched in Modbox 3.1.0. '\r\n\t\t\t\t)]),\r\n\t\t\tthis._cancelButton,\r\n\t\t]);\r\n\t\t\r\n\t\tconstructor(private _doc: SongDocument) {\r\n\t\t\tthis._cancelButton.addEventListener(\"click\", this._close);\r\n\t\t}\r\n\t\t\r\n\t\tprivate _close = (): void => { \r\n\t\t\tthis._doc.undo();\r\n\t\t}\r\n\t\t\r\n\t\tpublic cleanUp = (): void => { \r\n\t\t\tthis._cancelButton.removeEventListener(\"click\", this._close);\r\n\t\t}\r\n\t}\r\n\r\n","/*\r\nCopyright (C) 2018 John Nesky\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\nimport { Config, Dictionary, InstrumentType, EnvelopeType } from \"./SynthConfig\";\r\nimport { Instrument, Song, Note, NotePin, Pattern } from \"./song\";\r\n//import { Deque } from \"./Deque\";\r\n\r\n\tdeclare global {\r\n\t\tinterface Window {\r\n\t\t\tAudioContext: any;\r\n\t\t\twebkitAudioContext: any;\r\n\t\t}\r\n\t}\r\n\r\n\tclass SynthChannel {\r\n\t\tpublic sampleLeft: number = 0.0;\r\n\t\tpublic sampleRight: number = 0.0;\r\n\t\tpublic readonly phases: number[] = [];\r\n\t\tpublic readonly phaseDeltas: number[] = [];\r\n\t\tpublic readonly volumeStarts: number[] = [];\r\n\t\tpublic readonly volumeDeltas: number[] = [];\r\n\t\tpublic readonly volumeLeft: number[] = [];\r\n\t\tpublic readonly volumeRight: number[] = [];\r\n\t\tpublic phaseDeltaScale: number = 0.0;\r\n\t\tpublic filter: number = 0.0;\r\n\t\tpublic filterScale: number = 0.0;\r\n\t\tpublic vibratoScale: number = 0.0;\r\n\t\tpublic harmonyMult: number = 0.0;\r\n\t\tpublic harmonyVolumeMult: number = 1.0;\r\n\t\tpublic feedbackOutputs: number[] = [];\r\n\t\tpublic feedbackMult: number = 0.0;\r\n\t\tpublic feedbackDelta: number = 0.0;\r\n\t\t\r\n\t\tconstructor() {\r\n\t\t\tthis.reset();\r\n\t\t}\r\n\t\t\r\n\t\tpublic reset(): void {\r\n\t\t\tfor (let i: number = 0; i < Config.operatorCount; i++) {\r\n\t\t\t\tthis.phases[i] = 0.0;\r\n\t\t\t\tthis.feedbackOutputs[i] = 0.0;\r\n\t\t\t}\r\n\t\t\tthis.sampleLeft = 0.0;\r\n\t\t\tthis.sampleRight = 0.0;\r\n\t\t}\r\n\t}\r\n\t\r\n\texport class Tone {\r\n\t\tpublic instrument: Instrument;\r\n\t\tpublic readonly pitches: number[] = [0, 0, 0, 0];\r\n\t\tpublic pitchCount: number = 0;\r\n\t\tpublic chordSize: number = 0;\r\n\t\tpublic drumsetPitch: number = 0;\r\n\t\tpublic note: Note | null = null;\r\n\t\tpublic prevNote: Note | null = null;\r\n\t\tpublic nextNote: Note | null = null;\r\n\t\tpublic prevNotePitchIndex: number = 0;\r\n\t\tpublic nextNotePitchIndex: number = 0;\r\n\t\tpublic active: boolean = false;\r\n\t\tpublic noteStart: number = 0;\r\n\t\tpublic noteEnd: number = 0;\r\n\t\tpublic noteLengthTicks: number = 0;\r\n\t\tpublic ticksSinceReleased: number = 0;\r\n\t\tpublic liveInputSamplesHeld: number = 0;\r\n\t\tpublic lastInterval: number = 0;\r\n\t\tpublic lastVolume: number = 0;\r\n\t\tpublic stereoVolume1: number = 0.0;\r\n\t\tpublic stereoVolume2: number = 0.0;\r\n\t\tpublic stereoOffset: number = 0.0;\r\n\t\tpublic stereoDelay: number = 0.0;\r\n\t\tpublic sample: number = 0.0;\r\n\t\tpublic readonly phases: number[] = [];\r\n\t\tpublic readonly phaseDeltas: number[] = [];\r\n\t\tpublic readonly volumeStarts: number[] = [];\r\n\t\tpublic readonly volumeDeltas: number[] = [];\r\n\t\tpublic volumeStart: number = 0.0;\r\n\t\tpublic volumeDelta: number = 0.0;\r\n\t\tpublic phaseDeltaScale: number = 0.0;\r\n\t\tpublic pulseWidth: number = 0.0;\r\n\t\tpublic pulseWidthDelta: number = 0.0;\r\n\t\tpublic filter: number = 0.0;\r\n\t\tpublic filterScale: number = 0.0;\r\n\t\tpublic filterSample0: number = 0.0;\r\n\t\tpublic filterSample1: number = 0.0;\r\n\t\tpublic vibratoScale: number = 0.0;\r\n\t\tpublic intervalMult: number = 0.0;\r\n\t\tpublic intervalVolumeMult: number = 1.0;\r\n\t\tpublic feedbackOutputs: number[] = [];\r\n\t\tpublic feedbackMult: number = 0.0;\r\n\t\tpublic feedbackDelta: number = 0.0;\r\n\t\t\r\n\t\tconstructor() {\r\n\t\t\tthis.reset();\r\n\t\t}\r\n\t\t\r\n\t\tpublic reset(): void {\r\n\t\t\tfor (let i: number = 0; i < Config.operatorCount; i++) {\r\n\t\t\t\tthis.phases[i] = 0.0;\r\n\t\t\t\tthis.feedbackOutputs[i] = 0.0;\r\n\t\t\t}\r\n\t\t\tthis.sample = 0.0;\r\n\t\t\tthis.filterSample0 = 0.0;\r\n\t\t\tthis.filterSample1 = 0.0;\r\n\t\t\tthis.liveInputSamplesHeld = 0.0;\r\n\t\t}\r\n\t}\r\n\r\n\texport class Synth {\r\n\t\t\r\n\t\tprivate static warmUpSynthesizer(song: Song | null): void {\r\n\t\t\t// Don't bother to generate the drum waves unless the song actually\r\n\t\t\t// uses them, since they may require a lot of computation.\r\n\t\t\tif (song != null) {\r\n\t\t\t\tfor (let i: number = 0; i < song.instrumentsPerChannel; i++) {\r\n\t\t\t\t\tfor (let j: number = song.pitchChannelCount; j < song.pitchChannelCount + song.drumChannelCount; j++) {\r\n\t\t\t\t\t\tConfig.getDrumWave(song.channels[j].instruments[i].wave);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tfor (let i: number = 0; i < song.barCount; i++) {\r\n\t\t\t\t\tSynth.getGeneratedSynthesizer(song, i);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tprivate static operatorAmplitudeCurve(amplitude: number): number {\r\n\t\t\treturn (Math.pow(16.0, amplitude / 15.0) - 1.0) / 15.0;\r\n\t\t}\r\n\t\t\r\n\t\tprivate static readonly negativePhaseGuard: number = 1000;\r\n\t\t\r\n\t\tpublic samplesPerSecond: number = 44100;\r\n\t\tprivate effectDuration: number = 0.14;\r\n\t\tprivate effectAngle: number = Math.PI * 2.0 / (this.effectDuration * this.samplesPerSecond);\r\n\t\tpublic effectYMult: number = 2.0 * Math.cos(this.effectAngle);\r\n\t\tpublic limitDecay: number = 1.0 / (2.0 * this.samplesPerSecond);\r\n\t\t\r\n\t\tpublic song: Song | null = null;\r\n\t\tpublic pianoPressed: boolean = false;\r\n\t\tpublic pianoPitch: number[] = [0];\r\n\t\tpublic pianoChannel: number = 0;\r\n\t\tpublic enableIntro: boolean = true;\r\n\t\tpublic enableOutro: boolean = false;\r\n\t\tpublic loopCount: number = -1;\r\n\t\tpublic volume: number = 1.0;\r\n\t\t\r\n\t\tpublic liveInputDuration: number = 0;\r\n\t\tpublic liveInputStarted: boolean = false;\r\n\t\tpublic liveInputPitches: number[] = [];\r\n\t\tpublic liveInputChannel: number = 0;\r\n\t\t\r\n\t\tprivate playheadInternal: number = 0.0;\r\n\t\tprivate bar: number = 0;\r\n\t\tprivate beat: number = 0;\r\n\t\tprivate part: number = 0;\r\n\t\tprivate arpeggio: number = 0;\r\n\t\tprivate arpSampleCountdown: number = 0;\r\n\t\tprivate isPlaying: boolean = false;\r\n\t\tprivate liveInputEndTime: number = 0.0;\r\n\t\tprivate browserAutomaticallyClearsAudioBuffer: boolean = true;\r\n\t\t\r\n\t\tprivate readonly channels: SynthChannel[] = [];\r\n\t\tpublic stillGoing: boolean = false;\r\n\t\tpublic effectPhase: number = 0.0;\r\n\t\tpublic limit: number = 0.0;\r\n\t\t\r\n\t\tprivate delayLineLeft: Float32Array = new Float32Array(16384);\r\n\t\tprivate delayLineRight: Float32Array = new Float32Array(16384);\r\n\t\tpublic delayPosLeft: number = 0;\r\n\t\tpublic delayPosRight: number = 0;\r\n\t\tpublic delayFeedback0Left: number = 0.0;\r\n\t\tpublic delayFeedback0Right: number = 0.0;\r\n\t\tpublic delayFeedback1Left: number = 0.0;\r\n\t\tpublic delayFeedback1Right: number = 0.0;\r\n\t\tpublic delayFeedback2Left: number = 0.0;\r\n\t\tpublic delayFeedback2Right: number = 0.0;\r\n\t\tpublic delayFeedback3Left: number = 0.0;\r\n\t\tpublic delayFeedback3Right: number = 0.0;\r\n\t\t\r\n\t\tprivate audioCtx: any | null = null;\r\n\t\tprivate scriptNode: any | null = null;\r\n\t\t\r\n\t\tpublic get playing(): boolean {\r\n\t\t\treturn this.isPlaying;\r\n\t\t}\r\n\t\t\r\n\t\tpublic get playhead(): number {\r\n\t\t\treturn this.playheadInternal;\r\n\t\t}\r\n\t\t\r\n\t\tpublic set playhead(value: number) {\r\n\t\t\tif (this.song != null) {\r\n\t\t\t\tthis.playheadInternal = Math.max(0, Math.min(this.song.barCount, value));\r\n\t\t\t\tlet remainder: number = this.playheadInternal;\r\n\t\t\t\tthis.bar = Math.floor(remainder);\r\n\t\t\t\tremainder = this.song.beatsPerBar * (remainder - this.bar);\r\n\t\t\t\tthis.beat = Math.floor(remainder);\r\n\t\t\t\tremainder = this.song.partsPerBeat * (remainder - this.beat);\r\n\t\t\t\tthis.part = Math.floor(remainder);\r\n\t\t\t\tremainder = 4 * (remainder - this.part);\r\n\t\t\t\tthis.arpeggio = Math.floor(remainder);\r\n\t\t\t\tconst samplesPerTick: number = this.getSamplesPerArpeggio();\r\n\t\t\t\tremainder = samplesPerTick * (remainder - this.arpeggio);\r\n\t\t\t\tthis.arpSampleCountdown = Math.floor(samplesPerTick - remainder);\r\n\t\t\t\tif (this.bar < this.song.loopStart) {\r\n\t\t\t\t\tthis.enableIntro = true;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.bar > this.song.loopStart + this.song.loopLength) {\r\n\t\t\t\t\tthis.enableOutro = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tpublic get totalSamples(): number {\r\n\t\t\tif (this.song == null) return 0;\r\n\t\t\tconst samplesPerBar: number = this.getSamplesPerArpeggio() * 4 * this.song.partsPerBeat * this.song.beatsPerBar;\r\n\t\t\tlet loopMinCount: number = this.loopCount;\r\n\t\t\tif (loopMinCount < 0) loopMinCount = 1;\r\n\t\t\tlet bars: number = this.song.loopLength * loopMinCount;\r\n\t\t\tif (this.enableIntro) bars += this.song.loopStart;\r\n\t\t\tif (this.enableOutro) bars += this.song.barCount - (this.song.loopStart + this.song.loopLength);\r\n\t\t\treturn bars * samplesPerBar;\r\n\t\t}\r\n\t\t\r\n\t\tpublic get totalSeconds(): number {\r\n\t\t\t// @TODO: Revisit\r\n\t\t\treturn Math.round(this.totalSamples / this.samplesPerSecond);\r\n\t\t}\r\n\t\t\r\n\t\tpublic get totalBars(): number {\r\n\t\t\tif (this.song == null) return 0.0;\r\n\t\t\treturn this.song.barCount;\r\n\t\t}\r\n\t\t\r\n\t\tconstructor(song: any = null) {\r\n\t\t\tif (song != null) this.setSong(song);\r\n\t\t}\r\n\t\t\r\n\t\tpublic setSong(song: any): void {\r\n\t\t\tif (typeof(song) == \"string\") {\r\n\t\t\t\tthis.song = new Song(song);\r\n\t\t\t} else if (song instanceof Song) {\r\n\t\t\t\tthis.song = song;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tprivate spsCalc(): number {\r\n\t\t\tSynth.warmUpSynthesizer(this.song);\r\n\t\t\tif (this.song!.sampleRate == 0) return 44100;\r\n\t\t\telse if (this.song!.sampleRate == 1) return 48000;\r\n\t\t\telse if (this.song!.sampleRate == 2) return this.audioCtx.sampleRate;\r\n\t\t\telse if (this.song!.sampleRate == 3) return this.audioCtx.sampleRate * 4;\r\n\t\t\telse if (this.song!.sampleRate == 4) return this.audioCtx.sampleRate * 2;\r\n\t\t\telse if (this.song!.sampleRate == 5) return this.audioCtx.sampleRate / 2;\r\n\t\t\telse if (this.song!.sampleRate == 6) return this.audioCtx.sampleRate / 4;\r\n\t\t\telse if (this.song!.sampleRate == 7) return this.audioCtx.sampleRate / 8;\r\n\t\t\telse if (this.song!.sampleRate == 8) return this.audioCtx.sampleRate / 16;\r\n\t\t\telse return this.audioCtx.sampleRate;\r\n\t\t}\r\n\r\n\t\tprivate activateAudio(): void {\r\n\t\t\tif (this.audioCtx == null || this.scriptNode == null) {\r\n\t\t\t\tif (this.scriptNode != null) this.deactivateAudio();\r\n\t\t\t\tthis.audioCtx = this.audioCtx || new (window.AudioContext || window.webkitAudioContext);\r\n\t\t\t\tthis.samplesPerSecond = this.spsCalc();\r\n\t\t\t\tthis.scriptNode = this.audioCtx.createScriptProcessor ? this.audioCtx.createScriptProcessor(2048, 0, 2) : this.audioCtx.createJavaScriptNode(2048, 0, 2); \r\n\t\t\t\tthis.scriptNode.onaudioprocess = this.audioProcessCallback;\r\n\t\t\t\tthis.scriptNode.channelCountMode = 'explicit';\r\n\t\t\t\tthis.scriptNode.channelInterpretation = 'speakers';\r\n\r\n\t\t\t\tthis.effectAngle = Math.PI * 2.0 / (this.effectDuration * this.samplesPerSecond);\r\n\t\t\t\tthis.effectYMult = 2.0 * Math.cos(this.effectAngle);\r\n\t\t\t\tthis.limitDecay = 1.0 / (2.0 * this.samplesPerSecond);\r\n\t\t\t\t\r\n\t\t\t\tthis.scriptNode.connect(this.audioCtx.destination);\r\n\t\t\t}\r\n\t\t\tthis.audioCtx.resume();\r\n\t\t}\r\n\t\t\r\n\t\tprivate deactivateAudio(): void {\r\n\t\t\tif (this.audioCtx != null && this.scriptNode != null) {\r\n\t\t\t\tthis.scriptNode.disconnect(this.audioCtx.destination);\r\n\t\t\t\tthis.scriptNode = null;\r\n\t\t\t\tif (this.audioCtx.close) this.audioCtx.close(); // firefox is missing this function?\r\n\t\t\t\tthis.audioCtx = null;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t\tpublic maintainLiveInput(): void {\r\n\t\t\t\tthis.activateAudio();\r\n\t\t\t\tthis.liveInputEndTime = performance.now() + 10000.0;\r\n\t\t\t}\r\n\r\n\t\tpublic play(): void {\r\n\t\t\tif (this.isPlaying) return;\r\n\t\t\tthis.isPlaying = true;\r\n\t\t\t\r\n\t\t\tSynth.warmUpSynthesizer(this.song);\r\n\t\t\tthis.activateAudio();\r\n\t\t}\r\n\t\t\r\n\t\tpublic pause(): void {\r\n\t\t\tif (!this.isPlaying) return;\r\n\t\t\tthis.isPlaying = false;\r\n\t\t\tthis.deactivateAudio();\r\n\t\t\tthis.scriptNode = null;\r\n\t\t}\r\n\t\t\r\n\t\t/*private determineLiveInputTones(song: Song): void {\r\n\t\t\tconst toneList: Deque<Tone> = this.liveInputTones;\r\n\t\t\tconst pitches: number[] = this.liveInputPitches;\r\n\t\t\tlet toneCount: number = 0;\r\n\t\t\tif (this.liveInputDuration > 0) {\r\n\t\t\t\tconst instrument: Instrument = song.channels[this.liveInputChannel].instruments[song.getPatternInstrument(this.liveInputChannel, this.bar)];\r\n\t\t\t\t\r\n\t\t\t\tif (instrument.getChord().arpeggiates) {\r\n\t\t\t\t\tlet tone: Tone;\r\n\t\t\t\t\tif (toneList.count() == 0) {\r\n\t\t\t\t\t\ttone = this.newTone();\r\n\t\t\t\t\t\ttoneList.pushBack(tone);\r\n\t\t\t\t\t} else if (!instrument.getTransition().isSeamless && this.liveInputStarted) {\r\n\t\t\t\t\t\tthis.releaseTone(this.liveInputChannel, toneList.popFront());\r\n\t\t\t\t\t\ttone = this.newTone();\r\n\t\t\t\t\t\ttoneList.pushBack(tone);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttone = toneList.get(0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttoneCount = 1;\r\n\t\t\t\t\r\n\t\t\t\t\tfor (let i: number = 0; i < pitches.length; i++) {\r\n\t\t\t\t\t\ttone.pitches[i] = pitches[i];\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttone.pitchCount = pitches.length;\r\n\t\t\t\t\ttone.chordSize = 1;\r\n\t\t\t\t\ttone.instrument = instrument;\r\n\t\t\t\t\ttone.note = tone.prevNote = tone.nextNote = null;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t//const transition: Transition = instrument.getTransition();\r\n\t\t\t\t\tfor (let i: number = 0; i < pitches.length; i++) {\r\n\t\t\t\t\t\t//const strumOffsetParts: number = i * instrument.getChord().strumParts;\r\n\r\n\t\t\t\t\t\tlet tone: Tone;\r\n\t\t\t\t\t\tif (toneList.count() <= i) {\r\n\t\t\t\t\t\t\ttone = this.newTone();\r\n\t\t\t\t\t\t\ttoneList.pushBack(tone);\r\n\t\t\t\t\t\t} else if (!instrument.getTransition().isSeamless && this.liveInputStarted) {\r\n\t\t\t\t\t\t\tthis.releaseTone(this.liveInputChannel, toneList.get(i));\r\n\t\t\t\t\t\t\ttone = this.newTone();\r\n\t\t\t\t\t\t\ttoneList.set(i, tone);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttone = toneList.get(i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttoneCount++;\r\n\r\n\t\t\t\t\t\ttone.pitches[0] = pitches[i];\r\n\t\t\t\t\t\ttone.pitchCount = 1;\r\n\t\t\t\t\t\ttone.chordSize = pitches.length;\r\n\t\t\t\t\t\ttone.instrument = instrument;\r\n\t\t\t\t\t\ttone.note = tone.prevNote = tone.nextNote = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\twhile (toneList.count() > toneCount) {\r\n\t\t\t\tthis.releaseTone(this.liveInputChannel, toneList.popBack());\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.liveInputStarted = false;\r\n\t\t}*/\r\n\r\n\t\tpublic snapToStart(): void {\r\n\t\t\tthis.bar = 0;\r\n\t\t\tthis.enableIntro = true;\r\n\t\t\tthis.snapToBar();\r\n\t\t}\r\n\t\t\r\n\t\tpublic snapToBar(bar?: number): void {\r\n\t\t\tif (bar !== undefined) this.bar = bar;\r\n\t\t\tthis.playheadInternal = this.bar;\r\n\t\t\tthis.beat = 0;\r\n\t\t\tthis.part = 0;\r\n\t\t\tthis.arpeggio = 0;\r\n\t\t\tthis.arpSampleCountdown = 0;\r\n\t\t\tthis.effectPhase = 0.0;\r\n\t\t\t\r\n\t\t\tfor (const channel of this.channels) channel.reset();\r\n\t\t\t\r\n\t\t\tthis.delayPosLeft = 0;\r\n\t\t\tthis.delayPosRight = 0;\r\n\t\t\tthis.delayFeedback0Left = 0.0;\r\n\t\t\tthis.delayFeedback0Right = 0.0;\r\n\t\t\tthis.delayFeedback1Left = 0.0;\r\n\t\t\tthis.delayFeedback1Right = 0.0;\r\n\t\t\tthis.delayFeedback2Left = 0.0;\r\n\t\t\tthis.delayFeedback2Right = 0.0;\r\n\t\t\tthis.delayFeedback3Left = 0.0;\r\n\t\t\tthis.delayFeedback3Right = 0.0;\r\n\t\t\tfor (let i: number = 0; i < this.delayLineLeft.length; i++) this.delayLineLeft[i] = 0.0;\r\n\t\t\tfor (let i: number = 0; i < this.delayLineRight.length; i++) this.delayLineRight[i] = 0.0;\r\n\t\t}\r\n\t\t\r\n\t\tpublic nextBar(): void {\r\n\t\t\tif (!this.song) return;\r\n\t\t\tconst oldBar: number = this.bar;\r\n\t\t\tthis.bar++;\r\n\t\t\tif (this.enableOutro) {\r\n\t\t\t\tif (this.bar >= this.song.barCount) {\r\n\t\t\t\t\tthis.bar = this.enableIntro ? 0 : this.song.loopStart;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (this.bar >= this.song.loopStart + this.song.loopLength || this.bar >= this.song.barCount) {\r\n\t\t\t\t\tthis.bar = this.song.loopStart;\r\n\t\t\t\t}\r\n \t\t\t}\r\n\t\t\tthis.playheadInternal += this.bar - oldBar;\r\n\t\t}\r\n\t\t\r\n\t\tpublic prevBar(): void {\r\n\t\t\tif (!this.song) return;\r\n\t\t\tconst oldBar: number = this.bar;\r\n\t\t\tthis.bar--;\r\n\t\t\tif (this.bar < 0) {\r\n\t\t\t\tthis.bar = this.song.loopStart + this.song.loopLength - 1;\r\n\t\t\t}\r\n\t\t\tif (this.bar >= this.song.barCount) {\r\n\t\t\t\tthis.bar = this.song.barCount - 1;\r\n\t\t\t}\r\n\t\t\tif (this.bar < this.song.loopStart) {\r\n\t\t\t\tthis.enableIntro = true;\r\n\t\t\t}\r\n\t\t\tif (!this.enableOutro && this.bar >= this.song.loopStart + this.song.loopLength) {\r\n\t\t\t\tthis.bar = this.song.loopStart + this.song.loopLength - 1;\r\n\t\t\t}\r\n\t\t\tthis.playheadInternal += this.bar - oldBar;\r\n\t\t}\r\n\t\t\r\n\t\tprivate audioProcessCallback = (audioProcessingEvent: any): void => {\r\n\t\t\tconst outputBuffer = audioProcessingEvent.outputBuffer;\r\n\t\t\tconst outputDataL: Float32Array = outputBuffer.getChannelData(0);\r\n\t\t\tconst outputDataR: Float32Array = outputBuffer.getChannelData(1);\r\n\r\n\t\t\tif (this.browserAutomaticallyClearsAudioBuffer && (outputDataL[0] != 0.0 || outputDataR[0] != 0.0 || outputDataL[outputBuffer.length-1] != 0.0 || outputDataR[outputBuffer.length-1] != 0.0)) {\r\n\t\t\t// If the buffer is ever initially nonzero, then this must be an older browser that doesn't automatically clear the audio buffer.\r\n\t\t\tthis.browserAutomaticallyClearsAudioBuffer = false;\r\n\t\t\t}\r\n\t\t\tif (!this.browserAutomaticallyClearsAudioBuffer) {\r\n\t\t\t\t// If this browser does not clear the buffer automatically, do so manually before continuing.\r\n\t\t\t\tconst length: number = outputBuffer.length;\r\n\t\t\t\tfor (let i: number = 0; i < length; i++) {\r\n\t\t\t\t\toutputDataL[i] = 0.0;\r\n\t\t\t\t\toutputDataR[i] = 0.0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!this.isPlaying && performance.now() >= this.liveInputEndTime) { \r\n\t\t\t\tthis.deactivateAudio();\r\n\t\t\t} else {\r\n\t\t\t\tthis.synthesize(outputDataL, outputDataR, outputBuffer.length, this.isPlaying);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tpublic synthesize(dataLeft: Float32Array, dataRight: Float32Array, bufferLength: number, playSong: boolean = true): void {\r\n\t\t\tif (this.song == null) {\r\n\t\t\t\tfor (let i: number = 0; i < bufferLength; i++) {\r\n\t\t\t\t\tdataLeft[i] = 0.0;\r\n\t\t\t\t\tdataRight[i] = 0.0;\r\n\t\t\t\t}\r\n\t\t\t\tthis.deactivateAudio();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst channelCount: number = this.song.getChannelCount();\r\n\t\t\tfor (let i: number = this.channels.length; i < channelCount; i++) {\r\n\t\t\t\tthis.channels[i] = new SynthChannel();\r\n\t\t\t}\r\n\t\t\tthis.channels.length = channelCount;\r\n\t\t\t\r\n\t\t\tconst samplesPerTick: number = this.getSamplesPerArpeggio();\r\n\t\t\tlet bufferIndex: number = 0;\r\n\t\t\tlet ended: boolean = false;\r\n\t\t\t\r\n\t\t\t// Check the bounds of the playhead:\r\n\t\t\tif (this.arpSampleCountdown == 0 || this.arpSampleCountdown > samplesPerTick) {\r\n\t\t\t\tthis.arpSampleCountdown = samplesPerTick;\r\n\t\t\t}\r\n\t\t\tif (playSong) {\r\n\t\t\t\tif (this.part >= this.song.partsPerBeat) {\r\n\t\t\t\t\tthis.beat++;\r\n\t\t\t\t\tthis.part = 0;\r\n\t\t\t\t\tthis.arpeggio = 0;\r\n\t\t\t\t\tthis.arpSampleCountdown = samplesPerTick;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.beat >= this.song.beatsPerBar) {\r\n\t\t\t\t\tthis.bar++;\r\n\t\t\t\t\tthis.beat = 0;\r\n\t\t\t\t\tthis.part = 0;\r\n\t\t\t\t\tthis.arpeggio = 0;\r\n\t\t\t\t\tthis.arpSampleCountdown = samplesPerTick;\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (this.loopCount == -1) {\r\n\t\t\t\t\t\tif (this.bar < this.song.loopStart && !this.enableIntro) this.bar = this.song.loopStart;\r\n\t\t\t\t\t\tif (this.bar >= this.song.loopStart + this.song.loopLength && !this.enableOutro) this.bar = this.song.loopStart;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (this.bar >= this.song.barCount) {\r\n\t\t\t\t\tif (this.enableOutro) {\r\n\t\t\t\t\t\tthis.bar = 0;\r\n\t\t\t\t\t\tthis.enableIntro = true;\r\n\t\t\t\t\t\tended = true;\r\n\t\t\t\t\t\tthis.pause();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.bar = this.song.loopStart;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (this.bar >= this.song.loopStart) {\r\n\t\t\t\t\tthis.enableIntro = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n \t\t\twhile (true) {\r\n\t\t\t\tif (ended) {\r\n\t\t\t\t\twhile (bufferIndex < bufferLength) {\r\n\t\t\t\t\t\tdataLeft[bufferIndex] = 0.0;\r\n\t\t\t\t\t\tdataRight[bufferIndex] = 0.0;\r\n\t\t\t\t\t\tbufferIndex++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tconst generatedSynthesizer: Function = Synth.getGeneratedSynthesizer(this.song, this.bar);\r\n\t\t\t\tbufferIndex = generatedSynthesizer(this, this.song, dataLeft, dataRight, bufferLength, bufferIndex, samplesPerTick);\r\n\t\t\t\t\r\n\t\t\t\tconst finishedBuffer: boolean = (bufferIndex == -1);\r\n\t\t\t\tif (finishedBuffer) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// bar changed, reset for next bar:\r\n\t\t\t\t\tthis.beat = 0;\r\n\t\t\t\t\tthis.effectPhase = 0.0;\r\n\t\t\t\t\tthis.bar++;\r\n\t\t\t\t\tif (this.bar < this.song.loopStart) {\r\n\t\t\t\t\t\tif (!this.enableIntro) this.bar = this.song.loopStart;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.enableIntro = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.bar >= this.song.loopStart + this.song.loopLength) {\r\n\t\t\t\t\t\tif (this.loopCount > 0) this.loopCount--;\r\n\t\t\t\t\t\tif (this.loopCount > 0 || !this.enableOutro) {\r\n\t\t\t\t\t\t\tthis.bar = this.song.loopStart;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.bar >= this.song.barCount) {\r\n\t\t\t\t\t\tthis.bar = 0;\r\n\t\t\t\t\t\tthis.enableIntro = true;\r\n\t\t\t\t\t\tended = true;\r\n\t\t\t\t\t\tthis.pause();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.playheadInternal = (((this.arpeggio + 1.0 - this.arpSampleCountdown / samplesPerTick) / 4.0 + this.part) / this.song.partsPerBeat + this.beat) / this.song.beatsPerBar + this.bar;\r\n\t\t}\r\n\r\n\t\tprivate static computeOperatorEnvelope(envelope: number, time: number, beats: number, customVolume: number): number {\r\n\t\t\tswitch(Config.operatorEnvelopeType[envelope]) {\r\n\t\t\t\tcase EnvelopeType.custom: return customVolume;\r\n\t\t\t\tcase EnvelopeType.steady: return 1.0;\r\n\t\t\t\tcase EnvelopeType.pluck:\r\n\t\t\t\t\tlet curve: number = 1.0 / (1.0 + time * Config.operatorEnvelopeSpeed[envelope]);\r\n\t\t\t\t\tif (Config.operatorEnvelopeInverted[envelope]) {\r\n\t\t\t\t\t\treturn 1.0 - curve;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn curve;\r\n\t\t\t\t\t}\r\n\t\t\t\tcase EnvelopeType.tremolo: \r\n\t\t\t\t\tif (Config.operatorSpecialCustomVolume[envelope]) {\r\n\t\t\t\t\t\treturn 0.5 - Math.cos(beats * 2.0 * Math.PI * (customVolume * 4)) * 0.5;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn 0.5 - Math.cos(beats * 2.0 * Math.PI * Config.operatorEnvelopeSpeed[envelope]) * 0.5;\r\n\t\t\t\t\t}\r\n\t\t\t\tcase EnvelopeType.punch: \r\n\t\t\t\t\treturn Math.max(1.0, 2.0 - time * 10.0);\r\n\t\t\t\tcase EnvelopeType.flare:\r\n\t\t\t\t\tif (Config.operatorSpecialCustomVolume[envelope]) {\r\n\t\t\t\t\t\tconst attack: number = 0.25 / Math.sqrt(customVolume);\r\n\t\t\t\t\t\treturn time < attack ? time / attack : 1.0 / (1.0 + (time - attack) * (customVolume * 16));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconst speed: number = Config.operatorEnvelopeSpeed[envelope];\r\n\t\t\t\t\t\tconst attack: number = 0.25 / Math.sqrt(speed);\r\n\t\t\t\t\t\treturn time < attack ? time / attack : 1.0 / (1.0 + (time - attack) * speed);\r\n\t\t\t\t\t}\r\n\t\t\t\tcase EnvelopeType.flute:\r\n\t\t\t\t\treturn Math.max(-1.0 - time, -2.0 + time);\r\n\t\t\t\tdefault: throw new Error(\"Unrecognized operator envelope type.\");\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tpublic static computeChannelInstrument(synth: Synth, song: Song, channel: number, time: number, sampleTime: number, samplesPerTick: number, samples: number): void {\r\n\t\t\tconst isDrum: boolean = song.getChannelIsDrum(channel);\r\n\t\t\tconst synthChannel: SynthChannel = synth.channels[channel];\r\n\t\t\tconst pattern: Pattern | null = song.getPattern(channel, synth.bar);\r\n\t\t\tconst instrument: Instrument = song.channels[channel].instruments[pattern == null ? 0 : pattern.instrument];\r\n\t\t\tconst pianoMode = (synth.pianoPressed && channel == synth.pianoChannel);\r\n\t\t\tconst basePitch: number = isDrum ? Config.drumBasePitches[instrument.wave] : Config.keys[song.key].basePitch;\r\n\t\t\tconst intervalScale: number = isDrum ? Config.drumInterval : 1;\r\n\t\t\tconst pitchDamping: number = isDrum ? (Config.drumWaveIsSoft[instrument.wave] ? 24.0 : 60.0) : 48.0;\r\n\t\t\tconst secondsPerPart: number = 4.0 * samplesPerTick / synth.samplesPerSecond;\r\n\t\t\tconst beatsPerPart: number = 1.0 / song.partsPerBeat;\r\n\t\t\t\r\n\t\t\tsynthChannel.phaseDeltaScale = 0.0;\r\n\t\t\tsynthChannel.filter = 1.0;\r\n\t\t\tsynthChannel.filterScale = 1.0;\r\n\t\t\tsynthChannel.vibratoScale = 0.0;\r\n\t\t\tsynthChannel.harmonyMult = 1.0;\r\n\t\t\tsynthChannel.harmonyVolumeMult = 1.0;\r\n\t\t\t\r\n\t\t\tlet partsSinceStart: number = 0.0;\r\n\t\t\tlet arpeggio: number = synth.arpeggio;\r\n\t\t\tlet arpSampleCountdown: number = synth.arpSampleCountdown;\r\n\t\t\t\r\n\t\t\tlet pitches: number[] | null = null;\r\n\t\t\tlet resetPhases: boolean = true;\r\n\t\t\t\r\n\t\t\tlet intervalStart: number = 0.0;\r\n\t\t\tlet intervalEnd: number = 0.0;\r\n\t\t\tlet transitionVolumeStart: number = 1.0;\r\n\t\t\tlet transitionVolumeEnd: number = 1.0;\r\n\t\t\tlet envelopeVolumeStart: number = 0.0;\r\n\t\t\tlet envelopeVolumeEnd: number = 0.0;\r\n\t\t\t// TODO: probably part time can be calculated independently of any notes?\r\n\t\t\tlet partTimeStart: number = 0.0;\r\n\t\t\tlet partTimeEnd:   number = 0.0;\r\n\t\t\tlet decayTimeStart: number = 0.0;\r\n\t\t\tlet decayTimeEnd:   number = 0.0;\r\n\t\t\t\r\n\t\t\tfor (let i: number = 0; i < Config.operatorCount; i++) {\r\n\t\t\t\tsynthChannel.phaseDeltas[i] = 0.0;\r\n\t\t\t\tsynthChannel.volumeStarts[i] = 0.0;\r\n\t\t\t\tsynthChannel.volumeDeltas[i] = 0.0;\r\n\t\t\t\tsynthChannel.volumeLeft[0] = 0.0;\r\n\t\t\t\tsynthChannel.volumeRight[0] = 0.0;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (pianoMode) {\r\n\t\t\t\tpitches = synth.pianoPitch;\r\n\t\t\t\ttransitionVolumeStart = transitionVolumeEnd = 1;\r\n\t\t\t\tenvelopeVolumeStart = envelopeVolumeEnd = 1;\r\n\t\t\t\tresetPhases = false;\r\n\t\t\t\t// TODO: track time since live piano note started for transition, envelope, decays, delayed vibrato, etc.\r\n\t\t\t} else if (pattern != null) {\r\n\t\t\t\tlet note: Note | null = null;\r\n\t\t\t\tlet prevNote: Note | null = null;\r\n\t\t\t\tlet nextNote: Note | null = null;\r\n\t\t\t\tfor (let i: number = 0; i < pattern.notes.length; i++) {\r\n\t\t\t\t\tif (pattern.notes[i].end <= time) {\r\n\t\t\t\t\t\tprevNote = pattern.notes[i];\r\n\t\t\t\t\t} else if (pattern.notes[i].start <= time && pattern.notes[i].end > time) {\r\n\t\t\t\t\t\tnote = pattern.notes[i];\r\n\t\t\t\t\t} else if (pattern.notes[i].start > time) {\r\n\t\t\t\t\t\tnextNote = pattern.notes[i];\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (note != null && prevNote != null && prevNote.end != note.start) prevNote = null;\r\n\t\t\t\tif (note != null && nextNote != null && nextNote.start != note.end) nextNote = null;\r\n\t\t\t\t\r\n\t\t\t\tif (note != null) {\r\n\t\t\t\t\tpitches = note.pitches;\r\n\t\t\t\t\tpartsSinceStart = time - note.start;\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet endPinIndex: number;\r\n\t\t\t\t\tfor (endPinIndex = 1; endPinIndex < note.pins.length - 1; endPinIndex++) {\r\n\t\t\t\t\t\tif (note.pins[endPinIndex].time + note.start > time) break;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst startPin: NotePin = note.pins[endPinIndex-1];\r\n\t\t\t\t\tconst endPin: NotePin = note.pins[endPinIndex];\r\n\t\t\t\t\tconst noteStart: number = note.start * 4;\r\n\t\t\t\t\tconst noteEnd:   number = note.end   * 4;\r\n\t\t\t\t\tconst pinStart: number  = (note.start + startPin.time) * 4;\r\n\t\t\t\t\tconst pinEnd:   number  = (note.start +   endPin.time) * 4;\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst tickTimeStart: number = time * 4 + arpeggio;\r\n\t\t\t\t\tconst tickTimeEnd:   number = time * 4 + arpeggio + 1;\r\n\t\t\t\t\tconst pinRatioStart: number = (tickTimeStart - pinStart) / (pinEnd - pinStart);\r\n\t\t\t\t\tconst pinRatioEnd:   number = (tickTimeEnd   - pinStart) / (pinEnd - pinStart);\r\n\t\t\t\t\tlet envelopeVolumeTickStart: number = startPin.volume + (endPin.volume - startPin.volume) * pinRatioStart;\r\n\t\t\t\t\tlet envelopeVolumeTickEnd:   number = startPin.volume + (endPin.volume - startPin.volume) * pinRatioEnd;\r\n\t\t\t\t\tlet transitionVolumeTickStart: number = 1.0;\r\n\t\t\t\t\tlet transitionVolumeTickEnd:   number = 1.0;\r\n\t\t\t\t\tlet intervalTickStart: number = startPin.interval + (endPin.interval - startPin.interval) * pinRatioStart;\r\n\t\t\t\t\tlet intervalTickEnd:   number = startPin.interval + (endPin.interval - startPin.interval) * pinRatioEnd;\r\n\t\t\t\t\tlet partTimeTickStart: number = startPin.time + (endPin.time - startPin.time) * pinRatioStart;\r\n\t\t\t\t\tlet partTimeTickEnd:   number = startPin.time + (endPin.time - startPin.time) * pinRatioEnd;\r\n\t\t\t\t\tlet decayTimeTickStart: number = partTimeTickStart;\r\n\t\t\t\t\tlet decayTimeTickEnd:   number = partTimeTickEnd;\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst startRatio: number = 1.0 - (arpSampleCountdown + samples) / samplesPerTick;\r\n\t\t\t\t\tconst endRatio:   number = 1.0 - (arpSampleCountdown)           / samplesPerTick;\r\n\t\t\t\t\tresetPhases = (tickTimeStart + startRatio - noteStart == 0.0);\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst transition: number = instrument.transition;\r\n\t\t\t\t\tif (tickTimeStart == noteStart) {\r\n\t\t\t\t\t\tif (transition == 0) {\r\n\t\t\t\t\t\t\t// seamless start\r\n\t\t\t\t\t\t\tresetPhases = false;\r\n\t\t\t\t\t\t} else if (transition == 2) {\r\n\t\t\t\t\t\t\t// smooth start\r\n\t\t\t\t\t\t\ttransitionVolumeTickStart = 0.0;\r\n\t\t\t\t\t\t} else if (transition == 3) {\r\n\t\t\t\t\t\t\t// slide start\r\n\t\t\t\t\t\t\tif (prevNote == null) {\r\n\t\t\t\t\t\t\t\ttransitionVolumeTickStart = 0.0;\r\n\t\t\t\t\t\t\t} else if (prevNote.pins[prevNote.pins.length-1].volume == 0 || note.pins[0].volume == 0) {\r\n\t\t\t\t\t\t\t\ttransitionVolumeTickStart = 0.0;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tintervalTickStart = (prevNote.pitches[0] + prevNote.pins[prevNote.pins.length-1].interval - note.pitches[0]) * 0.5;\r\n\t\t\t\t\t\t\t\tdecayTimeTickStart = prevNote.pins[prevNote.pins.length-1].time * 0.5;\r\n\t\t\t\t\t\t\t\tresetPhases = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (transition == 4) {\r\n\t\t\t\t\t\t\t// trill start\r\n\t\t\t\t\t\t\ttransitionVolumeTickEnd = 0.0;\r\n\t\t\t\t\t\t} else if (transition == 5) {\r\n\t\t\t\t\t\t\t// click start\r\n\t\t\t\t\t\t\tintervalTickStart = 100.0;\r\n\t\t\t\t\t\t} else if (transition == 6) {\r\n\t\t\t\t\t\t\t// bow start\r\n\t\t\t\t\t\t\tintervalTickStart = -1.0;\r\n\t\t\t\t\t\t} else if (transition == 7) {\r\n\t\t\t\t\t\t\t// blip start\r\n\t\t\t\t\t\t\ttransitionVolumeTickStart = 6.0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (tickTimeEnd == noteEnd) {\r\n\t\t\t\t\t\tif (transition == 0) {\r\n\t\t\t\t\t\t\t// seamless ending: fade out, unless adjacent to another note or at end of bar.\r\n\t\t\t\t\t\t\tif (nextNote == null && note.start + endPin.time != song.partsPerBeat * song.beatsPerBar) {\r\n\t\t\t\t\t\t\t\ttransitionVolumeTickEnd = 0.0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (transition == 1 || transition == 2) {\r\n\t\t\t\t\t\t\t// sudden/smooth ending\r\n\t\t\t\t\t\t\ttransitionVolumeTickEnd = 0.0;\r\n\t\t\t\t\t\t} else if (transition == 3) {\r\n\t\t\t\t\t\t\t// slide ending\r\n\t\t\t\t\t\t\tif (nextNote == null) {\r\n\t\t\t\t\t\t\t\ttransitionVolumeTickEnd = 0.0;\r\n\t\t\t\t\t\t\t} else if (note.pins[note.pins.length-1].volume == 0 || nextNote.pins[0].volume == 0) {\r\n\t\t\t\t\t\t\t\ttransitionVolumeTickEnd = 0.0;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tintervalTickEnd = (nextNote.pitches[0] - note.pitches[0] + note.pins[note.pins.length-1].interval) * 0.5;\r\n\t\t\t\t\t\t\t\tdecayTimeTickEnd *= 0.5;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tintervalStart = intervalTickStart + (intervalTickEnd - intervalTickStart) * startRatio;\r\n\t\t\t\t\tintervalEnd   = intervalTickStart + (intervalTickEnd - intervalTickStart) * endRatio;\r\n\t\t\t\t\tenvelopeVolumeStart = synth.volumeConversion(envelopeVolumeTickStart + (envelopeVolumeTickEnd - envelopeVolumeTickStart) * startRatio);\r\n\t\t\t\t\tenvelopeVolumeEnd   = synth.volumeConversion(envelopeVolumeTickStart + (envelopeVolumeTickEnd - envelopeVolumeTickStart) * endRatio);\r\n\t\t\t\t\ttransitionVolumeStart = transitionVolumeTickStart + (transitionVolumeTickEnd - transitionVolumeTickStart) * startRatio;\r\n\t\t\t\t\ttransitionVolumeEnd   = transitionVolumeTickStart + (transitionVolumeTickEnd - transitionVolumeTickStart) * endRatio;\r\n\t\t\t\t\tpartTimeStart = note.start + partTimeTickStart + (partTimeTickEnd - partTimeTickStart) * startRatio;\r\n\t\t\t\t\tpartTimeEnd   = note.start + partTimeTickStart + (partTimeTickEnd - partTimeTickStart) * endRatio;\r\n\t\t\t\t\tdecayTimeStart = decayTimeTickStart + (decayTimeTickEnd - decayTimeTickStart) * startRatio;\r\n\t\t\t\t\tdecayTimeEnd   = decayTimeTickStart + (decayTimeTickEnd - decayTimeTickStart) * endRatio;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (pitches != null) {\r\n\t\t\t\tif (!isDrum && instrument.type == InstrumentType.fm) {\r\n\t\t\t\t\t// phase modulation!\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet sineVolumeBoost: number = 1.0;\r\n\t\t\t\t\tlet totalCarrierVolume: number = 0.0;\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst carrierCount: number = Config.operatorCarrierCounts[instrument.algorithm];\r\n\t\t\t\t\tfor (let i: number = 0; i < Config.operatorCount; i++) {\r\n\t\t\t\t\t\tconst isCarrier: boolean = i < Config.operatorCarrierCounts[instrument.algorithm];\r\n\t\t\t\t\t\tconst associatedCarrierIndex: number = Config.operatorAssociatedCarrier[instrument.algorithm][i] - 1;\r\n\t\t\t\t\t\tconst pitch: number = pitches[(i < pitches.length) ? i : ((associatedCarrierIndex < pitches.length) ? associatedCarrierIndex : 0)] + Config.octoffValues[instrument.octoff] + (song.detune / 24);\r\n\t\t\t\t\t\tconst freqMult = Config.operatorFrequencies[instrument.operators[i].frequency];\r\n\t\t\t\t\t\tconst chorusInterval = Config.operatorCarrierChorus[Config.fmChorusNames[instrument.fmChorus]][associatedCarrierIndex];\r\n\t\t\t\t\t\tconst startPitch: number = (pitch + intervalStart) * intervalScale + chorusInterval;\r\n\t\t\t\t\t\tconst startFreq: number = freqMult * (synth.frequencyFromPitch(basePitch + startPitch)) + Config.operatorHzOffsets[instrument.operators[i].frequency];\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tsynthChannel.phaseDeltas[i] = startFreq * sampleTime * Config.sineWaveLength;\r\n\t\t\t\t\t\tif (resetPhases) synthChannel.reset();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tconst amplitudeCurve: number = Synth.operatorAmplitudeCurve(instrument.operators[i].amplitude);\r\n\t\t\t\t\t\t// const amplitudeMult: number = amplitudeCurve * Config.operatorAmplitudeSigns[instrument.operators[i].frequency];\r\n\t\t\t\t\t\t// @TODO: Revisit\r\n\t\t\t\t\t\tlet amplitudeMult: number = 0;\r\n\t\t\t\t\t\tif ((Config.volumeValues[instrument.volume] != -1.0 && song.mix == 2) || (Config.volumeMValues[instrument.volume] != -1.0 && song.mix != 2)) {\r\n\t\t\t\t\t\t\tif (song.mix == 2) {\r\n\t\t\t\t\t\t\t\tamplitudeMult = isCarrier ? (amplitudeCurve * Config.operatorAmplitudeSigns[instrument.operators[i].frequency]) * (1 - Config.volumeValues[instrument.volume] / 2.3) : (amplitudeCurve * Config.operatorAmplitudeSigns[instrument.operators[i].frequency]);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tamplitudeMult = (amplitudeCurve * Config.operatorAmplitudeSigns[instrument.operators[i].frequency]) * (1 - Config.volumeMValues[instrument.volume] / 2.3);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (Config.volumeValues[instrument.volume] != -1.0) {\r\n\t\t\t\t\t\t\tamplitudeMult = 0;\r\n\t\t\t\t\t\t} else if (Config.volumeMValues[instrument.volume] != -1.0) {\r\n\t\t\t\t\t\t\tamplitudeMult = 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlet volumeStart: number = amplitudeMult * Config.imuteValues[instrument.imute];\r\n\t\t\t\t\t\tlet volumeEnd: number = amplitudeMult * Config.imuteValues[instrument.imute];\r\n\t\t\t\t\t\tsynthChannel.volumeLeft[0] = Math.min(1, 1 + Config.ipanValues[instrument.ipan]);\r\n\t\t\t\t\t\tsynthChannel.volumeRight[0] = Math.min(1, 1 - Config.ipanValues[instrument.ipan]);\r\n\t\t\t\t\t\tif (i < carrierCount) {\r\n\t\t\t\t\t\t\t// carrier\r\n\t\t\t\t\t\t\tconst volumeMult: number = 0.03;\r\n\t\t\t\t\t\t\t// The commented out portion in the line below fixes\r\n\t\t\t\t\t\t\t// the crackling heard when using FM chorus. It seems\r\n\t\t\t\t\t\t\t// that it was accidentally omitted in BeepBox 2.3.\r\n\t\t\t\t\t\t\tconst endPitch: number = (pitch + intervalEnd) * intervalScale/* + chorusInterval */;\r\n\t\t\t\t\t\t\tlet pitchVolumeStart: number = 0;\r\n\t\t\t\t\t\t\tlet pitchVolumeEnd: number = 0;\r\n\t\t\t\t\t\t\tif (song.mix == 3) {\r\n\t\t\t\t\t\t\t\tpitchVolumeStart = Math.pow(5.0, -startPitch / pitchDamping);\r\n\t\t\t\t\t\t\t\tpitchVolumeEnd   = Math.pow(5.0,   -endPitch / pitchDamping);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tpitchVolumeStart = Math.pow(2.0, -startPitch / pitchDamping);\r\n\t\t\t\t\t\t\t\tpitchVolumeEnd   = Math.pow(2.0,   -endPitch / pitchDamping);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvolumeStart *= pitchVolumeStart * volumeMult * transitionVolumeStart;\r\n\t\t\t\t\t\t\tvolumeEnd *= pitchVolumeEnd * volumeMult * transitionVolumeEnd;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\ttotalCarrierVolume += amplitudeCurve;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// modulator\r\n\t\t\t\t\t\t\tvolumeStart *= Config.sineWaveLength * 1.5;\r\n\t\t\t\t\t\t\tvolumeEnd *= Config.sineWaveLength * 1.5;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tsineVolumeBoost *= 1.0 - Math.min(1.0, instrument.operators[i].amplitude / 15);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst envelope: number = instrument.operators[i].envelope;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvolumeStart *= Synth.computeOperatorEnvelope(envelope, secondsPerPart * decayTimeStart, beatsPerPart * partTimeStart, envelopeVolumeStart);\r\n\t\t\t\t\t\tvolumeEnd *= Synth.computeOperatorEnvelope(envelope, secondsPerPart * decayTimeEnd, beatsPerPart * partTimeEnd, envelopeVolumeEnd);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tsynthChannel.volumeStarts[i] = volumeStart;\r\n\t\t\t\t\t\tsynthChannel.volumeDeltas[i] = (volumeEnd - volumeStart) / samples;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst feedbackAmplitude: number = Config.sineWaveLength * 0.3 * instrument.feedbackAmplitude / 15.0;\r\n\t\t\t\t\tlet feedbackStart: number = feedbackAmplitude * Synth.computeOperatorEnvelope(instrument.feedbackEnvelope, secondsPerPart * decayTimeStart, beatsPerPart * partTimeStart, envelopeVolumeStart);\r\n\t\t\t\t\tlet feedbackEnd: number = feedbackAmplitude * Synth.computeOperatorEnvelope(instrument.feedbackEnvelope, secondsPerPart * decayTimeEnd, beatsPerPart * partTimeEnd, envelopeVolumeEnd);\r\n\t\t\t\t\tsynthChannel.feedbackMult = feedbackStart;\r\n\t\t\t\t\tsynthChannel.feedbackDelta = (feedbackEnd - synthChannel.feedbackMult) / samples;\r\n\t\t\t\t\t\r\n\t\t\t\t\tsineVolumeBoost *= 1.0 - instrument.feedbackAmplitude / 15.0;\r\n\t\t\t\t\t\r\n\t\t\t\t\tsineVolumeBoost *= 1.0 - Math.min(1.0, Math.max(0.0, totalCarrierVolume - 1) / 2.0);\r\n\t\t\t\t\tfor (let i: number = 0; i < carrierCount; i++) {\r\n\t\t\t\t\t\tsynthChannel.volumeStarts[i] *= 1.0 + sineVolumeBoost * 3.0;\r\n\t\t\t\t\t\tsynthChannel.volumeDeltas[i] *= 1.0 + sineVolumeBoost * 3.0;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet pitch: number = pitches[0];\r\n\t\t\t\t\t// if (Config.chorusHarmonizes[instrument.chorus]) {\r\n\t\t\t\t\t// \tlet harmonyOffset: number = 0.0;\r\n\t\t\t\t\t// \tif (pitches.length == 2) {\r\n\t\t\t\t\t// \t\tharmonyOffset = pitches[1] - pitches[0];\r\n\t\t\t\t\t// \t} else if (pitches.length == 3) {\r\n\t\t\t\t\t// \t\tharmonyOffset = pitches[(arpeggio >> 1) + 1] - pitches[0];\r\n\t\t\t\t\t// \t} else if (pitches.length == 4) {\r\n\t\t\t\t\t// \t\tharmonyOffset = pitches[(arpeggio == 3 ? 1 : arpeggio) + 1] - pitches[0];\r\n\t\t\t\t\t// \t}\r\n\t\t\t\t\t// \tsynthChannel.harmonyMult = Math.pow(2.0, harmonyOffset / 12.0);\r\n\t\t\t\t\t// \tsynthChannel.harmonyVolumeMult = Math.pow(2.0, -harmonyOffset / pitchDamping)\r\n\t\t\t\t\t// } else {\r\n\t\t\t\t\t// \tif (pitches.length == 2) {\r\n\t\t\t\t\t// \t\tpitch = pitches[arpeggio >> 1];\r\n\t\t\t\t\t// \t} else if (pitches.length == 3) {\r\n\t\t\t\t\t// \t\tpitch = pitches[arpeggio == 3 ? 1 : arpeggio];\r\n\t\t\t\t\t// \t} else if (pitches.length == 4) {\r\n\t\t\t\t\t// \t\tpitch = pitches[arpeggio];\r\n\t\t\t\t\t// \t}\r\n\t\t\t\t\t// }\r\n\t\t\t\t\tif (!isDrum) {\r\n\t\t\t\t\t\tif (Config.harmNames[instrument.harm] == 1) {\r\n\t\t\t\t\t\t\t// duet\r\n\t\t\t\t\t\t\tlet harmonyOffset: number = 0.0;\r\n\t\t\t\t\t\t\tif (pitches.length == 2) {\r\n\t\t\t\t\t\t\t\tharmonyOffset = pitches[1] - pitches[0];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 3) {\r\n\t\t\t\t\t\t\t\tharmonyOffset = pitches[(arpeggio >> 1) + 1] - pitches[0];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 4) {\r\n\t\t\t\t\t\t\t\tharmonyOffset = pitches[(arpeggio == 3 ? 1 : arpeggio) + 1] - pitches[0];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tsynthChannel.harmonyMult = Math.pow(2.0, harmonyOffset / 12.0);\r\n\t\t\t\t\t\t\tsynthChannel.harmonyVolumeMult = Math.pow(2.0, -harmonyOffset / pitchDamping)\r\n\t\t\t\t\t\t} else if (Config.harmNames[instrument.harm] == 2) {\r\n\t\t\t\t\t\t\t// chord\r\n\t\t\t\t\t\t\tlet harmonyOffset: number = 0.0;\r\n\t\t\t\t\t\t\tif (pitches.length == 2) {\r\n\t\t\t\t\t\t\t\tharmonyOffset = pitches[1] - pitches[0];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 3) {\r\n\t\t\t\t\t\t\t\tharmonyOffset = pitches[2] - pitches[0];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 4) {\r\n\t\t\t\t\t\t\t\tharmonyOffset = pitches[(arpeggio == 3 ? 2 : arpeggio) + 1] - pitches[0];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tsynthChannel.harmonyMult = Math.pow(2.0, harmonyOffset / 12.0);\r\n\t\t\t\t\t\t\tsynthChannel.harmonyVolumeMult = Math.pow(2.0, -harmonyOffset / pitchDamping)\r\n\t\t\t\t\t\t} else if (Config.harmNames[instrument.harm] == 3) {\r\n\t\t\t\t\t\t\t// seventh\r\n\t\t\t\t\t\t\tlet harmonyOffset: number = 0.0;\r\n\t\t\t\t\t\t\tif (pitches.length == 2) {\r\n\t\t\t\t\t\t\t\tharmonyOffset = pitches[1] - pitches[0];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 3) {\r\n\t\t\t\t\t\t\t\tharmonyOffset = pitches[2] - pitches[0];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 4) {\r\n\t\t\t\t\t\t\t\tharmonyOffset = pitches[3] - pitches[0];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tsynthChannel.harmonyMult = Math.pow(2.0, harmonyOffset / 12.0);\r\n\t\t\t\t\t\t\tsynthChannel.harmonyVolumeMult = Math.pow(2.0, -harmonyOffset / pitchDamping)\r\n\t\t\t\t\t\t} else if (Config.harmNames[instrument.harm] == 4) {\r\n\t\t\t\t\t\t\t// half arpeggio\r\n\t\t\t\t\t\t\tlet harmonyOffset: number = 0.0;\r\n\t\t\t\t\t\t\tif (pitches.length == 2) {\r\n\t\t\t\t\t\t\t\tharmonyOffset = pitches[1] - pitches[0];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 3) {\r\n\t\t\t\t\t\t\t\tharmonyOffset = pitches[(arpeggio >> 1) + 1] - pitches[0];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 4) {\r\n\t\t\t\t\t\t\t\tharmonyOffset = pitches[(arpeggio >> 1) + 2] - pitches[0];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tsynthChannel.harmonyMult = Math.pow(2.0, harmonyOffset / 12.0);\r\n\t\t\t\t\t\t\tsynthChannel.harmonyVolumeMult = Math.pow(2.0, -harmonyOffset / pitchDamping)\r\n\t\t\t\t\t\t} else if (Config.harmNames[instrument.harm] == 5) {\r\n\t\t\t\t\t\t\t// arp-chord\r\n\t\t\t\t\t\t\tlet harmonyOffset: number = 0.0;\r\n\t\t\t\t\t\t\tif (pitches.length == 2) {\r\n\t\t\t\t\t\t\t\tharmonyOffset = pitches[1] - pitches[0];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 3) {\r\n\t\t\t\t\t\t\t\tharmonyOffset = pitches[2] - pitches[0];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 4) {\r\n\t\t\t\t\t\t\t\tharmonyOffset = pitches[(arpeggio == 3 ? 2 : arpeggio)] - pitches[0];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tsynthChannel.harmonyMult = Math.pow(2.0, harmonyOffset / 12.0);\r\n\t\t\t\t\t\t\tsynthChannel.harmonyVolumeMult = Math.pow(2.0, -harmonyOffset / pitchDamping)\r\n\t\t\t\t\t\t} else if (Config.harmNames[instrument.harm] == 0) {\r\n\t\t\t\t\t\t\t// arpeggio\r\n\t\t\t\t\t\t\tif (pitches.length == 2) {\r\n\t\t\t\t\t\t\t\tpitch = pitches[arpeggio >> 1];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 3) {\r\n\t\t\t\t\t\t\t\tpitch = pitches[arpeggio == 3 ? 1 : arpeggio];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 4) {\r\n\t\t\t\t\t\t\t\tpitch = pitches[arpeggio];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (Config.harmNames[instrument.harm] == 0) {\r\n\t\t\t\t\t\t\t// arpeggio\r\n\t\t\t\t\t\t\tif (pitches.length == 1) {\r\n\t\t\t\t\t\t\t\tpitch = pitches[0] + Config.octoffValues[instrument.octoff];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 2) {\r\n\t\t\t\t\t\t\t\tpitch = pitches[arpeggio >> 1] + Config.octoffValues[instrument.octoff];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 3) {\r\n\t\t\t\t\t\t\t\tpitch = pitches[arpeggio == 3 ? 1 : arpeggio] + Config.octoffValues[instrument.octoff];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 4) {\r\n\t\t\t\t\t\t\t\tpitch = pitches[arpeggio] + Config.octoffValues[instrument.octoff];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (Config.harmNames[instrument.harm] == 1) {\r\n\t\t\t\t\t\t\t// duet\r\n\t\t\t\t\t\t\tif (pitches.length == 1) {\r\n\t\t\t\t\t\t\t\tpitch = pitches[0] + Config.octoffValues[instrument.octoff];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 2) {\r\n\t\t\t\t\t\t\t\tpitch = (pitches[1] + pitches[0]) / 2 + Config.octoffValues[instrument.octoff];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 3) {\r\n\t\t\t\t\t\t\t\tpitch = (pitches[(arpeggio >> 1) + 1] + pitches[0]) / 2 + Config.octoffValues[instrument.octoff];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 4) {\r\n\t\t\t\t\t\t\t\tpitch = (pitches[(arpeggio == 3 ? 1 : arpeggio) + 1] + pitches[0]) / 2 + Config.octoffValues[instrument.octoff];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (Config.harmNames[instrument.harm] == 2) {\r\n\t\t\t\t\t\t\t// chord\r\n\t\t\t\t\t\t\tif (pitches.length == 1) {\r\n\t\t\t\t\t\t\t\tpitch = pitches[0] + Config.octoffValues[instrument.octoff];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 2) {\r\n\t\t\t\t\t\t\t\tpitch = (pitches[1] + pitches[0]) / 2 + Config.octoffValues[instrument.octoff];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 3) {\r\n\t\t\t\t\t\t\t\tpitch = (pitches[2] + pitches[0]) / 2 + Config.octoffValues[instrument.octoff];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 4) {\r\n\t\t\t\t\t\t\t\tpitch = (pitches[(arpeggio == 3 ? 2 : arpeggio) + 1] + pitches[0]) / 2 + Config.octoffValues[instrument.octoff];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (Config.harmNames[instrument.harm] == 3) {\r\n\t\t\t\t\t\t\t// seventh\r\n\t\t\t\t\t\t\tif (pitches.length == 1) {\r\n\t\t\t\t\t\t\t\tpitch = pitches[0] + Config.octoffValues[instrument.octoff];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 2) {\r\n\t\t\t\t\t\t\t\tpitch = (pitches[1] + pitches[0]) / 2 + Config.octoffValues[instrument.octoff];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 3) {\r\n\t\t\t\t\t\t\t\tpitch = (pitches[2] + pitches[0]) / 2 + Config.octoffValues[instrument.octoff];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 4) {\r\n\t\t\t\t\t\t\t\tpitch = (pitches[3] + pitches[0]) / 2 + Config.octoffValues[instrument.octoff];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (Config.harmNames[instrument.harm] == 4) {\r\n\t\t\t\t\t\t\t// half arpeggio\r\n\t\t\t\t\t\t\tif (pitches.length == 1) {\r\n\t\t\t\t\t\t\t\tpitch = pitches[0] + Config.octoffValues[instrument.octoff];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 2) {\r\n\t\t\t\t\t\t\t\tpitch = (pitches[1] + pitches[0]) / 2 + Config.octoffValues[instrument.octoff];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 3) {\r\n\t\t\t\t\t\t\t\tpitch = (pitches[(arpeggio >> 1) + 1] + pitches[0]) / 2 + Config.octoffValues[instrument.octoff];\r\n\t\t\t\t\t\t\t} else if (pitches.length == 4) {\r\n\t\t\t\t\t\t\t\tpitch = pitches[(arpeggio >> 1) + 2] + pitches[0] + Config.octoffValues[instrument.octoff];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst startPitch: number = (pitch + intervalStart) * intervalScale;\r\n\t\t\t\t\tconst endPitch: number = (pitch + intervalEnd) * intervalScale;\r\n\t\t\t\t\tconst startFreq: number = synth.frequencyFromPitch(basePitch + startPitch);\r\n\t\t\t\t\tconst pitchVolumeStart: number = Math.pow(2.0, -startPitch / pitchDamping);\r\n\t\t\t\t\tconst pitchVolumeEnd: number   = Math.pow(2.0,   -endPitch / pitchDamping);\r\n\t\t\t\t\tif (isDrum && Config.drumWaveIsSoft[instrument.wave]) {\r\n\t\t\t\t\t\tsynthChannel.filter = Math.min(1.0, startFreq * sampleTime * Config.drumPitchFilterMult[instrument.wave]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet settingsVolumeMult: number;\r\n\t\t\t\t\tif (!isDrum) {\r\n\t\t\t\t\t\tconst filterScaleRate: number = Config.filterDecays[instrument.filter];\r\n\t\t\t\t\t\tsynthChannel.filter = Math.pow(2, -filterScaleRate * secondsPerPart * decayTimeStart);\r\n\t\t\t\t\t\tconst endFilter: number = Math.pow(2, -filterScaleRate * secondsPerPart * decayTimeEnd);\r\n\t\t\t\t\t\tsynthChannel.filterScale = Math.pow(endFilter / synthChannel.filter, 1.0 / samples);\r\n\t\t\t\t\t\tsettingsVolumeMult = 0.27 * 0.5 * Config.waveVolumes[instrument.wave] * Config.filterVolumes[instrument.filter] * Config.chorusVolumes[instrument.chorus];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (song.mix == 0) {\r\n\t\t\t\t\t\t\tsettingsVolumeMult = 0.19 * Config.drumVolumes[instrument.wave];\r\n\t\t\t\t\t\t} else if (song.mix == 3) {\r\n\t\t\t\t\t\t\tsettingsVolumeMult = 0.12 * Config.drumVolumes[instrument.wave];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tsettingsVolumeMult = 0.09 * Config.drumVolumes[instrument.wave];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (resetPhases && !isDrum) {\r\n\t\t\t\t\t\tsynthChannel.reset();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tsynthChannel.phaseDeltas[0] = startFreq * sampleTime;\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet instrumentVolumeMult: number = 0;\r\n\t\t\t\t\tif (song.mix == 2) {\r\n\t\t\t\t\t\tinstrumentVolumeMult = (instrument.volume == 9) ? 0.0 : Math.pow(3, -Config.volumeValues[instrument.volume]) * Config.imuteValues[instrument.imute];\r\n\t\t\t\t\t} else if (song.mix == 1) {\r\n\t\t\t\t\t\tinstrumentVolumeMult = (instrument.volume >= 5) ? 0.0 : Math.pow(3, -Config.volumeMValues[instrument.volume]) * Config.imuteValues[instrument.imute];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tinstrumentVolumeMult = (instrument.volume >= 5) ? 0.0 : Math.pow(2, -Config.volumeMValues[instrument.volume]) * Config.imuteValues[instrument.imute];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsynthChannel.volumeStarts[0] = transitionVolumeStart * envelopeVolumeStart * pitchVolumeStart * settingsVolumeMult * instrumentVolumeMult;\r\n\t\t\t\t\tconst volumeEnd: number = transitionVolumeEnd * envelopeVolumeEnd * pitchVolumeEnd * settingsVolumeMult * instrumentVolumeMult;\r\n\t\t\t\t\tsynthChannel.volumeDeltas[0] = (volumeEnd - synthChannel.volumeStarts[0]) / samples;\r\n\t\t\t\t\tsynthChannel.volumeLeft[0] = Math.min(1, 1 + Config.ipanValues[instrument.ipan]);\r\n\t\t\t\t\tsynthChannel.volumeRight[0] = Math.min(1, 1 - Config.ipanValues[instrument.ipan]);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tsynthChannel.phaseDeltaScale = Math.pow(2.0, ((intervalEnd - intervalStart) * intervalScale / 12.0) / samples);\r\n\t\t\t\tsynthChannel.vibratoScale = (partsSinceStart < Config.effectVibratoDelays[instrument.effect]) ? 0.0 : Math.pow(2.0, Config.effectVibratos[instrument.effect] / 12.0) - 1.0;\r\n\t\t\t} else {\r\n\t\t\t\t// @TODO: ModBox doesn't have this guard around .reset, why?\r\n\t\t\t\t// if (!isDrum) {\r\n\t\t\t\t\tsynthChannel.reset();\r\n\t\t\t\t// }\r\n\t\t\t\tfor (let i: number = 0; i < Config.operatorCount; i++) {\r\n\t\t\t\t\tsynthChannel.phaseDeltas[0] = 0.0;\r\n\t\t\t\t\tsynthChannel.volumeStarts[0] = 0.0;\r\n\t\t\t\t\tsynthChannel.volumeDeltas[0] = 0.0;\r\n\t\t\t\t\tsynthChannel.volumeLeft[0] = 0.0;\r\n\t\t\t\t\tsynthChannel.volumeRight[0] = 0.0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tprivate static readonly generatedSynthesizers: Dictionary<Function> = {};\r\n\t\t\r\n\t\tprivate static getGeneratedSynthesizer(song: Song, bar: number): Function {\r\n\t\t\tconst fingerprint: string = song.getChannelFingerprint(bar);\r\n\t\t\tif (Synth.generatedSynthesizers[fingerprint] == undefined) {\r\n\t\t\t\tconst synthSource: string[] = [];\r\n\t\t\t\tconst instruments: Instrument[] = [];\r\n\t\t\t\tfor (let channel = 0; channel < song.pitchChannelCount; channel++) {\r\n\t\t\t\t\tinstruments[channel] = song.channels[channel].instruments[song.getPatternInstrument(channel, bar)];\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tfor (const line of Synth.synthSourceTemplate) {\r\n\t\t\t\t\tif (line.indexOf(\"#\") != -1) {\r\n\t\t\t\t\t\tif (line.indexOf(\"// PITCH\") != -1) {\r\n\t\t\t\t\t\t\tfor (let channel = 0; channel < song.pitchChannelCount; channel++) {\r\n\t\t\t\t\t\t\t\tsynthSource.push(line.replace(/#/g, channel + \"\"));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (line.indexOf(\"// JCHIP\") != -1) {\r\n\t\t\t\t\t\t\tfor (let channel = 0; channel < song.pitchChannelCount; channel++) {\r\n\t\t\t\t\t\t\t\tif (instruments[channel].type == InstrumentType.chip) {\r\n\t\t\t\t\t\t\t\t\tsynthSource.push(line.replace(/#/g, channel + \"\"));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (line.indexOf(\"// CHIP\") != -1) {\r\n\t\t\t\t\t\t\tfor (let channel = 0; channel < song.pitchChannelCount; channel++) {\r\n\t\t\t\t\t\t\t\tif (instruments[channel].type == InstrumentType.chip) {\r\n\t\t\t\t\t\t\t\t\tsynthSource.push(line.replace(/#/g, channel + \"\"));\r\n\t\t\t\t\t\t\t\t} else if (instruments[channel].type == InstrumentType.pwm) {\r\n\t\t\t\t\t\t\t\t\tsynthSource.push(line.replace(/#/g, channel + \"\"));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (line.indexOf(\"// FM\") != -1) {\r\n\t\t\t\t\t\t\tfor (let channel = 0; channel < song.pitchChannelCount; channel++) {\r\n\t\t\t\t\t\t\t\tif (instruments[channel].type == InstrumentType.fm) {\r\n\t\t\t\t\t\t\t\t\tif (line.indexOf(\"$\") != -1) {\r\n\t\t\t\t\t\t\t\t\t\tfor (let j = 0; j < Config.operatorCount; j++) {\r\n\t\t\t\t\t\t\t\t\t\t\tsynthSource.push(line.replace(/#/g, channel + \"\").replace(/\\$/g, j + \"\"));\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tsynthSource.push(line.replace(/#/g, channel + \"\"));\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (line.indexOf(\"// PWM\") != -1) {\r\n\t\t\t\t\t\t\tfor (let channel = 0; channel < song.pitchChannelCount; channel++) {\r\n\t\t\t\t\t\t\t\tif (instruments[channel].type == InstrumentType.pwm) {\r\n\t\t\t\t\t\t\t\t\tsynthSource.push(line.replace(/#/g, channel + \"\"));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (line.indexOf(\"// CARRIER OUTPUTS\") != -1) {\r\n\t\t\t\t\t\t\tfor (let channel = 0; channel < song.pitchChannelCount; channel++) {\r\n\t\t\t\t\t\t\t\tif (instruments[channel].type == InstrumentType.fm) {\r\n\t\t\t\t\t\t\t\t\tconst outputs: string[] = [];\r\n\t\t\t\t\t\t\t\t\tfor (let j = 0; j < Config.operatorCarrierCounts[instruments[channel].algorithm]; j++) {\r\n\t\t\t\t\t\t\t\t\t\toutputs.push(\"channel\" + channel + \"Operator\" + j + \"Scaled\");\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tsynthSource.push(line.replace(/#/g, channel + \"\").replace(\"/*channel\" + channel + \"Operator$Scaled*/\", outputs.join(\" + \")));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (line.indexOf(\"// NOISE\") != -1) {\r\n\t\t\t\t\t\t\tfor (let channel = song.pitchChannelCount; channel < song.pitchChannelCount + song.drumChannelCount; channel++) {\r\n\t\t\t\t\t\t\t\tsynthSource.push(line.replace(/#/g, channel + \"\"));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (line.indexOf(\"// ALL\") != -1) {\r\n\t\t\t\t\t\t\tfor (let channel = 0; channel < song.pitchChannelCount + song.drumChannelCount; channel++) {\r\n\t\t\t\t\t\t\t\tsynthSource.push(line.replace(/#/g, channel + \"\"));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthrow new Error(\"Missing channel type annotation for line: \" + line);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (line.indexOf(\"// INSERT OPERATOR COMPUTATION HERE\") != -1) {\r\n\t\t\t\t\t\tfor (let j = Config.operatorCount - 1; j >= 0; j--) {\r\n\t\t\t\t\t\t\tfor (const operatorLine of Synth.operatorSourceTemplate) {\r\n\t\t\t\t\t\t\t\tfor (let channel = 0; channel < song.pitchChannelCount; channel++) {\r\n\t\t\t\t\t\t\t\t\tif (instruments[channel].type == InstrumentType.fm) {\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tif (operatorLine.indexOf(\"/* + channel#Operator@Scaled*/\") != -1) {\r\n\t\t\t\t\t\t\t\t\t\t\tlet modulators = \"\";\r\n\t\t\t\t\t\t\t\t\t\t\tfor (const modulatorNumber of Config.operatorModulatedBy[instruments[channel].algorithm][j]) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tmodulators += \" + channel\" + channel + \"Operator\" + (modulatorNumber - 1) + \"Scaled\";\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\tconst feedbackIndices: ReadonlyArray<number> = Config.operatorFeedbackIndices[instruments[channel].feedbackType][j];\r\n\t\t\t\t\t\t\t\t\t\t\tif (feedbackIndices.length > 0) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tmodulators += \" + channel\" + channel + \"FeedbackMult * (\";\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst feedbacks: string[] = [];\r\n\t\t\t\t\t\t\t\t\t\t\t\tfor (const modulatorNumber of feedbackIndices) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfeedbacks.push(\"channel\" + channel + \"Operator\" + (modulatorNumber - 1) + \"Output\");\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\tmodulators += feedbacks.join(\" + \") + \")\";\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tsynthSource.push(operatorLine.replace(/#/g, channel + \"\").replace(/\\$/g, j + \"\").replace(\"/* + channel\" + channel + \"Operator@Scaled*/\", modulators));\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\tsynthSource.push(operatorLine.replace(/#/g, channel + \"\").replace(/\\$/g, j + \"\"));\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsynthSource.push(line);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t//console.log(synthSource.join(\"\\n\"));\r\n\t\t\t\t\r\n\t\t\t\tSynth.generatedSynthesizers[fingerprint] = new Function(\"synth\", \"song\", \"dataLeft\", \"dataRight\", \"bufferLength\", \"bufferIndex\", \"samplesPerTick\", synthSource.join(\"\\n\"));\r\n\t\t\t}\r\n\t\t\treturn Synth.generatedSynthesizers[fingerprint];\r\n\t\t}\r\n\r\n\t\tprivate static synthSourceTemplate: string[] = (`\r\n\t\t\tvar sampleTime = 1.0 / synth.samplesPerSecond;\r\n\t\t\tvar effectYMult = +synth.effectYMult;\r\n\t\t\tvar limitDecay = +synth.limitDecay;\r\n\t\t\tvar volume = +synth.volume;\r\n\t\t\tvar delayLineLeft = synth.delayLineLeft;\r\n\t\t\tvar delayLineRight = synth.delayLineRight;\r\n\t\t\tvar reverb = Math.pow(song.reverb / beepbox.Config.reverbRange, 0.667) * 0.425;\r\n\t\t\tvar blend = Math.pow(song.blend / beepbox.Config.blendRange, 0.667) * 0.425;\r\n\t\t\tvar mix = song.mix;\r\n\t\t\tvar muff = Math.pow(song.muff / beepbox.Config.muffRange, 0.667) * 0.425;\r\n\t\t\tvar detune = song.detune;\r\n\t\t\tvar riff = Math.pow(song.riff / beepbox.Config.riffRange, 0.667) * 0.425; \r\n\t\t\tvar sineWave = beepbox.Config.sineWave;\r\n\t\t\t\r\n\t\t\t// Initialize instruments based on current pattern.\r\n\t\t\tvar instrumentChannel# = song.getPatternInstrument(#, synth.bar); // ALL\r\n\t\t\tvar instrument# = song.channels[#].instruments[instrumentChannel#]; // ALL\r\n\t\t\tvar channel#Wave = (mix <= 1) ? beepbox.Config.waves[instrument#.wave] : beepbox.Config.wavesMixC[instrument#.wave]; // CHIP\r\n\t\t\tvar channel#Wave = beepbox.Config.getDrumWave(instrument#.wave); // NOISE\r\n\t\t\tvar channel#WaveLength = channel#Wave.length; // CHIP\r\n\t\t\tvar channel#Wave = beepbox.Config.pwmwaves[instrument#.wave]; // PWM\r\n\t\t\tvar channel#WaveLength = channel#Wave.length; // PWM\r\n\t\t\tvar channel#FilterBase = (song.mix == 2) ? Math.pow(2 - (blend * 2) + (muff * 2), -beepbox.Config.filterBases[instrument#.filter]) : Math.pow(2, -beepbox.Config.filterBases[instrument#.filter] + (blend * 4) - (muff * 4)); // CHIP\r\n\t\t\tvar channel#TremoloScale = beepbox.Config.effectTremolos[instrument#.effect]; // PITCH\r\n\t\t\t\r\n\t\t\twhile (bufferIndex < bufferLength) {\r\n\t\t\t\t\r\n\t\t\t\tvar samples;\r\n\t\t\t\tvar samplesLeftInBuffer = bufferLength - bufferIndex;\r\n\t\t\t\tif (synth.arpSampleCountdown <= samplesLeftInBuffer) {\r\n\t\t\t\t\tsamples = synth.arpSampleCountdown;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsamples = samplesLeftInBuffer;\r\n\t\t\t\t}\r\n\t\t\t\tsynth.arpSampleCountdown -= samples;\r\n\t\t\t\t\r\n\t\t\t\tvar time = synth.part + synth.beat * song.partsPerBeat;\r\n\t\t\t\t\r\n\t\t\t\tbeepbox.Synth.computeChannelInstrument(synth, song, #, time, sampleTime, samplesPerTick, samples); // ALL\r\n\t\t\t\tvar synthChannel# = synth.channels[#]; // ALL\r\n\t\t\t\t\r\n\t\t\t\tvar channel#ChorusA = Math.pow(2.0, (beepbox.Config.chorusOffsets[instrument#.chorus] + beepbox.Config.chorusIntervals[instrument#.chorus] + beepbox.Config.octoffValues[instrument#.octoff] + (detune / 24) * ((riff * beepbox.Config.chorusRiffApp[instrument#.chorus]) + 1)) / 12.0); // CHIP\r\n\t\t\t\tvar channel#ChorusB = Math.pow(2.0, (beepbox.Config.chorusOffsets[instrument#.chorus] - beepbox.Config.chorusIntervals[instrument#.chorus] + beepbox.Config.octoffValues[instrument#.octoff] + (detune / 24) * ((riff * beepbox.Config.chorusRiffApp[instrument#.chorus]) + 1)) / 12.0); // CHIP\r\n\t\t\t\tvar channel#ChorusSign = synthChannel#.harmonyVolumeMult * (beepbox.Config.chorusSigns[instrument#.chorus]); // CHIP\r\n\t\t\t\tchannel#ChorusB *= synthChannel#.harmonyMult; // CHIP\r\n\t\t\t\tvar channel#ChorusDeltaRatio = channel#ChorusB / channel#ChorusA * ((riff * beepbox.Config.chorusRiffApp[instrument#.chorus]) + 1); // CHIP\r\n\t\t\t\t\r\n\t\t\t\tvar channel#PhaseDelta = synthChannel#.phaseDeltas[0] * channel#ChorusA * ((riff * beepbox.Config.chorusRiffApp[instrument#.chorus]) + 1); // CHIP\r\n\t\t\t\tvar channel#PhaseDelta = synthChannel#.phaseDeltas[0] / 32768.0; // NOISE\r\n\t\t\t\tvar channel#PhaseDeltaScale = synthChannel#.phaseDeltaScale; // ALL\r\n\t\t\t\tvar channel#Volume = synthChannel#.volumeStarts[0]; // CHIP\r\n\t\t\t\tvar channel#Volume = synthChannel#.volumeStarts[0]; // NOISE\r\n\t\t\t\tvar channel#VolumeLeft = synthChannel#.volumeLeft[0]; // ALL\r\n\t\t\t\tvar channel#VolumeRight = synthChannel#.volumeRight[0]; // ALL\r\n\t\t\t\tvar channel#VolumeDelta = synthChannel#.volumeDeltas[0]; // CHIP\r\n\t\t\t\tvar channel#VolumeDelta = synthChannel#.volumeDeltas[0]; // NOISE\r\n\t\t\t\tvar channel#Filter = synthChannel#.filter * channel#FilterBase; // CHIP\r\n\t\t\t\tvar channel#Filter = synthChannel#.filter; // NOISE\r\n\t\t\t\tvar channel#FilterScale = synthChannel#.filterScale; // CHIP\r\n\t\t\t\tvar channel#VibratoScale = synthChannel#.vibratoScale; // PITCH\r\n\t\t\t\t\r\n\t\t\t\tvar effectY     = Math.sin(synth.effectPhase);\r\n\t\t\t\tvar prevEffectY = Math.sin(synth.effectPhase - synth.effectAngle);\r\n\t\t\t\t\r\n\t\t\t\tvar channel#PhaseA = synth.channels[#].phases[0] % 1; // CHIP\r\n\t\t\t\tvar channel#PhaseB = synth.channels[#].phases[1] % 1; // CHIP\r\n\t\t\t\tvar channel#Phase  = synth.channels[#].phases[0] % 1; // NOISE\r\n\t\t\t\t\r\n\t\t\t\tvar channel#Operator$Phase       = ((synth.channels[#].phases[$] % 1) + ` + Synth.negativePhaseGuard + `) * ` + Config.sineWaveLength + `; // FM\r\n\t\t\t\tvar channel#Operator$PhaseDelta  = synthChannel#.phaseDeltas[$]; // FM\r\n\t\t\t\tvar channel#Operator$OutputMult  = synthChannel#.volumeStarts[$]; // FM\r\n\t\t\t\tvar channel#Operator$OutputDelta = synthChannel#.volumeDeltas[$]; // FM\r\n\t\t\t\tvar channel#Operator$Output      = synthChannel#.feedbackOutputs[$]; // FM\r\n\t\t\t\tvar channel#FeedbackMult         = synthChannel#.feedbackMult; // FM\r\n\t\t\t\tvar channel#FeedbackDelta        = synthChannel#.feedbackDelta; // FM\r\n\t\t\t\t\r\n\t\t\t\tvar channel#SampleLeft = +synth.channels[#].sampleLeft; // ALL\r\n\t\t\t\tvar channel#SampleRight = +synth.channels[#].sampleRight; // ALL\r\n\t\t\t\t\r\n\t\t\t\tvar delayPosLeft = 0|synth.delayPosLeft;\r\n\t\t\t\tvar delayFeedback0Left = +synth.delayFeedback0Left;\r\n\t\t\t\tvar delayFeedback1Left = +synth.delayFeedback1Left;\r\n\t\t\t\tvar delayFeedback2Left = +synth.delayFeedback2Left;\r\n\t\t\t\tvar delayFeedback3Left = +synth.delayFeedback3Left;\r\n\t\t\t\tvar delayPosRight = 0|synth.delayPosRight;\r\n\t\t\t\tvar delayFeedback0Right = +synth.delayFeedback0Right;\r\n\t\t\t\tvar delayFeedback1Right = +synth.delayFeedback1Right;\r\n\t\t\t\tvar delayFeedback2Right = +synth.delayFeedback2Right;\r\n\t\t\t\tvar delayFeedback3Right = +synth.delayFeedback3Right;\r\n\t\t\t\tvar limit = +synth.limit;\r\n\t\t\t\t\r\n\t\t\t\twhile (samples) {\r\n\t\t\t\t\tvar channel#Vibrato = 1.0 + channel#VibratoScale * effectY; // PITCH\r\n\t\t\t\t\tvar channel#Tremolo = 1.0 + channel#TremoloScale * (effectY - 1.0); // PITCH\r\n\t\t\t\t\tvar temp = effectY;\r\n\t\t\t\t\teffectY = effectYMult * effectY - prevEffectY;\r\n\t\t\t\t\tprevEffectY = temp;\r\n\t\t\t\t\t\r\n\t\t\t\t\tchannel#SampleLeft += ((channel#Wave[0|(channel#PhaseA * channel#WaveLength)] + channel#Wave[0|(channel#PhaseB * channel#WaveLength)] * channel#ChorusSign) * channel#Volume * channel#Tremolo - channel#SampleLeft) * channel#Filter * channel#VolumeLeft; // CHIP \r\n\t\t\t\t\tchannel#SampleLeft += (channel#Wave[0|(channel#Phase * 32768.0)] * channel#Volume - channel#SampleLeft) * channel#Filter * channel#VolumeLeft; // NOISE\r\n\t\t\t\t\tchannel#SampleRight += ((channel#Wave[0|(channel#PhaseA * channel#WaveLength)] + channel#Wave[0|(channel#PhaseB * channel#WaveLength)] * channel#ChorusSign) * channel#Volume * channel#Tremolo - channel#SampleRight) * channel#Filter * channel#VolumeRight; // CHIP \r\n\t\t\t\t\tchannel#SampleRight += (channel#Wave[0|(channel#Phase * 32768.0)] * channel#Volume - channel#SampleRight) * channel#Filter * channel#VolumeRight; // NOISE\r\n\t\t\t\t\tchannel#Volume += channel#VolumeDelta; // CHIP\r\n\t\t\t\t\tchannel#Volume += channel#VolumeDelta; // NOISE\r\n\t\t\t\t\tchannel#PhaseA += channel#PhaseDelta * channel#Vibrato; // CHIP\r\n\t\t\t\t\tchannel#PhaseB += channel#PhaseDelta * channel#Vibrato * channel#ChorusDeltaRatio; // CHIP\r\n\t\t\t\t\tchannel#Phase += channel#PhaseDelta; // NOISE\r\n\t\t\t\t\tchannel#Filter *= channel#FilterScale; // CHIP\r\n\t\t\t\t\tchannel#PhaseA -= 0|channel#PhaseA; // CHIP\r\n\t\t\t\t\tchannel#PhaseB -= 0|channel#PhaseB; // CHIP\r\n\t\t\t\t\tchannel#Phase -= 0|channel#Phase; // NOISE\r\n\t\t\t\t\tchannel#PhaseDelta *= channel#PhaseDeltaScale; // CHIP\r\n\t\t\t\t\tchannel#PhaseDelta *= channel#PhaseDeltaScale; // NOISE\r\n\t\t\t\t\t\r\n\t\t\t\t\t// INSERT OPERATOR COMPUTATION HERE\r\n\t\t\t\t\tchannel#SampleLeft = channel#Tremolo * (/*channel#Operator$Scaled*/) * channel#VolumeLeft; // CARRIER OUTPUTS\r\n\t\t\t\t\tchannel#SampleRight = channel#Tremolo * (/*channel#Operator$Scaled*/) * channel#VolumeRight; // CARRIER OUTPUTS\r\n\t\t\t\t\tchannel#FeedbackMult += channel#FeedbackDelta; // FM\r\n\t\t\t\t\tchannel#Operator$OutputMult += channel#Operator$OutputDelta; // FM\r\n\t\t\t\t\tchannel#Operator$Phase += channel#Operator$PhaseDelta * channel#Vibrato; // FM\r\n\t\t\t\t\tchannel#Operator$PhaseDelta *= channel#PhaseDeltaScale; // FM\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Reverb, implemented using a feedback delay network with a Hadamard matrix and lowpass filters.\r\n\t\t\t\t\t// good ratios:    0.555235 + 0.618033 + 0.818 +   1.0 = 2.991268\r\n\t\t\t\t\t// Delay lengths:  3041     + 3385     + 4481  +  5477 = 16384 = 2^14\r\n\t\t\t\t\t// Buffer offsets: 3041    -> 6426   -> 10907 -> 16384\r\n\t\t\t\t\tvar delayPos1Left = (delayPosLeft +  3041) & 0x3FFF;\r\n\t\t\t\t\tvar delayPos2Left = (delayPosLeft +  6426) & 0x3FFF;\r\n\t\t\t\t\tvar delayPos3Left = (delayPosLeft + 10907) & 0x3FFF;\r\n\t\t\t\t\tvar delaySampleLeft0 = (delayLineLeft[delayPosLeft]\r\n\t\t\t\t\t\t+ channel#SampleLeft // PITCH\r\n\t\t\t\t\t);\r\n\t\t\t\t\tvar delayPos1Right = (delayPosRight +  3041) & 0x3FFF;\r\n\t\t\t\t\tvar delayPos2Right = (delayPosRight +  6426) & 0x3FFF;\r\n\t\t\t\t\tvar delayPos3Right = (delayPosRight + 10907) & 0x3FFF;\r\n\t\t\t\t\tvar delaySampleRight0 = (delayLineRight[delayPosRight]\r\n\t\t\t\t\t\t+ channel#SampleRight // PITCH\r\n\t\t\t\t\t);\r\n\t\t\t\t\tvar delaySampleLeft1 = delayLineLeft[delayPos1Left];\r\n\t\t\t\t\tvar delaySampleLeft2 = delayLineLeft[delayPos2Left];\r\n\t\t\t\t\tvar delaySampleLeft3 = delayLineLeft[delayPos3Left];\r\n\t\t\t\t\tvar delayTemp0Left = -delaySampleLeft0 + delaySampleLeft1;\r\n\t\t\t\t\tvar delayTemp1Left = -delaySampleLeft0 - delaySampleLeft1;\r\n\t\t\t\t\tvar delayTemp2Left = -delaySampleLeft2 + delaySampleLeft3;\r\n\t\t\t\t\tvar delayTemp3Left = -delaySampleLeft2 - delaySampleLeft3;\r\n\t\t\t\t\tdelayFeedback0Left += ((delayTemp0Left + delayTemp2Left) * reverb - delayFeedback0Left) * 0.5;\r\n\t\t\t\t\tdelayFeedback1Left += ((delayTemp1Left + delayTemp3Left) * reverb - delayFeedback1Left) * 0.5;\r\n\t\t\t\t\tdelayFeedback2Left += ((delayTemp0Left - delayTemp2Left) * reverb - delayFeedback2Left) * 0.5;\r\n\t\t\t\t\tdelayFeedback3Left += ((delayTemp1Left - delayTemp3Left) * reverb - delayFeedback3Left) * 0.5;\r\n\t\t\t\t\tdelayLineLeft[delayPos1Left] = delayFeedback0Left;\r\n\t\t\t\t\tdelayLineLeft[delayPos2Left] = delayFeedback1Left;\r\n\t\t\t\t\tdelayLineLeft[delayPos3Left] = delayFeedback2Left;\r\n\t\t\t\t\tdelayLineLeft[delayPosLeft ] = delayFeedback3Left;\r\n\t\t\t\t\tdelayPosLeft = (delayPosLeft + 1) & 0x3FFF;\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar delaySampleRight1 = delayLineRight[delayPos1Right];\r\n\t\t\t\t\tvar delaySampleRight2 = delayLineRight[delayPos2Right];\r\n\t\t\t\t\tvar delaySampleRight3 = delayLineRight[delayPos3Right];\r\n\t\t\t\t\tvar delayTemp0Right = -delaySampleRight0 + delaySampleRight1;\r\n\t\t\t\t\tvar delayTemp1Right = -delaySampleRight0 - delaySampleRight1;\r\n\t\t\t\t\tvar delayTemp2Right = -delaySampleRight2 + delaySampleRight3;\r\n\t\t\t\t\tvar delayTemp3Right = -delaySampleRight2 - delaySampleRight3;\r\n\t\t\t\t\tdelayFeedback0Right += ((delayTemp0Right + delayTemp2Right) * reverb - delayFeedback0Right) * 0.5;\r\n\t\t\t\t\tdelayFeedback1Right += ((delayTemp1Right + delayTemp3Right) * reverb - delayFeedback1Right) * 0.5;\r\n\t\t\t\t\tdelayFeedback2Right += ((delayTemp0Right - delayTemp2Right) * reverb - delayFeedback2Right) * 0.5;\r\n\t\t\t\t\tdelayFeedback3Right += ((delayTemp1Right - delayTemp3Right) * reverb - delayFeedback3Right) * 0.5;\r\n\t\t\t\t\tdelayLineRight[delayPos1Right] = delayFeedback0Right;\r\n\t\t\t\t\tdelayLineRight[delayPos2Right] = delayFeedback1Right;\r\n\t\t\t\t\tdelayLineRight[delayPos3Right] = delayFeedback2Right;\r\n\t\t\t\t\tdelayLineRight[delayPosRight ] = delayFeedback3Right;\r\n\t\t\t\t\tdelayPosRight = (delayPosRight + 1) & 0x3FFF;\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar sampleLeft = delaySampleLeft0 + delaySampleLeft1 + delaySampleLeft2 + delaySampleLeft3\r\n\t\t\t\t\t\t+ channel#SampleLeft // NOISE\r\n\t\t\t\t\t;\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar sampleRight = delaySampleRight0 + delaySampleRight1 + delaySampleRight2 + delaySampleRight3\r\n\t\t\t\t\t\t+ channel#SampleRight // NOISE\r\n\t\t\t\t\t;\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar abs = sampleLeft < 0.0 ? -sampleLeft : sampleLeft;\r\n\t\t\t\t\tlimit -= limitDecay;\r\n\t\t\t\t\tif (limit < abs) limit = abs;\r\n\t\t\t\t\tsampleLeft /= limit * 0.75 + 0.25;\r\n\t\t\t\t\tsampleLeft *= volume;\r\n\t\t\t\t\tsampleLeft = sampleLeft;\r\n\t\t\t\t\tdataLeft[bufferIndex] = sampleLeft;\r\n\t\t\t\t\tsampleRight /= limit * 0.75 + 0.25;\r\n\t\t\t\t\tsampleRight *= volume;\r\n\t\t\t\t\tsampleRight = sampleRight;\r\n\t\t\t\t\tdataRight[bufferIndex] = sampleRight;\r\n\t\t\t\t\tbufferIndex++;\r\n\t\t\t\t\tsamples--;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tsynthChannel#.phases[0] = channel#PhaseA; // CHIP\r\n\t\t\t\tsynthChannel#.phases[1] = channel#PhaseB; // CHIP\r\n\t\t\t\tsynthChannel#.phases[0] = channel#Phase; // NOISE\r\n\t\t\t\tsynthChannel#.phases[$] = channel#Operator$Phase / ` + Config.sineWaveLength + `; // FM\r\n\t\t\t\tsynthChannel#.feedbackOutputs[$] = channel#Operator$Output; // FM\r\n\t\t\t\tsynthChannel#.sampleLeft = channel#SampleLeft; // ALL\r\n\t\t\t\tsynthChannel#.sampleRight = channel#SampleRight; // ALL\r\n\t\t\t\t\r\n\t\t\t\tsynth.delayPosLeft = delayPosLeft;\r\n\t\t\t\tsynth.delayFeedback0Left = delayFeedback0Left;\r\n\t\t\t\tsynth.delayFeedback1Left = delayFeedback1Left;\r\n\t\t\t\tsynth.delayFeedback2Left = delayFeedback2Left;\r\n\t\t\t\tsynth.delayFeedback3Left = delayFeedback3Left;\r\n\t\t\t\tsynth.delayPosRight = delayPosRight;\r\n\t\t\t\tsynth.delayFeedback0Right = delayFeedback0Right;\r\n\t\t\t\tsynth.delayFeedback1Right = delayFeedback1Right;\r\n\t\t\t\tsynth.delayFeedback2Right = delayFeedback2Right;\r\n\t\t\t\tsynth.delayFeedback3Right = delayFeedback3Right;\r\n\t\t\t\tsynth.limit = limit;\r\n\t\t\t\t\r\n\t\t\t\tif (effectYMult * effectY - prevEffectY > prevEffectY) {\r\n\t\t\t\t\tsynth.effectPhase = Math.asin(effectY);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsynth.effectPhase = Math.PI - Math.asin(effectY);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (synth.arpSampleCountdown == 0) {\r\n\t\t\t\t\tsynth.arpeggio++;\r\n\t\t\t\t\tsynth.arpSampleCountdown = samplesPerTick;\r\n\t\t\t\t\tif (synth.arpeggio == 4) {\r\n\t\t\t\t\t\tsynth.arpeggio = 0;\r\n\t\t\t\t\t\tsynth.part++;\r\n\t\t\t\t\t\tif (synth.part == song.partsPerBeat) {\r\n\t\t\t\t\t\t\tsynth.part = 0;\r\n\t\t\t\t\t\t\tsynth.beat++;\r\n\t\t\t\t\t\t\tif (synth.beat == song.beatsPerBar) {\r\n\t\t\t\t\t\t\t\t// The bar ended, may need to regenerate synthesizer.\r\n\t\t\t\t\t\t\t\treturn bufferIndex;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Indicate that the buffer is finished generating.\r\n\t\t\treturn -1;\r\n\t\t`).split(\"\\n\");\r\n\t\t\r\n\t\tprivate static operatorSourceTemplate: string[] = (`\r\n\t\t\t\t\t\tvar channel#Operator$PhaseMix = channel#Operator$Phase/* + channel#Operator@Scaled*/;\r\n\t\t\t\t\t\tvar channel#Operator$PhaseInt = channel#Operator$PhaseMix|0;\r\n\t\t\t\t\t\tvar channel#Operator$Index    = channel#Operator$PhaseInt & ` + Config.sineWaveMask + `;\r\n\t\t\t\t\t\tvar channel#Operator$Sample   = sineWave[channel#Operator$Index];\r\n\t\t\t\t\t\tchannel#Operator$Output       = channel#Operator$Sample + (sineWave[channel#Operator$Index + 1] - channel#Operator$Sample) * (channel#Operator$PhaseMix - channel#Operator$PhaseInt);\r\n\t\t\t\t\t\tvar channel#Operator$Scaled   = channel#Operator$OutputMult * channel#Operator$Output;\r\n\t\t`).split(\"\\n\");\r\n\t\t\r\n\t\tprivate frequencyFromPitch(pitch: number): number {\r\n\t\t\treturn 440.0 * Math.pow(2.0, (pitch - 69.0) / 12.0);\r\n\t\t}\r\n\t\t\r\n\t\tprivate volumeConversion(noteVolume: number): number {\r\n\t\t\treturn Math.pow(noteVolume / 3.0, 1.5);\r\n\t\t}\r\n\t\t\r\n\t\tprivate getSamplesPerArpeggio(): number {\r\n\t\t\tif (this.song == null) return 0;\r\n\t\t\tconst beatsPerMinute: number = this.song.getBeatsPerMinute();\r\n\t\t\tconst beatsPerSecond: number = beatsPerMinute / 60.0;\r\n\t\t\tconst partsPerSecond: number = beatsPerSecond * this.song.partsPerBeat;\r\n\t\t\tconst arpeggioPerSecond: number = partsPerSecond * 4.0;\r\n\t\t\treturn Math.floor(this.samplesPerSecond / arpeggioPerSecond);\r\n\t\t}\r\n\t}\r\n","/*\r\nCopyright (C) 2018 John Nesky\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\nimport { HTML} from \"imperative-html/dist/esm/elements-strict\";\r\nimport { Prompt } from \"./Prompt\";\r\nimport { SongDocument } from \"./SongDocument\";\r\nimport { Synth } from \"../synth/synth\";\r\n\tconst {button, div, input} = HTML;\r\n\r\n\t// function lerp(low: number, high: number, t: number): number {\r\n\t// \treturn low + t * (high - low);\r\n\t// }\r\n\t\r\n\tfunction save(blob: Blob, name: string): void {\r\n\t\tif ((<any>navigator).msSaveOrOpenBlob) {\r\n\t\t\t(<any>navigator).msSaveOrOpenBlob(blob, name);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\r\n\t\tconst anchor: HTMLAnchorElement = document.createElement(\"a\");\r\n\t\tif (anchor.download != undefined) {\r\n\t\t\tconst url: string = URL.createObjectURL(blob);\r\n\t\t\tsetTimeout(function() { URL.revokeObjectURL(url); }, 60000);\r\n\t\t\tanchor.href = url;\r\n\t\t\tanchor.download = name;\r\n\t\t\t// Chrome bug regression: We need to delay dispatching the click\r\n\t\t\t// event. Seems to be related to going back in the browser history.\r\n\t\t\t// https://bugs.chromium.org/p/chromium/issues/detail?id=825100\r\n\t\t\tsetTimeout(function() { anchor.dispatchEvent(new MouseEvent(\"click\")); }, 0);\r\n\t\t} else {\r\n\t\t\tconst url: string = URL.createObjectURL(blob);\r\n\t\t\tsetTimeout(function() { URL.revokeObjectURL(url); }, 60000);\r\n\t\t\tif (!window.open(url, \"_blank\")) window.location.href = url;\r\n\t\t}\r\n\t}\r\n\r\n\texport class ExportPrompt implements Prompt {\r\n\t\tprivate readonly _fileName: HTMLInputElement = input({type: \"text\", style: \"width: 10em;\", value: \"Modbox-Song\", maxlength: 250});\r\n\t\tprivate readonly _enableIntro: HTMLInputElement = input({type: \"checkbox\"});\r\n\t\tprivate readonly _loopDropDown: HTMLInputElement = input({style:\"width: 2em;\", type: \"number\", min: \"1\", max: \"4\", step: \"1\"});\r\n\t\tprivate readonly _enableOutro: HTMLInputElement = input({type: \"checkbox\"});\r\n\t\tprivate readonly _exportWavButton: HTMLButtonElement = button({}, [div(\"Export to .wav file\")]);\r\n\t\tprivate readonly _exportJsonButton: HTMLButtonElement = button({}, [div(\"Export to .json file\")]);\r\n\t\tprivate readonly _cancelButton: HTMLButtonElement = button({}, [div(\"Cancel\")]);\r\n\t\t\r\n\t\tpublic readonly container: HTMLDivElement = div({class: \"prompt\", style: \"width: 200px;\"}, [\r\n\t\t\tdiv({style: \"font-size: 2em\"}, [div(\"Export Options\")]),\r\n\t\t\tdiv({style: \"display: flex; flex-direction: row; align-items: center; justify-content: space-between;\"}, [\r\n\t\t\t\tdiv(\"File name:\"),\r\n\t\t\t\tthis._fileName,\r\n\t\t\t]),\r\n\t\t\tdiv({style: \"display: table; width: 100%;\"}, [\r\n\t\t\t\tdiv({style: \"display: table-row;\"}, [\r\n\t\t\t\t\tdiv({style: \"display: table-cell;\"}, [div(\"Intro:\")]),\r\n\t\t\t\t\tdiv({style: \"display: table-cell;\"}, [div(\"Loop Count:\")]),\r\n\t\t\t\t\tdiv({style: \"display: table-cell;\"}, [div(\"Outro:\")]),\r\n\t\t\t\t]),\r\n\t\t\t\tdiv({style: \"display: table-row;\"}, [\r\n\t\t\t\t\tdiv({style: \"display: table-cell; vertical-align: middle;\"}, [this._enableIntro]),\r\n\t\t\t\t\tdiv({style: \"display: table-cell; vertical-align: middle;\"}, [this._loopDropDown]),\r\n\t\t\t\t\tdiv({style: \"display: table-cell; vertical-align: middle;\"}, [this._enableOutro]),\r\n\t\t\t\t]),\r\n\t\t\t]),\r\n\t\t\tthis._exportWavButton,\r\n\t\t\tthis._exportJsonButton,\r\n\t\t\tthis._cancelButton,\r\n\t\t]);\r\n\t\t\r\n\t\tconstructor(private _doc: SongDocument) {\r\n\t\t\tthis._loopDropDown.value = \"1\";\r\n\t\t\t\r\n\t\t\tif (this._doc.song.loopStart == 0) {\r\n\t\t\t\tthis._enableIntro.checked = false;\r\n\t\t\t\tthis._enableIntro.disabled = true;\r\n\t\t\t} else {\r\n\t\t\t\tthis._enableIntro.checked = true;\r\n\t\t\t\tthis._enableIntro.disabled = false;\r\n\t\t\t}\r\n\t\t\tif (this._doc.song.loopStart + this._doc.song.loopLength == this._doc.song.barCount) {\r\n\t\t\t\tthis._enableOutro.checked = false;\r\n\t\t\t\tthis._enableOutro.disabled = true;\r\n\t\t\t} else {\r\n\t\t\t\tthis._enableOutro.checked = true;\r\n\t\t\t\tthis._enableOutro.disabled = false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._fileName.addEventListener(\"input\", ExportPrompt._validateFileName);\r\n\t\t\tthis._loopDropDown.addEventListener(\"blur\", ExportPrompt._validateNumber);\r\n\t\t\tthis._exportWavButton.addEventListener(\"click\", this._whenExportToWav);\r\n\t\t\tthis._exportJsonButton.addEventListener(\"click\", this._whenExportToJson);\r\n\t\t\tthis._cancelButton.addEventListener(\"click\", this._close);\r\n\t\t}\r\n\t\t\r\n\t\tprivate _close = (): void => { \r\n\t\t\tthis._doc.undo();\r\n\t\t}\r\n\t\t\r\n\t\tpublic cleanUp = (): void => { \r\n\t\t\tthis._fileName.removeEventListener(\"input\", ExportPrompt._validateFileName);\r\n\t\t\tthis._loopDropDown.removeEventListener(\"blur\", ExportPrompt._validateNumber);\r\n\t\t\tthis._exportWavButton.removeEventListener(\"click\", this._whenExportToWav);\r\n\t\t\tthis._exportJsonButton.removeEventListener(\"click\", this._whenExportToJson);\r\n\t\t\tthis._cancelButton.removeEventListener(\"click\", this._close);\r\n\t\t}\r\n\t\t\r\n\t\tprivate static _validateFileName(event: Event): void {\r\n\t\t\tconst input: HTMLInputElement = <HTMLInputElement>event.target;\r\n\t\t\tconst deleteChars = /[\\+\\*\\$\\?\\|\\{\\}\\\\\\/<>#%!`&'\"=:@]/gi;\r\n\t\t\tif (deleteChars.test(input.value)) {\r\n\t\t\t\tlet cursorPos: number = <number>input.selectionStart;\r\n\t\t\t\tinput.value = input.value.replace(deleteChars, \"\");\r\n\t\t\t\tcursorPos--;\r\n\t\t\t\tinput.setSelectionRange(cursorPos, cursorPos);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tprivate static _validateNumber(event: Event): void {\r\n\t\t\tconst input: HTMLInputElement = <HTMLInputElement>event.target;\r\n\t\t\tinput.value = Math.floor(Math.max(Number(input.min), Math.min(Number(input.max), Number(input.value)))) + \"\";\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenExportToWav = (): void => {\r\n\t\t\t\r\n\t\t\tconst synth: Synth = new Synth(this._doc.song)\r\n\t\t\tsynth.enableIntro = this._enableIntro.checked;\r\n\t\t\tsynth.enableOutro = this._enableOutro.checked;\r\n\t\t\tsynth.loopCount = Number(this._loopDropDown.value);\r\n\t\t\tif (!synth.enableIntro) {\r\n\t\t\t\tfor (let introIter: number = 0; introIter < this._doc.song.loopStart; introIter++) {\r\n\t\t\t\t\tsynth.nextBar();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst sampleFrames: number = synth.totalSamples;\r\n\t\t\tconst recordedSamplesLeft: Float32Array = new Float32Array(sampleFrames);\r\n\t\t\tconst recordedSamplesRight: Float32Array = new Float32Array(sampleFrames);\r\n\t\t\t//const timer: number = performance.now();\r\n\t\t\tsynth.synthesize(recordedSamplesLeft, recordedSamplesRight, sampleFrames);\r\n\t\t\t//console.log(\"export timer\", (performance.now() - timer) / 1000.0);\r\n\t\t\t\r\n\t\t\tconst srcChannelCount: number = 2;\r\n\t\t\tconst wavChannelCount: number = 2;\r\n\t\t\t// const sampleRate: number = 44100;\r\n\t\t\tconst sampleRate: number = synth.samplesPerSecond;\r\n\t\t\tconst bytesPerSample: number = 2;\r\n\t\t\tconst bitsPerSample: number = 8 * bytesPerSample;\r\n\t\t\tconst sampleCount: number = wavChannelCount * sampleFrames;\r\n\t\t\t\r\n\t\t\tconst totalFileSize: number = 44 + sampleCount * bytesPerSample;\r\n\t\t\t\r\n\t\t\tlet index: number = 0;\r\n\t\t\tconst arrayBuffer: ArrayBuffer = new ArrayBuffer(totalFileSize);\r\n\t\t\tconst data: DataView = new DataView(arrayBuffer);\r\n\t\t\tdata.setUint32(index, 0x52494646, false); index += 4;\r\n\t\t\tdata.setUint32(index, 36 + sampleCount * bytesPerSample, true); index += 4; // size of remaining file\r\n\t\t\tdata.setUint32(index, 0x57415645, false); index += 4;\r\n\t\t\tdata.setUint32(index, 0x666D7420, false); index += 4;\r\n\t\t\tdata.setUint32(index, 0x00000010, true); index += 4; // size of following header\r\n\t\t\tdata.setUint16(index, 0x0001, true); index += 2; // not compressed\r\n\t\t\tdata.setUint16(index, wavChannelCount, true); index += 2; // channel count\r\n\t\t\tdata.setUint32(index, sampleRate, true); index += 4; // sample rate\r\n\t\t\tdata.setUint32(index, sampleRate * bytesPerSample * wavChannelCount, true); index += 4; // bytes per second\r\n\t\t\tdata.setUint16(index, bytesPerSample, true); index += 2; // sample rate\r\n\t\t\tdata.setUint16(index, bitsPerSample, true); index += 2; // sample rate\r\n\t\t\tdata.setUint32(index, 0x64617461, false); index += 4;\r\n\t\t\tdata.setUint32(index, sampleCount * bytesPerSample, true); index += 4;\r\n\t\t\tlet stride: number;\r\n\t\t\tlet repeat: number;\r\n\t\t\tif (srcChannelCount == wavChannelCount) {\r\n\t\t\t\tstride = 1;\r\n\t\t\t\trepeat = 1;\r\n\t\t\t} else {\r\n\t\t\t\tstride = srcChannelCount;\r\n\t\t\t\trepeat = wavChannelCount;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tlet valLeft: number;\r\n\t\t\tlet valRight: number;\r\n\t\t\tif (bytesPerSample > 1) {\r\n\t\t\t\t// usually samples are signed. \r\n\t\t\t\tfor (let i: number = 0; i < sampleFrames; i++) {\r\n\t\t\t\t\tvalLeft = Math.floor(recordedSamplesLeft[i * stride] * ((1 << (bitsPerSample - 1)) - 1));\r\n\t\t\t\t\tvalRight = Math.floor(recordedSamplesRight[i * stride] * ((1 << (bitsPerSample - 1)) - 1));\r\n\t\t\t\t\tfor (let k: number = 0; k < repeat; k++) {\r\n\t\t\t\t\t\tif (bytesPerSample == 2) {\r\n\t\t\t\t\t\t\tdata.setInt16(index, valLeft, true); index += 2;\r\n\t\t\t\t\t\t\tdata.setInt16(index, valRight, true); index += 2;\r\n\t\t\t\t\t\t} else if (bytesPerSample == 4) {\r\n\t\t\t\t\t\t\tdata.setInt32(index, valLeft, true); index += 4;\r\n\t\t\t\t\t\t\tdata.setInt32(index, valRight, true); index += 4;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthrow new Error(\"unsupported sample size\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// 8 bit samples are a special case: they are unsigned.\r\n\t\t\t\tfor (let i: number = 0; i < sampleFrames; i++) {\r\n\t\t\t\t\tvalLeft = Math.floor(recordedSamplesLeft[i*stride] * 127 + 128);\r\n\t\t\t\t\tvalRight = Math.floor(recordedSamplesRight[i*stride] * 127 + 128);\r\n\t\t\t\t\tfor (let k: number = 0; k < repeat; k++) {\r\n\t\t\t\t\t\tdata.setUint8(index, valLeft > 255 ? 255 : (valLeft < 0 ? 0 : valLeft)); index++;\r\n\t\t\t\t\t\tdata.setUint8(index, valRight > 255 ? 255 : (valRight < 0 ? 0 : valRight)); index++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst blob = new Blob([arrayBuffer], {type: \"audio/wav\"});\r\n\t\t\tsave(blob, this._fileName.value.trim() + \".wav\");\r\n\t\t\t\r\n\t\t\tthis._close();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenExportToJson = (): void => {\r\n\t\t\tconst jsonObject: Object = this._doc.song.toJsonObject(this._enableIntro.checked, Number(this._loopDropDown.value), this._enableOutro.checked);\r\n\t\t\tconst jsonString: string = JSON.stringify(jsonObject, null, '\\t');\r\n\t\t\tconst blob = new Blob([jsonString], {type: \"application/json\"});\r\n\t\t\tsave(blob, this._fileName.value.trim() + \".json\");\r\n\t\t\tthis._close();\r\n\t\t}\r\n\t}\r\n\r\n","/*\r\nCopyright (C) 2018 John Nesky\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\nimport { HTML } from \"imperative-html/dist/esm/elements-strict\";\r\nimport { Prompt } from \"./Prompt\";\r\nimport { SongDocument } from \"./SongDocument\";\r\nimport { ChangeSong } from \"./changes\";\r\n\tconst {button, div, input} = HTML;\r\n\r\n\r\n\texport class ImportPrompt implements Prompt {\r\n\t\tprivate readonly _fileInput: HTMLInputElement = input({type: \"file\", accept: \".json,application/json\"});\r\n\t\tprivate readonly _cancelButton: HTMLButtonElement = button({}, [div(\"Cancel\")]);\r\n\t\t\r\n\t\tpublic readonly container: HTMLDivElement = div({class: \"prompt\", style: \"width: 200px;\"}, [\r\n\t\t\tdiv({style: \"font-size: 2em\"}, [div(\"Import\")]),\r\n\t\t\tdiv({style: \"text-align: left;\"}, [div(\"BeepBox songs can be exported and re-imported as .json files. You could also use other means to make .json files for BeepBox as long as they follow the same structure.\")]),\r\n\t\t\tthis._fileInput,\r\n\t\t\tthis._cancelButton,\r\n\t\t]);\r\n\t\t\r\n\t\tconstructor(private _doc: SongDocument) {\r\n\t\t\tthis._fileInput.addEventListener(\"change\", this._whenFileSelected);\r\n\t\t\tthis._cancelButton.addEventListener(\"click\", this._close);\r\n\t\t}\r\n\t\t\r\n\t\tprivate _close = (): void => { \r\n\t\t\tthis._doc.undo();\r\n\t\t}\r\n\t\t\r\n\t\tpublic cleanUp = (): void => { \r\n\t\t\tthis._fileInput.removeEventListener(\"change\", this._whenFileSelected);\r\n\t\t\tthis._cancelButton.removeEventListener(\"click\", this._close);\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenFileSelected = (): void => {\r\n\t\t\tconst file: File = this._fileInput.files![0];\r\n\t\t\tif (!file) return;\r\n\t\t\t\r\n\t\t\tconst reader: FileReader = new FileReader();\r\n\t\t\treader.addEventListener(\"load\", (event: Event): void => {\r\n\t\t\t\tthis._doc.prompt = null;\r\n\t\t\t\tthis._doc.record(new ChangeSong(this._doc, <string>reader.result), true);\r\n\t\t\t});\r\n\t\t\treader.readAsText(file);\r\n\t\t}\r\n\t}\r\n\r\n","/*\r\nCopyright (C) 2018 John Nesky\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\nimport { HTML } from \"imperative-html/dist/esm/elements-strict\";\r\nimport { Prompt } from \"./Prompt\";\r\nimport { SongDocument } from \"./SongDocument\";\r\n\r\n\tconst {button, div, a} = HTML;\r\n\texport class ArchivePrompt implements Prompt {\r\n\t\tprivate readonly _cancelButton: HTMLButtonElement = button({}, div(\"No thanks!\"));\r\n\t\t\r\n\t\tpublic readonly container: HTMLDivElement = div({class: \"prompt\", style: \"width: 250px;\"}, \r\n\t\t\tdiv({ style: \"font-size: 2em\" }, div(\"Archives\")),\r\n\t\t\tdiv({ style: \"text-align: center;\" }, div('These are the Archives. Below are previous versions of Modded Beepbox/Sandbox that you are able to play around with, changelog included. Go nuts!')),\r\n\t\t\tdiv({ style: \"text-align: center;\" }, \r\n\t\t\t\ta({ target: \"_blank\", href: \"https://moddedbeepbox.github.io/beta/mb-archives/1.3.0.htm\" }, div(\"MB 1.3.0\")), div(\" | \"),\r\n\t\t\t\ta({ target: \"_blank\", href: \"https://moddedbeepbox.github.io/beta/mb-archives/1.6.0.htm\" }, div(\"MB 1.6.0\")), div(\" | \"),\r\n\t\t\t\ta({ target: \"_blank\", href: \"https://moddedbeepbox.github.io/beta/mb-archives/1.9.1.htm\" }, div(\"MB 1.9.1\")), div(\" | \"),\r\n\t\t\t\ta({ target: \"_blank\", href: \"https://moddedbeepbox.github.io/beta/mb-archives/2.0.0.htm\" }, div(\"MB v2.0.0\")), div(\" | \"),\r\n\t\t\t\ta({ target: \"_blank\", href: \"https://moddedbeepbox.github.io/beta/mb-archives/2.3.0.htm\" }, div(\"MB v2.2.2\")), div(\" | \"),\r\n\t\t\t\ta({ target: \"_blank\", href: \"https://moddedbeepbox.github.io/beta/mb-archives/2.3.html\" }, div(\"MB v2.3.0\")), div(\" | \"),\r\n\t\t\t\ta({ target: \"_blank\", href: \"https://moddedbeepbox.github.io/beta/mb-archives/3.0.html\" }, div(\"MB v3.0.3\")), div(\" | \"),\r\n\t\t\t\ta({ target: \"_blank\", href: \"https://moddedbeepbox.github.io/beta/sb-archives/1.2.1.htm\" }, div(\"SB v1.2.1\")), div(\" | \"),\r\n\t\t\t\ta({ target: \"_blank\", href: \"https://moddedbeepbox.github.io/beta/sb-archives/1.3.0.htm\" }, div(\"SB v1.3.0\")), div(\" | \"),\r\n\t\t\t\ta({ target: \"_blank\", href: \"https://moddedbeepbox.github.io/beta/sb-archives/1.4.0.htm\" }, div(\"SB v1.4.0\")), div(\" | \"),\r\n\t\t\t\ta({ target: \"_blank\", href: \"https://moddedbeepbox.github.io/beta/sb-archives/2.0.6.1.htm\" }, div(\"SB v2.0.6.1\")), div(\" | \"),\r\n\t\t\t\ta({ target: \"_blank\", href: \"https://moddedbeepbox.github.io/beta/sb-archives/2.1.3.htm\" }, div(\"SB v2.1.3\")), div(\" | \"),\r\n\t\t\t\ta({ target: \"_blank\", href: \"https://moddedbeepbox.github.io/beta/sb-archives/3.0.0.htm\" }, div(\"SB v3.0.0\")), div(\" | \"),\r\n\t\t\t\ta({ target: \"_blank\", href: \"https://moddedbeepbox.github.io/beta/changelogs/mbchangelog.html\" }, div(\"Changelog\")),\r\n\t\t\t),\r\n\t\t\tthis._cancelButton,\r\n\t\t);\r\n\r\n\t\t\tconstructor(private _doc: SongDocument) {\r\n\t\t\t\tthis._cancelButton.addEventListener(\"click\", this._close);\r\n\t\t\t}\r\n\t\t\tprivate _close = (): void => { \r\n\t\t\t\tthis._doc.undo();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tpublic cleanUp = (): void => { \r\n\t\t\t\tthis._cancelButton.removeEventListener(\"click\", this._close);\r\n            };\r\n    }\r\n","/*\r\nCopyright (C) 2018 John Nesky\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\nimport { HTML } from \"imperative-html/dist/esm/elements-strict\";\r\nimport { SongDocument } from \"./SongDocument\";\r\nimport { Prompt } from \"./Prompt\";\r\n\tconst {button, div} = HTML;\r\n\r\n\texport class SongDataPrompt implements Prompt {\r\n\t\tprivate readonly _cancelButton: HTMLButtonElement = button({}, [div(\"Close\")]);\r\n\t\t\r\n\t\tpublic readonly container: HTMLDivElement = div({class: \"prompt\", style: \"width: 250px;\"}, [\r\n                div({ style: \"font-size: 2em\" }, [div(\"Song Data\")]),\r\n\t\t\t\tdiv({ style: \"text-align: left;\" }, [div('You are on update Modbox 3.3.0-B_1.')]),\r\n\t\t\t\tdiv({ style: \"text-align: left;\" }, [div('Your song is ' + this._doc.synth.totalSeconds + ' seconds long.')]),\r\n\t\t\t\tdiv({ style: \"text-align: left;\" }, [div('Your song runs at ' + this._doc.song.getBeatsPerMinute() + ' beats per minute.')]),\r\n\t\t\t\tdiv({ style: \"text-align: left;\" }, [div('There are currently ' + this._doc.song.getChannelUnusedCount() + ' unused channels in your song out of 16.')]),\r\n\t\t\t\tdiv({ style: \"text-align: left;\" }, [div(this._doc.song.setSongTheme == \"none\" ? 'You are using your personal theme.' :'Your are using the ' + this._doc.song.setSongTheme + ' theme.')]),\r\n\t\t\t\tdiv({ style: \"text-align: left;\" }, [div('Your time signuature is ' + this._doc.song.getTimeSig())]),\r\n\t\t\t\tdiv({ style: \"text-align: left;\" }, [div('Your scale is ' + this._doc.song.getScaleNKey() + '.')]),\r\n\t\t\tthis._cancelButton,\r\n         ]);\r\n\r\n\t\t\tconstructor(private _doc: SongDocument) {\r\n\t\t\t\tthis._cancelButton.addEventListener(\"click\", this._close);\r\n\t\t\t}\r\n\t\t\tprivate _close = (): void => { \r\n\t\t\t\tthis._doc.undo();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tpublic cleanUp = (): void => { \r\n\t\t\t\tthis._cancelButton.removeEventListener(\"click\", this._close);\r\n            };\r\n    }\r\n","/*\r\nCopyright (C) 2018 John Nesky\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\nimport { HTML } from \"imperative-html/dist/esm/elements-strict\";\r\nimport { SongDocument } from \"./SongDocument\";\r\nimport { Prompt } from \"./Prompt\";\r\nimport { SongEditor } from \"./SongEditor\";\r\nimport { ChangeKey } from \"./changes\";\r\n\tconst {button, div} = HTML;\r\n\texport class RefreshKeyPrompt implements Prompt {\r\n\t\tprivate readonly _refreshButton: HTMLButtonElement = button({}, [div(\"Refresh\")]);\r\n\t\t\r\n\t\tpublic readonly container: HTMLDivElement = div({class: \"prompt\", style: \"width: 200px;\"}, [\r\n\t\t\tdiv({style: \"font-size: 1em\"}, [div(\"Refresh\")]),\r\n\t\t\tdiv({style: \"text-align: left; margin: 0.5em 0;\"}, [\r\n\t\t\t\tdiv(\"Due to you using the Piano theme, you will need to refresh to display the change in key colors.\")]),\r\n\t\t\tdiv({style: \"text-align: left; margin: 0.5em 0;\"}, [\r\n\t\t\t\tdiv(\"You must refresh to continue.\")]),\r\n            this._refreshButton,\r\n         ]);\r\n\r\n\t\t\tconstructor(private _doc: SongDocument, private _songEditor: SongEditor, private _newKeyValue: number) {\r\n\t\t\t\tthis._refreshButton.addEventListener(\"click\", this._saveChangesAndRefresh);\r\n\t\t\t}\r\n\r\n\t\t\tprivate _saveChangesAndRefresh = (): void => {\r\n\t\t\t\tthis._doc.prompt = null;\r\n\t\t\t\tthis._doc.record(new ChangeKey(this._doc, this._newKeyValue));\r\n\t\t\t\tthis._songEditor.refreshNow();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tpublic cleanUp = (): void => { \r\n\t\t\t\tthis._refreshButton.addEventListener(\"click\", this._saveChangesAndRefresh);\r\n            };\r\n    }\r\n","/*\r\nCopyright (C) 2018 John Nesky\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\nimport { HTML } from \"imperative-html/dist/esm/elements-strict\";\r\nimport { SongDocument } from \"./SongDocument\";\r\nimport { Prompt } from \"./Prompt\";\r\nimport { Config } from \"../synth/SynthConfig\";\r\nimport { ChangeGroup } from \"./Change\";\r\nimport { ChangeBeatsPerBar, ChangeBarCount, ChangePatternsPerChannel, ChangeInstrumentsPerChannel, ChangeChannelCount } from \"./changes\";\r\n\tconst {button, div, input, span} = HTML;\r\n\t\r\n\texport class SongDurationPrompt implements Prompt {\r\n\t\tprivate readonly _beatsStepper: HTMLInputElement = input({style: \"width: 3em; margin-left: 1em;\", type: \"number\", step: \"1\"});\r\n\t\tprivate readonly _barsStepper: HTMLInputElement = input({style: \"width: 3em; margin-left: 1em;\", type: \"number\", step: \"1\"});\r\n\t\tprivate readonly _patternsStepper: HTMLInputElement = input({style: \"width: 3em; margin-left: 1em;\", type: \"number\", step: \"1\"});\r\n\t\tprivate readonly _instrumentsStepper: HTMLInputElement = input({style: \"width: 3em; margin-left: 1em;\", type: \"number\", step: \"1\"});\r\n\t\tprivate readonly _pitchChannelStepper: HTMLInputElement = input({style: \"width: 3em; margin-left: 1em;\", type: \"number\", step: \"1\"});\r\n\t\tprivate readonly _drumChannelStepper: HTMLInputElement = input({style: \"width: 3em; margin-left: 1em;\", type: \"number\", step: \"1\"});\r\n\t\tprivate readonly _okayButton: HTMLButtonElement = button({style: \"width:45%;\"}, [div(\"Okay\")]);\r\n\t\tprivate readonly _cancelButton: HTMLButtonElement = button({style: \"width:45%;\"}, [div(\"Cancel\")]);\r\n\t\t\r\n\t\tpublic readonly container: HTMLDivElement = div({class: \"prompt\", style: \"width: 250px;\"}, [\r\n\t\t\tdiv({style: \"font-size: 2em\"}, [div(\"Custom Song Size\")]),\r\n\t\t\tdiv({style: \"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;\"}, [\r\n\t\t\t\tdiv({style: \"text-align: right;\"}, [\r\n\t\t\t\t\tdiv(\"Beats per bar:\"),\r\n\t\t\t\t\tspan({style: \"font-size: smaller; color: #888888;\"}, [div(\"(Multiples of 3 or 4 are recommended)\")]),\r\n\t\t\t\t]),\r\n\t\t\t\tthis._beatsStepper,\r\n\t\t\t]),\r\n\t\t\tdiv({style: \"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;\"}, [\r\n\t\t\t\tdiv({style: \"display: inline-block; text-align: right;\"}, [\r\n\t\t\t\t\tdiv(\"Bars per song:\"),\r\n\t\t\t\t\tspan({style: \"font-size: smaller; color: #888888;\"}, [div(\"(Multiples of 2 or 4 are recommended)\")]),\r\n\t\t\t\t]),\r\n\t\t\t\tthis._barsStepper,\r\n\t\t\t]),\r\n\t\t\tdiv({style: \"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;\"}, [\r\n\t\t\t\tdiv(\"Patterns per channel:\"),\r\n\t\t\t\tthis._patternsStepper,\r\n\t\t\t]),\r\n\t\t\tdiv({style: \"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;\"}, [\r\n\t\t\t\tdiv(\"Instruments per channel:\"),\r\n\t\t\t\tthis._instrumentsStepper,\r\n\t\t\t]),\r\n\t\t\tdiv({style: \"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;\"}, [\r\n\t\t\t\tdiv(\"Number of pitch channels:\"),\r\n\t\t\t\tthis._pitchChannelStepper,\r\n\t\t\t]),\r\n\t\t\tdiv({style: \"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;\"}, [\r\n\t\t\t\tdiv(\"Number of drum channels:\"),\r\n\t\t\t\tthis._drumChannelStepper,\r\n\t\t\t]),\r\n\t\t\tdiv({style: \"display: flex; flex-direction: row; justify-content: space-between;\"}, [\r\n\t\t\t\tthis._okayButton,\r\n\t\t\t\tthis._cancelButton,\r\n\t\t\t]),\r\n\t\t]);\r\n\t\t\r\n\t\tconstructor(private _doc: SongDocument) {\r\n\t\t\tthis._beatsStepper.value = this._doc.song.beatsPerBar + \"\";\r\n\t\t\tthis._beatsStepper.min = Config.beatsPerBarMin + \"\";\r\n\t\t\tthis._beatsStepper.max = Config.beatsPerBarMax + \"\";\r\n\t\t\t\r\n\t\t\tthis._barsStepper.value = this._doc.song.barCount + \"\";\r\n\t\t\tthis._barsStepper.min = Config.barCountMin + \"\";\r\n\t\t\tthis._barsStepper.max = Config.barCountMax + \"\";\r\n\t\t\t\r\n\t\t\tthis._patternsStepper.value = this._doc.song.patternsPerChannel + \"\";\r\n\t\t\tthis._patternsStepper.min = Config.patternsPerChannelMin + \"\";\r\n\t\t\tthis._patternsStepper.max = Config.patternsPerChannelMax + \"\";\r\n\t\t\t\r\n\t\t\tthis._instrumentsStepper.value = this._doc.song.instrumentsPerChannel + \"\";\r\n\t\t\tthis._instrumentsStepper.min = Config.instrumentsPerChannelMin + \"\";\r\n\t\t\tthis._instrumentsStepper.max = Config.instrumentsPerChannelMax + \"\";\r\n\t\t\t\r\n\t\t\tthis._pitchChannelStepper.value = this._doc.song.pitchChannelCount + \"\";\r\n\t\t\tthis._pitchChannelStepper.min = Config.pitchChannelCountMin + \"\";\r\n\t\t\tthis._pitchChannelStepper.max = Config.pitchChannelCountMax + \"\";\r\n\t\t\t\r\n\t\t\tthis._drumChannelStepper.value = this._doc.song.drumChannelCount + \"\";\r\n\t\t\tthis._drumChannelStepper.min = Config.drumChannelCountMin + \"\";\r\n\t\t\tthis._drumChannelStepper.max = Config.drumChannelCountMax + \"\";\r\n\t\t\t\r\n\t\t\tthis._okayButton.addEventListener(\"click\", this._saveChanges);\r\n\t\t\tthis._cancelButton.addEventListener(\"click\", this._close);\r\n\t\t\tthis._beatsStepper.addEventListener(\"keypress\", SongDurationPrompt._validateKey);\r\n\t\t\tthis._barsStepper.addEventListener(\"keypress\", SongDurationPrompt._validateKey);\r\n\t\t\tthis._patternsStepper.addEventListener(\"keypress\", SongDurationPrompt._validateKey);\r\n\t\t\tthis._instrumentsStepper.addEventListener(\"keypress\", SongDurationPrompt._validateKey);\r\n\t\t\tthis._pitchChannelStepper.addEventListener(\"keypress\", SongDurationPrompt._validateKey);\r\n\t\t\tthis._drumChannelStepper.addEventListener(\"keypress\", SongDurationPrompt._validateKey);\r\n\t\t\tthis._beatsStepper.addEventListener(\"blur\", SongDurationPrompt._validateNumber);\r\n\t\t\tthis._barsStepper.addEventListener(\"blur\", SongDurationPrompt._validateNumber);\r\n\t\t\tthis._patternsStepper.addEventListener(\"blur\", SongDurationPrompt._validateNumber);\r\n\t\t\tthis._instrumentsStepper.addEventListener(\"blur\", SongDurationPrompt._validateNumber);\r\n\t\t\tthis._pitchChannelStepper.addEventListener(\"blur\", SongDurationPrompt._validateNumber);\r\n\t\t\tthis._drumChannelStepper.addEventListener(\"blur\", SongDurationPrompt._validateNumber);\r\n\t\t}\r\n\t\t\r\n\t\tprivate _close = (): void => { \r\n\t\t\tthis._doc.undo();\r\n\t\t}\r\n\t\t\r\n\t\tpublic cleanUp = (): void => { \r\n\t\t\tthis._okayButton.removeEventListener(\"click\", this._saveChanges);\r\n\t\t\tthis._cancelButton.removeEventListener(\"click\", this._close);\r\n\t\t\tthis._beatsStepper.removeEventListener(\"keypress\", SongDurationPrompt._validateKey);\r\n\t\t\tthis._barsStepper.removeEventListener(\"keypress\", SongDurationPrompt._validateKey);\r\n\t\t\tthis._patternsStepper.removeEventListener(\"keypress\", SongDurationPrompt._validateKey);\r\n\t\t\tthis._instrumentsStepper.removeEventListener(\"keypress\", SongDurationPrompt._validateKey);\r\n\t\t\tthis._pitchChannelStepper.removeEventListener(\"keypress\", SongDurationPrompt._validateKey);\r\n\t\t\tthis._drumChannelStepper.removeEventListener(\"keypress\", SongDurationPrompt._validateKey);\r\n\t\t\tthis._beatsStepper.removeEventListener(\"blur\", SongDurationPrompt._validateNumber);\r\n\t\t\tthis._barsStepper.removeEventListener(\"blur\", SongDurationPrompt._validateNumber);\r\n\t\t\tthis._patternsStepper.removeEventListener(\"blur\", SongDurationPrompt._validateNumber);\r\n\t\t\tthis._instrumentsStepper.removeEventListener(\"blur\", SongDurationPrompt._validateNumber);\r\n\t\t\tthis._pitchChannelStepper.removeEventListener(\"blur\", SongDurationPrompt._validateNumber);\r\n\t\t\tthis._drumChannelStepper.removeEventListener(\"blur\", SongDurationPrompt._validateNumber);\r\n\t\t}\r\n\t\t\r\n\t\tprivate static _validateKey(event: KeyboardEvent): boolean {\r\n\t\t\tconst charCode = (event.which) ? event.which : event.keyCode;\r\n\t\t\tif (charCode != 46 && charCode > 31 && (charCode < 48 || charCode > 57)) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\tprivate static _validateNumber(event: Event): void {\r\n\t\t\tconst input: HTMLInputElement = <HTMLInputElement>event.target;\r\n\t\t\tinput.value = Math.floor(Math.max(Number(input.min), Math.min(Number(input.max), Number(input.value)))) + \"\";\r\n\t\t}\r\n\t\t\r\n\t\tprivate static _validate(input: HTMLInputElement): number {\r\n\t\t\treturn Math.floor(Number(input.value));\r\n\t\t}\r\n\t\t\r\n\t\tprivate _saveChanges = (): void => {\r\n\t\t\tconst group: ChangeGroup = new ChangeGroup();\r\n\t\t\tgroup.append(new ChangeBeatsPerBar(this._doc, SongDurationPrompt._validate(this._beatsStepper)));\r\n\t\t\tgroup.append(new ChangeBarCount(this._doc, SongDurationPrompt._validate(this._barsStepper)));\r\n\t\t\tgroup.append(new ChangePatternsPerChannel(this._doc, SongDurationPrompt._validate(this._patternsStepper)));\r\n\t\t\tgroup.append(new ChangeInstrumentsPerChannel(this._doc, SongDurationPrompt._validate(this._instrumentsStepper)));\r\n\t\t\tgroup.append(new ChangeChannelCount(this._doc, SongDurationPrompt._validate(this._pitchChannelStepper), SongDurationPrompt._validate(this._drumChannelStepper)));\r\n\t\t\tthis._doc.prompt = null;\r\n\t\t\tthis._doc.record(group, true);\r\n\t\t}\r\n\t}\r\n\r\n","/*\r\nCopyright (C) 2018 John Nesky\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\nimport { HTML} from \"imperative-html/dist/esm/elements-strict\";\r\nimport { Prompt } from \"./Prompt\";\r\nimport { SongDocument } from \"./SongDocument\";\r\n\tconst {button, div, a} = HTML;\r\n\r\n\texport class InstrumentTypePrompt implements Prompt {\r\n\t\tprivate readonly _cancelButton: HTMLButtonElement = button({}, [div(\"Close\")]);\r\n\t\t\r\n\t\tpublic readonly container: HTMLDivElement = div({class: \"prompt\", style: \"width: 300px;\"}, [\r\n\t\t\tdiv({style: \"font-size: 2em\"}, [div(\"FM Synthesis\")]),\r\n\t\t\tdiv({ style: \"text-align: left; margin: 0.5em 0;\" }, [\r\n\t\t\t\tdiv('Popularized by the Sega Genesis and Yamaha keyboards, FM Synthesis is a mysterious but powerful technique for crafting sounds. It may seem confusing, but just play around with the options until you get a feel for it, check out some examples in '),\r\n\t\t\t\ta( { target: \"_blank\", href: \"#6n10s0kbl00e07t5m0a7g07j7i7r1o2T1d2c0A0F1B0V1Q0200Pff00E0411T1d1c0A0F0B0V1Q2800Pf700E0711T1d2c0A0F1B4VaQ0200Pfb00E0911T1d1c2A0F9B3V1Q1000Pfbc0E0191T1d2c0AcF8B5V1Q0259PffffE0000T1d3c1AcF4B5V4Q2600Pff00E0011T1d1c0AbF0B0V1Q2580PfffaE2226T1d1c0A1F0B0V1Q520dPff4dEd41eb4zhmu0p21h5dfxd7ij7XrjfiAjPudUTtUSRsTzudTudJvdUTztTzrpPudUTtUSSYTzudTudJTdUTztTzrvPudUTtUSQ\" }, [div(\"this demo\")]),\r\n\t\t\t\tdiv(\", or find some instruments to use in the Beepbox Discord's FM sheet \"),\r\n\t\t\t\ta( { target: \"_blank\", href: \"https://docs.google.com/spreadsheets/d/1ddbXnrP7yvv5X4oUur9boi3AxcI-Xxz1XIHIAo-wi0s/edit#gid=230623845\" }, [div(\"right here\")]),\r\n\t\t\t\tdiv(\".\")\r\n\t\t\t]),\r\n\t\t\tdiv({style: \"text-align: left; margin: 0.5em 0;\"}, [div(\r\n\t\t\t\t'This FM instrument uses up to four waves, numbered 1, 2, 3, and 4. ' +\r\n\t\t\t\t'Each wave may have its own frequency, volume, and volume envelope to control its effect over time. '\r\n\t\t\t)]),\r\n\t\t\tdiv({style: \"text-align: left; margin: 0.5em 0;\"}, [div(\r\n\t\t\t\t'There are two kinds of waves: \"carrier\" waves play a tone out loud, but \"modulator\" waves distort other waves instead. ' +\r\n\t\t\t\t'Wave 1 is always a carrier and plays a tone, but other waves may distort it. ' +\r\n\t\t\t\t'The \"Algorithm\" setting determines which waves are modulators, and which other waves those modulators distort. '\r\n\t\t\t)]),\r\n\t\t\tdiv({style: \"text-align: left; margin: 0.5em 0;\"}, [div(\r\n\t\t\t\t'Modulators distort in one direction (like 1‚Üê2), but you can also use \"Feedback\" to make any wave distort in the opposite direction (1‚Üí2), in both directions (1üóò2), or even itself (1‚ü≤). '\r\n\t\t\t)]),\r\n\t\t\tdiv({style: \"text-align: left; margin: 0.5em 0;\"}, [div(\r\n\t\t\t\t'You can set the pitch of each wave independently by adding simultaneous notes, one above another. This often sounds harsh or dissonant, but can make cool sound effects! '\r\n\t\t\t)]),\r\n\t\t\tthis._cancelButton,\r\n\t\t]);\r\n\t\t\r\n\t\tconstructor(private _doc: SongDocument) {\r\n\t\t\tthis._cancelButton.addEventListener(\"click\", this._close);\r\n\t\t}\r\n\t\t\r\n\t\tprivate _close = (): void => { \r\n\t\t\tthis._doc.undo();\r\n\t\t}\r\n\t\t\r\n\t\tpublic cleanUp = (): void => { \r\n\t\t\tthis._cancelButton.removeEventListener(\"click\", this._close);\r\n\t\t}\r\n\t}\r\n\r\n","/*\r\nCopyright (C) 2018 John Nesky\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\nimport { HTML } from \"imperative-html/dist/esm/elements-strict\";\r\nimport { SongDocument } from \"./SongDocument\";\r\nimport { Prompt } from \"./Prompt\";\r\nimport { ColorConfig } from \"./ColorConfig\"; \r\n\tconst {button, div, form, label, input } = HTML;\r\n\r\n\texport class ThemePrompt implements Prompt {\r\n\t\tpublic hasChanged = false;\r\n\t\tprivate readonly _closeButton: HTMLButtonElement = button({style:\"flex: 1; width: 0;\"},\"Close\");\r\n\t\tprivate readonly _previewButton: HTMLButtonElement = button({style:\"flex: 1; width: 0;\"},\"Preview\");\r\n\t\tprivate readonly _previewText: HTMLDivElement = div({style:\"opacity: 0; position:absolute; left: 8px; top: 24px; font-size: 32px; font-weight:bold;\"},\"Previewing...\")\r\n\t\tpublic readonly previewExit: HTMLDivElement = div({style: \"width: 100vw; height: 100vh; position: fixed; left: 0; top: -2vh; display: flex; pointer-events: none;\"},this._previewText);\r\n\t\t\r\n\t\tprivate _form: HTMLFormElement = form({style: \"display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; max-height:265px; overflow-y: scroll; overflow-x: hidden;\"},\r\n\t\t\tlabel({title:\"Default\", class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"default\", style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #606060; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Default\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"NepBox\", class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"nepbox\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #9150ff; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"NepBox\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Laffey\", class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"laffey\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #dbbeed; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Laffey\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"ModBox 2.0\", class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"modbox2\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #c4ffa3; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"ModBox 2.0\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Artic\", class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"artic\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #a5eeff; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Artic\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Cinnamon Roll [!]\", class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"Cinnamon Roll\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #f5bb00; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"CinnaBun [!]\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Ocean\", class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"Ocean\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #4449a3; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Ocean\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Rainbow [!]\", class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"rainbow\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: linear-gradient(140deg, #faa, #ffceaa, #ffdfaa, #fff5aa, #e8ffaa, #bfffb2, #b2ffc8, #b2ffe4, #b2b3ff, #e0b2ff, #ffafe9); border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Rainbow [!]\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Float\", class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"float\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: linear-gradient(140deg, #fff, #282828); border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Float [!]\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({ title:\"Windows\", class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"windows\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #295294; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Windows\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Grassland\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"grassland\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #74bc21; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Grassland\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Dessert\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"dessert\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #fffc5b; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Dessert\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Kahootiest\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"kahootiest\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #864cbf; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Kahoot\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Beam to the Bit [!]\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"beambit\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #fa0103; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Beambit [!]\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Pretty Egg\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"egg\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #ffb1f4; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Pretty Egg\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Poniryoshka\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"Poniryoshka\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #dabbe6; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Poni\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Gameboy [!]\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"gameboy\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #306230; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Gameboy [!]\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Woodkid\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"woodkid\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #41323b; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Woodkid\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Midnight\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"midnight\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #445566; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Midnight\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Snedbox\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"snedbox\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #10997e; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Snedbox\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"unnamed\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"unnamed\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #ffffa0; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"unnamed\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Piano\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"piano\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #bfbfbf; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Piano [!]\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Halloween\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"halloween\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #914300; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Halloween\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"FrozenOver‚ùÑÔ∏è\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"frozen\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #99c8ef; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Frozen\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t);\r\n\t\t\r\n\t\t\r\n\t\tpublic readonly themeContainer: HTMLDivElement = div({class: \"prompt\", style: \"width: 330px; max-height: 600px;\"}, \r\n                div({ style: \"font-size: 2em\" }, div(\"Themes\")),\r\n\t\t\t\tthis._form,\r\n\t\t\t\tdiv({style:\"display:flex; flex-direction:row; width:100%; gap: 16px;\"},\r\n\t\t\tthis._previewButton,\r\n\t\t\tthis._closeButton),\r\n        );\r\n\t\tpublic readonly container: HTMLDivElement = div({}, \r\n\t\t\tthis.themeContainer,\r\n\t\t\tthis.previewExit,\r\n        );\r\n\r\n\t\t\tconstructor(private _doc: SongDocument) {\r\n\t\t\t\tthis._closeButton.addEventListener(\"click\", this._close);\r\n\t\t\t\tthis._previewButton.addEventListener(\"click\", this._previewTheme);\r\n\t\t\t\tthis.previewExit.addEventListener(\"click\", this._exitPreview);\r\n\t\t\t\tthis._form.addEventListener(\"change\", this._themeChange);\r\n\t\t\t\tif (window.localStorage.getItem(\"modboxTheme\") != null) {\r\n\t\t\t\t\t(<any> this._form.elements)[\"theme\"].value = window.localStorage.getItem(\"modboxTheme\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tprivate _close = (): void => { \r\n\t\t\t\tif (this.hasChanged == false) {\r\n\t\t\t\t\tif (window.localStorage.getItem(\"modboxTheme\")){\r\n\t\t\t\t\t\tColorConfig.setTheme(String(window.localStorage.getItem(\"modboxTheme\")));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tColorConfig.setTheme(\"default\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._doc.prompt = null;\r\n\t\t\t\t\tthis._doc.undo(); \r\n\t\t\t\t} else {\r\n\t\t\t\t\twindow.localStorage.setItem(\"modboxTheme\", (<any> this._form.elements)[\"theme\"].value);\r\n\t\t\t\t\tthis._doc.prompt = null;\r\n\t\t\t\t\tthis._doc.undo();\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tprivate _themeChange = (): void => {\r\n\t\t\t\tColorConfig.setTheme((<any> this._form.elements)[\"theme\"].value);\r\n\t\t\t\t\r\n\t\t\t\tif ((<any> this._form.elements)[\"theme\"].value != window.localStorage.getItem(\"modboxTheme\")) {\r\n\t\t\t\tthis.hasChanged = true;\r\n\t\t\t\tthis._closeButton.innerHTML = \"Save\"; \r\n\t\t\t} else {\r\n\t\t\t\tthis.hasChanged = false;\r\n\t\t\t\tthis._closeButton.innerHTML = \"Cancel\"; \r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tprivate _previewTheme = (): void => { \r\n\t\t\t\tthis.themeContainer.style.opacity = \"0\";\r\n\t\t\t\tthis.previewExit.style.pointerEvents = \"\";\r\n\t\t\t\tthis._previewText.style.opacity = \"1\";\r\n\t\t\t}\r\n\r\n\t\t\tprivate _exitPreview = (): void => { \r\n\t\t\t\tthis.themeContainer.style.opacity = \"1\";\r\n\t\t\t\tthis.previewExit.style.pointerEvents = \"none\";\r\n\t\t\t\tthis._previewText.style.opacity = \"0\";\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tpublic cleanUp = (): void => { \r\n\t\t\t\tthis._closeButton.removeEventListener(\"click\", this._close);\r\n            };\r\n    }\r\n","/*\r\nCopyright (C) 2018 John Nesky\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\nimport { HTML } from \"imperative-html/dist/esm/elements-strict\";\r\nimport { SongDocument } from \"./SongDocument\";\r\nimport { Prompt } from \"./Prompt\";\r\nimport { ColorConfig } from \"./ColorConfig\"; \r\nimport { ChangeSongTheme } from \"./changes\";\r\n\tconst {button, div, form, label, input } = HTML;\r\n\r\n\texport class SongThemePrompt implements Prompt {\r\n\t\tpublic hasChanged = false;\r\n\t\tprivate readonly _closeButton: HTMLButtonElement = button({style:\"flex: 1; width: 0;\"},\"Close\");\r\n\t\tprivate readonly _previewButton: HTMLButtonElement = button({style:\"flex: 1; width: 0;\"},\"Preview\");\r\n\t\tprivate readonly _previewText: HTMLDivElement = div({style:\"opacity: 0; position:absolute; left: 8px; top: 24px; font-size: 32px; font-weight:bold;\"},\"Previewing...\")\r\n\t\tpublic readonly previewExit: HTMLDivElement = div({style: \"width: 100vw; height: 100vh; position: fixed; left: 0; top: -2vh; display: flex; pointer-events: none;\"},this._previewText);\r\n\t\t\r\n\t\tprivate _form: HTMLFormElement = form({style: \"display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; max-height:265px; overflow-y: scroll; overflow-x: hidden;\"},\r\n\t\t\tlabel({title:\"None\", class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"none\", style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background:rgb(0, 0, 0); border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"None\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Default\", class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"default\", style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #606060; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Default\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Laffey\", class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"laffey\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #dbbeed; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Laffey\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"NepBox\", class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"nepbox\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #9150ff; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"NepBox\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"ModBox 2.0\", class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"modbox2\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #c4ffa3; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"ModBox 2.0\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Artic\", class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"artic\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #a5eeff; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Artic\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Cinnamon Roll [!]\", class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"Cinnamon Roll\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #f5bb00; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"CinnaBun [!]\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Ocean\", class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"Ocean\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #4449a3; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Ocean\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Rainbow [!]\", class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"rainbow\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: linear-gradient(140deg, #faa, #ffceaa, #ffdfaa, #fff5aa, #e8ffaa, #bfffb2, #b2ffc8, #b2ffe4, #b2b3ff, #e0b2ff, #ffafe9); border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Rainbow [!]\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Float\", class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"float\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: linear-gradient(140deg, #fff, #282828); border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Float [!]\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({ title:\"Windows\", class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"windows\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #295294; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Windows\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Grassland\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"grassland\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #74bc21; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Grassland\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Dessert\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"dessert\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #fffc5b; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Dessert\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Kahootiest\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"kahootiest\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #864cbf; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Kahoot\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Beam to the Bit [!]\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"beambit\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #fa0103; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Beambit [!]\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Pretty Egg\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"egg\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #ffb1f4; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Pretty Egg\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Poniryoshka\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"Poniryoshka\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #dabbe6; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Poni\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Gameboy [!]\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"gameboy\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #306230; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Gameboy [!]\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Woodkid\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"woodkid\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #41323b; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Woodkid\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Midnight\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"midnight\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #445566; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Midnight\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Snedbox\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"snedbox\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #10997e; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Snedbox\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"unnamed\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"unnamed\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #ffffa0; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"unnamed\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Piano\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"piano\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #bfbfbf; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Piano [!]\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"Halloween\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"halloween\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #914300; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Halloween\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tlabel({title:\"FrozenOver‚ùÑÔ∏è\",class: \"theme-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"theme\", value: \"frozen\",style:\"display:none;\"}),\r\n\t\t\t\tdiv({style:\"display: flex; flex-direction: column; gap: 3px; align-items: center;\"},\r\n\t\t\t\t\tdiv({style:\"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;\"},\r\n\t\t\t\t\t\tdiv({style:\"width: 58px; height: 58px; background: #99c8ef; border-radius: 35px;\"}),\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({style:\"text-wrap:wrap; max-width: 64px; color:currentColor;\"},\"Frozen\"),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t);\r\n\t\t\r\n\t\t\r\n\t\tpublic readonly themeContainer: HTMLDivElement = div({class: \"prompt\", style: \"width: 330px; max-height: 600px;\"}, \r\n                div({ style: \"font-size: 2em\" }, div(\"Song Themes\")),\r\n\t\t\t\tthis._form,\r\n\t\t\t\tdiv({style:\"display:flex; flex-direction:row; width:100%; gap: 16px;\"},\r\n\t\t\tthis._previewButton,\r\n\t\t\tthis._closeButton),\r\n        );\r\n\t\tpublic readonly container: HTMLDivElement = div({}, \r\n\t\t\tthis.themeContainer,\r\n\t\t\tthis.previewExit,\r\n        );\r\n\r\n\t\t\tconstructor(private _doc: SongDocument) {\r\n\t\t\t\tthis._closeButton.addEventListener(\"click\", this._close);\r\n\t\t\t\tthis._previewButton.addEventListener(\"click\", this._previewTheme);\r\n\t\t\t\tthis.previewExit.addEventListener(\"click\", this._exitPreview);\r\n\t\t\t\tthis._form.addEventListener(\"change\", this._themeChange);\r\n\t\t\t\tif (this._doc.song.setSongTheme != \"none\") {\r\n\t\t\t\t\t(<any> this._form.elements)[\"theme\"].value = this._doc.song.setSongTheme;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t(<any> this._form.elements)[\"theme\"].value = \"none\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tprivate _close = (): void => { \r\n\t\t\t\tif (this.hasChanged == false) {\r\n\t\t\t\t\tif (this._doc.song.setSongTheme == \"none\") {\r\n\t\t\t\t\t\tif (window.localStorage.getItem(\"modboxTheme\")){\r\n\t\t\t\t\t\t\tColorConfig.setTheme(String(window.localStorage.getItem(\"modboxTheme\")));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tColorConfig.setTheme(\"default\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tColorConfig.setTheme(this._doc.song.setSongTheme)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._doc.prompt = null;\r\n\t\t\t\t\tthis._doc.undo(); \r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._doc.prompt = null;\r\n\t\t\t\t\tthis._doc.record(new ChangeSongTheme(this._doc, this._doc.song.setSongTheme, (<any> this._form.elements)[\"theme\"].value), true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tprivate _themeChange = (): void => {\r\n\t\t\t\tif ((<any> this._form.elements)[\"theme\"].value != \"none\") {\r\n\t\t\t\tColorConfig.setTheme((<any> this._form.elements)[\"theme\"].value);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (window.localStorage.getItem(\"modboxTheme\")){\r\n\t\t\t\t\t\tColorConfig.setTheme(String(window.localStorage.getItem(\"modboxTheme\")));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tColorConfig.setTheme(\"default\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif ((<any> this._form.elements)[\"theme\"].value != this._doc.song.setSongTheme) {\r\n\t\t\t\tthis.hasChanged = true;\r\n\t\t\t\tthis._closeButton.innerHTML = \"Save\"; \r\n\t\t\t} else {\r\n\t\t\t\tthis.hasChanged = false;\r\n\t\t\t\tthis._closeButton.innerHTML = \"Cancel\"; \r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tprivate _previewTheme = (): void => { \r\n\t\t\t\tthis.themeContainer.style.opacity = \"0\";\r\n\t\t\t\tthis.previewExit.style.pointerEvents = \"\";\r\n\t\t\t\tthis._previewText.style.opacity = \"1\";\r\n\t\t\t}\r\n\r\n\t\t\tprivate _exitPreview = (): void => { \r\n\t\t\t\tthis.themeContainer.style.opacity = \"1\";\r\n\t\t\t\tthis.previewExit.style.pointerEvents = \"none\";\r\n\t\t\t\tthis._previewText.style.opacity = \"0\";\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tpublic cleanUp = (): void => { \r\n\t\t\t\tthis._closeButton.removeEventListener(\"click\", this._close);\r\n            };\r\n    }\r\n","// Copyright (c) 2012-2022 John Nesky and contributing authors, distributed under the MIT license, see accompanying the LICENSE.md file.\r\n\r\nimport {HTML} from \"imperative-html/dist/esm/elements-strict\";\r\n//import {ColorConfig} from \"./ColorConfig\";\r\n\r\n// check SongEditor.ts for these\r\n//const fullLayoutColumns = window.localStorage.getItem(\"advancedSettings\") ? \"minmax(0, 1fr) 190px 200px\" : \"minmax(0, 1fr) 190px\";\r\n//const middleLayoutColumns = window.localStorage.getItem(\"advancedSettings\") ? \"190px minmax(0, 1fr) 200px\" : \"190px minmax(0, 1fr)\";\r\n\r\n\r\n\r\nexport class Layout {\r\n\tprivate static readonly _layoutMap: {[K: string]: string} = {\r\n\t\t\"small\": \"\",\r\n\r\n\t\t// Full\r\n\r\n\t\t\"full\": `\\\r\n\t\tbody {\r\n\t\t\tmargin: 0;\r\n\t\t}\r\n\r\n\t\t.centerDiv {\r\n\t\t\twidth: unset !important;\r\n\t\t}\r\n\r\n\t\t#beepboxEditorContainer {\r\n\t\t\twidth: 100% !important;\r\n\t\t\theight: 100vh !important;\r\n\t\t}\r\n\t\t\r\n\t\t.modTitle {\r\n\t\tdisplay: none;\r\n\t\t}\r\n\r\n\t\t.beepboxEditor {\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 100vh;\r\n\t\t\tgrid-template-columns: var(--full-layout-columns);\r\n\t\t\tgrid-template-rows: minmax(0px, min-content) minmax(0px, 1fr) minmax(0, min-content);\r\n\t\t\toverflow-y: hidden;\r\n\t\t}\r\n\r\n\t\t.editorBox {\r\n\t\t\theight: unset !important;\r\n\t\t}\r\n\r\n\t\t.trackContainer {\r\n\t\t\twidth: unset !important;\r\n\t\t\toverflow-x: scroll !important;\r\n\t\t}\r\n\r\n\t\t.beepboxEditor .trackAndMuteContainer {\r\n\t\t\twidth: 100%;\r\n\t\t\tmin-height: 0;\r\n\t\t\tflex: 1;\r\n\t\t\toverflow: auto;\r\n\t\t}\r\n\r\n\t\t.trackArea {\r\n\t\t\toverflow-y: scroll;\r\n\t\t}\r\n\r\n\t\t.barScrollBar {\r\n\t\t\tdisplay: none !important;\r\n\t\t}\r\n\t\t`,\r\n\r\n\t\t// Middle\r\n\r\n\t\t\"middle\": `\\\r\n\t\t\t\tbody {\r\n\t\t\tmargin: 0;\r\n\t\t}\r\n\r\n\t\t.centerDiv {\r\n\t\t\twidth: unset !important;\r\n\t\t}\r\n\r\n\t\t.modTitle {\r\n\t\tdisplay: none;\r\n\t\t}\r\n\r\n\t\t#beepboxEditorContainer {\r\n\t\t\twidth: 100% !important;\r\n\t\t\theight: 100vh !important;\r\n\t\t}\r\n\t\t\r\n\t\t.beepboxEditor {\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 100vh;\r\n\t\t\tgrid-template-areas:\r\n\t\t\t\t\"settings-area      pattern-area  advanced-settings-area\" \r\n\t\t\t\t\"song-settings-area pattern-area  advanced-settings-area\" \r\n\t\t\t\t\"song-settings-area track-area    advanced-settings-area\" !important;\r\n\t\t\tgrid-template-columns: var(--middle-layout-columns);\r\n\t\t\tgrid-template-rows: minmax(0px, min-content) minmax(0px, 1fr) minmax(0, min-content);\r\n\t\t\toverflow-y: hidden;\r\n\t\t}\r\n\r\n\t\t.settings-area {\r\n\t\t\tmargin-left: 0 !important;\r\n\t\t\tmargin-right: 6px !important;\r\n\t\t}\r\n\r\n\t\t.song-settings-area {\r\n\t\t\tmargin-left: 0 !important;\r\n\t\t\tmargin-right: 6px !important;\r\n\t\t}\r\n\r\n\t\t.editorBox {\r\n\t\t\theight: unset !important;\r\n\t\t}\r\n\r\n\t\t.trackContainer {\r\n\t\t\twidth: unset !important;\r\n\t\t\toverflow-x: scroll !important;\r\n\t\t}\r\n\r\n\t\t.trackArea {\r\n\t\t\toverflow-y: scroll;\r\n\t\t}\r\n\r\n\t\t.beepboxEditor .trackAndMuteContainer {\r\n\t\t\twidth: 100%;\r\n\t\t\tmin-height: 0;\r\n\t\t\tflex: 1;\r\n\t\t\toverflow: auto;\r\n\t\t}\r\n\r\n\t\t.barScrollBar {\r\n\t\t\tdisplay: none !important;\r\n\t\t}\r\n\t\t`,\r\n\r\n\t\t// Flow\r\n\r\n\t\t\"flow\": `\\\r\n\t\tbody {\r\n\t\t\tmargin: 0;\r\n\t\t}\r\n\r\n\t\t.beepboxEditor {\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 100vh;\r\n\t\t\tgrid-template-areas:\r\n\t\t\t\t\"settings-area settings-area         \" \r\n\t\t\t\t\"song-settings-area     pattern-area\" \r\n\t\t\t\t\"advanced-settings-area pattern-area\"\r\n\t\t\t\t\"advanced-settings-area track-area  \" !important;\r\n\t\t\tgrid-template-columns: 190px minmax(0, 1fr);\r\n\t\t\tgrid-template-rows: minmax(0px, min-content) minmax(0px, min-content) minmax(0px, 1fr);\r\n\t\t\toverflow-y: hidden;\r\n\t\t}\r\n\r\n\t\t.advanced-settings-area {\r\n\t\toverflow-y: scroll;\r\n\t\t}\r\n\r\n\t\t.centerDiv {\r\n\t\t\twidth: unset !important;\r\n\t\t}\r\n\r\n\t\t#beepboxEditorContainer {\r\n\t\t\twidth: 100% !important;\r\n\t\t\theight: 100vh !important;\r\n\t\t}\r\n\t\t\r\n\t\t.modTitle {\r\n\t\tdisplay: none;\r\n\t\t}\r\n\r\n\t\t.editorBox {\r\n\t\t\theight: unset !important;\r\n\t\t}\r\n\r\n\t\t.trackContainer {\r\n\t\t\twidth: unset !important;\r\n\t\t\toverflow-x: scroll !important;\r\n\t\t}\r\n\r\n\t\t.beepboxEditor .trackAndMuteContainer {\r\n\t\t\twidth: 100%;\r\n\t\t\tmin-height: 0;\r\n\t\t\tflex: 1;\r\n\t\t\toverflow: auto;\r\n\t\t}\r\n\r\n\t\t.trackArea {\r\n\t\t\toverflow-y: scroll;\r\n\t\t}\r\n\r\n\t\t.barScrollBar {\r\n\t\t\tdisplay: none !important;\r\n\t\t}\r\n\r\n\t\t.beepboxEditor .editor-settings {\r\n\t\t\tmargin-right: 6px;\r\n\t\t}\r\n\r\n\t\t.settings-area {\r\n\t\t\twidth: 50% !important;\r\n  \t\t\tgap: 3px !important;\r\n\t\t\tflex-direction: row !important;\r\n\t\t}\r\n\r\n\t\t.settings-area .title {\r\n\t\t\tflex: 1;\r\n\t\t}\r\n\r\n\t\t.settings-area .controller {\r\n\t\t\tflex-direction: row-reverse !important;\r\n\t\t\tflex: 3;\r\n\t\t}\r\n\r\n\t\t.settings-area .controller div {\r\n\t\t\tflex: 1;\r\n\t\t}\r\n\r\n\t\t.settings-area .editor-widgets {\r\n\t\t\tflex: 1;\r\n\t\t}\r\n\r\n\t\t.settings-area .editor-widgets .editor-menus {\r\n\t\t\tflex-direction: row;\r\n\t\t\tgap: 3px;\r\n\t\t\tmargin-top: .2em;\r\n\t\t\twidth: 0 !important;\r\n\t\t}\r\n\r\n\t\t.settings-area .editor-widgets .editor-menus .selectContainer {\r\n\t\t\tdisplay: flex;\r\n  \t\t\tjustify-content: center;\r\n\t\t}\r\n\r\n\t\t.settings-area .editor-widgets .editor-menus svg {\r\n\t\t\tleft: unset !important;\r\n\t\t}\r\n\r\n\t\t.settings-area .editor-widgets .editor-menus .selectContainer select {\r\n\t\t\twidth: 0 !important;\r\n\t\t}\r\n\r\n\t\t.beepboxEditor .selectContainer.menu::after {\r\n\t\t\tcontent: none !important;\r\n\t\t}\r\n\r\n\t\t.beepboxEditor .settings-area .editor-widgets .editor-menus {\r\n\t\t\twidth: 8em !important;\r\n\t\t}\r\n\r\n\t\t`,\r\n\t}\r\n\t\r\n\tprivate static readonly _styleElement: HTMLStyleElement = document.head.appendChild(HTML.style({type: \"text/css\"}));\r\n\t\r\n\tpublic static setLayout(layout: string): void {\r\n\t\tthis._styleElement.textContent = this._layoutMap[layout];\r\n\t}\r\n}\r\n","// Copyright (c) 2012-2022 John Nesky and contributing authors, distributed under the MIT license, see accompanying the LICENSE.md file.\r\n\r\nimport {SongDocument} from \"./SongDocument\";\r\nimport {Layout} from \"./Layout\";\r\nimport {Prompt} from \"./Prompt\";\r\nimport {HTML, SVG} from \"imperative-html/dist/esm/elements-strict\";\r\n\r\nconst {button, label, div, form, input} = HTML;\r\n\r\nexport class LayoutPrompt implements Prompt {\r\n\tprivate readonly _fileInput: HTMLInputElement = input({type: \"file\", accept: \".json,application/json,.mid,.midi,audio/midi,audio/x-midi\"});\r\n\tprivate readonly _okayButton: HTMLButtonElement = button({class: \"okayButton\", style: \"flex:1;\"}, \"Okay\");\r\n\tprivate readonly _cancelButton: HTMLButtonElement = button({style:\"flex: 1; width: 0;\"},\"Cancel\");\r\n\tprivate readonly _form: HTMLFormElement = form({style: \"display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; max-height: 265px; overflow-y: scroll; overflow-x: hidden;\"},\r\n\t\t\tlabel({class: \"layout-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"layout\", value: \"small\"}),\r\n\t\t\t\tSVG(`\\\r\n\t\t\t\t\t<svg viewBox=\"-4 -1 28 22\">\r\n\t\t\t\t\t\t<rect x=\"0\" y=\"0\" width=\"20\" height=\"20\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1\"/>\r\n\t\t\t\t\t\t<rect x=\"2\" y=\"2\" width=\"11\" height=\"10\" fill=\"currentColor\"/>\r\n\t\t\t\t\t\t<rect x=\"14\" y=\"2\" width=\"4\" height=\"16\" fill=\"currentColor\"/>\r\n\t\t\t\t\t\t<rect x=\"2\" y=\"13\" width=\"11\" height=\"5\" fill=\"currentColor\"/>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t`),\r\n\t\t\t\tdiv(\"Small\"),\r\n\t\t\t),\r\n\t\t\tlabel({class: \"layout-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"layout\", value: \"full\"}),\r\n\t\t\t\tSVG(`\\\r\n\t\t\t\t\t<svg viewBox=\"-1 -1 28 22\">\r\n\t\t\t\t\t\t<rect x=\"0\" y=\"0\" width=\"26\" height=\"20\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1\"/>\r\n\t\t\t\t\t\t<rect x=\"2\" y=\"2\" width=\"12\" height=\"10\" fill=\"currentColor\"/>\r\n\t\t\t\t\t\t<rect x=\"15\" y=\"2\" width=\"4\" height=\"16\" fill=\"currentColor\"/>\r\n\t\t\t\t\t\t<rect x=\"20\" y=\"2\" width=\"4\" height=\"16\" fill=\"currentColor\"/>\r\n\t\t\t\t\t\t<rect x=\"2\" y=\"13\" width=\"12\" height=\"5\" fill=\"currentColor\"/>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t`),\r\n\t\t\t\tdiv(\"Full\"),\r\n\t\t\t),\r\n\t\t\tlabel({class: \"layout-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"layout\", value: \"middle\"}),\r\n\t\t\t\tSVG(`\\\r\n\t\t\t\t\t<svg viewBox=\"-1 -1 28 22\">\r\n\t\t\t\t\t\t<rect x=\"0\" y=\"0\" width=\"26\" height=\"20\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1\"/>\r\n\t\t\t\t\t\t<rect x=\"7\" y=\"2\" width=\"12\" height=\"10\" fill=\"currentColor\"/>\r\n\t\t\t\t\t\t<rect x=\"2\" y=\"2\" width=\"4\" height=\"16\" fill=\"currentColor\"/>\r\n\t\t\t\t\t\t<rect x=\"20\" y=\"2\" width=\"4\" height=\"16\" fill=\"currentColor\"/>\r\n\t\t\t\t\t\t<rect x=\"7\" y=\"13\" width=\"12\" height=\"5\" fill=\"currentColor\"/>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t`),\r\n\t\t\t\tdiv(\"Middle\"),\r\n\t\t\t),\r\n\t\t\tlabel({class: \"layout-option\"},\r\n\t\t\t\tinput({type: \"radio\", name: \"layout\", value: \"flow\"}),\r\n\t\t\t\tSVG(`\\\r\n\t\t\t\t\t<svg viewBox=\"-1 -1 28 22\">\r\n\t\t\t\t\t\t<rect x=\"0\" y=\"0\" width=\"26\" height=\"20\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1\"/>\r\n\t\t\t\t\t\t<rect x=\"7\" y=\"5\" width=\"17\" height=\"7\" fill=\"currentColor\"/>\r\n\t\t\t\t\t\t<rect x=\"2\" y=\"2\" width=\"22\" height=\"2\" fill=\"currentColor\"/>\r\n\t\t\t\t\t\t<rect x=\"2\" y=\"5\" width=\"4\" height=\"13\" fill=\"currentColor\"/>\r\n\t\t\t\t\t\t<rect x=\"7\" y=\"13\" width=\"17\" height=\"5\" fill=\"currentColor\"/>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t`),\r\n\t\t\t\tdiv(\"Flow\"),\r\n\t\t\t),\r\n\t\t);\r\n\t\r\n\tpublic readonly container: HTMLDivElement = div({class: \"prompt noSelection\", style: \"width: 300px;\"},\r\n\t\tdiv({ style: \"font-size: 2em\" }, div(\"Layouts\")),\r\n\t\tthis._form,\r\n\t\tdiv({style: \"display: flex; flex-direction: row; justify-content: space-between; gap: 3px;\"},\r\n\t\t\tthis._cancelButton,\r\n\t\t\tthis._okayButton,\r\n\t\t),\r\n\t);\r\n\t\r\n\tconstructor(private _doc: SongDocument) {\r\n\t\tthis._fileInput.select();\r\n\t\tsetTimeout(()=>this._fileInput.focus());\r\n\t\t\r\n\t\tthis._okayButton.addEventListener(\"click\", this._confirm);\r\n\t\tthis._cancelButton.addEventListener(\"click\", this._close);\r\n\t\tthis.container.addEventListener(\"keydown\", this._whenKeyPressed);\r\n\t\t\r\n\t\t(<any> this._form.elements)[\"layout\"].value = this._doc.prefs.layout;\r\n\t}\r\n\t\r\n\tprivate _close = (): void => { \r\n\t\tthis._doc.undo();\r\n\t}\r\n\t\r\n\tpublic cleanUp = (): void => { \r\n\t\tthis._okayButton.removeEventListener(\"click\", this._confirm);\r\n\t\tthis._cancelButton.removeEventListener(\"click\", this._close);\r\n\t\tthis.container.removeEventListener(\"keydown\", this._whenKeyPressed);\r\n\t}\r\n\t\r\n\tprivate _whenKeyPressed = (event: KeyboardEvent): void => {\r\n\t\tif ((<Element> event.target).tagName != \"BUTTON\" && event.keyCode == 13) { // Enter key\r\n\t\t\tthis._confirm();\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate _confirm = (): void => { \r\n\t\twindow.localStorage.setItem(\"layout\", (<any> this._form.elements)[\"layout\"].value)\r\n\t\tthis._doc.prefs.layout = (<any> this._form.elements)[\"layout\"].value;\r\n\t\tLayout.setLayout(this._doc.prefs.layout);\r\n\t\tthis._close();\r\n\t}\r\n}\r\n","/*\r\nCopyright (C) 2018 John Nesky\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\nimport {Prompt} from \"./Prompt\";\r\nimport { SongDocument } from \"./SongDocument\";\r\nimport {Change} from \"./Change\";\r\nimport {PatternEditor} from \"./PatternEditor\";\r\nimport { HTML, SVG } from \"imperative-html/dist/esm/elements-strict\";\r\nimport { Channel, Instrument, Note, Pattern } from \"../synth/song\";\r\nimport { InstrumentType, Config } from \"../synth/SynthConfig\";\r\nimport { TrackEditor } from \"./TrackEditor\";\r\nimport { LoopEditor } from \"./LoopEditor\";\r\nimport { BarScrollBar } from \"./BarScrollBar\";\r\nimport { OctaveScrollBar } from \"./OctaveScrollBar\";\r\nimport { Piano } from \"./Piano\";\r\nimport { ChangeInsertBars, ChangeTransition, ChangeAlgorithm, ChangeBlend, ChangeChannelBar, ChangeChorus, ChangeDetune, ChangeEffect,ChangeFMChorus, ChangeFeedbackAmplitude, ChangeFeedbackEnvelope, ChangeFeedbackType, ChangeFilter, ChangeHarm, ChangeImute, ChangeInstrumentType, ChangeIpan, ChangeKey,  ChangeMix, ChangeMuff, ChangeOctoff, ChangeOperatorAmplitude, ChangeOperatorEnvelope, ChangeOperatorFrequency, ChangePartsPerBeat, ChangePaste, ChangePatternInstrument, ChangeReverb, ChangeRiff, ChangeSampleRate, ChangeScale, ChangeSong, ChangeTempo, ChangeTranspose, ChangeVolume, ChangeWave, ChangeDeleteBars, ChangeRemoveChannel, ChangeEnsurePatternExists } from \"./changes\";\r\nimport { MixPrompt} from \"./MixPrompt\";\r\nimport { ChorusPrompt } from \"./ChorusPrompt\";\r\nimport { ExportPrompt } from \"./ExportPrompt\";\r\nimport { ImportPrompt } from \"./ImportPrompt\";\r\nimport { ArchivePrompt } from \"./ArchivePrompt\";\r\nimport { SongDataPrompt } from \"./SongDataPrompt\";\r\nimport { RefreshKeyPrompt } from \"./RefreshKeyPrompt\";\r\nimport { SongDurationPrompt } from \"./SongDurationPrompt\";\r\nimport { InstrumentTypePrompt } from \"./InstrumentTypePrompt\";\r\nimport { ThemePrompt } from \"./ThemePrompt\";\r\nimport { SongThemePrompt } from \"./SongThemePrompt\";\r\nimport { LayoutPrompt } from \"./LayoutPrompt\";\r\nimport { ColorConfig } from \"./ColorConfig\"; \r\n\r\nconst {button, div, span, select, option, input, a} = HTML;\r\n\t\r\n\texport const isMobile: boolean = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|android|ipad|playbook|silk/i.test(navigator.userAgent);\r\n\t\r\n\tlet songThemeSet = \"none\";\r\n\r\n\tfunction buildOptions(menu: HTMLSelectElement, items: ReadonlyArray<string | number>): HTMLSelectElement {\r\n\t\tfor (let index: number = 0; index < items.length; index++) {\r\n\t\t\tmenu.appendChild(option({value: index}, items[index]));\r\n\t\t}\r\n\t\treturn menu;\r\n\t}\r\n\t\r\n\tfunction buildOptionsWithSpecificValues(menu: HTMLSelectElement, items: ReadonlyArray<string | number>, values: ReadonlyArray<string | number>): HTMLSelectElement {\r\n\t\tif (items.length != values.length) {\r\n\t\t\tthrow new Error(\"items and values don't have the same length\");\r\n\t\t}\r\n\t\tfor (let i: number = 0; i < items.length; i++) {\r\n\t\t\tconst item: string | number = items[i];\r\n\t\t\tconst value: string | number = values[i];\r\n\t\t\tmenu.appendChild(option({value:value}, item));\r\n\t\t}\r\n\t\treturn menu;\r\n\t}\r\n\t\r\n\tfunction setSelectedIndex(menu: HTMLSelectElement, index: number): void {\r\n\t\tif (menu.selectedIndex != index) menu.selectedIndex = index;\r\n\t}\r\n\r\n\tfunction setSelectedValue(menu: HTMLInputElement, index: string): void {\r\n\t\tif (menu.value != index) menu.value = index;\r\n\t}\r\n\t\r\n\tinterface PatternCopy {\r\n\t\tnotes: Note[];\r\n\t\tbeatsPerBar: number;\r\n\t\tpartsPerBeat: number;\r\n\t\tdrums: boolean;\r\n\t}\r\n\t\r\n\tclass Slider {\r\n\t\tprivate _change: Change | null = null;\r\n\t\tprivate _value: number = 0;\r\n\t\tprivate _oldValue: number = 0;\r\n\t\t\r\n\t\tconstructor(public readonly input: HTMLInputElement, private readonly _doc: SongDocument, private readonly _getChange: (oldValue: number, newValue: number)=>Change) {\r\n\t\t\tinput.addEventListener(\"input\", this._whenInput);\r\n\t\t\tinput.addEventListener(\"change\", this._whenChange);\r\n\t\t}\r\n\t\t\r\n\t\tpublic updateValue(value: number): void {\r\n\t\t\tthis._value = value;\r\n\t\t\tthis.input.value = String(value);\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenInput = (): void => {\r\n\t\t\tconst continuingProspectiveChange: boolean = this._doc.lastChangeWas(this._change);\r\n\t\t\tif (!continuingProspectiveChange) this._oldValue = this._value;\r\n\t\t\tthis._change = this._getChange(this._oldValue, parseInt(this.input.value));\r\n\t\t\tthis._doc.setProspectiveChange(this._change);\r\n\t\t};\r\n\t\t\r\n\t\tprivate _whenChange = (): void => {\r\n\t\t\tthis._doc.record(this._change!);\r\n\t\t\tthis._change = null;\r\n\t\t};\r\n\t}\r\n\t\r\n\texport class SongEditor {\r\n\t\tpublic prompt: Prompt | null = null;\r\n\t\t\r\n\t\tpublic readonly _patternEditor: PatternEditor = new PatternEditor(this._doc);\r\n\t\tprivate readonly _trackEditor: TrackEditor = new TrackEditor(this._doc);\r\n\t\tprivate readonly _loopEditor: LoopEditor = new LoopEditor(this._doc);\r\n\t\tprivate readonly _trackContainer: HTMLDivElement = div({class: \"trackContainer\"}, \r\n\t\t\tthis._trackEditor.container,\r\n\t\t\tthis._loopEditor.container,\r\n\t\t);\r\n\t\tprivate readonly _trackVisibleArea: HTMLDivElement = div({style: \"position: absolute; width: 100%; height: 100%; pointer-events: none;\"});\r\n\t\tprivate readonly _barScrollBar: BarScrollBar = new BarScrollBar(this._doc, this._trackContainer);\r\n\t\tprivate readonly _piano: Piano = new Piano(this._doc);\r\n\t\tprivate readonly _octaveScrollBar: OctaveScrollBar = new OctaveScrollBar(this._doc, this._piano);\r\n\t\tprivate readonly _editorBox: HTMLDivElement = div({class: \"editorBox\", style: \"height: 481px; display: flex; flex-direction: row; margin-bottom: 6px;\"}, \r\n\t\t\t\tthis._piano.container,\r\n\t\t\t\tthis._patternEditor.container,\r\n\t\t\t\tthis._octaveScrollBar.container,\r\n\t\t);\r\n\t\t//private readonly _trackVisibleArea: HTMLDivElement = div({style: \"position: absolute; width: 100%; height: 100%; pointer-events: none;\"});\r\n\t\tprivate readonly _trackAndMuteContainer: HTMLDivElement = div({class: \"trackAndMuteContainer prefers-big-scrollbars\"},\r\n\t\t\tthis._trackContainer,\r\n\t\t\tthis._trackVisibleArea,\r\n\t\t);\r\n\t\tprivate readonly _trackEditorBox: HTMLDivElement = div({class:\"track-area\"}, \r\n\t\t\tthis._trackAndMuteContainer,\r\n\t\t\tthis._barScrollBar.container,\r\n\t\t);\r\n\t\tprivate readonly _playButton: HTMLButtonElement = button({style: \"width:0; flex:2;\", type: \"button\"});\r\n\t\tprivate readonly _prevBarButton: HTMLButtonElement = button({class: \"prevBarButton\", style: \"width: 0; margin: 0px; flex:1; margin-left: 0px;\", type: \"button\", title: \"Prev Bar (left bracket)\"});\r\n\t\tprivate readonly _nextBarButton: HTMLButtonElement = button({class: \"nextBarButton\", style: \"width: 0; margin: 0px; flex:1; margin-left: 0px;\", type: \"button\", title: \"Next Bar (right bracket)\"});\r\n\t\tprivate readonly _volumeSlider: HTMLInputElement = input({title: \"main volume\", style: \"flex:1; margin: 0px;\", type: \"range\", min: \"0\", max: \"100\", value: \"50\", step: \"1\"});\r\n\t\tprivate readonly _fileMenu: HTMLSelectElement = select({style: \"width: 100%;\"}, \r\n\t\t\toption({selected: true, disabled: true, hidden: false}, \"File Menu\"),\r\n\t\t\toption({value: \"cleanS\"}, \"New Song\"),\r\n\t\t\toption({value: \"import\"}, \"Import JSON...\"),\r\n\t\t\toption({value: \"export\"}, \"Export Song...\"),\r\n\t\t\toption({value: \"shortenUrl\"}, \"Shorten Song Url...\"),\r\n\t\t\toption({value: \"songdata\"}, \"Song Data...\"),\r\n\t\t\toption({value: \"manual\"}, \"Open Manual...\"),\r\n\t\t);\r\n\t\tprivate readonly _editMenu: HTMLSelectElement = select({style: \"width: 100%;\"}, \r\n\t\t\toption({selected: true, disabled: true, hidden: false}, \"Edit Menu\"),\r\n\t\t\toption({value: \"undo\"}, \"Undo (Z)\"),\r\n\t\t\toption({value: \"redo\"}, \"Redo (Y)\"),\r\n\t\t\toption({value: \"copy\"}, \"Copy Pattern (C)\"),\r\n\t\t\toption({value: \"cut\"}, \"Cut Pattern (X)\"),\r\n\t\t\toption({value: \"paste\"}, \"Paste Pattern (V)\"),\r\n\t\t\toption({value: \"transposeUp\"}, \"Shift Notes Up (+)\"),\r\n\t\t\toption({value: \"transposeDown\"}, \"Shift Notes Down (-)\"),\r\n\t\t\toption({value: \"duration\"}, \"Custom Song Size (Q)\"),\r\n\t\t\toption({value: \"songTheme\"}, \"Set Song Theme...\"),\r\n\t\t);\r\n\t\tprivate readonly _optionsMenu: HTMLSelectElement = select({style: \"width: 100%;\"}, \r\n\t\t\toption({selected: true, disabled: true, hidden: false}, \"Preferences Menu\"),\r\n\t\t\toption({value: \"autoPlay\"}, \"Auto Play On Load\"),\r\n\t\t\toption({value: \"autoFollow\"}, \"Auto Follow Track\"),\r\n\t\t\toption({value: \"showLetters\"}, \"Show Piano\"),\r\n\t\t\toption({value: \"showFifth\"}, \"Highlight 'Fifth' Notes\"),\r\n\t\t\toption({value: \"showMore\"}, \"Advanced Color Scheme\"),\r\n\t\t\toption({value: \"showChannels\"},\"Show All Channels\"),\r\n\t\t\toption({value: \"showScrollBar\"}, \"Octave Scroll Bar\"),\r\n\t\t\toption({value: \"showVolumeBar\"}, \"Show Channel Volume\"),\r\n\t\t\toption({value: \"advancedSettings\"}, \"Enable Advanced Settings\"),\r\n\t\t\toption({value: \"themes\"}, \"Set Theme...\"),\r\n\t\t\toption({value: \"layouts\"}, \"Set Layout...\"),\r\n\t\t);\r\n\t\tprivate readonly _newSongButton: HTMLButtonElement = button({type: \"button\"}, \r\n\t\t\tdiv({},\"New\"),\r\n\t\t\tspan({class: \"fullWidthOnly\"}, div({},\" Song\")),\r\n\t\t\t// Page icon:\r\n\t\t\tSVG.svg( {style: \"flex-shrink: 0; position: absolute; left: 0; top: 50%; margin-top: -1em; pointer-events: none;\", width: \"2em\", height: \"2em\", viewBox: \"-5 -21 26 26\"}, \r\n\t\t\t\tSVG.path({d: \"M 2 0 L 2 -16 L 10 -16 L 14 -12 L 14 0 z M 3 -1 L 13 -1 L 13 -11 L 9 -11 L 9 -15 L 3 -15 z\", fill: \"currentColor\"}),\r\n\t\t\t),\r\n\t\t);\r\n\t\tprivate readonly _songDataButton: HTMLButtonElement = button({type: \"button\"}, \r\n\t\t\tdiv({},\"Song Data\"),\r\n\t\t\tSVG.svg( {style: \"flex-shrink: 0; position: absolute; left: 0; top: 50%; margin-top: -1em; pointer-events: none;\", width: \"2em\", height: \"2em\", viewBox: \"-5 -21 26 26\"}, \r\n\t\t\t\tSVG.path({d: \"M 0 0 L 16 0 L 16 -13 L 10 -13 L 8 -16 L 0 -16 L 0 -13 z\", fill: \"currentColor\"}),\r\n\t\t\t),\r\n\t\t);\r\n\t\tprivate readonly _customizeButton: HTMLButtonElement = button({type: \"button\"}, \r\n\t\t\tspan({ class: \"center\" }, div({},\"Custom Song Size\")),\r\n\t\t\tSVG.svg( {style: \"flex-shrink: 0; position: absolute; left: 0; top: 50%; margin-top: -1em; pointer-events: none;\", width: \"2em\", height: \"2em\", viewBox: \"-13 -13 26 26\"}, \r\n\t\t\t\tSVG.path({d: \"M -8 2 L -2 2 L -2 8 L 2 8 L 2 2 L 8 2 L 8 -2 L 2 -2 L 2 -8 L -2 -8 L -2 -2 L -8 -2 z M 0 2 L -4 -2 L -1 -2 L -1 -8 L 1 -8 L 1 -2 L 4 -2 z M -8 -8 L 8 -8 L 8 -9 L -8 -9 L -8 -8 z\", fill: \"currentColor\"}),\r\n\t\t\t),\r\n\t\t);\r\n\t\tprivate readonly _archiveButton: HTMLButtonElement = button({type: \"button\"}, \r\n\t\t\tspan({ class: \"center\" }, div({},\"Load Mods...\")),\r\n\t\t\tSVG.svg( {style: \"flex-shrink: 0; position: absolute; left: 0; top: 50%; margin-top: -1em; pointer-events: none;\", width: \"2em\", height: \"2em\", viewBox: \"-13 -13 26 26\"}, \r\n\t\t\t\tSVG.path({d: \"M 5.78 -1.6 L 7.93 -0.94 L 7.93 0.94 L 5.78 1.6 L 4.85 3.53 L 5.68 5.61 L 4.21 6.78 L 2.36 5.52 L 0.27 5.99 L -0.85 7.94 L -2.68 7.52 L -2.84 5.28 L -4.52 3.95 L -6.73 4.28 L -7.55 2.59 L -5.9 1.07 L -5.9 -1.07 L -7.55 -2.59 L -6.73 -4.28 L -4.52 -3.95 L -2.84 -5.28 L -2.68 -7.52 L -0.85 -7.94 L 0.27 -5.99 L 2.36 -5.52 L 4.21 -6.78 L 5.68 -5.61 L 4.85 -3.53 M 2.92 0.67 L 2.92 -0.67 L 2.35 -1.87 L 1.3 -2.7 L 0 -3 L -1.3 -2.7 L -2.35 -1.87 L -2.92 -0.67 L -2.92 0.67 L -2.35 1.87 L -1.3 2.7 L -0 3 L 1.3 2.7 L 2.35 1.87 z\", fill: \"currentColor\"}),\r\n\t\t\t),\r\n\t\t);\r\n\t\tprivate readonly _undoButton: HTMLButtonElement = button({type: \"button\", style: \"width: 45%; margin: 0px; margin-top: -2px;\"}, div({},\"Undo\"));\r\n\t\tprivate readonly _redoButton: HTMLButtonElement = button({type: \"button\", style: \"width: 45%; margin: 0px; margin-top: -2px;\"}, div({},\"Redo\"));\r\n\t\tprivate readonly _exportButton: HTMLButtonElement = button({type: \"button\"}, \r\n\t\t\tdiv({},\"Export\"),\r\n\t\t\t// Download icon:\r\n\t\t\tSVG.svg( {style: \"flex-shrink: 0; position: absolute; left: 0; top: 50%; margin-top: -1em; pointer-events: none;\", width: \"2em\", height: \"2em\", viewBox: \"-13 -13 26 26\"}, \r\n\t\t\t\tSVG.path({d: \"M -8 3 L -8 8 L 8 8 L 8 3 L 6 3 L 6 6 L -6 6 L -6 3 z M 0 2 L -4 -2 L -1 -2 L -1 -8 L 1 -8 L 1 -2 L 4 -2 z\", fill: \"currentColor\"}),\r\n\t\t\t),\r\n\t\t);\r\n\t\tprivate readonly _scaleSelect: HTMLSelectElement = buildOptions(select({}), Config.scales.map(scale=>scale.name));\r\n\t\tprivate readonly _mixSelect: HTMLSelectElement = buildOptions(select({}), Config.mixNames);\r\n\t\tprivate readonly _sampleRateSelect: HTMLSelectElement = buildOptions(select({}), Config.sampleRateNames);\r\n\t\tprivate readonly _mixHint: HTMLAnchorElement = <HTMLAnchorElement> a({ class: \"hintButton\" }, div({},\"?\"));\r\n\t\tprivate readonly _archiveHint: HTMLAnchorElement = <HTMLAnchorElement> a({ class: \"hintButton\" }, div({},\"?\"));\r\n\t\tprivate readonly _mixSelectRow: HTMLDivElement = div({class: \"selectRow\"}, this._mixSelect);\r\n\t\t// private readonly _chipHint: HTMLAnchorElement = <HTMLAnchorElement> a( { class: \"hintButton\" }, div({},\"?\"));\r\n\t\tprivate readonly _instrumentTypeHint: HTMLAnchorElement = <HTMLAnchorElement> a( { class: \"hintButton\" }, div({},\"?\"));\r\n\t\tprivate readonly _keySelect: HTMLSelectElement = buildOptions(select({}), Config.keys.map(key=>key.name).reverse());\r\n\t\tprivate readonly _tempoStepper: HTMLInputElement = input({class: \"numberInput\", style:\"margin-left:0.5em\", type:\"number\", min:Config.tempoMin, max: Config.tempoMax});\r\n\t\tprivate readonly _tempoSlider: Slider = new Slider(input({style: \"margin: 0px;\", type: \"range\", min: Config.tempoMin, max: Config.tempoMax, value: \"160\", step: \"1\"}), this._doc, (oldValue: number, newValue: number) => new ChangeTempo(this._doc, oldValue, newValue));\r\n\t\tprivate readonly _reverbSlider: Slider = new Slider(input({style: \"margin: 0px;\", type: \"range\", min: \"0\", max: Config.reverbRange - 1, value: \"0\", step: \"1\"}), this._doc, (oldValue: number, newValue: number) => new ChangeReverb(this._doc, oldValue, newValue));\r\n\t\tprivate readonly _blendSlider: Slider = new Slider(input({style: \"margin: 0px;\", type: \"range\", min: \"0\", max: Config.blendRange - 1, value: \"0\", step: \"1\"}), this._doc, (oldValue: number, newValue: number) => new ChangeBlend(this._doc, oldValue, newValue));\r\n\t\tprivate readonly _riffSlider: Slider = new Slider(input({style: \"margin: 0px;\", type: \"range\", min: \"0\", max: Config.riffRange - 1, value: \"0\", step: \"1\"}), this._doc, (oldValue: number, newValue: number) => new ChangeRiff(this._doc, oldValue, newValue));\r\n\t\tprivate readonly _detuneSlider: Slider = new Slider(input({style: \"margin: 0px;\", type: \"range\", min: \"0\", max: Config.detuneRange - 1, value: \"0\", step: \"1\"}), this._doc, (oldValue: number, newValue: number) => new ChangeDetune(this._doc, oldValue, newValue));\r\n\t\tprivate readonly _muffSlider: Slider = new Slider(input({style: \"margin: 0px;\", type: \"range\", min: \"0\", max: Config.muffRange - 1, value: \"0\", step: \"1\"}), this._doc, (oldValue: number, newValue: number) => new ChangeMuff(this._doc, oldValue, newValue));\r\n\t\tprivate readonly _imuteButton: HTMLButtonElement = button({ style: \"width: 27px; margin-left: 0.5em;\", type: \"button\" });\r\n\t\tprivate readonly _iMmuteButton: HTMLButtonElement = button({ style: \"width: 27px; margin-left: 0.5em;\", type: \"button\" });\r\n\t\tprivate readonly _partSelect: HTMLSelectElement = buildOptions(select({}), Config.partNames);\r\n\t\tprivate readonly _instrumentTypeSelect: HTMLSelectElement = buildOptionsWithSpecificValues(select({}), Config.pitchChannelTypeNames, Config.pitchChannelTypeValues);\r\n\t\tprivate readonly _instrumentTypeSelectRow: HTMLDivElement = div({class: \"selectRow\"}, span({}, div({style:\"display:flex;\"},\"Type: \", this._instrumentTypeHint)), div({class: \"selectContainer\"}, this._instrumentTypeSelect));\r\n\t\tprivate readonly _algorithmSelect: HTMLSelectElement = buildOptions(select({}), Config.operatorAlgorithmNames);\r\n\t\tprivate readonly _algorithmSelectRow: HTMLDivElement = div({class: \"selectRow\"}, span({}, div({},\"Algorithm: \")), div({class: \"selectContainer\"}, this._algorithmSelect));\r\n\t\tprivate readonly _instrumentSelect: HTMLSelectElement = select({});\r\n\t\tprivate readonly _instrumentInput: HTMLInputElement = input({class: \"numberInput\", type:\"number\", min:1});\r\n\t\tprivate readonly _instrumentSelectRow: HTMLDivElement = div({class: \"selectRow\", style: \"display: none;\"}, span({}, div({},\"Instrument: \")), \r\n\t\tdiv({class: \"inputContainer\"}, \r\n\t\t\tthis._instrumentInput\r\n\t\t));\r\n\t\tprivate readonly _instrumentVolumeSlider: Slider = new Slider(input({ type: \"range\", min: \"-9\", max: \"0\", value: \"0\", step: \"1\"}), this._doc, (oldValue: number, newValue: number) => new ChangeVolume(this._doc, oldValue, -newValue));\r\n\t\tprivate readonly _instrumentMVolumeSlider: Slider = new Slider(input({ type: \"range\", min: \"-5\", max: \"0\", value: \"0\", step: \"1\"}), this._doc, (oldValue: number, newValue: number) => new ChangeVolume(this._doc, oldValue, -newValue));\r\n\t\tprivate readonly _instrumentVolumeSliderRow: HTMLDivElement = div({class: \"selectRow\"}, span({}, div({},\"Volume: \")), \r\n\t\tdiv({ style:\"display: flex; flex-direction: row;\" },this._instrumentVolumeSlider.input, this._imuteButton));\r\n\t\tprivate readonly _instrumentMVolumeSliderRow: HTMLDivElement = div({class: \"selectRow\"}, span({}, div({},\"Volume: \")), \r\n\t\tdiv({ style:\"display: flex; flex-direction: row;\" },this._instrumentMVolumeSlider.input, this._iMmuteButton));\r\n\t\tprivate readonly _SettingsLabel: HTMLDivElement = div({ style: \"margin: 3px 0; text-align: center; color: rgb(170, 170, 170);\" }, div({},\"Settings\"));\r\n\t\tprivate readonly _advancedInstrumentSettingsLabel: HTMLDivElement = div({ style: \"margin: 3px 0; text-align: center;\" }, div({},\"Advanced Instrument Settings\"));\r\n\t\tprivate readonly _waveSelect: HTMLSelectElement = buildOptions(select({}), Config.waveNames);\r\n\t\tprivate readonly _drumSelect: HTMLSelectElement = buildOptions(select({}), Config.drumNames);\r\n\t\tprivate readonly _pwmwaveSelect: HTMLSelectElement = buildOptions(select({}), Config.pwmwaveNames);\r\n\t\tprivate readonly _waveSelectRow: HTMLDivElement = div({class: \"selectRow\"}, span({}, div({},\"Wave: \")), div({class: \"selectContainer\"}, this._waveSelect, this._pwmwaveSelect, this._drumSelect));\r\n\t\tprivate readonly _transitionSelect: HTMLSelectElement = buildOptions(select({}), Config.transitionNames);\r\n\t\tprivate readonly _filterSelect: HTMLSelectElement = buildOptions(select({}), Config.filterNames);\r\n\t\tprivate readonly _filterSelectRow: HTMLDivElement = div({class: \"selectRow\"}, span({}, div({},\"Filter: \")), div({class: \"selectContainer\"}, this._filterSelect));\r\n\t\tprivate readonly _chorusSelect: HTMLSelectElement = buildOptions(select({}), Config.chorusNames);\r\n\t\tprivate readonly _chorusHint = <HTMLAnchorElement> a( {class: \"hintButton\"}, div({},\"?\"));\r\n\t\tprivate readonly _chorusSelectRow: HTMLElement = div({class: \"selectRow\"}, span({}, div({},\"Chorus: \")), div({class: \"selectContainer\"}, this._chorusSelect));\r\n\t\tprivate readonly _effectSelect: HTMLSelectElement = buildOptions(select({}), Config.effectNames);\r\n\t\tprivate readonly _effectSelectRow: HTMLDivElement = div({class: \"selectRow\"}, span({}, div({},\"Effect: \")), div({class: \"selectContainer\"}, this._effectSelect));\r\n\t\tprivate readonly _harmSelect: HTMLSelectElement = buildOptions(select({}), Config.harmDisplay);\r\n\t\tprivate readonly _harmSelectRow: HTMLDivElement = div({class: \"selectRow\"}, span({}, div({style:\"display:flex;\"},\"Chord: \", this._chorusHint)), div({class: \"selectContainer\"}, this._harmSelect));\r\n\t\tprivate readonly _octoffSelect: HTMLSelectElement = buildOptions(select({}), Config.octoffNames);\r\n\t\tprivate readonly _octoffSelectRow: HTMLDivElement = div({class: \"selectRow\"}, span({}, div({},\"Octave Offset: \")), div({class: \"selectContainer\"}, this._octoffSelect));\r\n\t\tprivate readonly _fmChorusSelect: HTMLSelectElement = buildOptions(select({}), Config.fmChorusDisplay);\r\n\t\tprivate readonly _fmChorusSelectRow: HTMLDivElement = div({class: \"selectRow\"}, span({}, div({},\"FM Chorus: \")), div({class: \"selectContainer\"}, this._fmChorusSelect));\r\n\t\tprivate readonly _ipanSlider: Slider = new Slider(input({ type: \"range\", min: \"-8\", max: \"0\", value: \"0\", step: \"1\"}), this._doc, (oldValue: number, newValue: number) => new ChangeIpan(this._doc, oldValue, -newValue));\r\n\t\tprivate readonly _ipanSliderRow: HTMLDivElement = div({class: \"selectRow\"}, span({}, div({},\"Panning: \")),\r\n\t\tdiv({style:\"display:flex;\"},\r\n\t\t\tspan({style:\"margin-right: 0.5em; align-content: center;\"}, div({},\"L\")), \r\n\t\t\tthis._ipanSlider.input, \r\n\t\t\tspan({style:\"margin-left: 0.5em; align-content: center;\"}, div({},\"R\"))\r\n\t\t));\r\n\t\tprivate readonly _phaseModGroup: HTMLElement = div({style: \"display: flex; flex-direction: column; display: none;\"}, );\r\n\t\tprivate readonly _feedbackTypeSelect: HTMLSelectElement = buildOptions(select({}), Config.operatorFeedbackNames);\r\n\t\tprivate readonly _feedbackRow1: HTMLDivElement = div({class: \"selectRow\"}, span({}, div({},\"Feedback:\")), div({class: \"selectContainer\"}, this._feedbackTypeSelect));\r\n\t\t\r\n\t\tprivate readonly _feedbackAmplitudeSlider: Slider = new Slider(input({style: \"margin: 0px; flex: 1; width: 4em;\", type: \"range\", min: \"0\", max: Config.operatorAmplitudeMax, value: \"0\", step: \"1\", title: \"Feedback Amplitude\"}), this._doc, (oldValue: number, newValue: number) => new ChangeFeedbackAmplitude(this._doc, oldValue, newValue));\r\n\t\tprivate readonly _feedbackEnvelopeSelect: HTMLSelectElement = buildOptions(select({style: \"width: 100%;\", title: \"Feedback Envelope\"}), Config.operatorEnvelopeNames);\r\n\t\tprivate readonly _feedbackRow2: HTMLDivElement = div({class: \"operatorRow\"}, \r\n\t\t\tthis._feedbackAmplitudeSlider.input,\r\n\t\t\tdiv({class: \"selectContainer\", style: \"width:0; margin-left: .3em;\"}, this._feedbackEnvelopeSelect),\r\n\t\t);\r\n\r\n\t\tprivate readonly _songSettingsButton: HTMLButtonElement = button({style:\"flex: 1; border-bottom: solid 2px var(--link-accent);\"}, \"Song\");\r\n\t\tprivate readonly _instSettingsButton: HTMLButtonElement = button({style:\"flex: 1;\"}, \"Instrument\");\r\n\t\tprivate readonly _settingsTabs: HTMLDivElement = div({style:\"display: flex; gap: 3px;\"},\r\n\t\t\t\tthis._songSettingsButton,\r\n\t\t\t\tthis._instSettingsButton\r\n\t\t);\r\n\r\n\t\tprivate readonly _instrumentSettingsGroup: HTMLDivElement = div({style:\"display:none;\"}, \r\n\t\t\tthis._instrumentSelectRow,\r\n\t\t\tthis._instrumentTypeSelectRow,\r\n\t\t\tthis._instrumentMVolumeSliderRow,\r\n\t\t\tthis._instrumentVolumeSliderRow,\r\n\t\t\tthis._waveSelectRow,\r\n\t\t\tdiv({class: \"selectRow\"}, \r\n\t\t\t\tspan({}, div({},\"Transitions: \")),\r\n\t\t\t\tdiv({class: \"selectContainer\"}, this._transitionSelect),\r\n\t\t\t),\r\n\t\t\tthis._filterSelectRow,\r\n\t\t\tthis._chorusSelectRow,\r\n\t\t\tthis._effectSelectRow,\r\n\t\t\tthis._algorithmSelectRow,\r\n\t\t\tthis._phaseModGroup,\r\n\t\t\tthis._feedbackRow1,\r\n\t\t\tthis._feedbackRow2,\r\n\t\t);\r\n\t\tprivate readonly _songSettingsGroup: HTMLDivElement = div({ class: \"editor-song-settings\" }, \r\n\t\t\tdiv({ class: \"selectRow\" }, span({}, div({},\"Scale: \")), div({ class: \"selectContainer\", style: \"margin: 3px 0; text-align: center; color: #ccc;\" }, this._scaleSelect)),\r\n\t\t\tdiv({ class: \"selectRow\" }, span({}, div({},\"Key: \")), div({ class: \"selectContainer\", style: \"margin: 3px 0; text-align: center; color: #ccc;\" }, this._keySelect)),\r\n\t\t\tdiv({ class: \"selectRow\" }, span({}, div({},\"Tempo: \")), \r\n\t\t\tdiv({ style: \"display: flex; flex-direction: row;\" }, this._tempoSlider.input, this._tempoStepper)),\r\n\t\t\tdiv({ class: \"selectRow\" }, span({}, div({},\"Reverb: \")), this._reverbSlider.input),\r\n\t\t\tdiv({ class: \"selectRow\" }, span({}, div({},\"Rhythm: \")), div({ class: \"selectContainer\", style: \"margin: 3px 0; text-align: center; color: #ccc;\" }, this._partSelect)),\r\n\t\t);\r\n\t\tprivate readonly _advancedInstrumentSettingsGroup: HTMLDivElement = div({}, \r\n\t\t\tthis._advancedInstrumentSettingsLabel,\r\n\t\t\tthis._ipanSliderRow,\r\n\t\t\tthis._harmSelectRow,\r\n\t\t\tthis._octoffSelectRow,\r\n\t\t\tthis._fmChorusSelectRow,\r\n\t\t);\r\n\t\tprivate readonly _promptContainer: HTMLDivElement = div({class: \"promptContainer\", id: \"promptContainer\", style: \"display: none;\"});\r\n\t\tprivate readonly _advancedSongSettings: HTMLDivElement = div({ class: \"editor-song-settings\", style: \"margin: 0px 5px;\" }, \r\n\t\t\tdiv({ style: \"margin: 3px 0; text-align: center;\" }, div({},\"Advanced Song Settings\")),\r\n\t\t\tdiv({ class: \"selectRow\" }, span({}, div({style:\"display: flex;\"},\"Mix: \", this._mixHint)), div({ class: \"selectContainer\" }, this._mixSelectRow)),\r\n\t\t\tdiv({ class: \"selectRow\" }, span({}, div({},\"Sample Rate: \")), div({ class: \"selectContainer\" }, this._sampleRateSelect)),\r\n\t\t\tdiv({ class: \"selectRow\" }, span({}, div({},\"Blending: \")), this._blendSlider.input),\r\n\t\t\tdiv({ class: \"selectRow\" }, span({}, div({},\"Riff: \")), this._riffSlider.input),\r\n\t\t\tdiv({ class: \"selectRow\" }, span({}, div({},\"Detune: \")), this._detuneSlider.input),\r\n\t\t\tdiv({ class: \"selectRow\" }, span({}, div({},\"Muff: \")), this._muffSlider.input),\r\n\t\t);\r\n\t\tprivate readonly _advancedSettingsContainer: HTMLDivElement = div({ class: \"advanced-settings-area\", style: \"margin: 0px 5px;\" }, \r\n\t\t\tdiv({ class: \"editor-widgets\" }, \r\n\t\t\t\tdiv({ style: \"text-align: center;\" }, div({},\"Advanced Settings\")),\r\n\t\t\t\tdiv({ style: \"margin: 2px 0; display: flex; flex-direction: row; align-items: center;\" }, ),\r\n\t\t\t\tdiv({ class: \"editor-menus\" }, \r\n\t\t\t\t\tdiv({ style: \"margin: 5px 0; display: flex; flex-direction: row; justify-content: space-between;\" }, \r\n\t\t\t\t\t\tthis._prevBarButton,\r\n\t\t\t\t\t\tthis._undoButton,\r\n\t\t\t\t\t\tthis._redoButton,\r\n\t\t\t\t\t\tthis._nextBarButton,\r\n\t\t\t\t\t),\r\n\t\t\t\t),\r\n\t\t\t\tdiv({ class: \"editor-settings\" }, \r\n\t\t\t\t\tthis._advancedSongSettings,\r\n\t\t\t\t\tdiv({ class: \"editor-instrument-settings\" }, \r\n\t\t\t\t\t\tthis._advancedInstrumentSettingsGroup,\r\n\t\t\t\t\t),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t);\r\n\t\tpublic readonly mainLayer: HTMLDivElement = div({class: \"beepboxEditor\", tabIndex: \"0\"}, \r\n\t\t\tthis._editorBox,\r\n\t\t\tthis._trackEditorBox,\r\n\t\t\tdiv({class: \"settings-area\"}, \r\n\t\t\t\tdiv({ class:\"title\", style: \"align-items: center; display: flex; justify-content: center;\" }, div({},\"Neo NepBox\")),\r\n\t\t\t\tdiv({ class:\"controller\", style: \"margin: 5px 0; gap: 3px; display: flex; flex-direction: column; align-items: center;\" }, \r\n\t\t\t\t\tdiv({ style: \"display:flex; flex-direction:row;\" },\r\n\t\t\t\t\t\tSVG.svg( { width: \"2em\", height: \"2em\", viewBox: \"0 0 26 26\" }, \r\n\t\t\t\t\t\t\tSVG.path({ d: \"M 4 17 L 4 9 L 8 9 L 12 5 L 12 21 L 8 17 z\", fill: ColorConfig.volumeIcon}),\r\n\t\t\t\t\t\t\tSVG.path({ d: \"M 15 11 L 16 10 A 7.2 7.2 0 0 1 16 16 L 15 15 A 5.8 5.8 0 0 0 15 12 z\", fill: ColorConfig.volumeIcon }),\r\n\t\t\t\t\t\t\tSVG.path({ d: \"M 18 8 L 19 7 A 11.5 11.5 0 0 1 19 19 L 18 18 A 10.1 10.1 0 0 0 18 8 z\", fill: ColorConfig.volumeIcon }),\r\n\t\t\t\t\t\t),\r\n\t\t\t\t\t\tthis._volumeSlider,\r\n\t\t\t\t\t),\r\n\t\t\t\t\tdiv({ style: \"display: flex; flex-direction: row; align-items: center; width:100%; gap: 3px;\" }, \r\n\t\t\t\t\t\tthis._playButton,\r\n\t\t\t\t\t\tthis._prevBarButton,\r\n\t\t\t\t\t\tthis._nextBarButton,\r\n\t\t\t\t\t),\r\n\t\t\t\t),\r\n\t\t\t\tdiv({ class: \"editor-widgets\" }, \r\n\t\t\t\t\tdiv({ class: \"editor-menus\" }, \r\n\t\t\t\t\t\tdiv({class: \"selectContainer menu\"}, \r\n\t\t\t\t\t\t\tthis._fileMenu,\r\n\t\t\t\t\t\t\t// File icon:\r\n\t\t\t\t\t\t\tSVG.svg( {style: \"flex-shrink: 0; position: absolute; left: 0; top: 50%; margin-top: -1em; pointer-events: none;\", width: \"2em\", height: \"2em\", viewBox: \"-5 -21 26 26\"}, \r\n\t\t\t\t\t\t\t\tSVG.path({d: \"M 0 0 L 16 0 L 16 -13 L 10 -13 L 8 -16 L 0 -16 L 0 -13 z\", fill: \"currentColor\"}),\r\n\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t),\r\n\t\t\t\t\t\tdiv({class: \"selectContainer menu\"}, \r\n\t\t\t\t\t\t\tthis._editMenu,\r\n\t\t\t\t\t\t\t// Edit icon:\r\n\t\t\t\t\t\t\tSVG.svg( {style: \"flex-shrink: 0; position: absolute; left: 0; top: 50%; margin-top: -1em; pointer-events: none;\", width: \"2em\", height: \"2em\", viewBox: \"-5 -21 26 26\"}, \r\n\t\t\t\t\t\t\t\tSVG.path({d: \"M 0 0 L 1 -4 L 4 -1 z M 2 -5 L 10 -13 L 13 -10 L 5 -2 zM 11 -14 L 13 -16 L 14 -16 L 16 -14 L 16 -13 L 14 -11 z\", fill: \"currentColor\"}),\r\n\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t),\r\n\t\t\t\t\t\tdiv({class: \"selectContainer menu\"}, \r\n\t\t\t\t\t\t\tthis._optionsMenu,\r\n\t\t\t\t\t\t\t// Gear icon:\r\n\t\t\t\t\t\t\tSVG.svg( {style: \"flex-shrink: 0; position: absolute; left: 0; top: 50%; margin-top: -1em; pointer-events: none;\", width: \"2em\", height: \"2em\", viewBox: \"-13 -13 26 26\"}, \r\n\t\t\t\t\t\t\t\tSVG.path({d: \"M 5.78 -1.6 L 7.93 -0.94 L 7.93 0.94 L 5.78 1.6 L 4.85 3.53 L 5.68 5.61 L 4.21 6.78 L 2.36 5.52 L 0.27 5.99 L -0.85 7.94 L -2.68 7.52 L -2.84 5.28 L -4.52 3.95 L -6.73 4.28 L -7.55 2.59 L -5.9 1.07 L -5.9 -1.07 L -7.55 -2.59 L -6.73 -4.28 L -4.52 -3.95 L -2.84 -5.28 L -2.68 -7.52 L -0.85 -7.94 L 0.27 -5.99 L 2.36 -5.52 L 4.21 -6.78 L 5.68 -5.61 L 4.85 -3.53 M 2.92 0.67 L 2.92 -0.67 L 2.35 -1.87 L 1.3 -2.7 L 0 -3 L -1.3 -2.7 L -2.35 -1.87 L -2.92 -0.67 L -2.92 0.67 L -2.35 1.87 L -1.3 2.7 L -0 3 L 1.3 2.7 L 2.35 1.87 z\", fill: \"currentColor\"}),\r\n\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t),\r\n\t\t\t\t\t),\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tdiv({ class: \"song-settings-area editor-settings\" }, \r\n\t\t\t\tthis._SettingsLabel,\r\n\t\t\t\tthis._settingsTabs,\r\n\t\t\t\tthis._songSettingsGroup,\r\n\t\t\t\tdiv({class: \"editor-instrument-settings\"}, \r\n\t\t\t\t\tthis._instrumentSettingsGroup,\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t\tthis._advancedSettingsContainer,\r\n\t\t\tthis._promptContainer,\r\n\t\t);\r\n\t\t\r\n\t\tprivate _wasPlaying: boolean;\r\n\t\tprivate _changeTranspose: ChangeTranspose | null = null;\r\n\t\tprivate readonly _operatorRows: HTMLDivElement[] = []\r\n\t\tprivate readonly _operatorAmplitudeSliders: Slider[] = []\r\n\t\tprivate readonly _operatorEnvelopeSelects: HTMLSelectElement[] = []\r\n\t\tprivate readonly _operatorFrequencySelects: HTMLSelectElement[] = []\r\n\t\t\r\n\t\tconstructor(private _doc: SongDocument) {\r\n\t\t\tthis._doc.notifier.watch(this.whenUpdated);\r\n\t\t\t\r\n\t\t\tthis._phaseModGroup.appendChild(div({class: \"operatorRow\", style: \"height: 1em; margin-top: 0.5em;\"}, \r\n\t\t\t\tdiv({style: \"margin-right: .1em; visibility: hidden;\"}, div({},1 + \".\")),\r\n\t\t\t\tdiv({style: \"width: 3em; margin-right: .3em;\"}, div({},\"Freq:\")),\r\n\t\t\t\tdiv({style: \"width: 4em; margin: 0;\"}, div({},\"Volume:\")),\r\n\t\t\t\tdiv({style: \"width: 5em; margin-left: .3em;\"}, div({},\"Envelope:\")),\r\n\t\t\t));\r\n\t\t\tfor (let i = 0; i < Config.operatorCount; i++) {\r\n\t\t\t\tconst operatorIndex: number = i;\r\n\t\t\t\tconst operatorNumber: HTMLDivElement = div({style: \"margin-right: .1em; color: #999;\"}, div({},i + 1 + \".\"));\r\n\t\t\t\tconst frequencySelect: HTMLSelectElement = buildOptions(select({style: \"width: 100%;\", title: \"Frequency\"}), Config.operatorFrequencyNames);\r\n\t\t\t\tconst amplitudeSlider: Slider = new Slider(input({style: \"margin: 0; width: 4em;\", type: \"range\", min: \"0\", max: Config.operatorAmplitudeMax, value: \"0\", step: \"1\", title: \"Volume\"}), this._doc, (oldValue: number, newValue: number) => new ChangeOperatorAmplitude(this._doc, operatorIndex, oldValue, newValue));\r\n\t\t\t\tconst envelopeSelect: HTMLSelectElement = buildOptions(select({style: \"width: 100%;\", title: \"Envelope\"}), Config.operatorEnvelopeNames);\r\n\t\t\t\tconst row = div({class: \"operatorRow\"}, \r\n\t\t\t\t\toperatorNumber,\r\n\t\t\t\t\tdiv({class: \"selectContainer\", style: \"width: 3em; margin-right: .3em;\"}, frequencySelect),\r\n\t\t\t\t\tamplitudeSlider.input,\r\n\t\t\t\t\tdiv({class: \"selectContainer\", style: \"width: 5em; margin-left: .3em;\"}, envelopeSelect),\r\n\t\t\t\t);\r\n\t\t\t\tthis._phaseModGroup.appendChild(row);\r\n\t\t\t\tthis._operatorRows[i] = row;\r\n\t\t\t\tthis._operatorAmplitudeSliders[i] = amplitudeSlider;\r\n\t\t\t\tthis._operatorEnvelopeSelects[i] = envelopeSelect;\r\n\t\t\t\tthis._operatorFrequencySelects[i] = frequencySelect;\r\n\t\t\t\t\r\n\t\t\t\tenvelopeSelect.addEventListener(\"change\", () => {\r\n\t\t\t\t\tthis._doc.record(new ChangeOperatorEnvelope(this._doc, operatorIndex, envelopeSelect.selectedIndex));\r\n\t\t\t\t});\r\n\t\t\t\tfrequencySelect.addEventListener(\"change\", () => {\r\n\t\t\t\t\tthis._doc.record(new ChangeOperatorFrequency(this._doc, operatorIndex, frequencySelect.selectedIndex));\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._fileMenu.addEventListener(\"change\", this._fileMenuHandler);\r\n\t\t\tthis._editMenu.addEventListener(\"change\", this._editMenuHandler);\r\n\t\t\tthis._optionsMenu.addEventListener(\"change\", this._optionsMenuHandler);\r\n\t\t\tthis._scaleSelect.addEventListener(\"change\", this._whenSetScale);\r\n\t\t\tthis._mixSelect.addEventListener(\"change\", this._whenSetMix);\r\n\t\t\tthis._sampleRateSelect.addEventListener(\"change\", this._whenSetSampleRate);\r\n\t\t\tthis._keySelect.addEventListener(\"change\", this._whenSetKey);\r\n\t\t\tthis._partSelect.addEventListener(\"change\", this._whenSetPartsPerBeat);\r\n\t\t\tthis._instrumentTypeSelect.addEventListener(\"change\", this._whenSetInstrumentType);\r\n\t\t\tthis._algorithmSelect.addEventListener(\"change\", this._whenSetAlgorithm);\r\n\t\t\t//this._instrumentSelect.addEventListener(\"change\", this._whenSetInstrument);\r\n\t\t\tthis._instrumentInput.addEventListener(\"change\", this._whenSetInstrument);\r\n\t\t\tthis._feedbackTypeSelect.addEventListener(\"change\", this._whenSetFeedbackType);\r\n\t\t\tthis._feedbackEnvelopeSelect.addEventListener(\"change\", this._whenSetFeedbackEnvelope);\r\n\t\t\tthis._waveSelect.addEventListener(\"change\", this._whenSetWave);\r\n\t\t\tthis._drumSelect.addEventListener(\"change\", this._whenSetDrum);\r\n\t\t\tthis._pwmwaveSelect.addEventListener(\"change\", this._whenSetPWMWave);\r\n\t\t\tthis._transitionSelect.addEventListener(\"change\", this._whenSetTransition);\r\n\t\t\tthis._filterSelect.addEventListener(\"change\", this._whenSetFilter);\r\n\t\t\tthis._chorusSelect.addEventListener(\"change\", this._whenSetChorus);\r\n\t\t\tthis._effectSelect.addEventListener(\"change\", this._whenSetEffect);\r\n\t\t\tthis._harmSelect.addEventListener(\"change\", this._whenSetHarm);\r\n\t\t\tthis._octoffSelect.addEventListener(\"change\", this._whenSetOctoff);\r\n\t\t\tthis._fmChorusSelect.addEventListener(\"change\", this._whenSetFMChorus);\r\n\t\t\tthis._imuteButton.addEventListener(\"click\", this._muteInstrument);\r\n\t\t\tthis._iMmuteButton.addEventListener(\"click\", this._muteInstrument);\r\n\t\t\tthis._playButton.addEventListener(\"click\", this._togglePlay);\r\n\t\t\tthis._prevBarButton.addEventListener(\"click\", this._whenPrevBarPressed);\r\n\t\t\tthis._nextBarButton.addEventListener(\"click\", this._whenNextBarPressed);\r\n\t\t\tthis._newSongButton.addEventListener(\"click\", this._whenNewSongPressed);\r\n\t\t\tthis._songDataButton.addEventListener(\"click\", this._openSongDataPrompt);\r\n\t\t\tthis._customizeButton.addEventListener(\"click\", this._whenCustomizePressed);\r\n\t\t\tthis._undoButton.addEventListener(\"click\", this._advancedUndo);\r\n\t\t\tthis._redoButton.addEventListener(\"click\", this._advancedRedo);\r\n\t\t\tthis._exportButton.addEventListener(\"click\", this._openExportPrompt);\r\n\t\t\tthis._archiveButton.addEventListener(\"click\", this._openArchivePrompt);\r\n\t\t\tthis._volumeSlider.addEventListener(\"input\", this._setVolumeSlider);\r\n\t\t\t// this._chipHint.addEventListener(\"click\", this._openChipPrompt);\r\n\t\t\tthis._instrumentTypeHint.addEventListener(\"click\", this._openInstrumentTypePrompt);\r\n\t\t\tthis._mixHint.addEventListener(\"click\", this._openMixPrompt);\r\n\t\t\tthis._chorusHint.addEventListener(\"click\", this._openChorusPrompt);\r\n\t\t\tthis._archiveHint.addEventListener(\"click\", this._openArchivePrompt);\r\n\r\n\t\t\tthis._tempoStepper.addEventListener(\"change\", this._whenSetTempo);\r\n\r\n\t\t\tthis._instrumentInput.addEventListener(\"keydown\", this._captureNumberKeys, false);\r\n\t\t\tthis._tempoStepper.addEventListener(\"keydown\", this._captureNumberKeys, false);\r\n\t\t\t\r\n\t\t\tthis._editorBox.addEventListener(\"mousedown\", this._refocusStage);\r\n\t\t\tthis.mainLayer.addEventListener(\"keydown\", this._whenKeyPressed);\r\n\t\t\t\r\n\t\t\tthis._songSettingsButton.addEventListener(\"click\", this._setSongSettings);\r\n\t\t\tthis._instSettingsButton.addEventListener(\"click\", this._setInstSettings);\r\n\r\n\t\t\tif (isMobile) (<HTMLOptionElement> this._optionsMenu.children[1]).disabled = true;\r\n\t\t}\r\n\t\t\r\n\t\tprivate _openPrompt(promptName: string): void {\r\n\t\t\tthis._doc.openPrompt(promptName);\r\n\t\t\tthis._setPrompt(promptName);\r\n\t\t}\r\n\t\t\r\n\t\tprivate _setPrompt(promptName: string | null): void {\r\n\t\t\tif (this.prompt) {\r\n\t\t\t\tif (this._wasPlaying) this._play();\r\n\t\t\t\tthis._wasPlaying = false;\r\n\t\t\t\tthis._promptContainer.style.display = \"none\";\r\n\t\t\t\tthis._promptContainer.removeChild(this.prompt.container);\r\n\t\t\t\tthis.prompt.cleanUp();\r\n\t\t\t\tthis.prompt = null;\r\n\t\t\t\tthis.mainLayer.focus();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (promptName) {\r\n\t\t\t\tswitch (promptName) {\r\n\t\t\t\t\tcase \"export\":\r\n\t\t\t\t\t\tthis.prompt = new ExportPrompt(this._doc);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"import\":\r\n\t\t\t\t\t\tthis.prompt = new ImportPrompt(this._doc);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"duration\":\r\n\t\t\t\t\t\tthis.prompt = new SongDurationPrompt(this._doc);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"archive\":\r\n\t\t\t\t\t\tthis.prompt = new ArchivePrompt(this._doc);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"instrumentType\":\r\n\t\t\t\t\t\tthis.prompt = new InstrumentTypePrompt(this._doc);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t// case \"chipPrompt\":\r\n\t\t\t\t\t// \tthis.prompt = new ChipPrompt(this._doc, this);\r\n\t\t\t\t\t// \tbreak;\r\n\t\t\t\t\tcase \"mix\":\r\n\t\t\t\t\t\tthis.prompt = new MixPrompt(this._doc);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"chorus\":\r\n\t\t\t\t\t\tthis.prompt = new ChorusPrompt(this._doc);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"songdata\":\r\n\t\t\t\t\t\tthis.prompt = new SongDataPrompt(this._doc);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"refresh key\":\r\n\t\t\t\t\t\tthis.prompt = new RefreshKeyPrompt(this._doc, this, this._keySelect.selectedIndex);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"archive\":\r\n\t\t\t\t\t\tthis.prompt = new ArchivePrompt(this._doc);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"themes\":\r\n\t\t\t\t\t\tthis.prompt = new ThemePrompt(this._doc);\r\n\t\t\t\t\t\tbreak;\t\r\n\t\t\t\t\tcase \"songTheme\":\r\n\t\t\t\t\t\tthis.prompt = new SongThemePrompt(this._doc);\r\n\t\t\t\t\t\tbreak;\t\r\n\t\t\t\t\tcase \"layouts\":\r\n\t\t\t\t\t\tthis.prompt = new LayoutPrompt(this._doc);\r\n\t\t\t\t\t\tbreak;\t\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tthrow new Error(\"Unrecognized prompt type.\");\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (this.prompt) {\r\n\t\t\t\t\tthis._wasPlaying = this._doc.synth.playing;\r\n\t\t\t\t\tthis._pause();\r\n\t\t\t\t\tthis._promptContainer.style.display = \"\";\r\n\t\t\t\t\tthis._promptContainer.appendChild(this.prompt.container);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tprivate _refocusStage = (): void => {\r\n\t\t\tthis.mainLayer.focus();\r\n\t\t}\r\n\t\t\r\n\t\tpublic whenUpdated = (): void => {\r\n\t\t\tconst trackBounds = this._trackContainer.getBoundingClientRect();\r\n\t\t\tthis._doc.trackVisibleBars = Math.floor((trackBounds.right - trackBounds.left) / 32);\r\n\t\t\tthis._barScrollBar.render();\r\n\t\t\tthis._trackEditor.render();\r\n\t\t\tthis._patternEditor.render();\r\n\r\n\t\t\tif (this._doc.song.setSongTheme != songThemeSet) {\r\n\t\t\t\tif (this._doc.song.setSongTheme == \"none\") {\r\n\t\t\t\t\tif (window.localStorage.getItem(\"modboxTheme\") != null) {\r\n\t\t\t\t\t\tColorConfig.setTheme(String(window.localStorage.getItem(\"modboxTheme\")));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\twindow.localStorage.setItem(\"modboxTheme\", \"default\");\r\n\t\t\t\t\t\tColorConfig.setTheme(\"default\");\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tColorConfig.setTheme(this._doc.song.setSongTheme);\r\n\t\t\t\t}\r\n\t\t\t\tsongThemeSet = this._doc.song.setSongTheme;\r\n\t\t\t} \r\n\r\n\t\t\tdocument.documentElement.style.setProperty(\"--full-layout-columns\", this._doc.prefs.advancedSettings ? \"minmax(0, 1fr) 190px 200px\": \"minmax(0, 1fr) 190px\");\r\n\t\t\tdocument.documentElement.style.setProperty(\"--middle-layout-columns\", this._doc.prefs.advancedSettings ? \"190px minmax(0, 1fr) 200px\" : \"190px minmax(0, 1fr)\");\r\n\r\n\t\t\tconst optionCommands: ReadonlyArray<string> = [\r\n\t\t\t\t(this._doc.prefs.autoPlay ? \"‚úì \" : \"‚úó \") + \"Auto Play On Load\",\r\n\t\t\t\t(this._doc.prefs.autoFollow ? \"‚úì \" : \"‚úó \") + \"Auto Follow Track\",\r\n\t\t\t\t(this._doc.prefs.showLetters ? \"‚úì \" : \"‚úó \") + \"Show Piano\",\r\n\t\t\t\t(this._doc.prefs.showFifth ? \"‚úì \" : \"‚úó \") + \"Highlight 'Fifth' Notes\",\r\n\t\t\t\t(this._doc.prefs.showMore ? \"‚úì \" : \"‚úó \") + \"Advanced Color Scheme\",\r\n\t\t\t\t(this._doc.prefs.showChannels ? \"‚úì \" : \"‚úó \") + \"Show All Channels\",\r\n\t\t\t\t(this._doc.prefs.showScrollBar ? \"‚úì \" : \"‚úó \") + \"Octave Scroll Bar\",\r\n\t\t\t\t(this._doc.prefs.showVolumeBar ? \"‚úì \" : \"‚úó \") + \"Show Channel Volume\",\r\n\t\t\t\t(this._doc.prefs.advancedSettings ? \"‚úì \" : \"‚úó \") + \"Enable Advanced Settings\",\r\n\t\t\t\t\"  Set Theme...\",\r\n\t\t\t]\r\n\t\t\tfor (let i: number = 0; i < optionCommands.length; i++) {\r\n\t\t\t\tconst option: HTMLOptionElement = <HTMLOptionElement> this._optionsMenu.children[i + 1];\r\n\t\t\t\tif (option.innerText != optionCommands[i]) option.innerText = optionCommands[i];\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst channel: Channel = this._doc.song.channels[this._doc.channel];\r\n\t\t\tconst pattern: Pattern | null = this._doc.getCurrentPattern();\r\n\t\t\tconst instrumentIndex: number = this._doc.getCurrentInstrument();\r\n\t\t\tconst instrument: Instrument = channel.instruments[instrumentIndex];\r\n\t\t\tconst wasActive: boolean = this.mainLayer.contains(document.activeElement);\r\n\t\t\tlet activeElement: Element = document.activeElement ? document.activeElement : document.activeElement!;\r\n\r\n            if (this._doc.channel >= this._doc.song.pitchChannelCount + this._doc.song.drumChannelCount) {\r\n                this._piano.forceRender();\r\n            }\r\n\r\n\t\t\tsetSelectedIndex(this._scaleSelect, this._doc.song.scale);\r\n\t\t\tsetSelectedIndex(this._mixSelect, this._doc.song.mix);\r\n\t\t\tsetSelectedIndex(this._sampleRateSelect, this._doc.song.sampleRate);\r\n\t\t\tsetSelectedIndex(this._keySelect, Config.keys.length - 1 - this._doc.song.key);\r\n\t\t\tthis._tempoSlider.updateValue(this._doc.song.tempo);\r\n\t\t\tthis._tempoStepper.value = String(this._doc.song.tempo);\r\n\t\t\tthis._tempoSlider.input.title = this._doc.song.getBeatsPerMinute() + \" beats per minute\";\r\n\t\t\tthis._reverbSlider.updateValue(this._doc.song.reverb);\r\n\t\t\tthis._advancedSettingsContainer.style.display = this._doc.prefs.advancedSettings ? \"\" : \"none\";\r\n\t\t\tthis._blendSlider.updateValue(this._doc.song.blend);\r\n\t\t\tthis._riffSlider.updateValue(this._doc.song.riff);\r\n\t\t\tthis._detuneSlider.updateValue(this._doc.song.detune);\r\n\t\t\tthis._muffSlider.updateValue(this._doc.song.muff);\r\n\t\t\tsetSelectedIndex(this._partSelect, Config.partCounts.indexOf(this._doc.song.partsPerBeat));\r\n\t\t\tif (this._doc.song.getChannelIsDrum(this._doc.channel)) {\r\n\t\t\t\tif (this._doc.song.mix == 2) {\r\n\t\t\t\t\tthis._instrumentVolumeSliderRow.style.display = \"\";\r\n\t\t\t\t\tthis._instrumentMVolumeSliderRow.style.display = \"none\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._instrumentVolumeSliderRow.style.display = \"none\";\r\n\t\t\t\t\tthis._instrumentMVolumeSliderRow.style.display = \"\";\r\n\t\t\t\t}\r\n\t\t\t\tthis._drumSelect.style.display = \"\";\r\n\t\t\t\tthis._waveSelectRow.style.display = \"\";\r\n\t\t\t\tthis._instrumentTypeSelectRow.style.display = \"none\";\r\n\t\t\t\tthis._instrumentTypeSelect.style.display = \"none\";\r\n\t\t\t\tthis._algorithmSelectRow.style.display = \"none\";\r\n\t\t\t\tthis._phaseModGroup.style.display = \"none\";\r\n\t\t\t\tthis._feedbackRow1.style.display = \"none\";\r\n\t\t\t\tthis._feedbackRow2.style.display = \"none\";\r\n\t\t\t\tthis._waveSelect.style.display = \"none\";\r\n\t\t\t\tthis._pwmwaveSelect.style.display = \"none\";\r\n\t\t\t\tthis._filterSelectRow.style.display = \"none\";\r\n\t\t\t\tthis._chorusSelectRow.style.display = \"none\";\r\n\t\t\t\tthis._effectSelectRow.style.display = \"none\";\r\n\t\t\t\tthis._ipanSliderRow.style.display = \"\";\r\n\t\t\t\tthis._harmSelectRow.style.display = \"\";\r\n\t\t\t\tthis._octoffSelectRow.style.display = \"\";\r\n\t\t\t\tthis._fmChorusSelectRow.style.display = \"none\";\r\n\t\t\t} else {\r\n\t\t\t\tthis._instrumentTypeSelectRow.style.display = \"\";\r\n\t\t\t\tthis._instrumentTypeSelect.style.display = \"\";\r\n\t\t\t\tthis._effectSelectRow.style.display = \"\";\r\n\t\t\t\tif (this._doc.song.mix == 2) {\r\n\t\t\t\t\tthis._instrumentVolumeSliderRow.style.display = \"\";\r\n\t\t\t\t\tthis._instrumentMVolumeSliderRow.style.display = \"none\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._instrumentVolumeSliderRow.style.display = \"none\";\r\n\t\t\t\t\tthis._instrumentMVolumeSliderRow.style.display = \"\";\r\n\t\t\t\t}\r\n\t\t\t\tthis._drumSelect.style.display = \"none\";\r\n\t\t\t\t\r\n\t\t\t\tif (instrument.type == InstrumentType.chip) {\r\n\t\t\t\t\tthis._waveSelect.style.display = \"\";\r\n\t\t\t\t\tthis._pwmwaveSelect.style.display = \"none\";\r\n\t\t\t\t\tthis._waveSelectRow.style.display = \"\";\r\n\t\t\t\t\tthis._filterSelectRow.style.display = \"\";\r\n\t\t\t\t\tthis._chorusSelectRow.style.display = \"\";\r\n\t\t\t\t\tthis._harmSelectRow.style.display = \"\";\r\n\t\t\t\t\tthis._algorithmSelectRow.style.display = \"none\";\r\n\t\t\t\t\tthis._phaseModGroup.style.display = \"none\";\r\n\t\t\t\t\tthis._feedbackRow1.style.display = \"none\";\r\n\t\t\t\t\tthis._feedbackRow2.style.display = \"none\";\r\n\t\t\t\t\tthis._ipanSliderRow.style.display = \"\";\r\n\t\t\t\t\tthis._octoffSelectRow.style.display = \"\";\r\n\t\t\t\t\tthis._fmChorusSelectRow.style.display = \"none\";\r\n\t\t\t\t} else if (instrument.type == InstrumentType.pwm) {\r\n\t\t\t\t\tthis._waveSelect.style.display = \"none\";\r\n\t\t\t\t\tthis._pwmwaveSelect.style.display = \"\";\r\n\t\t\t\t\tthis._waveSelectRow.style.display = \"\";\r\n\t\t\t\t\tthis._filterSelectRow.style.display = \"none\"; // @TODO: Unhide?\r\n\t\t\t\t\tthis._chorusSelectRow.style.display = \"none\"; // @TODO: Unhide?\r\n\t\t\t\t\tthis._harmSelectRow.style.display = \"none\";\r\n\t\t\t\t\tthis._algorithmSelectRow.style.display = \"none\";\r\n\t\t\t\t\tthis._phaseModGroup.style.display = \"none\";\r\n\t\t\t\t\tthis._feedbackRow1.style.display = \"none\";\r\n\t\t\t\t\tthis._feedbackRow2.style.display = \"none\";\r\n\t\t\t\t\tthis._ipanSliderRow.style.display = \"\";\r\n\t\t\t\t\tthis._octoffSelectRow.style.display = \"\";\r\n\t\t\t\t\tthis._fmChorusSelectRow.style.display = \"none\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._algorithmSelectRow.style.display = \"\";\r\n\t\t\t\t\tthis._phaseModGroup.style.display = \"\";\r\n\t\t\t\t\tthis._feedbackRow1.style.display = \"\";\r\n\t\t\t\t\tthis._feedbackRow2.style.display = \"\";\r\n\t\t\t\t\tthis._harmSelectRow.style.display = \"none\";\r\n\t\t\t\t\tthis._waveSelectRow.style.display = \"none\";\r\n\t\t\t\t\tthis._filterSelectRow.style.display = \"none\";\r\n\t\t\t\t\tthis._chorusSelectRow.style.display = \"none\";\r\n\t\t\t\t\tthis._ipanSliderRow.style.display = \"\";\r\n\t\t\t\t\tthis._octoffSelectRow.style.display = \"\";\r\n\t\t\t\t\tthis._fmChorusSelectRow.style.display = \"\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._instrumentTypeSelect.value = instrument.type + \"\";\r\n\t\t\tsetSelectedIndex(this._algorithmSelect, instrument.algorithm);\r\n\t\t\t\r\n\t\t\tthis._instrumentSelectRow.style.display = (this._doc.song.instrumentsPerChannel > 1) ? \"\" : \"none\";\r\n\t\t\tthis._instrumentSelectRow.style.visibility = (pattern == null) ? \"hidden\" : \"\";\r\n\t\t\t/*if (this._instrumentSelect.children.length != this._doc.song.instrumentsPerChannel) {\r\n\t\t\t\twhile (this._instrumentSelect.firstChild) this._instrumentSelect.removeChild(this._instrumentSelect.firstChild);\r\n\t\t\t\tconst instrumentList: number[] = [];\r\n\t\t\t\tfor (let i: number = 0; i < this._doc.song.instrumentsPerChannel; i++) {\r\n\t\t\t\t\tinstrumentList.push(i + 1);\r\n\t\t\t\t}\r\n\t\t\t\tbuildOptions(this._instrumentSelect, instrumentList);\r\n\t\t\t}*/\r\n\r\n\t\t\tif (this._instrumentInput.max != String(this._doc.song.instrumentsPerChannel)) {\r\n\t\t\t\tthis._instrumentInput.max = String(this._doc.song.instrumentsPerChannel);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (instrument.imute == 0) {\r\n\t\t\t\tthis._instrumentSettingsGroup.style.color = this._doc.song.getNoteColorBright(this._doc.channel);\r\n\t\t\t\tthis._advancedInstrumentSettingsGroup.style.color = this._doc.song.getNoteColorDim(this._doc.channel);\r\n\t\t\t\tthis._advancedSongSettings.style.color = \"#aaaaaa\";\r\n\t\t\t\tthis._imuteButton.innerText = \"‚óâ\";\r\n\t\t\t\tthis._iMmuteButton.innerText = \"‚óâ\";\r\n\t\t\t} else {\r\n\t\t\t\tthis._instrumentSettingsGroup.style.color = \"#cccccc\";\r\n\t\t\t\tthis._advancedInstrumentSettingsGroup.style.color = \"#aaaaaa\";\r\n\t\t\t\tthis._advancedSongSettings.style.color = \"#aaaaaa\";\r\n\t\t\t\tthis._imuteButton.innerText = \"‚óé\";\r\n\t\t\t\tthis._iMmuteButton.innerText = \"‚óé\";\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tsetSelectedIndex(this._waveSelect, instrument.wave);\r\n\t\t\tsetSelectedIndex(this._drumSelect, instrument.wave);\r\n\t\t\tsetSelectedIndex(this._pwmwaveSelect, instrument.wave);\r\n\t\t\tsetSelectedIndex(this._filterSelect, instrument.filter);\r\n\t\t\tsetSelectedIndex(this._transitionSelect, instrument.transition);\r\n\t\t\tsetSelectedIndex(this._effectSelect, instrument.effect);\r\n\t\t\tsetSelectedIndex(this._chorusSelect, instrument.chorus);\r\n\t\t\tsetSelectedIndex(this._harmSelect, instrument.harm);\r\n\t\t\tsetSelectedIndex(this._octoffSelect, instrument.octoff);\r\n\t\t\tsetSelectedIndex(this._fmChorusSelect, instrument.fmChorus);\r\n\t\t\tsetSelectedIndex(this._feedbackTypeSelect, instrument.feedbackType);\r\n\t\t\tthis._feedbackAmplitudeSlider.updateValue(instrument.feedbackAmplitude);\r\n\t\t\tsetSelectedIndex(this._feedbackEnvelopeSelect, instrument.feedbackEnvelope);\r\n\t\t\tthis._feedbackEnvelopeSelect.parentElement!.style.color = (instrument.feedbackAmplitude > 0) ? \"\" : \"#999\";\r\n\t\t\tthis._instrumentVolumeSlider.updateValue(-instrument.volume);\r\n\t\t\tthis._instrumentMVolumeSlider.updateValue(-instrument.volume);\r\n\t\t\tthis._ipanSlider.updateValue(-instrument.ipan);\r\n\t\t\tsetSelectedIndex(this._instrumentSelect, instrumentIndex);\r\n\t\t\tsetSelectedValue(this._instrumentInput, String(instrumentIndex+1));\r\n\t\t\tfor (let i: number = 0; i < Config.operatorCount; i++) {\r\n\t\t\t\tconst isCarrier: boolean = (i < Config.operatorCarrierCounts[instrument.algorithm]);\r\n\t\t\t\tthis._operatorRows[i].style.color = isCarrier ? \"white\" : \"\";\r\n\t\t\t\tsetSelectedIndex(this._operatorFrequencySelects[i], instrument.operators[i].frequency);\r\n\t\t\t\tthis._operatorAmplitudeSliders[i].updateValue(instrument.operators[i].amplitude);\r\n\t\t\t\tsetSelectedIndex(this._operatorEnvelopeSelects[i], instrument.operators[i].envelope);\r\n\t\t\t\tconst operatorName: string = (isCarrier ? \"Voice \" : \"Modulator \") + (i + 1);\r\n\t\t\t\tthis._operatorFrequencySelects[i].title = operatorName + \" Frequency\";\r\n\t\t\t\tthis._operatorAmplitudeSliders[i].input.title = operatorName + (isCarrier ? \" Volume\" : \" Amplitude\");\r\n\t\t\t\tthis._operatorEnvelopeSelects[i].title = operatorName + \" Envelope\";\r\n\t\t\t\tthis._operatorEnvelopeSelects[i].parentElement!.style.color = (instrument.operators[i].amplitude > 0) ? \"\" : \"#999\";\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._piano.container.style.display = this._doc.prefs.showLetters ? \"\" : \"none\";\r\n\t\t\tthis._octaveScrollBar.container.style.display = this._doc.prefs.showScrollBar ? \"\" : \"none\";\r\n\t\t\tthis._barScrollBar.container.style.display = this._doc.song.barCount > this._doc.trackVisibleBars ? \"\" : \"none\";\r\n\t\t\t// this._chipHint.style.display = (instrument.type == InstrumentType.fm) ? \"none\" : \"\";\r\n\t\t\tthis._instrumentTypeHint.style.display = (instrument.type == InstrumentType.fm) ? \"\" : \"none\";\r\n\t\t\tthis._mixHint.style.display = (this._doc.song.mix != 1) ? \"\" : \"none\";\r\n\t\t\tthis._chorusHint.style.display = (Config.harmNames[instrument.harm]) ? \"\" : \"none\";\r\n\t\t\t\r\n\t\t\tlet patternWidth: number = 512;\r\n\t\t\tif (this._doc.prefs.showLetters) patternWidth -= 32;\r\n\t\t\tif (this._doc.prefs.showScrollBar) patternWidth -= 20;\r\n\t\t\tthis._patternEditor.container.style.width = String(patternWidth) + \"px\";\r\n\t\t\t\r\n\t\t\tthis._volumeSlider.value = String(this._doc.prefs.volume);\r\n\t\t\t\r\n\t\t\t// If an interface element was selected, but becomes invisible (e.g. an instrument\r\n\t\t\t// select menu) just select the editor container so keyboard commands still work.\r\n\t\t\tif (wasActive && (activeElement.clientWidth == 0)) {\r\n\t\t\t\tthis._refocusStage();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._setPrompt(this._doc.prompt);\r\n\t\t\t\r\n\t\t\tif (this._doc.prefs.autoFollow && !this._doc.synth.playing) {\r\n\t\t\t\tthis._doc.synth.snapToBar(this._doc.bar);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tprivate _setSongSettings = (): void => {\r\n\t\t\tthis._songSettingsGroup.style.display = \"flex\";\r\n\t\t\tthis._instrumentSettingsGroup.style.display = \"none\";\r\n\t\t\tthis._songSettingsButton.style.borderBottom = \"solid 2px var(--link-accent)\";\r\n\t\t\tthis._instSettingsButton.style.borderBottom = \"\";\r\n\t\t}\r\n\r\n\t\tprivate _setInstSettings = (): void => {\r\n\t\t\tthis._instrumentSettingsGroup.style.display = \"unset\";\r\n\t\t\tthis._songSettingsGroup.style.display = \"none\";\r\n\t\t\tthis._instSettingsButton.style.borderBottom = \"solid 2px var(--link-accent)\";\r\n\t\t\tthis._songSettingsButton.style.borderBottom = \"\";\r\n\t\t}\r\n\r\n\t\tprivate _muteInstrument = (): void => {\r\n\t\t\tconst channel: Channel = this._doc.song.channels[this._doc.channel];\r\n\t\t\tconst instrumentIndex: number = this._doc.getCurrentInstrument();\r\n\t\t\tconst instrument: Instrument = channel.instruments[instrumentIndex];\r\n\t\t\tconst oldValue: number = instrument.imute;\r\n\t\t\tconst isMuted: boolean = oldValue == 1;\r\n\t\t\tconst newValue: number = isMuted ? 0 : 1;\r\n\t\t\tthis._doc.record(new ChangeImute(this._doc, newValue));\r\n\t\t\tif (instrument.imute == 0) {\r\n\t\t\t\tthis._instrumentSettingsGroup.style.color = this._doc.song.getNoteColorBright(this._doc.channel);\r\n\t\t\t\tthis._advancedInstrumentSettingsGroup.style.color = this._doc.song.getNoteColorDim(this._doc.channel);\r\n\t\t\t\tthis._advancedSongSettings.style.color = \"#aaaaaa\";\r\n\t\t\t\tthis._imuteButton.innerText = \"‚óâ\";\r\n\t\t\t\tthis._iMmuteButton.innerText = \"‚óâ\";\r\n\t\t\t} else {\r\n\t\t\t\tthis._instrumentSettingsGroup.style.color = \"#cccccc\";\r\n\t\t\t\tthis._advancedInstrumentSettingsGroup.style.color = \"#aaaaaa\";\r\n\t\t\t\tthis._advancedSongSettings.style.color = \"#aaaaaa\";\r\n\t\t\t\tthis._imuteButton.innerText = \"‚óé\";\r\n\t\t\t\tthis._iMmuteButton.innerText = \"‚óé\";\r\n\t\t\t}\r\n\t\t\tthis.whenUpdated();\r\n\t\t}\r\n\t\t\r\n\t\tpublic updatePlayButton(): void {\r\n\t\t\tif (this._doc.synth.playing) {\r\n\t\t\t\tthis._playButton.classList.remove(\"playButton\");\r\n\t\t\t\tthis._playButton.classList.add(\"pauseButton\");\r\n\t\t\t\tthis._playButton.title = \"Pause (Space)\";\r\n\t\t\t\tthis._playButton.innerText = \"Pause\";\r\n\t\t\t} else {\r\n\t\t\t\tthis._playButton.classList.remove(\"pauseButton\");\r\n\t\t\t\tthis._playButton.classList.add(\"playButton\");\r\n\t\t\t\tthis._playButton.title = \"Play (Space)\";\r\n\t\t\t\tthis._playButton.innerText = \"Play\";\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tpublic _whenSetTempo = ():void => {\r\n\t\t\tthis._doc.record(new ChangeTempo(this._doc, -1, parseInt(this._tempoStepper.value) | 0));\r\n\t\t}\r\n\r\n\t\tprivate _captureNumberKeys = (event: KeyboardEvent): void => {\r\n        // When the number input is in focus, allow some keyboard events to\r\n        // edit the input without accidentally editing the song otherwise.\r\n\t\t\tswitch (event.keyCode) {\r\n\t\t\t\tcase 8: // backspace/delete\r\n\t\t\t\tcase 13: // enter/return\r\n\t\t\t\tcase 38: // up\r\n\t\t\t\tcase 40: // down\r\n\t\t\t\tcase 37: // left\r\n\t\t\t\tcase 39: // right\r\n\t\t\t\tcase 48: // 0\r\n\t\t\t\tcase 49: // 1\r\n\t\t\t\tcase 50: // 2\r\n\t\t\t\tcase 51: // 3\r\n\t\t\t\tcase 52: // 4\r\n\t\t\t\tcase 53: // 5\r\n\t\t\t\tcase 54: // 6\r\n\t\t\t\tcase 55: // 7\r\n\t\t\t\tcase 56: // 8\r\n\t\t\t\tcase 57: // 9\r\n\t\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t\tbreak;\r\n        \t}\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenKeyPressed = (event: KeyboardEvent): void => {\r\n\t\t\tif (this.prompt) {\r\n\t\t\t\tif (event.keyCode == 27) { // ESC key\r\n\t\t\t\t\t// close prompt.\r\n\t\t\t\t\twindow.history.back();\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t//if (event.ctrlKey)\r\n\t\t\t//trace(event.keyCode)\r\n\t\t\tswitch (event.keyCode) {\r\n\t\t\t\tcase 8:\r\n\t\t\t\t\tif (event.ctrlKey) {\r\n\t\t\t\t\t\tif (this._doc.channel > 0) {\r\n\t\t\t\t\t\t\tthis._doc.record(new ChangeRemoveChannel(this._doc, this._doc.channel, this._doc.channel));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis._doc.record(new ChangeDeleteBars(this._doc, this._doc.bar, 1));\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 13: // enter\r\n\t\t\t\t\tif (event.ctrlKey || event.metaKey) {\t\t\r\n\t\t\t\t\t\t\tthis._doc.selection.insertChannel();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis._doc.record(new ChangeInsertBars(this._doc, this._doc.bar+1, 1)); }\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 38: // up\r\n\t\t\t\t\tthis._trackEditor._setChannelBar((this._doc.channel - 1 + this._doc.song.getChannelCount()) % this._doc.song.getChannelCount(), this._doc.bar);\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 40: // down\r\n\t\t\t\tthis._trackEditor._setChannelBar((this._doc.channel + 1) % this._doc.song.getChannelCount(), this._doc.bar);\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 37: // left\r\n\t\t\t\tthis._trackEditor._setChannelBar(this._doc.channel, (this._doc.bar + this._doc.song.barCount - 1) % this._doc.song.barCount);\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 39: // right\r\n\t\t\t\tthis._trackEditor._setChannelBar(this._doc.channel, (this._doc.bar + 1) % this._doc.song.barCount);\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 48: // 0\r\n\t\t\t\tthis._trackEditor._nextDigit(\"0\");\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 49: // 1\r\n\t\t\t\tthis._trackEditor._nextDigit(\"1\");\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 50: // 2\r\n\t\t\t\tthis._trackEditor._nextDigit(\"2\");\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 51: // 3\r\n\t\t\t\tthis._trackEditor._nextDigit(\"3\");\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 52: // 4\r\n\t\t\t\tthis._trackEditor._nextDigit(\"4\");\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 53: // 5\r\n\t\t\t\tthis._trackEditor._nextDigit(\"5\");\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 54: // 6\r\n\t\t\t\tthis._trackEditor._nextDigit(\"6\");\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 55: // 7\r\n\t\t\t\tthis._trackEditor._nextDigit(\"7\");\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 56: // 8\r\n\t\t\t\tthis._trackEditor._nextDigit(\"8\");\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 57: // 9\r\n\t\t\t\tthis._trackEditor._nextDigit(\"9\");\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\tthis._trackEditor._digits = \"\";\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 77: // m\r\n\t\t\t\tif (event.shiftKey) {\r\n\t\t\t\t\tthis._doc.selection.muteAllInstruments();\r\n\t\t\t\t\t} else { \r\n\t\t\t\t\tthis._muteInstrument();\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 83: // s\r\n\t\t\t\tif (event.ctrlKey || event.metaKey) {\r\n\t\t\t\t\tthis._openPrompt(\"export\");\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t}\telse {\r\n\t\t\t\t\tthis._doc.selection.soloChannels(event.shiftKey);\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 79: // o\r\n\t\t\t\tif (event.ctrlKey || event.metaKey) {\r\n\t\t\t\t\tthis._openPrompt(\"import\");\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 32: // space\r\n\t\t\t\t\t//stage.focus = stage;\r\n\t\t\t\t\tthis._togglePlay();\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 90: // z\r\n\t\t\t\t\tif (event.shiftKey) {\r\n\t\t\t\t\t\tthis._doc.redo();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis._doc.undo();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 89: // y\r\n\t\t\t\t\tthis._doc.redo();\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 88: // x\r\n\t\t\t\t\tthis._cut();\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 67: // c\r\n\t\t\t\t\tthis._copy();\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 70: // f\r\n\t\t\t\tif (event.shiftKey) {\r\n\t\t\t\t\tthis._doc.synth.snapToBar(this._doc.song.loopStart);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._doc.synth.snapToStart();\r\n\t\t\t\t}\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 86: // v\r\n\t\t\t\t\tthis._paste();\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 219: // left brace\r\n\t\t\t\t\tthis._doc.synth.prevBar();\r\n\t\t\t\t\tif (this._doc.prefs.autoFollow) {\r\n\t\t\t\t\t\tnew ChangeChannelBar(this._doc, this._doc.channel, Math.floor(this._doc.synth.playhead));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 221: // right brace\r\n\t\t\t\t\tthis._doc.synth.nextBar();\r\n\t\t\t\t\tif (this._doc.prefs.autoFollow) {\r\n\t\t\t\t\t\tnew ChangeChannelBar(this._doc, this._doc.channel, Math.floor(this._doc.synth.playhead));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 189: // -\r\n\t\t\t\tcase 173: // Firefox -\r\n\t\t\t\t\tthis._transpose(false);\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 187: // +\r\n\t\t\t\tcase 61: // Firefox +\r\n\t\t\t\t\tthis._transpose(true);\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 81: // q\r\n\t\t\t\t\tthis._openPrompt(\"duration\");\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenPrevBarPressed = (): void => {\r\n\t\t\tthis._doc.synth.prevBar();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenNextBarPressed = (): void => {\r\n\t\t\tthis._doc.synth.nextBar();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _togglePlay = (): void => {\r\n\t\t\tif (this._doc.synth.playing) {\r\n\t\t\t\tthis._pause();\r\n\t\t\t} else {\r\n\t\t\t\tthis._play();\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tprivate _play(): void {\r\n\t\t\tthis._doc.synth.play();\r\n\t\t\tthis.updatePlayButton();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _pause(): void {\r\n\t\t\tthis._doc.synth.pause();\r\n\t\t\tif (this._doc.prefs.autoFollow) {\r\n\t\t\t\tthis._doc.synth.snapToBar(this._doc.bar);\r\n\t\t\t} else {\r\n\t\t\t\tthis._doc.synth.snapToBar();\r\n\t\t\t}\r\n\t\t\tthis.updatePlayButton();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _setVolumeSlider = (): void => {\r\n\t\t\tthis._doc.setVolume(Number(this._volumeSlider.value));\r\n\t\t\tthis._trackEditor.render();\r\n\t\t}\r\n\r\n\t\tprivate _cut(): void {\r\n\t\t\tconst pattern: Pattern | null = this._doc.getCurrentPattern();\r\n\t\t\tif (pattern == null) return;\r\n\t\t\twindow.localStorage.setItem(\"patternCopy\", JSON.stringify({\r\n\t\t\t\tnotes: pattern.notes,\r\n\t\t\t\tbeatsPerBar: this._doc.song.beatsPerBar,\r\n\t\t\t\tpartsPerBeat: this._doc.song.partsPerBeat,\r\n\t\t\t\tdrums: this._doc.song.getChannelIsDrum(this._doc.channel),\r\n\t\t\t}));\r\n\t\t\tthis._doc.record(new ChangePaste(this._doc, pattern, [], this._doc.song.beatsPerBar, this._doc.song.partsPerBeat));\r\n\t\t}\r\n\t\t\r\n\t\tprivate _copy(): void {\r\n\t\t\tconst pattern: Pattern | null = this._doc.getCurrentPattern();\r\n\t\t\tlet notes: Note[] = [];\r\n\t\t\tif (pattern != null) notes = pattern.notes;\r\n\t\t\t\r\n\t\t\tconst patternCopy: PatternCopy = {\r\n\t\t\t\tnotes: notes,\r\n\t\t\t\tbeatsPerBar: this._doc.song.beatsPerBar,\r\n\t\t\t\tpartsPerBeat: this._doc.song.partsPerBeat,\r\n\t\t\t\tdrums: this._doc.song.getChannelIsDrum(this._doc.channel),\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\twindow.localStorage.setItem(\"patternCopy\", JSON.stringify(patternCopy));\r\n\t\t}\r\n\t\t\r\n\t\tprivate _paste(): void {\r\n\t\t\tconst patternCopy: PatternCopy | null = JSON.parse(String(window.localStorage.getItem(\"patternCopy\")));\r\n\t\t\tif (patternCopy != null && patternCopy.drums == this._doc.song.getChannelIsDrum(this._doc.channel)) {\r\n\t\t\t\tnew ChangeEnsurePatternExists(this._doc);\r\n\t\t\t\tconst pattern: Pattern | null = this._doc.getCurrentPattern();\r\n\t\t\t\tif (pattern == null) throw new Error();\r\n\t\t\t\tthis._doc.record(new ChangePaste(this._doc, pattern, patternCopy.notes, patternCopy.beatsPerBar, patternCopy.partsPerBeat));\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tprivate _transpose(upward: boolean): void {\r\n\t\t\tconst pattern: Pattern | null = this._doc.getCurrentPattern();\r\n\t\t\tif (pattern == null) return;\r\n\t\t\t\r\n\t\t\tconst canReplaceLastChange: boolean = this._doc.lastChangeWas(this._changeTranspose);\r\n\t\t\tthis._changeTranspose = new ChangeTranspose(this._doc, pattern, upward);\r\n\t\t\tthis._doc.record(this._changeTranspose, canReplaceLastChange);\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenNewSongPressed = (): void => {\r\n\t\t\tthis._doc.record(new ChangeSong(this._doc, \"\"));\r\n\t\t\tthis._patternEditor.resetCopiedPins();\r\n\t\t}\r\n\r\n\t\tprivate _whenCustomizePressed = (): void => {\r\n\t\t\tthis._openPrompt(\"duration\");\r\n\t\t}\r\n\r\n\t\tprivate _advancedUndo = (): void => {\r\n\t\t\tthis._doc.undo();\r\n\t\t}\r\n\r\n\t\tprivate _advancedRedo = (): void => {\r\n\t\t\tthis._doc.redo();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _openExportPrompt = (): void => {\r\n\t\t\tthis._openPrompt(\"export\");\r\n\t\t}\r\n\t\t\r\n\t\tprivate _openSongDataPrompt = (): void => {\r\n\t\t\tthis._openPrompt(\"songdata\");\r\n\t\t}\r\n\t\t\r\n\t\tprivate _openInstrumentTypePrompt = (): void => {\r\n\t\t\tthis._openPrompt(\"instrumentType\");\r\n\t\t}\r\n\t\t\r\n\t\t// private _openChipPrompt = (): void => {\r\n\t\t// \tthis._openPrompt(\"chipPrompt\");\r\n\t\t// }\r\n\t\t\r\n\t\tprivate _openMixPrompt = (): void => {\r\n\t\t\tthis._openPrompt(\"mix\");\r\n\t\t}\r\n\t\t\r\n\t\tprivate _openChorusPrompt = (): void => {\r\n\t\t\tthis._openPrompt(\"chorus\");\r\n\t\t}\r\n\t\t\r\n\t\tprivate _openArchivePrompt = (): void => {\r\n\t\t\tthis._openPrompt(\"archive\");\r\n\t\t}\r\n\r\n\t\tpublic refreshNow = (): void => {\r\n\t\t\tsetTimeout(() => { // Prompts seem to get stuck if reloading is done too quickly.\r\n\t\t\t\tlocation.reload();\r\n\t\t\t}, 500);\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenSetScale = (): void => {\r\n\t\t\tthis._doc.record(new ChangeScale(this._doc, this._scaleSelect.selectedIndex));\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenSetMix = (): void => {\r\n\t\t\tthis._doc.record(new ChangeMix(this._doc, this._mixSelect.selectedIndex));\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenSetSampleRate = (): void => {\r\n\t\t\tthis._doc.record(new ChangeSampleRate(this._doc, this._sampleRateSelect.selectedIndex));\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenSetKey = (): void => {\r\n\t\t\tthis._doc.record(new ChangeKey(this._doc, Config.keys.length - 1 - this._keySelect.selectedIndex));\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenSetPartsPerBeat = (): void => {\r\n\t\t\tthis._doc.record(new ChangePartsPerBeat(this._doc, Config.partCounts[this._partSelect.selectedIndex]));\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenSetInstrumentType = (): void => {\r\n\t\t\tthis._doc.record(new ChangeInstrumentType(this._doc, +this._instrumentTypeSelect.value));\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenSetFeedbackType = (): void => {\r\n\t\t\tthis._doc.record(new ChangeFeedbackType(this._doc, this._feedbackTypeSelect.selectedIndex));\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenSetFeedbackEnvelope = (): void => {\r\n\t\t\tthis._doc.record(new ChangeFeedbackEnvelope(this._doc, this._feedbackEnvelopeSelect.selectedIndex));\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenSetAlgorithm = (): void => {\r\n\t\t\tthis._doc.record(new ChangeAlgorithm(this._doc, this._algorithmSelect.selectedIndex));\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenSetInstrument = (): void => {\r\n\t\t\tconst pattern : Pattern | null = this._doc.getCurrentPattern();\r\n\t\t\tif (pattern == null) return;\r\n\t\t\tthis._doc.record(new ChangePatternInstrument(this._doc, Number(this._instrumentInput.value)-1, pattern));\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenSetWave = (): void => {\r\n\t\t\tthis._doc.record(new ChangeWave(this._doc, this._waveSelect.selectedIndex));\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenSetDrum = (): void => {\r\n\t\t\tthis._doc.record(new ChangeWave(this._doc, this._drumSelect.selectedIndex));\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenSetPWMWave = (): void => {\r\n\t\t\tthis._doc.record(new ChangeWave(this._doc, this._pwmwaveSelect.selectedIndex));\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenSetFilter = (): void => {\r\n\t\t\tthis._doc.record(new ChangeFilter(this._doc, this._filterSelect.selectedIndex));\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenSetTransition = (): void => {\r\n\t\t\tthis._doc.record(new ChangeTransition(this._doc, this._transitionSelect.selectedIndex));\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenSetEffect = (): void => {\r\n\t\t\tthis._doc.record(new ChangeEffect(this._doc, this._effectSelect.selectedIndex));\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenSetHarm = (): void => {\r\n\t\t\tthis._doc.record(new ChangeHarm(this._doc, this._harmSelect.selectedIndex));\r\n\t\t}\r\n\r\n\t\tprivate _whenSetFMChorus = (): void => {\r\n\t\t\tthis._doc.record(new ChangeFMChorus(this._doc, this._fmChorusSelect.selectedIndex));\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenSetOctoff = (): void => {\r\n\t\t\tthis._doc.record(new ChangeOctoff(this._doc, this._octoffSelect.selectedIndex));\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenSetChorus = (): void => {\r\n\t\t\tthis._doc.record(new ChangeChorus(this._doc, this._chorusSelect.selectedIndex));\r\n\t\t}\r\n\t\t\r\n\t\tprivate _fileMenuHandler = (event:Event): void => {\r\n\t\t\tswitch (this._fileMenu.value) {\r\n\t\t\t\tcase \"import\":\r\n\t\t\t\t\tthis._openPrompt(\"import\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"export\":\r\n\t\t\t\t\tthis._openPrompt(\"export\");\r\n\t\t\t\t\tbreak;\t\r\n\t\t\t\tcase \"cleanS\":\r\n\t\t\t\t\tthis._whenNewSongPressed();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"songdata\":\r\n\t\t\t\t\tthis._openPrompt(\"songdata\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"manual\":\r\n\t\t\t\t\twindow.open(\"./manual.html\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"shortenUrl\":\r\n\t\t\t\t\twindow.open(\"https://tinyurl.com/api-create.php?url=\" + encodeURIComponent(new URL(\"#\" + this._doc.song.toBase64String(), location.href).href));\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tthis._fileMenu.selectedIndex = 0;\r\n\t\t}\r\n\r\n\t\tprivate _editMenuHandler = (event:Event): void => {\r\n\t\t\tswitch (this._editMenu.value) {\r\n\t\t\t\tcase \"undo\":\r\n\t\t\t\t\tthis._doc.undo();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"redo\":\r\n\t\t\t\t\tthis._doc.redo();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"cut\":\r\n\t\t\t\t\tthis._cut();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"copy\":\r\n\t\t\t\t\tthis._copy();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"paste\":\r\n\t\t\t\t\tthis._paste();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"transposeUp\":\r\n\t\t\t\t\tthis._transpose(true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"transposeDown\":\r\n\t\t\t\t\tthis._transpose(false);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"duration\":\r\n\t\t\t\t\tthis._openPrompt(\"duration\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"archive\":\r\n\t\t\t\t\tthis._openPrompt(\"archive\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"songTheme\":\r\n\t\t\t\t\tthis._openPrompt(\"songTheme\");\r\n\t\t\t\t\tbreak;\t\r\n\t\t\t}\r\n\t\t\tthis._editMenu.selectedIndex = 0;\r\n\t\t}\r\n\t\t\r\n\t\tprivate _optionsMenuHandler = (event:Event): void => {\r\n\t\t\tswitch (this._optionsMenu.value) {\r\n\t\t\t\tcase \"autoPlay\":\r\n\t\t\t\t\tthis._doc.prefs.autoPlay = !this._doc.prefs.autoPlay;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"autoFollow\":\r\n\t\t\t\t\tthis._doc.prefs.autoFollow = !this._doc.prefs.autoFollow;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"showLetters\":\r\n\t\t\t\t\tthis._doc.prefs.showLetters = !this._doc.prefs.showLetters;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"showFifth\":\r\n\t\t\t\t\tthis._doc.prefs.showFifth = !this._doc.prefs.showFifth;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"showMore\":\r\n\t\t\t\t\tthis._doc.prefs.showMore = !this._doc.prefs.showMore;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"showChannels\":\r\n\t\t\t\t\tthis._doc.prefs.showChannels = !this._doc.prefs.showChannels;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"showScrollBar\":\r\n\t\t\t\t\tthis._doc.prefs.showScrollBar = !this._doc.prefs.showScrollBar;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"showVolumeBar\":\r\n\t\t\t\t\tthis._doc.prefs.showVolumeBar = !this._doc.prefs.showVolumeBar;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"advancedSettings\":\r\n\t\t\t\t\tthis._doc.prefs.advancedSettings = !this._doc.prefs.advancedSettings;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"themes\":\r\n\t\t\t\t\tthis._openPrompt(\"themes\");\r\n\t\t\t\t\tbreak;\t\r\n\t\t\t\tcase \"layouts\":\r\n\t\t\t\t\tthis._openPrompt(\"layouts\");\r\n\t\t\t\t\tbreak;\t\t\r\n\t\t\t}\r\n\t\t\tthis._optionsMenu.selectedIndex = 0;\r\n\t\t\tthis._doc.notifier.changed();\r\n\t\t\tthis._doc.prefs.save();\r\n\t\t}\r\n\t}\r\n\t\r\n","/*\r\nCopyright (C) 2018 John Nesky\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\n\r\n\texport class ChangeNotifier {\r\n\t\tprivate _watchers: (()=>void)[] = [];\r\n\t\tprivate _dirty: boolean = false;\r\n\t\t\r\n\t\tpublic watch(watcher: ()=>void): void {\r\n\t\t\tif (this._watchers.indexOf(watcher) == -1) {\r\n\t\t\t\tthis._watchers.push(watcher);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tpublic unwatch(watcher: ()=>void): void {\r\n\t\t\tconst index: number = this._watchers.indexOf(watcher);\r\n\t\t\tif (index != -1) {\r\n\t\t\t\tthis._watchers.splice(index, 1);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tpublic changed(): void {\r\n\t\t\tthis._dirty = true;\r\n\t\t}\r\n\t\t\r\n\t\tpublic notifyWatchers(): void {\r\n\t\t\tif (!this._dirty) return;\r\n\t\t\tthis._dirty = false;\r\n\t\t\tfor (const watcher of this._watchers.concat()) {\r\n\t\t\t\twatcher();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n","import {ChangeGroup} from \"./Change\";\r\nimport { ChangeChannelBar, ChangeAddChannel, ChangeSoloChannels, ChangeAllImute } from \"./changes\";\r\nimport { Config } from \"../synth/SynthConfig\";\r\nimport { SongDocument } from \"./SongDocument\";\r\n//import { Channel, Instrument } from \"../synth/synth\";\r\n\r\nexport class Selection {\r\n\r\n    constructor(private _doc: SongDocument) {}\r\n\r\n    public muteAllInstruments(): void {\r\n        let shouldMute: boolean = false;\r\n        if (this._doc.song.channels[this._doc.channel].instruments[0].imute == 0) {\r\n            shouldMute = true;\r\n        }\r\n\r\n        for(let instrumentIndex: number = 0; instrumentIndex < this._doc.song.channels[this._doc.channel].instruments.length; instrumentIndex++) {  \r\n            this._doc.record(new ChangeAllImute(this._doc, Number(shouldMute), instrumentIndex));\r\n        }\r\n\r\n    this._doc.notifier.changed();\r\n}\r\n\r\n    public soloChannels(invert: boolean): void {\r\n\r\n            let mutedCounter: number = 0;\r\n\r\n\t\t\tfor (let channelIndex: number = 0; channelIndex < this._doc.song.channels.length; channelIndex++) {\r\n\t\t\t\tfor(let instrumentIndex: number = 0; instrumentIndex < this._doc.song.channels[channelIndex].instruments.length; instrumentIndex++) {\r\n\r\n                    if (this._doc.song.channels[channelIndex].instruments[instrumentIndex].imute == (invert ? 0 : 1) && channelIndex != this._doc.channel) {\r\n                        mutedCounter++;\r\n                    }\r\n\r\n                    if (channelIndex != this._doc.channel) {\r\n                        this._doc.record(new ChangeSoloChannels(this._doc, Number(!invert), channelIndex, instrumentIndex));\r\n                    } else {\r\n                        this._doc.record(new ChangeSoloChannels(this._doc, Number(invert), channelIndex, instrumentIndex));\r\n                    }\r\n\r\n                    \r\n                }\r\n\t\t\t}\r\n\r\n            if (mutedCounter >= this._doc.song.pitchChannelCount + this._doc.song.drumChannelCount - 1) {\r\n                for (let channelIndex: number = 0; channelIndex < this._doc.song.channels.length; channelIndex++) {\r\n                    for(let instrumentIndex: number = 0; instrumentIndex < this._doc.song.channels[channelIndex].instruments.length; instrumentIndex++) {\r\n                        this._doc.record(new ChangeSoloChannels(this._doc, Number(invert), channelIndex, instrumentIndex));  \r\n                    }\r\n                }\r\n            }\r\n\t\tthis._doc.notifier.changed();\r\n\t}\r\n\r\n    public insertChannel(): void {\r\n\r\n        const group: ChangeGroup = new ChangeGroup();\r\n        const insertIndex: number = this._doc.channel;\r\n        const isNoise: boolean = this._doc.song.getChannelIsDrum(insertIndex);\r\n        group.append(new ChangeAddChannel(this._doc, insertIndex+1, isNoise));\r\n        if (!group.isNoop()) {\r\n            group.append(new ChangeChannelBar(this._doc, insertIndex, this._doc.bar));\r\n            this._doc.record(group);\r\n        }\r\n\r\n        if (!isNoise && this._doc.channel < Config.pitchChannelCountMax-1) {\r\n            this._doc.channel++;\r\n        }\r\n\r\n        if (isNoise && this._doc.channel < Config.drumChannelCountMax + this._doc.song.pitchChannelCount - 1) {\r\n            this._doc.channel++;\r\n        }\r\n\r\n    }\r\n}","export class Preferences {\r\n\r\n    public static readonly defaultVisibleOctaves: number = 3;\r\n\r\n    autoPlay: boolean = localStorage.getItem(\"autoPlay\") == \"true\";\r\n\tautoFollow: boolean = localStorage.getItem(\"autoFollow\") == \"true\";\r\n\tshowFifth: boolean = localStorage.getItem(\"showFifth\") != \"false\";\r\n\tshowMore: boolean = localStorage.getItem(\"showMore\") == \"true\";\r\n\tshowLetters: boolean = localStorage.getItem(\"showLetters\") != \"false\";\r\n\tshowChannels: boolean = localStorage.getItem(\"showChannels\") == \"true\";\r\n\tshowScrollBar: boolean = localStorage.getItem(\"showScrollBar\") != \"false\";\r\n\tshowVolumeBar: boolean = localStorage.getItem(\"showVolumeBar\") == \"true\";\r\n\tadvancedSettings: boolean = localStorage.getItem(\"advancedSettings\") != \"false\";\r\n\tvisibleOctaves: number = localStorage.getItem(\"visibleOctaves\") != null ? Number(localStorage.getItem(\"visibleOctaves\")) : Preferences.defaultVisibleOctaves;\r\n    layout: string = localStorage.getItem(\"layout\") || \"small\";\r\n\tvolume: number = localStorage.getItem(\"volume\") != null ? Number(localStorage.getItem(\"volume\")) : 75;\r\n\r\n    save(): void {\r\n\t\tlocalStorage.setItem(\"autoPlay\", this.autoPlay ? \"true\" : \"false\");\r\n\t\tlocalStorage.setItem(\"autoFollow\", this.autoFollow ? \"true\" : \"false\");\r\n\t\tlocalStorage.setItem(\"showFifth\", this.showFifth ? \"true\" : \"false\");\r\n\t\tlocalStorage.setItem(\"showMore\", this.showMore ? \"true\" : \"false\");\r\n\t\tlocalStorage.setItem(\"showLetters\", this.showLetters ? \"true\" : \"false\");\r\n\t\tlocalStorage.setItem(\"showChannels\", this.showChannels ? \"true\" : \"false\");\r\n\t\tlocalStorage.setItem(\"showScrollBar\", this.showScrollBar ? \"true\" : \"false\");\r\n\t\tlocalStorage.setItem(\"showVolumeBar\", this.showVolumeBar ? \"true\" : \"false\");\r\n\t\tlocalStorage.setItem(\"advancedSettings\", this.advancedSettings ? \"true\" : \"false\");\r\n\t\tlocalStorage.setItem(\"visibleOctaves\", String(this.visibleOctaves));\r\n\t\tlocalStorage.setItem(\"volume\", String(this.volume));\r\n\t}\r\n\r\n}","/*\r\nCopyright (C) 2018 John Nesky\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\nimport { Synth} from \"../synth/synth\";\r\nimport { Song, Pattern  } from \"../synth/song\";\r\nimport { ChangeNotifier } from \"./ChangeNotifier\";\r\nimport { Change } from \"./Change\";\r\nimport { ChangeSong } from \"./changes\";\r\nimport { ColorConfig } from \"./ColorConfig\"; \r\nimport { Layout } from \"./Layout\";\r\nimport {Selection} from \"./Selection.js\";\r\nimport { Config } from \"../synth/SynthConfig\";\r\n\r\nimport { Preferences } from \"./Preferences\";\r\n\r\n\tinterface HistoryState {\r\n\t\tcanUndo: boolean;\r\n\t\tsequenceNumber: number;\r\n\t\tbar: number;\r\n\t\tchannel: number;\r\n\t\tprompt: string | null;\r\n\t}\r\n\t\r\n\texport class SongDocument {\r\n\t\tpublic song: Song;\r\n\t\tpublic synth: Synth;\r\n\t\tpublic notifier: ChangeNotifier = new ChangeNotifier();\r\n\t\tpublic readonly selection: Selection = new Selection(this);\r\n\t\tpublic channel: number = 0;\r\n\t\tpublic bar: number = 0;\r\n\t\tpublic trackVisibleBars: number = 16;\r\n\t\tpublic barScrollPos: number = 0;\r\n\t\tpublic prompt: string | null = null;\r\n\t\tpublic readonly prefs: Preferences = new Preferences();\r\n\t\t\r\n\t\tprivate _recentChange: Change | null = null;\r\n\t\tprivate _sequenceNumber: number = 0;\r\n\t\tprivate _barFromCurrentState: number = 0;\r\n\t\tprivate _channelFromCurrentState: number = 0;\r\n\t\tprivate _shouldPushState: boolean = false;\r\n\t\tprivate _waitingToUpdateState: boolean = false;\r\n\t\t\r\n\t\tconstructor(string?: string) {\r\n\t\t\tthis.song = new Song(string);\r\n\t\t\tthis.synth = new Synth(this.song);\r\n\r\n\t\t\tthis.synth.volume = this._calcVolume();\r\n\t\t\t\r\n\t\t\tif (this.song.setSongTheme == \"none\") {\r\n\t\t\t\tif (window.localStorage.getItem(\"modboxTheme\") != null) {\r\n\t\t\t\t\tColorConfig.setTheme(String(window.localStorage.getItem(\"modboxTheme\")));\r\n\t\t\t\t} else {\r\n\t\t\t\t\twindow.localStorage.setItem(\"modboxTheme\", \"default\");\r\n\t\t\t\t\tColorConfig.setTheme(\"default\");\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tColorConfig.setTheme(this.song.setSongTheme);\r\n\t\t\t}\r\n\r\n\t\t\tif (window.localStorage.getItem(\"layout\") != null) {\r\n\t\t\t\tLayout.setLayout(String(window.localStorage.getItem(\"layout\")));\r\n\t\t\t} else {\r\n\t\t\t\twindow.localStorage.setItem(\"layout\", \"small\");\r\n\t\t\t\tLayout.setLayout(\"small\");\r\n\t\t\t}\r\n\r\n\t\t\tlet state: HistoryState | null = window.history.state;\r\n\t\t\tif (state == null) {\r\n\t\t\t\t// When the page is first loaded, indicate that undo is NOT possible.\r\n\t\t\t\tstate = {canUndo: false, sequenceNumber: 0, bar: 0, channel: 0, prompt: null};\r\n\t\t\t\twindow.history.replaceState(state, \"\", \"#\" + this.song.toBase64String());\r\n\t\t\t}\r\n\t\t\twindow.addEventListener(\"hashchange\", this._whenHistoryStateChanged);\r\n\t\t\twindow.addEventListener(\"popstate\", this._whenHistoryStateChanged);\r\n\t\t\t\r\n\t\t\tthis.bar = state.bar;\r\n\t\t\tthis.channel = state.channel;\r\n\t\t\tthis._barFromCurrentState = state.bar;\r\n\t\t\tthis._channelFromCurrentState = state.channel;\r\n\t\t\tthis.barScrollPos = Math.max(0, this.bar - (this.trackVisibleBars - 6));\r\n\t\t\tthis.prompt = state.prompt;\r\n\t\t\t\r\n\t\t\t// For all input events, catch them when they are about to finish bubbling,\r\n\t\t\t// presumably after all handlers are done updating the model and update the\r\n\t\t\t// view before the screen renders. mouseenter and mouseleave do not bubble,\r\n\t\t\t// but they are immediately followed by mousemove which does. \r\n\t\t\tfor (const eventName of [\"input\", \"change\", \"click\", \"keyup\", \"keydown\", \"mousedown\", \"mousemove\", \"mouseup\", \"touchstart\", \"touchmove\", \"touchend\", \"touchcancel\"]) {\r\n\t\t\t\twindow.addEventListener(eventName, this._cleanDocument);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tprivate _whenHistoryStateChanged = (): void => {\r\n\t\t\tlet state: HistoryState | null = window.history.state;\r\n\t\t\t\r\n\t\t\t// We're listening for both hashchanged and popstate, which often fire together.\r\n\t\t\t// Abort if we've already handled the current state. \r\n\t\t\tif (state && state.sequenceNumber == this._sequenceNumber) return;\r\n\t\t\t\r\n\t\t\tif (state == null) {\r\n\t\t\t\t// The user changed the hash directly.\r\n\t\t\t\tthis._sequenceNumber++;\r\n\t\t\t\tstate = {canUndo: true, sequenceNumber: this._sequenceNumber, bar: this.bar, channel: this.channel, prompt: this.prompt};\r\n\t\t\t\tnew ChangeSong(this, location.hash);\r\n\t\t\t\twindow.history.replaceState(state, \"\", \"#\" + this.song.toBase64String());\r\n\t\t\t} else {\r\n\t\t\t\tif (state.sequenceNumber == this._sequenceNumber - 1) {\r\n\t\t\t\t\t// undo:\r\n\t\t\t\t\tthis.bar = this._barFromCurrentState;\r\n\t\t\t\t\tthis.channel = this._channelFromCurrentState;\r\n\t\t\t\t} else if (state.sequenceNumber != this._sequenceNumber) {\r\n\t\t\t\t\t// redo, or jump multiple steps in history:\r\n\t\t\t\t\tthis.bar = state.bar;\r\n\t\t\t\t\tthis.channel = state.channel;\r\n\t\t\t\t}\r\n\t\t\t\tthis._sequenceNumber = state.sequenceNumber;\r\n\t\t\t\tthis.prompt = state.prompt;\r\n\t\t\t\tnew ChangeSong(this, location.hash);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._barFromCurrentState = state.bar;\r\n\t\t\tthis._channelFromCurrentState = state.channel;\r\n\t\t\t\r\n\t\t\t//this.barScrollPos = Math.min(this.bar, Math.max(this.bar - (this.trackVisibleBars - 1), this.barScrollPos));\r\n\t\t\t\r\n\t\t\tthis.forgetLastChange();\r\n\t\t\tthis.notifier.notifyWatchers();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _cleanDocument = (): void => {\r\n\t\t\tthis.notifier.notifyWatchers();\r\n\t\t}\r\n\t\t\r\n\t\tprivate _updateHistoryState = (): void => {\r\n\t\t\tthis._waitingToUpdateState = false;\r\n\t\t\tconst hash: string = \"#\" + this.song.toBase64String();\r\n\t\t\tlet state: HistoryState;\r\n\t\t\tif (this._shouldPushState) {\r\n\t\t\t\tthis._sequenceNumber++;\r\n\t\t\t\tstate = {canUndo: true, sequenceNumber: this._sequenceNumber, bar: this.bar, channel: this.channel, prompt: this.prompt};\r\n\t\t\t\twindow.history.pushState(state, \"\", hash);\r\n\t\t\t} else {\r\n\t\t\t\tstate = {canUndo: true, sequenceNumber: this._sequenceNumber, bar: this.bar, channel: this.channel, prompt: this.prompt};\r\n\t\t\t\twindow.history.replaceState(state, \"\", hash);\r\n\t\t\t}\r\n\t\t\tthis._barFromCurrentState = state.bar;\r\n\t\t\tthis._channelFromCurrentState = state.channel;\r\n\t\t\tthis._shouldPushState = false;\r\n\t\t}\r\n\t\t\r\n\t\tpublic record(change: Change, replaceState: boolean = false): void {\r\n\t\t\tif (change.isNoop()) {\r\n\t\t\t\tthis._recentChange = null;\r\n\t\t\t\tif (replaceState) {\r\n\t\t\t\t\twindow.history.back();\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis._recentChange = change;\r\n\t\t\t\tif (!replaceState) {\r\n\t\t\t\t\tthis._shouldPushState = true;\r\n\t\t\t\t}\r\n\t\t\t\tif (!this._waitingToUpdateState) {\r\n\t\t\t\t\twindow.requestAnimationFrame(this._updateHistoryState);\r\n\t\t\t\t\tthis._waitingToUpdateState = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tpublic openPrompt(prompt: string): void {\r\n\t\t\tthis.prompt = prompt;\r\n\t\t\tconst hash: string = \"#\" + this.song.toBase64String();\r\n\t\t\tthis._sequenceNumber++;\r\n\t\t\tconst state = {canUndo: true, sequenceNumber: this._sequenceNumber, bar: this.bar, channel: this.channel, prompt: this.prompt};\r\n\t\t\twindow.history.pushState(state, \"\", hash);\r\n\t\t}\r\n\t\t\r\n\t\tpublic undo(): void {\r\n\t\t\tconst state: HistoryState = window.history.state;\r\n\t\t\tif (state.canUndo) window.history.back();\r\n\t\t}\r\n\t\t\r\n\t\tpublic redo(): void {\r\n\t\t\twindow.history.forward();\r\n\t\t}\r\n\t\t\r\n\t\tpublic setProspectiveChange(change: Change | null): void {\r\n\t\t\tthis._recentChange = change;\r\n\t\t}\r\n\t\t\r\n\t\tpublic forgetLastChange(): void {\r\n\t\t\tthis._recentChange = null;\r\n\t\t}\r\n\t\t\r\n\t\tpublic lastChangeWas(change: Change | null): boolean {\r\n\t\t\treturn change != null && change == this._recentChange;\r\n\t\t}\r\n\t\t\r\n\t\tpublic setVolume(val: number): void {\r\n\t\t\tthis.prefs.volume = val;\r\n\t\t\tthis.prefs.save();\r\n\t\t\tthis.synth.volume = this._calcVolume();\r\n\t\t}\r\n\t\t\r\n\t\tpublic getMobileLayout(): boolean {\r\n\t\t\treturn window.innerWidth <= 710;\r\n\t\t}\r\n\r\n\t\tpublic getFullScreen(): boolean {\r\n\t\t\treturn !this.getMobileLayout() && (this.prefs.layout != \"small\");\r\n\t\t}\r\n\r\n\t\tprivate _calcVolume(): number {\r\n\t\t\treturn Math.min(1.0, Math.pow(this.prefs.volume / 50.0, 0.5)) * Math.pow(2.0, (this.prefs.volume - 75.0) / 25.0);\r\n\t\t}\r\n\t\t\r\n\t\tpublic getCurrentPattern(): Pattern | null {\r\n\t\t\treturn this.song.getPattern(this.channel, this.bar);\r\n\t\t}\r\n\t\t\r\n\t\tpublic getCurrentInstrument(): number {\r\n\t\t\tconst pattern: Pattern | null = this.getCurrentPattern();\r\n\t\t\treturn pattern == null ? 0 : pattern.instrument;\r\n\t\t}\r\n\r\n\t\tpublic getVisibleOctaveCount(): number {\r\n\t\treturn this.prefs.visibleOctaves;\r\n\t\t}\r\n\t\t\r\n\t\tpublic getVisiblePitchCount(): number {\r\n\t\t\treturn this.getVisibleOctaveCount() * Config.pitchesPerOctave + 1;\r\n\t\t}\r\n\r\n\t\tpublic getBaseVisibleOctave(channel: number): number {\r\n\t\treturn this.song.channels[channel].octave;\r\n\t\t}\r\n\t}\r\n\r\n","/*\r\nCopyright (C) 2018 John Nesky\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of \r\nthis software and associated documentation files (the \"Software\"), to deal in \r\nthe Software without restriction, including without limitation the rights to \r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \r\nof the Software, and to permit persons to whom the Software is furnished to do \r\nso, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all \r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \r\nSOFTWARE.\r\n*/\r\n\r\nimport {HTML} from \"imperative-html/dist/esm/elements-strict\";\r\nimport { ColorConfig } from \"./ColorConfig\";\r\n\r\ndocument.head.appendChild(HTML.style({ type: \"text/css\" }, `\r\n\r\n:root {\r\n--drum-symbol: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"40\" viewBox=\"0 0 32 40\"> \\\r\n\t\t\t<defs> \\\r\n\t\t\t\t<linearGradient id=\"gold1\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\"> \\\r\n\t\t\t\t\t<stop offset=\"0%\" stop-color=\"%237e3302\"/> \\\r\n\t\t\t\t\t<stop offset=\"40%\" stop-color=\"%23ffec6b\"/> \\\r\n\t\t\t\t\t<stop offset=\"100%\" stop-color=\"%237e3302\"/> \\\r\n\t\t\t\t</linearGradient> \\\r\n\t\t\t\t<linearGradient id=\"gold2\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\"> \\\r\n\t\t\t\t\t<stop offset=\"0%\" stop-color=\"%23faaf7d\"/> \\\r\n\t\t\t\t\t<stop offset=\"15%\" stop-color=\"%23fffba9\"/> \\\r\n\t\t\t\t\t<stop offset=\"40%\" stop-color=\"%23ffffe3\"/> \\\r\n\t\t\t\t\t<stop offset=\"65%\" stop-color=\"%23fffba9\"/> \\\r\n\t\t\t\t\t<stop offset=\"100%\" stop-color=\"%23faaf7d\"/> \\\r\n\t\t\t\t</linearGradient> \\\r\n\t\t\t\t<radialGradient id=\"gold3\" cx=\"0%\" cy=\"0%\" r=\"100%\"> \\\r\n\t\t\t\t\t<stop offset=\"0%\" stop-color=\"%23ffffe3\"/> \\\r\n\t\t\t\t\t<stop offset=\"50%\" stop-color=\"%23ffec6b\"/> \\\r\n\t\t\t\t\t<stop offset=\"100%\" stop-color=\"%237e3302\"/> \\\r\n\t\t\t\t</radialGradient> \\\r\n\t\t\t\t<linearGradient id=\"red\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\"> \\\r\n\t\t\t\t\t<stop offset=\"0%\" stop-color=\"%23641919\"/> \\\r\n\t\t\t\t\t<stop offset=\"40%\" stop-color=\"%23cd2c2c\"/> \\\r\n\t\t\t\t\t<stop offset=\"100%\" stop-color=\"%23641919\"/> \\\r\n\t\t\t\t</linearGradient> \\\r\n\t\t\t\t<radialGradient id=\"membrane\"> \\\r\n\t\t\t\t\t<stop offset=\"10%\" stop-color=\"%23cccccc\" /> \\\r\n\t\t\t\t\t<stop offset=\"90%\" stop-color=\"%23f6f6f7\" /> \\\r\n\t\t\t\t\t<stop offset=\"100%\" stop-color=\"%23999\" /> \\\r\n\t\t\t\t</radialGradient> \\\r\n\t\t\t</defs> \\\r\n\t\t\t<ellipse cx=\"16\" cy=\"26\" rx=\"16\" ry=\"14\" fill=\"rgba(0,0,0,0.5)\"/> \\\r\n\t\t\t<ellipse cx=\"16\" cy=\"25\" rx=\"16\" ry=\"14\" fill=\"url(%23gold1)\"/> \\\r\n\t\t\t<rect x=\"0\" y=\"23\" width=\"32\" height=\"2\" fill=\"url(%23gold1)\"/> \\\r\n\t\t\t<ellipse cx=\"16\" cy=\"23\" rx=\"16\" ry=\"14\" fill=\"url(%23gold2)\"/> \\\r\n\t\t\t<ellipse cx=\"16\" cy=\"23\" rx=\"15\" ry=\"13\" fill=\"url(%23red)\"/> \\\r\n\t\t\t<rect x=\"1\" y=\"17\" width=\"30\" height=\"6\" fill=\"url(%23red)\"/> \\\r\n\t\t\t<rect x=\"5\" y=\"27\" width=\"1\" height=\"5\" rx=\"0.5\" fill=\"rgba(0,0,0,0.5)\"/> \\\r\n\t\t\t<rect x=\"15\" y=\"31\" width=\"2\" height=\"5\" rx=\"1\" fill=\"rgba(0,0,0,0.5)\"/> \\\r\n\t\t\t<rect x=\"26\" y=\"27\" width=\"1\" height=\"5\" rx=\"0.5\" fill=\"rgba(0,0,0,0.5)\"/> \\\r\n\t\t\t<rect x=\"5\" y=\"26\" width=\"1\" height=\"5\" rx=\"0.5\" fill=\"url(%23gold3)\"/> \\\r\n\t\t\t<rect x=\"15\" y=\"30\" width=\"2\" height=\"5\" rx=\"1\" fill=\"url(%23gold3)\"/> \\\r\n\t\t\t<rect x=\"26\" y=\"26\" width=\"1\" height=\"5\" rx=\"0.5\" fill=\"url(%23gold3)\"/> \\\r\n\t\t\t<ellipse cx=\"16\" cy=\"18\" rx=\"15\" ry=\"13\" fill=\"rgba(0,0,0,0.5)\"/> \\\r\n\t\t\t<ellipse cx=\"16\" cy=\"16\" rx=\"16\" ry=\"14\" fill=\"url(%23gold1)\"/> \\\r\n\t\t\t<rect x=\"0\" y=\"14\" width=\"32\" height=\"2\" fill=\"url(%23gold1)\"/> \\\r\n\t\t\t<ellipse cx=\"16\" cy=\"14\" rx=\"16\" ry=\"14\" fill=\"url(%23gold2)\"/> \\\r\n\t\t\t<ellipse cx=\"16\" cy=\"14\" rx=\"15\" ry=\"13\" fill=\"url(%23membrane)\"/> \\\r\n\t\t</svg>');\r\n\t--piano-key-symbol: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"15\" preserveAspectRatio=\"none\" viewBox=\"0 -1 32 15\"> \\\r\n\t\t\t<defs> \\\r\n\t\t\t\t<linearGradient id=\"shadow\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\"> \\\r\n\t\t\t\t\t<stop offset=\"0%\" stop-color=\"rgba(0,0,0,0.5)\"/> \\\r\n\t\t\t\t\t<stop offset=\"100%\" stop-color=\"transparent\"/> \\\r\n\t\t\t\t</linearGradient> \\\r\n\t\t\t</defs> \\\r\n\t\t\t<rect x=\"-1\" y=\"1\" width=\"31\" height=\"1\" rx=\"0.6\" fill=\"rgba(255,255,255,0.4)\"/> \\\r\n\t\t\t<path d=\"M -1 11 L 30 11 L 30 2 L 33 -1 L 33 14 L -1 14 z\" fill=\"rgba(0,0,0,0.7)\"/> \\\r\n\t\t\t<rect x=\"-1\" y=\"-1\" width=\"19\" height=\"15\" fill=\"url(%23shadow)\"/> \\\r\n\t\t</svg>');\r\n}\r\n\r\nhtml {\r\nbackground: ${ColorConfig.pageMargin};\r\n}\r\n\r\n.beepboxEditor .drum-button {\r\n\tflex: 1;\r\n\tbackground-color: transparent;\r\n\tbackground-image: var(--drum-symbol);\r\n\tbackground-repeat: no-repeat;\r\n\tbackground-position: center;\r\n}\r\n\r\n.beepboxEditor .piano-button.pressed, .beepboxEditor .drum-button.pressed {\r\n\tfilter: brightness(0.5);\r\n}\r\n\r\n.beepboxEditor .piano-button {\r\n\tflex: 1;\r\n\tposition: relative;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n}\r\n.beepboxEditor .piano-button::before {\r\n\tcontent: \"\";\r\n\tposition: absolute;\r\n\tleft: 0;\r\n\ttop: 0;\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\tpointer-events: none;\r\n\tbackground-image: var(--piano-key-symbol);\r\n\tbackground-repeat: no-repeat;\r\n\tbackground-position: center;\r\n\tbackground-size: 100% 115.38%;\r\n}\r\n.beepboxEditor .piano-button.disabled::after {\r\n\tcontent: \"\";\r\n\tposition: absolute;\r\n\tright: 0;\r\n\ttop: 0;\r\n\twidth: 70%;\r\n\theight: 100%;\r\n\tpointer-events: none;\r\n\tbackground: ${ColorConfig.editorBackground};\r\n\t-webkit-mask-image: linear-gradient(90deg, transparent 0%, gray 70%, gray 100%);\r\n\t-webkit-mask-repeat: no-repeat;\r\n\t-webkit-mask-position: center;\r\n\tmask-image: linear-gradient(90deg, transparent 0%, gray 70%, gray 100%);\r\n\tmask-repeat: no-repeat;\r\n\tmask-position: center;\r\n}\r\n\r\n.beepboxEditor .piano-button.pressed, .beepboxEditor .drum-button.pressed {\r\n\tfilter: brightness(0.5);\r\n}\r\n\r\n.beepboxEditor {\r\n\tdisplay: grid;\r\n\tgrid-template-areas: \"pattern-area settings-area advanced-settings-area\" \"pattern-area   song-settings-area advanced-settings-area\" \"track-area   song-settings-area advanced-settings-area\";\r\n\t-webkit-touch-callout: none;\r\n\t-webkit-user-select: none;\r\n\t-khtml-user-select: none;\r\n\t-moz-user-select: none;\r\n\t-ms-user-select: none;\r\n\tuser-select: none;\r\n\tposition: relative;\r\n\ttouch-action: manipulation;\r\n\tcursor: default;\r\n\tfont-size: small;\r\n\tbackground: ${ColorConfig.editorBackground};\r\n}\r\n\r\n.beepboxEditor .theme-option input:checked ~ * {\r\n\tcolor: #fff;\r\n}\r\n\r\n.beepboxEditor .theme-option {\r\n\tcolor: #999;\r\n}\r\n\r\n\r\n.hintButton {\r\n\twidth: 0.5em; \r\n\tdisplay: flex; \r\n\talign-items: center;\r\n}\r\n\r\n.beepboxEditor div {\r\n\tmargin: 0;\r\n\tpadding: 0;\r\n}\r\n\r\n.beepboxEditor .promptContainer {\r\n\tposition: absolute;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\t/*background: rgba(0,0,0,0.5);*/\r\n\tdisplay: flex;\r\n\tjustify-content: center;\r\n\talign-items: center;\r\n}\r\n\r\n.beepboxEditor .prompt {\r\n\tmargin: auto;\r\n\ttext-align: center;\r\n\tbackground: ${ColorConfig.editorBackground};\r\n\tborder-radius: 15px;\r\n\tborder: 4px solid #444;\r\n\tcolor: #fff;\r\n\tpadding: 20px;\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n}\r\n\r\n.beepboxEditor .prompt > *:not(:first-child) {\r\n\tmargin-top: 1.5em;\r\n}\r\n\r\n/* Use psuedo-elements to add cross-browser up & down arrows to select elements: */\r\n.beepboxEditor .selectContainer {\r\n\tposition: relative;\r\n\twidth: 100%;\r\n}\r\n.beepboxEditor .selectContainer:not(.menu)::before {\r\n\tcontent: \"\";\r\n\tposition: absolute;\r\n\tright: 0.3em;\r\n\ttop: 0.4em;\r\n\tborder-bottom: 0.4em solid currentColor;\r\n\tborder-left: 0.3em solid transparent;\r\n\tborder-right: 0.3em solid transparent;\r\n\tpointer-events: none;\r\n}\r\n.beepboxEditor .selectContainer:not(.menu)::after {\r\n\tcontent: \"\";\r\n\tposition: absolute;\r\n\tright: 0.3em;\r\n\tbottom: 0.4em;\r\n\tborder-top: 0.4em solid currentColor;\r\n\tborder-left: 0.3em solid transparent;\r\n\tborder-right: 0.3em solid transparent;\r\n\tpointer-events: none;\r\n}\r\n.beepboxEditor .selectContainer.menu::after {\r\n\tcontent: \"\";\r\n\tposition: absolute;\r\n\tright: 0.7em;\r\n\tmargin: auto;\r\n\ttop: 0;\r\n\tbottom: 0;\r\n\theight: 0;\r\n\tborder-top: 0.4em solid currentColor;\r\n\tborder-left: 0.3em solid transparent;\r\n\tborder-right: 0.3em solid transparent;\r\n\tpointer-events: none;\r\n}\r\n.beepboxEditor select {\r\n\tmargin: 0;\r\n\tpadding: 0 0.3em;\r\n\tdisplay: block;\r\n\theight: 2em;\r\n\tborder: none;\r\n\tborder-radius: 0.4em;\r\n\tbackground: ${ColorConfig.uiWidgetBackground};\r\n\tcolor: inherit;\r\n\tfont-size: inherit;\r\n\tcursor: pointer;\r\n\tfont-family: inherit;\r\n\r\n\twidth:100%;\r\n\r\n\t-webkit-appearance:none;\r\n\t-moz-appearance: none;\r\n\tappearance: none;\r\n}\r\n.beepboxEditor .menu select {\r\n\tpadding: 0 2em;\r\n}\r\n.beepboxEditor select:focus {\r\n\tbackground: ${ColorConfig.uiWidgetFocus};\r\n\toutline: none;\r\n}\r\n.beepboxEditor .menu select {\r\n\ttext-align: center;\r\n\ttext-align-last: center;\r\n}\r\n\r\n/* This makes it look better in firefox on my computer... What about others?\r\n@-moz-document url-prefix() {\r\n\t.beepboxEditor select { padding: 0 2px; }\r\n}\r\n*/\r\n.beepboxEditor button {\r\n\tmargin: 0;\r\n\tposition: relative;\r\n\theight: 2em;\r\n\tborder: none;\r\n\tborder-radius: 0.4em;\r\n\tbackground: ${ColorConfig.uiWidgetBackground};\r\n\tcolor: inherit;\r\n\tfont-size: inherit;\r\n\tfont-family: inherit;\r\n\tcursor: pointer;\r\n}\r\n.beepboxEditor .numberInput {\r\n\twidth: 3em !important;\r\n  \tmargin-left: 1em;\r\n}\r\n.beepboxEditor button:focus {\r\n\tbackground: ${ColorConfig.uiWidgetFocus};\r\n\toutline: none;\r\n}\r\n.beepboxEditor button.playButton, .beepboxEditor button.pauseButton {\r\n\tpadding-left: 2em;\r\n}\r\n.beepboxEditor button.playButton::before {\r\n\tcontent: \"\";\r\n\tposition: absolute;\r\n\tleft: 0.7em;\r\n\ttop: 50%;\r\n\tmargin-top: -0.65em;\r\n\tborder-left: 1em solid currentColor;\r\n\tborder-top: 0.65em solid transparent;\r\n\tborder-bottom: 0.65em solid transparent;\r\n\tpointer-events: none;\r\n}\r\n.beepboxEditor button.pauseButton::before {\r\n\tcontent: \"\";\r\n\tposition: absolute;\r\n\tleft: 0.7em;\r\n\ttop: 50%;\r\n\tmargin-top: -0.65em;\r\n\twidth: 0.3em;\r\n\theight: 1.3em;\r\n\tbackground: currentColor;\r\n\tpointer-events: none;\r\n}\r\n.beepboxEditor button.pauseButton::after {\r\n\tcontent: \"\";\r\n\tposition: absolute;\r\n\tleft: 1.4em;\r\n\ttop: 50%;\r\n\tmargin-top: -0.65em;\r\n\twidth: 0.3em;\r\n\theight: 1.3em;\r\n\tbackground: currentColor;\r\n\tpointer-events: none;\r\n}\r\n\r\n.beepboxEditor button.prevBarButton::before {\r\n\tcontent: \"\";\r\n\tposition: absolute;\r\n\tleft: 50%;\r\n\ttop: 50%;\r\n\tmargin-left: -0.5em;\r\n\tmargin-top: -0.5em;\r\n\twidth: 0.2em;\r\n\theight: 1em;\r\n\tbackground: currentColor;\r\n\tpointer-events: none;\r\n}\r\n.beepboxEditor button.prevBarButton::after {\r\n\tcontent: \"\";\r\n\tposition: absolute;\r\n\tleft: 50%;\r\n\ttop: 50%;\r\n\tmargin-left: -0.3em;\r\n\tmargin-top: -0.5em;\r\n\tborder-right: 0.8em solid currentColor;\r\n\tborder-top: 0.5em solid transparent;\r\n\tborder-bottom: 0.5em solid transparent;\r\n\tpointer-events: none;\r\n}\r\n\r\n.beepboxEditor .song-settings-area {\r\n\tgrid-area: song-settings-area;\r\n}\r\n\r\n.beepboxEditor button.nextBarButton::before {\r\n\tcontent: \"\";\r\n\tposition: absolute;\r\n\tleft: 50%;\r\n\ttop: 50%;\r\n\tmargin-left: -0.5em;\r\n\tmargin-top: -0.5em;\r\n\tborder-left: 0.8em solid currentColor;\r\n\tborder-top: 0.5em solid transparent;\r\n\tborder-bottom: 0.5em solid transparent;\r\n\tpointer-events: none;\r\n}\r\n.beepboxEditor button.nextBarButton::after {\r\n\tcontent: \"\";\r\n\tposition: absolute;\r\n\tleft: 50%;\r\n\ttop: 50%;\r\n\tmargin-left: 0.3em;\r\n\tmargin-top: -0.5em;\r\n\twidth: 0.2em;\r\n\theight: 1em;\r\n\tbackground: currentColor;\r\n\tpointer-events: none;\r\n}\r\n\r\n.beepboxEditor canvas {\r\n\toverflow: hidden;\r\n\tposition: absolute;\r\n\tdisplay: block;\r\n}\r\n\r\n.beepboxEditor .trackContainer {\r\n\toverflow-x: hidden;\r\n}\r\n\r\n.beepboxEditor .trackAndMuteContainer {\r\n\tdisplay: flex;\r\n\talign-items: flex-start;\r\n\twidth: 100%;\r\n\tmin-height: 0;\r\n\tflex: 1;\r\n\toverflow-x: hidden;\r\n\tposition: relative;\r\n}\r\n\r\n.beepboxEditor .selectRow {\r\n\tmargin: 0;\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\talign-items: center;\r\n\tjustify-content: space-between;\r\n}\r\n\r\n.beepboxEditor .selectRow > span {\r\n\tcolor: ${ColorConfig.secondaryText};\r\n}\r\n\r\n.beepboxEditor .inputRow {\r\n\tmargin: 0;\r\n\theight: 2.5em;\r\n\tdisplay: flex;\r\n\tflex-direction: row;\r\n\talign-items: center;\r\n\tjustify-content: space-between;\r\n}\r\n\r\n.beepboxEditor .inputRow > span {\r\n\tcolor: ${ColorConfig.secondaryText};\r\n}\r\n\r\n.beepboxEditor .operatorRow {\r\n\tmargin: 0;\r\n\theight: 2.5em;\r\n\tdisplay: flex;\r\n\tflex-direction: row;\r\n\talign-items: center;\r\n}\r\n\r\n.beepboxEditor .operatorRow > * {\r\n\tflex-grow: 1;\r\n\tflex-shrink: 1;\r\n}\r\n\r\n.beepboxEditor .settings-area {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n}\r\n\r\n.beepboxEditor .editor-widgets {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n}\r\n\r\n.beepboxEditor .editor-menus {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n}\r\n\r\n.beepboxEditor .editor-settings {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tmargin-left: 6px;\r\n}\r\n\r\n.beepboxEditor .layout-option {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tcursor: pointer;\r\n\tcolor: ${ColorConfig.secondaryText};\r\n\twidth: 25%;\r\n}\r\n\r\n.beepboxEditor .layout-option input {\r\n\tdisplay: none;\r\n}\r\n\r\n.beepboxEditor .layout-option input:checked ~ * {\r\n\tcolor: ${ColorConfig.primaryText};\r\n}\r\n\r\n.beepboxEditor .editor-song-settings {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n}\r\n\r\n.beepboxEditor .editor-instrument-settings {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n}\r\n.beepboxEditor .advanced-settings-area {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tgrid-area: advanced-settings-area;\r\n}\r\n\r\n.beepboxEditor .editorBox {\r\n\tgrid-area: pattern-area;\r\n}\r\n\r\n.beepboxEditor .track-area {\r\n\tgrid-area: track-area;\r\n}\r\n\r\n.beepboxEditor .editor-right-menus {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n}\r\n\r\n.beepboxEditor .editor-right-settings {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n}\r\n\r\n.beepboxEditor .editor-right-song-settings {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n}\r\n\r\n.beepboxEditor .editor-right-instrument-settings {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n}\r\n\r\n.beepboxEditor .editor-right-side-top > *, .beepboxEditor .editor-right-side-bottom > * {\r\n\tflex-shrink: 0;\r\n}\r\n\r\n.beepboxEditor input[type=text], .beepboxEditor input[type=number] {\r\n\tfont-size: inherit;\r\n\tbackground: transparent;\r\n\tborder: 1px solid #777;\r\n\tcolor: white;\r\n}\r\n\r\n.beepboxEditor input[type=checkbox] {\r\n  transform: scale(1.5);\r\n}\r\n\r\n.beepboxEditor input[type=range] {\r\n\t-webkit-appearance: none;\r\n\tcolor: inherit;\r\n\twidth: 100%;\r\n\theight: 2em;\r\n\tfont-size: inherit;\r\n\tmargin: 0;\r\n\tcursor: pointer;\r\n\tbackground-color: ${ColorConfig.editorBackground};\r\n\ttouch-action: pan-y;\r\n}\r\n.beepboxEditor input[type=range]:focus {\r\n\toutline: none;\r\n}\r\n.beepboxEditor input[type=range]::-webkit-slider-runnable-track {\r\n\twidth: 100%;\r\n\theight: 0.5em;\r\n\tcursor: pointer;\r\n\tbackground: ${ColorConfig.uiWidgetBackground};\r\n}\r\n.beepboxEditor input[type=range]::-webkit-slider-thumb {\r\n\theight: 2em;\r\n\twidth: 0.5em;\r\n\tborder-radius: 0.25em;\r\n\tbackground: currentColor;\r\n\tcursor: pointer;\r\n\t-webkit-appearance: none;\r\n\tmargin-top: -0.75em;\r\n}\r\n.beepboxEditor input[type=range]:focus::-webkit-slider-runnable-track {\r\n\tbackground: ${ColorConfig.uiWidgetFocus};\r\n}\r\n.beepboxEditor input[type=range]::-moz-range-track {\r\n\twidth: 100%;\r\n\theight: 0.5em;\r\n\tcursor: pointer;\r\n\tbackground: ${ColorConfig.uiWidgetBackground};\r\n}\r\n.beepboxEditor input[type=range]:focus::-moz-range-track {\r\n\tbackground: ${ColorConfig.uiWidgetFocus};\r\n}\r\n.beepboxEditor input[type=range]::-moz-range-thumb {\r\n\theight: 2em;\r\n\twidth: 0.5em;\r\n\tborder-radius: 0.25em;\r\n\tborder: none;\r\n\tbackground: currentColor;\r\n\tcursor: pointer;\r\n}\r\n.beepboxEditor input[type=range]::-ms-track {\r\n\twidth: 100%;\r\n\theight: 0.5em;\r\n\tcursor: pointer;\r\n\tbackground: ${ColorConfig.uiWidgetBackground};\r\n\tborder-color: transparent;\r\n}\r\n.beepboxEditor input[type=range]:focus::-ms-track {\r\n\tbackground: ${ColorConfig.uiWidgetFocus};\r\n}\r\n.beepboxEditor input[type=range]::-ms-thumb {\r\n\theight: 2em;\r\n\twidth: 0.5em;\r\n\tborder-radius: 0.25em;\r\n\tbackground: currentColor;\r\n\tcursor: pointer;\r\n}\r\n.beepboxEditor .hintButton {\r\n\tborder: 1px solid currentColor;\r\n\tborder-radius: 50%;\r\n\ttext-decoration: none;\r\n\theight: 1em;\r\n\ttext-align: center;\r\n\tmargin-right: .4em;\r\n\tcursor: pointer;\r\n}\r\n\r\n/* wide screen */\r\n@media (min-width: 501px) {\r\n\t#beepboxEditorContainer {\r\n\t\tdisplay: table;\r\n\t}\r\n\t.beepboxEditor {\r\n\t\tflex-direction: row;\r\n\t}\r\n\t.beepboxEditor:focus-within {\r\n\t\toutline: 3px solid #555;\r\n\t}\r\n\t.beepboxEditor .trackContainer {\r\n\t\twidth: 512px;\r\n\t\tgrid-area: track-editor;\r\n\t}\r\n\t.beepboxEditor .trackSelectBox {\r\n\t\tdisplay: none;\r\n\t}\r\n\t.beepboxEditor .playback-controls {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t}\r\n\t.beepboxEditor .playback-bar-controls {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row;\r\n\t\tmargin: .2em 0;\r\n\t}\r\n\t.beepboxEditor .playback-volume-controls {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row;\r\n\t\tmargin: .2em 0;\r\n\t\talign-items: center;\r\n\t}\r\n\t.beepboxEditor .pauseButton, .beepboxEditor .playButton {\r\n\t\tflex-grow: 1;\r\n\t}\r\n\t.beepboxEditor .nextBarButton, .beepboxEditor .prevBarButton {\r\n\t\tflex-grow: 1;\r\n\t\tmargin-left: 10px;\r\n\t}\r\n\t.beepboxEditor .settings-area {\r\n\t\tmargin-left: 6px;\r\n\t\twidth: 14em;\r\n\t\tflex-direction: column;\r\n\t\tgrid-area: settings-area;\r\n\t}\r\n\t.beepboxEditor .advanced-settings-area {\r\n\t\tmargin-left: 6px;\r\n\t\twidth: 14em;\r\n\t\tflex-direction: column;\r\n\t}\r\n\t.beepboxEditor .editor-widgets {\r\n\t\tflex-grow: 1;\r\n\t}\r\n\t.beepboxEditor .editor-right-widgets {\r\n\t\tflex-grow: 1;\r\n\t}\r\n\t.beepboxEditor .editor-right-settings input, .beepboxEditor .editor-right-settings select {\r\n\t\twidth: 100%;\r\n\t}\r\n\t.beepboxEditor .editor-menus > * {\r\n\t\tflex-grow: 1;\r\n\t\tmargin: .2em 0;\r\n\t}\r\n\t.beepboxEditor .editor-right-menus > * {\r\n\t\tflex-grow: 1;\r\n\t\tmargin: .2em 0;\r\n\t}\r\n\t.beepboxEditor .editor-menus > button {\r\n\t\tpadding: 0 2em;\r\n\t\twhite-space: nowrap;\r\n\t}\r\n\t.beepboxEditor .editor-right-menus > button {\r\n\t\tpadding: 0 2em;\r\n\t\twhite-space: nowrap;\r\n\t}\r\n}\r\n\r\n/* narrow screen */\r\n@media (max-width: 500px) {\r\n\t.beepboxEditor {\r\n\t\tflex-direction: column;\r\n\t}\r\n\t.beepboxEditor:focus-within {\r\n\t\toutline: none;\r\n\t}\r\n\t.beepboxEditor .editorBox {\r\n\t\tmax-height: 75vh;\r\n\t\tgrid-area: pattern-area;\r\n\t}\r\n\t.beepboxEditor .editor-menus {\r\n\t\tflex-direction: row;\r\n\t}\r\n\t.beepboxEditor .editor-right-menus {\r\n\t\tflex-direction: row;\r\n\t}\r\n\t.beepboxEditor .editor-menus > * {\r\n\t\tflex-grow: 1;\r\n\t\tmargin: .10em;\r\n\t}\r\n\t.beepboxEditor .editor-right-menus > * {\r\n\t\tflex-grow: 1;\r\n\t\tmargin: .2em;\r\n\t}\r\n\t.beepboxEditor .editor-menus > button {\r\n\t\tpadding-left: 2em;\r\n\t\twhite-space: nowrap;\r\n\t}\r\n\t.beepboxEditor .editor-right-menus > button {\r\n\t\tpadding-left: 2em;\r\n\t\twhite-space: nowrap;\r\n\t}\r\n\t.beepboxEditor .trackContainer {\r\n\t\toverflow-x: auto;\r\n\t}\r\n\t.beepboxEditor .barScrollBar {\r\n\t\tdisplay: none;\r\n\t}\r\n\t.beepboxEditor .playback-controls {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row;\r\n\t\tmargin: .2em 0;\r\n\t}\r\n\t.beepboxEditor .playback-bar-controls {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row;\r\n\t\tflex-grow: 1;\r\n\t}\r\n\t.beepboxEditor .playback-volume-controls {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row;\r\n\t\talign-items: center;\r\n\t\tflex-grow: 1;\r\n\t\tmargin: 0 .2em;\r\n\t}\r\n\t.beepboxEditor .settings-area {\r\n\t\tflex-direction: column-reverse;\r\n\t}\r\n\t.beepboxEditor .editor-settings {\r\n\t\tflex-direction: row;\r\n\t\tmargin-left: 6px;\r\n\t}\r\n\t.beepboxEditor .advanced-settings-area {\r\n\t\tflex-direction: column-reverse;\r\n\t}\r\n\t.beepboxEditor .editor-right-settings {\r\n\t\tflex-direction: row;\r\n\t}\r\n\t.beepboxEditor .pauseButton, .beepboxEditor .playButton,\r\n\t.beepboxEditor .nextBarButton, .beepboxEditor .prevBarButton {\r\n\t\tflex-grow: 1;\r\n\t\tmargin: 0 .2em;\r\n\t}\r\n\t.beepboxEditor .editor-song-settings, .beepboxEditor .editor-instrument-settings {\r\n\t\tflex-grow: 1;\r\n\t\tmargin: 0 .2em;\r\n\t}\r\n\t.beepboxEditor .editor-right-song-settings, .beepboxEditor .editor-right-instrument-settings {\r\n\t\tflex-grow: 1;\r\n\t\tmargin: 0 .2em;\r\n\t}\r\n\t.beepboxEditor .editor-settings input, .beepboxEditor .editor-settings .selectContainer {\r\n\t\twidth: 100%;\r\n\t}\r\n\t.beepboxEditor .editor-right-settings input, .beepboxEditor .editor-right-settings .selectContainer {\r\n\t\twidth: 100%;\r\n\t}\r\n\t.beepboxEditor .editor-settings select {\r\n\t\twidth: 100%;\r\n\t}\r\n\t.beepboxEditor .editor-right-settings select {\r\n\t\twidth: 100%;\r\n\t}\r\n\t.fullWidthOnly {\r\n\t\tdisplay: none;\r\n\t}\r\n\tp {\r\n\t\tmargin: 1em 0.5em;\r\n\t}\r\n}\r\n`));\r\n\t\r\n","// Copyright (c) 2012-2022 John Nesky and contributing authors, distributed under the MIT license, see accompanying the LICENSE.md file.\r\n\r\nimport {InstrumentType, Config} from \"../synth/SynthConfig\";\r\nimport {isMobile, SongEditor} from \"./SongEditor\";\r\nimport {Synth} from \"../synth/synth\";\r\nimport {Instrument, Channel, NotePin, Note, Pattern, Song } from \"../synth/song\";\r\nimport {SongDocument} from \"./SongDocument\";\r\nimport {ExportPrompt} from \"./ExportPrompt\";\r\nimport \"./style\"; // Import for the side effects, there's no exports.\r\n\r\nconst doc: SongDocument = new SongDocument(location.hash);\r\nconst editor: SongEditor = new SongEditor(doc);\r\nconst beepboxEditorContainer: HTMLElement = document.getElementById(\"beepboxEditorContainer\")!;\r\nbeepboxEditorContainer.appendChild(editor.mainLayer);\r\neditor.whenUpdated();\r\neditor.mainLayer.focus();\r\n\r\nif (!isMobile && doc.prefs.autoPlay) {\r\n\tfunction autoplay(): void {\r\n\t\tif (!document.hidden) {\r\n\t\t\tdoc.synth.play();\r\n\t\t\teditor.updatePlayButton();\r\n\t\t\twindow.removeEventListener(\"visibilitychange\", autoplay);\r\n\t\t}\r\n\t}\r\n\tif (document.hidden) {\r\n\t\t// Wait until the tab is visible to autoplay:\r\n\t\twindow.addEventListener(\"visibilitychange\", autoplay);\r\n\t} else {\r\n\t\tautoplay();\r\n\t}\r\n}\r\n\r\n// BeepBox uses browser history state as its own undo history. Browsers typically\r\n// remember scroll position for each history state, but BeepBox users would prefer not \r\n// auto scrolling when undoing. Sadly this tweak doesn't work on Edge or IE.\r\nif (\"scrollRestoration\" in history) history.scrollRestoration = \"manual\";\r\n\r\neditor.updatePlayButton();\r\n\r\nif (\"serviceWorker\" in navigator) {\r\n\tnavigator.serviceWorker.register(\"/service_worker.js\", {updateViaCache: \"all\", scope: \"/\"}).catch(() => {});\r\n}\r\n\r\n// When compiling synth.ts as a standalone module named \"beepbox\", expose these classes as members to JavaScript:\r\nexport {InstrumentType, Config, NotePin, Note, Pattern, Instrument, Channel, Song, Synth, SongDocument, SongEditor, ExportPrompt};\r\n"],"names":["__values","div","select","option","button","input","a","span","form","label"],"mappings":";;;IAiCiB,SAAA,qBAAqB,CAAC,KAAkB,EAAE,MAAc,EAAA;IACvE,IAAA,KAAK,IAAI,CAAC,GAAW,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;IAC9C,QAAA,KAAK,CAAC,CAAC,CAAC,IAAI,MAAM,CAAC;IACnB,KAAA;IACF,CAAC;IAED,SAAS,UAAU,CAAC,CAAS,EAAA;IAC5B,IAAA,OAAO,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;IAC9B,CAAC;IAED,SAAS,SAAS,CAAC,CAAS,EAAA;IAC3B,IAAA,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC;IAAE,QAAA,MAAM,IAAI,KAAK,CAAC,wCAAwC,CAAC,CAAC;IAC9E,IAAA,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IAC9C,CAAC;IAKD,SAAS,gBAAgB,CAAC,KAAkB,EAAA;IAC3C,IAAA,MAAM,eAAe,GAAW,KAAK,CAAC,MAAM,CAAC;IAC7C,IAAA,MAAM,QAAQ,GAAW,SAAS,CAAC,eAAe,CAAC,CAAC;QACpD,IAAI,QAAQ,GAAG,EAAE;IAAE,QAAA,MAAM,IAAI,KAAK,CAAC,iDAAiD,CAAC,CAAC;IACtF,IAAA,MAAM,UAAU,GAAW,EAAE,GAAG,QAAQ,CAAC;QACzC,KAAK,IAAI,CAAC,GAAW,CAAC,EAAE,CAAC,GAAG,eAAe,EAAE,CAAC,EAAE,EAAE;IAEjD,QAAA,IAAI,CAAS,CAAC;YACd,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,MAAM,KAAK,CAAC,KAAK,CAAC,CAAC,GAAG,MAAM,KAAK,CAAC,CAAC,CAAC;YAC9C,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,MAAM,KAAK,CAAC,KAAK,CAAC,CAAC,GAAG,MAAM,KAAK,CAAC,CAAC,CAAC;YAC9C,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,MAAM,KAAK,CAAC,KAAK,CAAC,CAAC,GAAG,MAAM,KAAK,CAAC,CAAC,CAAC;YAC9C,CAAC,GAAG,CAAC,CAAC,CAAC,IAAc,CAAC,KAAK,CAAC,CAAC,GAAK,IAAI,KAAK,CAAC,CAAC,KAAK,UAAU,CAAC;YAC7D,IAAI,CAAC,GAAG,CAAC,EAAE;IACV,YAAA,IAAI,IAAI,GAAW,KAAK,CAAC,CAAC,CAAC,CAAC;gBAC5B,KAAK,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;IACpB,YAAA,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC;IAChB,SAAA;IACD,KAAA;IACF,CAAC;IAoNK,SAAU,2BAA2B,CAAC,KAAkB,EAAA;IAC7D,IAAA,MAAM,eAAe,GAAW,KAAK,CAAC,MAAM,CAAC;IAC7C,IAAA,MAAM,WAAW,GAAW,SAAS,CAAC,eAAe,CAAC,CAAC;QACvD,IAAI,eAAe,GAAG,CAAC;IAAE,QAAA,MAAM,IAAI,KAAK,CAAC,sCAAsC,CAAC,CAAC;IAGjF,IAAA,KAAK,IAAI,IAAI,GAAW,WAAW,GAAG,CAAC,EAAE,IAAI,IAAI,CAAC,EAAE,IAAI,EAAE,EAAE;IAC3D,QAAA,MAAM,SAAS,GAAW,CAAC,IAAI,IAAI,CAAC;IACpC,QAAA,MAAM,YAAY,GAAW,SAAS,IAAI,CAAC,CAAC;IAC5C,QAAA,MAAM,MAAM,GAAW,SAAS,IAAI,CAAC,CAAC;YACtC,MAAM,gBAAgB,GAAW,IAAI,CAAC,EAAE,GAAG,GAAG,GAAG,MAAM,CAAC;YACxD,MAAM,YAAY,GAAW,IAAI,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;YACxD,MAAM,YAAY,GAAW,IAAI,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;IACxD,QAAA,MAAM,oBAAoB,GAAW,GAAG,GAAG,YAAY,CAAC;IAExD,QAAA,KAAK,IAAI,UAAU,GAAW,CAAC,EAAE,UAAU,GAAG,eAAe,EAAE,UAAU,IAAI,MAAM,EAAE;gBACpF,MAAM,WAAW,GAAW,UAAU,CAAC;IACvC,YAAA,MAAM,SAAS,GAAW,WAAW,GAAG,YAAY,CAAC;IACrD,YAAA,MAAM,WAAW,GAAW,WAAW,GAAG,SAAS,CAAC;IACpD,YAAA,MAAM,SAAS,GAAW,WAAW,GAAG,YAAY,CAAC;IACrD,YAAA,MAAM,SAAS,GAAW,WAAW,GAAG,SAAS,CAAC;IAClD,YAAA,MAAM,UAAU,GAAW,KAAK,CAAC,WAAW,CAAC,CAAC;IAC9C,YAAA,MAAM,UAAU,GAAW,KAAK,CAAC,WAAW,CAAC,CAAC;IAC9C,YAAA,KAAK,CAAC,WAAW,CAAC,GAAG,UAAU,GAAG,UAAU,CAAC;IAC7C,YAAA,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;IACtB,YAAA,KAAK,CAAC,WAAW,CAAC,GAAG,UAAU,GAAG,UAAU,CAAC;IAC7C,YAAA,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;gBACtB,IAAI,CAAC,GAAW,YAAY,CAAC;IAC7B,YAAA,IAAI,CAAC,GAAW,CAAC,YAAY,CAAC;gBAC9B,IAAI,KAAK,GAAW,GAAG,CAAC;gBACxB,IAAI,KAAK,GAAW,GAAG,CAAC;gBACxB,KAAK,IAAI,KAAK,GAAW,CAAC,EAAE,KAAK,GAAG,YAAY,EAAE,KAAK,EAAE,EAAE;IAC1D,gBAAA,MAAM,OAAO,GAAW,WAAW,GAAG,KAAK,CAAC;IAC5C,gBAAA,MAAM,OAAO,GAAW,WAAW,GAAG,KAAK,CAAC;IAC5C,gBAAA,MAAM,OAAO,GAAW,WAAW,GAAG,KAAK,CAAC;IAC5C,gBAAA,MAAM,OAAO,GAAW,SAAS,GAAK,KAAK,CAAC;IAC5C,gBAAA,MAAM,KAAK,GAAW,KAAK,CAAC,OAAO,CAAC,CAAC;IACrC,gBAAA,MAAM,KAAK,GAAW,KAAK,CAAC,OAAO,CAAC,CAAC;IACrC,gBAAA,MAAM,KAAK,GAAW,KAAK,CAAC,OAAO,CAAC,CAAC;IACrC,gBAAA,MAAM,KAAK,GAAW,KAAK,CAAC,OAAO,CAAC,CAAC;IACrC,gBAAA,MAAM,KAAK,GAAW,KAAK,GAAG,KAAK,CAAC;IACpC,gBAAA,MAAM,KAAK,GAAW,KAAK,GAAG,KAAK,CAAC;IACpC,gBAAA,KAAK,CAAC,OAAO,CAAC,GAAG,KAAK,GAAG,KAAK,CAAC;IAC/B,gBAAA,KAAK,CAAC,OAAO,CAAC,GAAG,KAAK,GAAG,KAAK,CAAC;oBAC/B,KAAK,CAAC,OAAO,CAAC,GAAG,KAAK,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,CAAC;oBACvC,KAAK,CAAC,OAAO,CAAC,GAAG,KAAK,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,CAAC;IACvC,gBAAA,MAAM,KAAK,GAAW,oBAAoB,GAAG,CAAC,GAAG,KAAK,CAAC;IACvD,gBAAA,MAAM,KAAK,GAAW,oBAAoB,GAAG,CAAC,GAAG,KAAK,CAAC;oBACvD,KAAK,GAAG,CAAC,CAAC;oBACV,KAAK,GAAG,CAAC,CAAC;oBACV,CAAC,GAAG,KAAK,CAAC;oBACV,CAAC,GAAG,KAAK,CAAC;IACV,aAAA;IACD,SAAA;IACD,KAAA;IAmCD,IAAA,KAAK,IAAI,KAAK,GAAW,CAAC,EAAE,KAAK,GAAG,eAAe,EAAE,KAAK,IAAI,CAAC,EAAE;IAChE,QAAA,MAAM,MAAM,GAAW,KAAK,GAAG,CAAC,CAAC;IACjC,QAAA,MAAM,MAAM,GAAW,KAAK,GAAG,CAAC,CAAC;IACjC,QAAA,MAAM,MAAM,GAAW,KAAK,GAAG,CAAC,CAAC;IACjC,QAAA,MAAM,KAAK,GAAW,KAAK,CAAC,KAAK,CAAE,CAAC;YACpC,MAAM,KAAK,GAAW,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;IACxC,QAAA,MAAM,KAAK,GAAW,KAAK,CAAC,MAAM,CAAC,CAAC;YACpC,MAAM,KAAK,GAAW,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;IACxC,QAAA,MAAM,KAAK,GAAW,KAAK,GAAG,KAAK,CAAC;IACpC,QAAA,MAAM,KAAK,GAAW,KAAK,GAAG,KAAK,CAAC;IACpC,QAAA,KAAK,CAAC,KAAK,CAAE,GAAG,KAAK,GAAG,KAAK,CAAC;IAC9B,QAAA,KAAK,CAAC,MAAM,CAAC,GAAG,KAAK,GAAG,KAAK,CAAC;IAC9B,QAAA,KAAK,CAAC,MAAM,CAAC,GAAG,KAAK,GAAG,KAAK,CAAC;IAC9B,QAAA,KAAK,CAAC,MAAM,CAAC,GAAG,KAAK,GAAG,KAAK,CAAC;IAC9B,KAAA;QAED,gBAAgB,CAAC,KAAK,CAAC,CAAC;IACzB;;ICnYD;;;;;;;;;;;;;;;;;;;;IAoBE;UA4CW,MAAM,CAAA;QAoZV,OAAO,WAAW,CAAC,IAAmB,EAAA;YAC7C,IAAI,GAAG,GAAW,GAAG,CAAC;IACtB,QAAA,KAAK,IAAI,CAAC,GAAW,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE;IAAE,YAAA,GAAG,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC;IAC7D,QAAA,MAAM,OAAO,GAAW,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC;IAC1C,QAAA,KAAK,IAAI,CAAC,GAAW,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE;IAAE,YAAA,IAAI,CAAC,CAAC,CAAC,IAAI,OAAO,CAAC;IACjE,QAAA,OAAO,IAAI,YAAY,CAAC,IAAI,CAAC,CAAC;SAC9B;QAED,OAAO,WAAW,CAAC,KAAa,EAAA;YAC/B,IAAI,IAAI,GAAwB,MAAM,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;YACzD,IAAI,IAAI,IAAI,IAAI,EAAE;IACjB,YAAA,IAAI,GAAG,IAAI,YAAY,CAAC,KAAK,CAAC,CAAC;IAC/B,YAAA,MAAM,CAAC,UAAU,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC;gBAEhC,IAAI,KAAK,IAAI,CAAC,EAAE;oBAEf,IAAI,UAAU,GAAW,CAAC,CAAC;oBAC3B,KAAK,IAAI,CAAC,GAAW,CAAC,EAAE,CAAC,GAAG,KAAK,EAAE,CAAC,EAAE,EAAE;IACvC,oBAAA,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,UAAU,GAAG,CAAC,IAAI,GAAG,GAAG,GAAG,CAAC;IACvC,oBAAA,IAAI,SAAS,GAAW,UAAU,IAAI,CAAC,CAAC;wBACxC,IAAI,CAAC,CAAC,UAAU,GAAG,SAAS,IAAI,CAAC,KAAK,CAAC,EAAE;IACxC,wBAAA,SAAS,IAAI,CAAC,IAAI,EAAE,CAAC;IACrB,qBAAA;wBACD,UAAU,GAAG,SAAS,CAAC;IACvB,iBAAA;IACD,aAAA;qBAAM,IAAI,KAAK,IAAI,CAAC,EAAE;oBAEtB,KAAK,IAAI,CAAC,GAAW,CAAC,EAAE,CAAC,GAAG,KAAK,EAAE,CAAC,EAAE,EAAE;IACvC,oBAAA,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,GAAG,GAAG,GAAG,CAAC;IACpC,iBAAA;IACD,aAAA;qBAAM,IAAI,KAAK,IAAI,CAAC,EAAE;oBAEtB,IAAI,UAAU,GAAW,CAAC,CAAC;oBAC3B,KAAK,IAAI,CAAC,GAAW,CAAC,EAAE,CAAC,GAAG,KAAK,EAAE,CAAC,EAAE,EAAE;IACvC,oBAAA,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,UAAU,GAAG,CAAC,IAAI,GAAG,GAAG,GAAG,CAAC;IACvC,oBAAA,IAAI,SAAS,GAAW,UAAU,IAAI,CAAC,CAAC;wBACxC,IAAI,CAAC,CAAC,UAAU,GAAG,SAAS,IAAI,CAAC,KAAK,CAAC,EAAE;IACxC,wBAAA,SAAS,IAAI,CAAC,IAAI,EAAE,CAAC;IACrB,qBAAA;wBACD,UAAU,GAAG,SAAS,CAAC;IACvB,iBAAA;IACD,aAAA;qBAAM,IAAI,KAAK,IAAI,CAAC,EAAE;oBAEtB,IAAI,UAAU,GAAW,CAAC,CAAC;oBAC3B,KAAK,IAAI,CAAC,GAAW,CAAC,EAAE,CAAC,GAAG,KAAK,EAAE,CAAC,EAAE,EAAE;IACvC,oBAAA,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,UAAU,GAAG,CAAC,IAAI,GAAG,GAAG,GAAG,CAAC;IACvC,oBAAA,IAAI,SAAS,GAAW,UAAU,IAAI,CAAC,CAAC;wBACxC,IAAI,CAAC,CAAC,UAAU,GAAG,SAAS,IAAI,CAAC,KAAK,CAAC,EAAE;IACxC,wBAAA,SAAS,IAAI,CAAC,IAAI,EAAE,CAAC;IACrB,qBAAA;wBACD,UAAU,GAAG,SAAS,CAAC;IACvB,iBAAA;IACD,aAAA;qBAAM,IAAI,KAAK,IAAI,CAAC,EAAE;oBAEtB,IAAI,UAAU,GAAW,CAAC,CAAC;oBAC3B,KAAK,IAAI,CAAC,GAAW,CAAC,EAAE,CAAC,GAAG,KAAK,EAAE,CAAC,EAAE,EAAE;IACvC,oBAAA,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,UAAU,GAAG,CAAC,IAAI,GAAG,GAAG,GAAG,CAAC;IACvC,oBAAA,IAAI,SAAS,GAAW,UAAU,IAAI,CAAC,CAAC;wBACxC,IAAI,CAAC,CAAC,UAAU,GAAG,SAAS,IAAI,CAAC,KAAK,CAAC,EAAE;IACxC,wBAAA,SAAS,IAAI,EAAE,IAAI,CAAC,CAAC;IACrB,qBAAA;wBACD,UAAU,GAAG,SAAS,CAAC;IACvB,iBAAA;IACD,aAAA;qBAAM,IAAI,KAAK,IAAI,CAAC,EAAE;IAEtB,gBAAA,MAAM,CAAC,iBAAiB,CAAC,IAAI,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAChD,gBAAA,MAAM,CAAC,iBAAiB,CAAC,IAAI,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;oBAClD,2BAA2B,CAAC,IAAI,CAAC,CAAC;IAClC,gBAAA,qBAAqB,CAAC,IAAI,EAAE,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC;IAC1D,aAAA;qBAAM,IAAI,KAAK,IAAI,CAAC,EAAE;IAEtB,gBAAA,MAAM,CAAC,iBAAiB,CAAC,IAAI,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAC/C,gBAAA,MAAM,CAAC,iBAAiB,CAAC,IAAI,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;oBAClD,2BAA2B,CAAC,IAAI,CAAC,CAAC;IAClC,gBAAA,qBAAqB,CAAC,IAAI,EAAE,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC;IAC1D,aAAA;qBAAM,IAAI,KAAK,IAAI,CAAC,EAAE;oBAEtB,IAAI,UAAU,GAAW,CAAC,CAAC;oBAC3B,KAAK,IAAI,CAAC,GAAW,CAAC,EAAE,CAAC,GAAG,KAAK,EAAE,CAAC,EAAE,EAAE;IACvC,oBAAA,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,UAAU,GAAG,CAAC,IAAI,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;IACjD,oBAAA,IAAI,SAAS,GAAW,UAAU,IAAI,CAAC,CAAC;wBACxC,IAAI,CAAC,CAAC,UAAU,GAAG,SAAS,IAAI,CAAC,KAAK,CAAC,EAAE;IACxC,wBAAA,SAAS,IAAI,EAAE,IAAI,CAAC,CAAC;IACrB,qBAAA;wBACD,UAAU,GAAG,SAAS,CAAC;IACvB,iBAAA;IACD,aAAA;qBAAM,IAAI,KAAK,IAAI,CAAC,EAAE;oBAEtB,IAAI,UAAU,GAAW,CAAC,CAAC;oBAC3B,KAAK,IAAI,CAAC,GAAW,CAAC,EAAE,CAAC,GAAG,KAAK,EAAE,CAAC,EAAE,EAAE;IACvC,oBAAA,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,UAAU,GAAG,CAAC,IAAI,GAAG,GAAG,GAAG,CAAC;IACvC,oBAAA,IAAI,SAAS,GAAW,UAAU,IAAI,CAAC,CAAC;wBACxC,IAAI,CAAC,CAAC,UAAU,GAAG,SAAS,IAAI,CAAC,KAAK,CAAC,EAAE;IACxC,wBAAA,SAAS,IAAI,EAAE,IAAI,CAAC,CAAC;IACrB,qBAAA;wBACD,UAAU,GAAG,SAAS,CAAC;IACvB,iBAAA;IACD,aAAA;qBAAM,IAAI,KAAK,IAAI,CAAC,EAAE;oBAEtB,KAAK,IAAI,CAAC,GAAW,CAAC,EAAE,CAAC,GAAG,KAAK,EAAE,CAAC,EAAE,EAAE;IACvC,oBAAA,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,GAAG,GAAG,GAAG,CAAC;IACpC,iBAAA;IA8BD,aAAA;IAAM,iBAAA;IACN,gBAAA,MAAM,IAAI,KAAK,CAAC,2BAA2B,GAAG,KAAK,CAAC,CAAC;IACrD,aAAA;IACD,SAAA;IAED,QAAA,OAAO,IAAI,CAAC;SACZ;IAEO,IAAA,OAAO,iBAAiB,CAAC,IAAkB,EAAE,SAAiB,EAAE,UAAkB,EAAE,QAAgB,EAAE,SAAiB,EAAE,WAAmB,EAAA;YACnJ,MAAM,eAAe,GAAW,EAAE,CAAC;IACnC,QAAA,MAAM,cAAc,GAAW,CAAC,IAAI,eAAe,CAAC;IACpD,QAAA,MAAM,QAAQ,GAAW,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,SAAS,CAAC,GAAG,CAAC,CAAC;IACpD,QAAA,MAAM,SAAS,GAAW,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,UAAU,CAAC,GAAG,CAAC,CAAC;YACtD,MAAM,IAAI,GAAW,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;YACjC,KAAK,IAAI,CAAC,GAAW,QAAQ,EAAE,CAAC,GAAG,SAAS,EAAE,CAAC,EAAE,EAAE;IAClD,YAAA,IAAI,SAAS,GAAW,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,QAAQ,GAAG,CAAC,SAAS,GAAG,QAAQ,KAAK,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,GAAG,SAAS,CAAC,IAAI,UAAU,GAAG,SAAS,CAAC,CAAC,CAAC;gBACrI,SAAS,IAAI,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,cAAc,EAAE,WAAW,CAAC,CAAC;IACvD,YAAA,MAAM,OAAO,GAAW,IAAI,CAAC,MAAM,EAAE,GAAG,IAAI,CAAC,EAAE,GAAG,GAAG,CAAC;IACtD,YAAA,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,GAAG,SAAS,CAAC;IACxC,YAAA,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,GAAG,SAAS,CAAC;IAChD,SAAA;SACD;IAEO,IAAA,OAAO,gBAAgB,GAAA;YAC9B,MAAM,IAAI,GAAiB,IAAI,YAAY,CAAC,MAAM,CAAC,cAAc,GAAG,CAAC,CAAC,CAAC;IACvE,QAAA,KAAK,IAAI,CAAC,GAAW,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,cAAc,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;gBAC3D,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,EAAE,GAAG,GAAG,GAAG,MAAM,CAAC,cAAc,CAAC,CAAC;IAC9D,SAAA;IACD,QAAA,OAAO,IAAI,CAAC;SACZ;;IAnjBsB,MAAM,CAAA,MAAA,GAA2B,SAAS,CAAC;IACjE,IAAA,EAAC,IAAI,EAAE,SAAS,EAAa,QAAQ,EAAE,kBAAkB,EAAO,KAAK,EAAE,CAAC,IAAI,EAAE,KAAK,EAAG,IAAI,EAAE,KAAK,EAAG,IAAI,EAAE,KAAK,EAAE,KAAK,EAAG,IAAI,EAAE,KAAK,EAAG,IAAI,EAAE,KAAK,EAAE,KAAK,CAAC,EAAC;IAC3J,IAAA,EAAC,IAAI,EAAE,SAAS,EAAa,QAAQ,EAAE,kBAAkB,EAAO,KAAK,EAAE,CAAC,IAAI,EAAE,KAAK,EAAE,KAAK,EAAG,IAAI,EAAE,KAAK,EAAG,IAAI,EAAE,KAAK,EAAG,IAAI,EAAE,KAAK,EAAE,KAAK,EAAG,IAAI,EAAE,KAAK,CAAC,EAAC;IAC3J,IAAA,EAAC,IAAI,EAAE,WAAW,EAAW,QAAQ,EAAE,QAAQ,EAAiB,KAAK,EAAE,CAAC,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAG,IAAI,EAAG,IAAI,EAAE,KAAK,EAAG,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAG,IAAI,CAAC,EAAC;IAC3J,IAAA,EAAC,IAAI,EAAE,WAAW,EAAW,QAAQ,EAAE,eAAe,EAAU,KAAK,EAAE,CAAC,IAAI,EAAG,IAAI,EAAE,KAAK,EAAG,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAG,IAAI,EAAG,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,EAAC;IAC3J,IAAA,EAAC,IAAI,EAAE,UAAU,EAAY,QAAQ,EAAE,aAAa,EAAY,KAAK,EAAE,CAAC,IAAI,EAAE,KAAK,EAAG,IAAI,EAAG,IAAI,EAAG,IAAI,EAAE,KAAK,EAAE,KAAK,EAAG,IAAI,EAAE,KAAK,EAAG,IAAI,EAAE,KAAK,EAAE,KAAK,CAAC,EAAC;IAC3J,IAAA,EAAC,IAAI,EAAE,UAAU,EAAY,QAAQ,EAAE,OAAO,EAAkB,KAAK,EAAE,CAAC,IAAI,EAAE,KAAK,EAAE,KAAK,EAAG,IAAI,EAAE,KAAK,EAAG,IAAI,EAAG,IAAI,EAAG,IAAI,EAAE,KAAK,EAAE,KAAK,EAAG,IAAI,EAAE,KAAK,CAAC,EAAC;IAC3J,IAAA,EAAC,IAAI,EAAE,WAAW,EAAW,QAAQ,EAAE,QAAQ,EAAiB,KAAK,EAAE,CAAC,IAAI,EAAE,KAAK,EAAG,IAAI,EAAE,KAAK,EAAG,IAAI,EAAG,IAAI,EAAE,KAAK,EAAG,IAAI,EAAE,KAAK,EAAG,IAAI,EAAE,KAAK,EAAG,IAAI,CAAC,EAAC;IAC3J,IAAA,EAAC,IAAI,EAAE,WAAW,EAAW,QAAQ,EAAE,SAAS,EAAgB,KAAK,EAAE,CAAC,IAAI,EAAE,KAAK,EAAG,IAAI,EAAG,IAAI,EAAE,KAAK,EAAG,IAAI,EAAE,KAAK,EAAG,IAAI,EAAG,IAAI,EAAE,KAAK,EAAG,IAAI,EAAE,KAAK,CAAC,EAAC;IAC3J,IAAA,EAAC,IAAI,EAAE,iBAAiB,EAAI,QAAQ,EAAE,uBAAuB,EAAE,KAAK,EAAE,CAAC,IAAI,EAAG,IAAI,EAAE,KAAK,EAAE,KAAK,EAAG,IAAI,EAAG,IAAI,EAAE,KAAK,EAAG,IAAI,EAAG,IAAI,EAAE,KAAK,EAAE,KAAK,EAAG,IAAI,CAAC,EAAC;IAC1J,IAAA,EAAC,IAAI,EAAE,iBAAiB,EAAK,QAAQ,EAAE,uBAAuB,EAAE,KAAK,EAAE,CAAC,IAAI,EAAE,KAAK,EAAG,IAAI,EAAG,IAAI,EAAE,KAAK,EAAE,KAAK,EAAG,IAAI,EAAG,IAAI,EAAG,IAAI,EAAE,KAAK,EAAE,KAAK,EAAG,IAAI,CAAC,EAAC;IAC3J,IAAA,EAAC,IAAI,EAAE,QAAQ,EAAc,QAAQ,EAAE,YAAY,EAAa,KAAK,EAAE,CAAC,IAAI,EAAE,KAAK,EAAG,IAAI,EAAE,KAAK,EAAG,IAAI,EAAE,KAAK,EAAG,IAAI,EAAE,KAAK,EAAG,IAAI,EAAE,KAAK,EAAG,IAAI,EAAE,KAAK,CAAC,EAAC;IAC3J,IAAA,EAAC,IAAI,EAAE,QAAQ,EAAc,QAAQ,EAAE,WAAW,EAAc,KAAK,EAAE,CAAC,IAAI,EAAG,IAAI,EAAG,IAAI,EAAG,IAAI,EAAG,IAAI,EAAG,IAAI,EAAG,IAAI,EAAG,IAAI,EAAG,IAAI,EAAG,IAAI,EAAG,IAAI,EAAG,IAAI,CAAC,EAAC;IAC3J,IAAA,EAAC,IAAI,EAAE,WAAW,EAAW,QAAQ,EAAE,WAAW,EAAc,KAAK,EAAE,CAAC,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,EAAC;IAC3J,IAAA,EAAC,IAAI,EAAE,YAAY,EAAU,QAAQ,EAAE,YAAY,EAAa,KAAK,EAAE,CAAC,IAAI,EAAG,IAAI,EAAE,KAAK,EAAG,IAAI,EAAG,IAAI,EAAG,IAAI,EAAG,IAAI,EAAG,IAAI,EAAG,IAAI,EAAE,KAAK,EAAG,IAAI,EAAE,KAAK,CAAC,EAAC;IAC3J,CAAA,CAAC,CAAC;IACa,MAAA,CAAA,mBAAmB,GAA0B,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACzF,MAAU,CAAA,UAAA,GAAiC,CAAC,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,CAAC,CAAC;IACtG,MAAO,CAAA,OAAA,GAAiC,CAAC,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,CAAC,CAAC;IACrG,MAAI,CAAA,IAAA,GAAyB,SAAS,CAAC;QAC7D,EAAC,IAAI,EAAE,GAAG,EAAG,UAAU,EAAG,IAAI,EAAE,SAAS,EAAE,EAAE,EAAC;QAC9C,EAAC,IAAI,EAAE,IAAI,EAAE,UAAU,EAAE,KAAK,EAAE,SAAS,EAAE,EAAE,EAAC;QAC9C,EAAC,IAAI,EAAE,GAAG,EAAG,UAAU,EAAG,IAAI,EAAE,SAAS,EAAE,EAAE,EAAC;QAC9C,EAAC,IAAI,EAAE,IAAI,EAAE,UAAU,EAAE,KAAK,EAAE,SAAS,EAAE,EAAE,EAAC;QAC9C,EAAC,IAAI,EAAE,GAAG,EAAG,UAAU,EAAG,IAAI,EAAE,SAAS,EAAE,EAAE,EAAC;QAC9C,EAAC,IAAI,EAAE,GAAG,EAAG,UAAU,EAAG,IAAI,EAAE,SAAS,EAAE,EAAE,EAAC;QAC9C,EAAC,IAAI,EAAE,IAAI,EAAE,UAAU,EAAE,KAAK,EAAE,SAAS,EAAE,EAAE,EAAC;QAC9C,EAAC,IAAI,EAAE,GAAG,EAAG,UAAU,EAAG,IAAI,EAAE,SAAS,EAAE,EAAE,EAAC;QAC9C,EAAC,IAAI,EAAE,IAAI,EAAE,UAAU,EAAE,KAAK,EAAE,SAAS,EAAE,EAAE,EAAC;QAC9C,EAAC,IAAI,EAAE,GAAG,EAAG,UAAU,EAAG,IAAI,EAAE,SAAS,EAAE,EAAE,EAAC;QAC9C,EAAC,IAAI,EAAE,IAAI,EAAE,UAAU,EAAE,KAAK,EAAE,SAAS,EAAE,EAAE,EAAC;QAC9C,EAAC,IAAI,EAAE,GAAG,EAAG,UAAU,EAAG,IAAI,EAAE,SAAS,EAAE,EAAE,EAAC;IAC9C,CAAA,CAAC,CAAC;IACa,MAAQ,CAAA,QAAA,GAA0B,CAAC,gBAAgB,EAAE,YAAY,EAAE,QAAQ,CAAC,CAAC;IAC7E,MAAe,CAAA,eAAA,GAA0B,CAAC,UAAU,EAAE,UAAU,EAAE,SAAS,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;IAClH,MAAQ,CAAA,QAAA,GAAW,CAAC,CAAC;IACrB,MAAQ,CAAA,QAAA,GAAW,GAAG,CAAC;IACvB,MAAW,CAAA,WAAA,GAAW,CAAC,CAAC;IACxB,MAAU,CAAA,UAAA,GAAW,CAAC,CAAC;IACvB,MAAS,CAAA,SAAA,GAAW,EAAE,CAAC;IACvB,MAAW,CAAA,WAAA,GAAW,EAAE,CAAC;IACzB,MAAS,CAAA,SAAA,GAAW,EAAE,CAAC;IACvB,MAAc,CAAA,cAAA,GAAW,CAAC,CAAC;IAC3B,MAAc,CAAA,cAAA,GAAW,EAAE,CAAC;IAC5B,MAAW,CAAA,WAAA,GAAW,CAAC,CAAC;IACxB,MAAW,CAAA,WAAA,GAAW,GAAG,CAAC;IAC1B,MAAqB,CAAA,qBAAA,GAAW,CAAC,CAAC;IAClC,MAAqB,CAAA,qBAAA,GAAW,EAAE,CAAC;IACnC,MAAwB,CAAA,wBAAA,GAAW,CAAC,CAAC;IACrC,MAAwB,CAAA,wBAAA,GAAW,EAAE,CAAC;IACtC,MAAgB,CAAA,gBAAA,GAAW,EAAE,CAAC;IAC9B,MAAS,CAAA,SAAA,GAAW,EAAE,CAAC;IACvB,MAAY,CAAA,YAAA,GAAW,CAAC,CAAC;IACzB,MAAS,CAAA,SAAA,GAA0B,CAAC,eAAe,EAAE,eAAe,EAAE,IAAI,EAAE,IAAI,EAAE,eAAe,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;IACpI,MAAU,CAAA,UAAA,GAA0B,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;IACvE,MAAA,CAAA,SAAS,GAA0B,CAAC,UAAU,EAAE,QAAQ,EAAE,YAAY,EAAE,cAAc,EAAE,UAAU,EAAE,YAAY,EAAE,cAAc,EAAE,OAAO,EAAE,SAAS,EAAE,QAAQ,EAAE,WAAW,EAAE,cAAc,EAAE,YAAY,EAAE,KAAK,EAAE,QAAQ,EAAE,MAAM,EAAE,YAAY,EAAE,aAAa,EAAE,UAAU,EAAE,iBAAiB,EAAE,OAAO,EAAE,OAAO,EAAE,eAAe,EAAE,MAAM,EAAE,YAAY,EAAE,SAAS,EAAE,aAAa,EAAE,UAAU,EAAE,gBAAgB,EAAE,kBAAkB,CAAC,CAAC;IACra,MAAA,CAAA,WAAW,GAA0B,CAAC,GAAG,EAAS,GAAG,EAAO,GAAG,EAAW,GAAG,EAAa,IAAI,EAAQ,GAAG,EAAW,GAAG,EAAa,GAAG,EAAM,IAAI,EAAO,GAAG,EAAO,GAAG,EAAU,GAAG,EAAa,GAAG,EAAW,GAAG,EAAI,IAAI,EAAM,GAAG,EAAK,GAAG,EAAW,GAAG,EAAY,GAAG,EAAS,GAAG,EAAgB,GAAG,EAAM,GAAG,EAAM,GAAG,EAAc,GAAG,EAAK,GAAG,EAAW,GAAG,EAAQ,GAAG,EAAY,GAAG,EAAS,GAAG,EAAkB,GAAG,CAAC,CAAC;IAC3Z,MAAS,CAAA,SAAA,GAA0B,CAAC,OAAO,EAAE,OAAO,EAAE,UAAU,EAAE,kBAAkB,EAAE,OAAO,EAAE,QAAQ,EAAE,MAAM,EAAE,QAAQ,EAAE,UAAU,EAAE,OAAO,CAAkC,CAAC;IACjL,MAAW,CAAA,WAAA,GAA0B,CAAC,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,CAAoB,CAAC;IAC7G,MAAe,CAAA,eAAA,GAA0B,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAkB,CAAC;IACpG,MAAmB,CAAA,mBAAA,GAA0B,CAAC,KAAK,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,CAAoB,CAAC;IACnI,MAAc,CAAA,cAAA,GAA2B,CAAC,KAAK,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,CAAuB,CAAC;IAE3H,MAAU,CAAA,UAAA,GAA+B,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAuB,CAAC;IACpI,MAAY,CAAA,YAAA,GAA0B,CAAC,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;IAC5G,MAAc,CAAA,cAAA,GAA0B,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;IAC3F,MAAA,CAAA,WAAW,GAA0B,CAAC,MAAM,EAAE,eAAe,EAAE,gBAAgB,EAAE,cAAc,EAAE,aAAa,EAAE,cAAc,EAAE,YAAY,EAAE,aAAa,EAAE,YAAY,EAAE,aAAa,EAAE,WAAW,EAAE,MAAM,EAAE,SAAS,EAAE,WAAW,EAAE,OAAO,EAAE,UAAU,EAAE,OAAO,EAAE,WAAW,CAAC,CAAC;IAClR,MAAA,CAAA,WAAW,GAA0B,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;IAClI,MAAA,CAAA,YAAY,GAA0B,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;IACvI,MAAA,CAAA,aAAa,GAA0B,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;IACrI,MAAA,CAAA,eAAe,GAA0B,CAAC,UAAU,EAAE,QAAQ,EAAE,QAAQ,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,MAAM,CAAC,CAAC;IACpH,MAAW,CAAA,WAAA,GAA0B,CAAC,MAAM,EAAE,eAAe,EAAE,iBAAiB,EAAE,eAAe,EAAE,eAAe,EAAE,eAAe,EAAE,OAAO,EAAE,SAAS,EAAE,OAAO,CAAC,CAAC;IAClK,MAAc,CAAA,cAAA,GAA0B,CAAC,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;IACzF,MAAc,CAAA,cAAA,GAA0B,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,KAAK,CAAC,CAAC;IACzF,MAAA,CAAA,mBAAmB,GAA0B,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IACtE,MAAA,CAAA,WAAW,GAA0B,CAAC,OAAO,EAAE,SAAS,EAAE,KAAK,EAAE,YAAY,EAAE,WAAW,EAAE,QAAQ,EAAE,SAAS,EAAE,SAAS,EAAE,QAAQ,EAAE,OAAO,EAAE,QAAQ,EAAE,SAAS,EAAE,SAAS,EAAE,MAAM,EAAE,OAAO,EAAE,YAAY,EAAE,mBAAmB,EAAE,SAAS,EAAE,QAAQ,EAAE,WAAW,CAAC,CAAC;IACrQ,MAAA,CAAA,eAAe,GAA0B,CAAC,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,CAAC,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,KAAK,EAAE,IAAI,EAAE,EAAE,CAAC,CAAC;IAC/I,MAAA,CAAA,aAAa,GAA0B,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;IACtI,MAAA,CAAA,aAAa,GAA0B,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;IACpJ,MAAW,CAAA,WAAA,GAA0B,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;IAC7I,MAAA,CAAA,aAAa,GAA0B,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;IAC5I,MAAA,CAAA,gBAAgB,GAA2B,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;IACjL,MAAA,CAAA,WAAW,GAA0B,CAAC,UAAU,EAAE,MAAM,EAAE,OAAO,EAAE,SAAS,EAAE,eAAe,EAAE,WAAW,CAAC,CAAC;IAC5G,MAAA,CAAA,SAAS,GAA0B,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IACtD,MAAe,CAAA,eAAA,GAA0B,CAAC,MAAM,EAAE,SAAS,EAAE,QAAQ,EAAE,YAAY,EAAE,aAAa,EAAE,mBAAmB,EAAE,mBAAmB,EAAE,QAAQ,EAAE,SAAS,CAAC,CAAC;IACnK,MAAa,CAAA,aAAA,GAA0B,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IACnE,MAAA,CAAA,UAAU,GAA0B,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;IAC/C,MAAA,CAAA,WAAW,GAA0B,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IAC5C,MAAW,CAAA,WAAA,GAA0B,CAAC,MAAM,EAAE,gBAAgB,EAAG,2BAA2B,EAAG,aAAa,EAAG,cAAc,EAAE,cAAc,EAAE,aAAa,EAAE,2BAA2B,EAAE,eAAe,CAAC,CAAC;IAC5M,MAAY,CAAA,YAAA,GAA0B,CAAC,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,CAAC;IAC9F,MAAW,CAAA,WAAA,GAA0B,CAAC,SAAS,EAAE,MAAM,EAAE,QAAQ,EAAE,OAAO,EAAE,UAAU,EAAE,MAAM,EAAE,GAAG,EAAE,SAAS,EAAE,IAAI,EAAE,UAAU,CAAC,CAAC;IAClI,MAAY,CAAA,YAAA,GAA0B,CAAC,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC;IAC9F,MAAA,CAAA,aAAa,GAA0B,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC;IACvE,MAAU,CAAA,UAAA,GAA0B,CAAC,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,CAAC,CAAC;IAC1F,MAAa,CAAA,aAAA,GAAW,CAAC,CAAC;IAC1B,MAAA,CAAA,sBAAsB,GAA0B;QAC/D,WAAW;QACX,WAAW;QACX,WAAW;QACX,WAAW;QACX,SAAS;QACT,SAAS;QACT,WAAW;QACX,SAAS;QACT,WAAW;QACX,aAAa;QACb,SAAS;QACT,WAAW;QACX,SAAS;KACT,CAAC;IACc,MAAA,CAAA,kBAAkB,GAA0B,CAAC,WAAW,EAAE,WAAW,EAAE,WAAW,EAAE,WAAW,EAAE,SAAS,EAAE,SAAS,EAAE,WAAW,EAAE,SAAS,EAAE,WAAW,EAAE,aAAa,EAAE,SAAS,EAAE,WAAW,EAAE,SAAS,CAAC,CAAC;IAC9M,MAAA,CAAA,mBAAmB,GAAwD;IAC1F,IAAA,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,EAAM,EAAE,EAAG,EAAE,CAAC;IAC5B,IAAA,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAK,EAAE,EAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;IAC5B,IAAA,CAAC,CAAC,CAAC,CAAC,EAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,EAAG,EAAE,CAAC;IAC5B,IAAA,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAK,CAAC,CAAC,CAAC,EAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;IAC5B,IAAA,CAAC,CAAC,CAAC,CAAC,EAAQ,CAAC,CAAC,CAAC,EAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;QAC5B,CAAC,CAAC,CAAC,CAAC,EAAQ,CAAC,CAAC,CAAC,EAAK,EAAE,EAAG,EAAE,CAAC;QAC5B,CAAC,EAAE,EAAS,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,EAAG,EAAE,CAAC;QAC5B,CAAC,EAAE,EAAS,CAAC,CAAC,CAAC,EAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;IAC5B,IAAA,CAAC,CAAC,CAAC,CAAC,EAAQ,CAAC,CAAC,CAAC,EAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;IAC5B,IAAA,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,EAAG,EAAE,CAAC;QAC5B,CAAC,EAAE,EAAS,EAAE,EAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;IAC5B,IAAA,CAAC,CAAC,CAAC,CAAC,EAAQ,CAAC,CAAC,CAAC,EAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;IAC5B,IAAA,CAAC,EAAE,EAAS,EAAE,EAAM,EAAE,EAAG,EAAE,CAAC;KAC5B,CAAC;IACc,MAAA,CAAA,yBAAyB,GAAyC;IACjF,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;KACZ,CAAC;IACc,MAAA,CAAA,qBAAqB,GAA0B,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IACvF,MAAA,CAAA,qBAAqB,GAAyC;IAC7E,IAAA,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;QACpB,CAAC,GAAG,EAAE,IAAI,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC;IAC1B,IAAA,CAAC,GAAG,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,CAAC;QACzB,CAAC,GAAG,EAAE,IAAI,EAAE,CAAC,IAAI,EAAE,IAAI,CAAC;IACxB,IAAA,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;IACpB,IAAA,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,CAAC;IACrB,IAAA,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,CAAC;IACrB,IAAA,CAAC,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC;IACtB,IAAA,CAAC,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC;KACvB,CAAC;IACc,MAAoB,CAAA,oBAAA,GAAW,EAAE,CAAC;IAClC,MAAA,CAAA,sBAAsB,GAA0B,CAAC,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;IACxJ,MAAA,CAAA,kBAAkB,GAA0B,CAAC,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;IACpJ,MAAA,CAAA,mBAAmB,GAA6B,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;IACtI,MAAA,CAAA,iBAAiB,GAA+B,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;IAClI,MAAA,CAAA,sBAAsB,GAA0B,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;IACnI,MAAA,CAAA,qBAAqB,GAA0B,CAAC,QAAQ,EAAE,QAAQ,EAAE,OAAO,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU,EAAE,cAAc,EAAE,gBAAgB,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,CAAC,CAAC;IACvR,MAAoB,CAAA,oBAAA,GAAgC,4DAA0Z,CAAC;IAC/c,MAAA,CAAA,2BAA2B,GAA2B,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;IACjM,MAAA,CAAA,qBAAqB,GAA0B,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;IACxJ,MAAA,CAAA,wBAAwB,GAA2B,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;IAC7L,MAAA,CAAA,qBAAqB,GAA0B;QAC9D,IAAI;QACJ,IAAI;QACJ,IAAI;QACJ,IAAI;QACJ,OAAO;QACP,OAAO;QACP,WAAW;QACX,WAAW;QACX,cAAc;QACd,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,SAAS;QACT,SAAS;QACT,SAAS;QACT,MAAM;QACN,MAAM;QACN,MAAM;QACN,MAAM;QACN,MAAM;QACN,MAAM;KACN,CAAC;IACc,MAAA,CAAA,iBAAiB,GAA0B;QAC1D,GAAG;QACH,GAAG;QACH,GAAG;QACH,GAAG;QACH,KAAK;QACL,KAAK;QACL,OAAO;QACP,OAAO;QACP,SAAS;QACT,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,SAAS;QACT,SAAS;QACT,SAAS;QACT,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;KACL,CAAC;IACc,MAAA,CAAA,uBAAuB,GAAwD;QAC9F,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;QACjB,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC;QACjB,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;QACjB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC;QACjB,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC;QAClB,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IAClB,IAAA,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;IACnB,IAAA,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACnB,IAAA,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QACpB,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC;QACjB,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;QACjB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC;QACjB,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;QACjB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC;QACjB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC;QACjB,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QAClB,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IAClB,IAAA,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QACnB,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,EAAG,EAAE,CAAG;QACrB,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,EAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAG;QACrB,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,EAAG,EAAE,EAAG,CAAC,CAAC,CAAC,CAAE;QACrB,CAAC,EAAE,EAAG,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,CAAG;QACrB,CAAC,EAAE,EAAG,CAAC,CAAC,CAAC,EAAE,EAAE,EAAG,CAAC,CAAC,CAAC,CAAE;QACrB,CAAC,EAAE,EAAG,EAAE,EAAG,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAE;KACrB,CAAC;IACc,MAAqB,CAAA,qBAAA,GAA0B,CAAC,MAAM,EAAE,aAAa,EAAE,YAAY,CAAC,CAAC;IACrF,MAAsB,CAAA,sBAAA,GAA0B,SAA4D,CAAC;IAC7G,MAAA,CAAA,oBAAoB,GAA0B,CAAC,OAAO,CAAC,CAAC;IACxD,MAAmB,CAAA,mBAAA,GAA0B,CAAC,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,CAAC,CAAC;IAE5E,MAAa,CAAA,aAAA,GAA0B,CAAC,SAAS,EAAE,YAAY,EAAE,OAAO,EAAE,mBAAmB,EAAE,OAAO,EAAE,aAAa,EAAE,WAAW,EAAE,SAAS,EAAE,WAAW,EAAE,SAAS,EAAE,YAAY,EAAE,qBAAqB,EAAE,YAAY,EAAE,aAAa,EAAE,aAAa,EAAE,SAAS,EAAE,UAAU,EAAE,SAAS,EAAE,SAAS,EAAE,eAAe,EAAE,WAAW,EAAE,cAAc,CAAC,CAAC;IAEnV,MAA2B,CAAA,2BAAA,GAAgB,SAAS,CAAC;IACrD,MAA2B,CAAA,2BAAA,GAAgB,SAAS,CAAC;IACrD,MAA6B,CAAA,6BAAA,GAAc,SAAS,CAAC;IACrD,MAA4B,CAAA,4BAAA,GAAe,SAAS,CAAC;IACrD,MAA4B,CAAA,4BAAA,GAAe,SAAS,CAAC;IACrD,MAA2B,CAAA,2BAAA,GAAgB,SAAS,CAAC;IACrD,MAA6B,CAAA,6BAAA,GAAc,SAAS,CAAC;IACrD,MAA6B,CAAA,6BAAA,GAAc,SAAS,CAAC;IACrD,MAA4B,CAAA,4BAAA,GAAe,SAAS,CAAC;IACrD,MAA2B,CAAA,2BAAA,GAAgB,SAAS,CAAC;IACrD,MAA8B,CAAA,8BAAA,GAAa,SAAS,CAAC;IACrD,MAA8B,CAAA,8BAAA,GAAa,SAAS,CAAC;IACrD,MAAgC,CAAA,gCAAA,GAAW,SAAS,CAAC;IACrD,MAAgC,CAAA,gCAAA,GAAW,SAAS,CAAC;IACrD,MAA+B,CAAA,+BAAA,GAAY,SAAS,CAAC;IACrD,MAA+B,CAAA,+BAAA,GAAY,SAAS,CAAC;IAErD,MAAwB,CAAA,wBAAA,GAAgB,SAAS,CAAC;IAClD,MAAwB,CAAA,wBAAA,GAAgB,SAAS,CAAC;IAClD,MAA0B,CAAA,0BAAA,GAAc,SAAS,CAAC;IAClD,MAAyB,CAAA,yBAAA,GAAe,SAAS,CAAC;IAClD,MAAyB,CAAA,yBAAA,GAAe,SAAS,CAAC;IAClD,MAAwB,CAAA,wBAAA,GAAgB,SAAS,CAAC;IAClD,MAA0B,CAAA,0BAAA,GAAc,SAAS,CAAC;IAClD,MAA0B,CAAA,0BAAA,GAAc,SAAS,CAAC;IAClD,MAAyB,CAAA,yBAAA,GAAe,SAAS,CAAC;IAClD,MAAwB,CAAA,wBAAA,GAAgB,SAAS,CAAC;IAClD,MAA2B,CAAA,2BAAA,GAAa,SAAS,CAAC;IAClD,MAA2B,CAAA,2BAAA,GAAa,SAAS,CAAC;IAClD,MAA6B,CAAA,6BAAA,GAAW,SAAS,CAAC;IAClD,MAA6B,CAAA,6BAAA,GAAW,SAAS,CAAC;IAClD,MAA4B,CAAA,4BAAA,GAAY,SAAS,CAAC;IAClD,MAA4B,CAAA,4BAAA,GAAY,SAAS,CAAC;IAElD,MAAqB,CAAA,qBAAA,GAA6B,CAAC,MAAM,CAAC,wBAAwB,EAAE,MAAM,CAAC,wBAAwB,EAAE,MAAM,CAAC,0BAA0B,EAAE,MAAM,CAAC,yBAAyB,EAAE,MAAM,CAAC,yBAAyB,EAAE,MAAM,CAAC,wBAAwB,EAAE,MAAM,CAAC,0BAA0B,EAAE,MAAM,CAAC,0BAA0B,EAAE,MAAM,CAAC,yBAAyB,EAAE,MAAM,CAAC,wBAAwB,EAAE,MAAM,CAAC,2BAA2B,EAAE,MAAM,CAAC,2BAA2B,CAAC,CAAC;IAC9c,MAAwB,CAAA,wBAAA,GAA0B,CAAC,MAAM,CAAC,2BAA2B,EAAE,MAAM,CAAC,2BAA2B,EAAE,MAAM,CAAC,6BAA6B,EAAE,MAAM,CAAC,4BAA4B,EAAE,MAAM,CAAC,4BAA4B,EAAE,MAAM,CAAC,2BAA2B,EAAE,MAAM,CAAC,6BAA6B,EAAE,MAAM,CAAC,6BAA6B,EAAE,MAAM,CAAC,4BAA4B,EAAE,MAAM,CAAC,2BAA2B,EAAE,MAAM,CAAC,8BAA8B,EAAE,MAAM,CAAC,8BAA8B,CAAC,CAAC;IAClf,MAAkB,CAAA,kBAAA,GAAgC,CAAC,MAAM,CAAC,wBAAwB,EAAE,MAAM,CAAC,wBAAwB,EAAE,MAAM,CAAC,0BAA0B,EAAE,MAAM,CAAC,yBAAyB,EAAE,MAAM,CAAC,yBAAyB,EAAE,MAAM,CAAC,wBAAwB,EAAE,MAAM,CAAC,0BAA0B,EAAE,MAAM,CAAC,0BAA0B,EAAE,MAAM,CAAC,yBAAyB,EAAE,MAAM,CAAC,wBAAwB,EAAE,MAAM,CAAC,2BAA2B,EAAE,MAAM,CAAC,2BAA2B,CAAC,CAAC;IAC9c,MAAqB,CAAA,qBAAA,GAA6B,CAAC,MAAM,CAAC,2BAA2B,EAAE,MAAM,CAAC,2BAA2B,EAAE,MAAM,CAAC,6BAA6B,EAAE,MAAM,CAAC,4BAA4B,EAAE,MAAM,CAAC,4BAA4B,EAAE,MAAM,CAAC,2BAA2B,EAAE,MAAM,CAAC,6BAA6B,EAAE,MAAM,CAAC,6BAA6B,EAAE,MAAM,CAAC,4BAA4B,EAAE,MAAM,CAAC,2BAA2B,EAAE,MAAM,CAAC,8BAA8B,EAAE,MAAM,CAAC,8BAA8B,CAAC,CAAC;IAClf,MAAA,CAAA,oBAAoB,GAA6B,CAAC,MAAM,CAAC,6BAA6B,EAAE,MAAM,CAAC,6BAA6B,EAAE,MAAM,CAAC,4BAA4B,EAAE,MAAM,CAAC,4BAA4B,CAAC,CAAC;IACxM,MAAA,CAAA,uBAAuB,GAA0B,CAAC,MAAM,CAAC,gCAAgC,EAAE,MAAM,CAAC,gCAAgC,EAAE,MAAM,CAAC,+BAA+B,EAAE,MAAM,CAAC,+BAA+B,CAAC,CAAC;IACpN,MAAA,CAAA,iBAAiB,GAAgC,CAAC,MAAM,CAAC,6BAA6B,EAAE,MAAM,CAAC,6BAA6B,EAAE,MAAM,CAAC,4BAA4B,EAAE,MAAM,CAAC,4BAA4B,CAAC,CAAC;IACxM,MAAA,CAAA,oBAAoB,GAA6B,CAAC,MAAM,CAAC,gCAAgC,EAAE,MAAM,CAAC,gCAAgC,EAAE,MAAM,CAAC,+BAA+B,EAAE,MAAM,CAAC,+BAA+B,CAAC,CAAC;IAEpN,MAAA,CAAA,qBAAqB,GAA0B,CAAC,cAAc,EAAE,gBAAgB,EAAE,gBAAgB,EAAE,eAAe,EAAE,gBAAgB,EAAE,cAAc,CAAC,CAAC;IACvJ,MAAoB,CAAA,oBAAA,GAA0B,CAAC,cAAc,EAAE,eAAe,EAAE,gBAAgB,CAAC,CAAC;IAClG,MAAA,CAAA,sBAAsB,GAAa;QAClD,IAAI;QACJ,IAAI;QACJ,IAAI;QACJ,IAAI;QACJ,IAAI;QACJ,IAAI;QACJ,IAAI;QACJ,IAAI;QACJ,IAAI;KACJ,CAAC;IACc,MAAA,CAAA,oBAAoB,GAAa;QAChD,IAAI;QACJ,IAAI;QACJ,IAAI;QACJ,IAAI;QACJ,IAAI;QACJ,IAAI;QACJ,IAAI;QACJ,IAAI;QACJ,IAAI;KACJ,CAAC;IACc,MAAY,CAAA,YAAA,GAAW,CAAC,CAAC;IACzB,MAAU,CAAA,UAAA,GAAW,EAAE,CAAC;IACxB,MAAQ,CAAA,QAAA,GAAW,EAAE,CAAC;IACtB,MAAoB,CAAA,oBAAA,GAAW,CAAC,CAAC;IACjC,MAAoB,CAAA,oBAAA,GAAW,EAAE,CAAC;IAClC,MAAmB,CAAA,mBAAA,GAAW,CAAC,CAAC;IAChC,MAAmB,CAAA,mBAAA,GAAW,CAAC,CAAC;IAChC,MAAA,CAAA,KAAK,GAAgC;IACpD,IAAA,MAAM,CAAC,WAAW,CAAC,CAAC,GAAG,GAAC,IAAI,EAAE,GAAG,GAAC,IAAI,EAAE,GAAG,GAAC,IAAI,EAAE,GAAG,GAAC,IAAI,EAAE,GAAG,GAAC,IAAI,EAAE,IAAI,GAAC,IAAI,EAAE,IAAI,GAAC,IAAI,EAAE,IAAI,GAAC,IAAI,EAAE,IAAI,GAAC,IAAI,EAAE,IAAI,GAAC,IAAI,EAAE,IAAI,GAAC,IAAI,EAAE,GAAG,GAAC,IAAI,EAAE,GAAG,GAAC,IAAI,EAAE,GAAG,GAAC,IAAI,EAAE,GAAG,GAAC,IAAI,EAAE,GAAG,GAAC,IAAI,EAAE,CAAC,GAAG,GAAC,IAAI,EAAE,CAAC,GAAG,GAAC,IAAI,EAAE,CAAC,GAAG,GAAC,IAAI,EAAE,CAAC,GAAG,GAAC,IAAI,EAAE,CAAC,GAAG,GAAC,IAAI,EAAE,CAAC,IAAI,GAAC,IAAI,EAAE,CAAC,IAAI,GAAC,IAAI,EAAE,CAAC,IAAI,GAAC,IAAI,EAAE,CAAC,IAAI,GAAC,IAAI,EAAE,CAAC,IAAI,GAAC,IAAI,EAAE,CAAC,IAAI,GAAC,IAAI,EAAE,CAAC,GAAG,GAAC,IAAI,EAAE,CAAC,GAAG,GAAC,IAAI,EAAE,CAAC,GAAG,GAAC,IAAI,EAAE,CAAC,GAAG,GAAC,IAAI,EAAE,CAAC,GAAG,GAAC,IAAI,CAAC,CAAC;QAChX,MAAM,CAAC,WAAW,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC;IAC/B,IAAA,MAAM,CAAC,WAAW,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC;QAC3C,MAAM,CAAC,WAAW,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC;IACnE,IAAA,MAAM,CAAC,WAAW,CAAC,CAAC,GAAG,GAAC,IAAI,EAAE,GAAG,GAAC,IAAI,EAAE,GAAG,GAAC,IAAI,EAAE,GAAG,GAAC,IAAI,EAAE,GAAG,GAAC,IAAI,EAAE,IAAI,GAAC,IAAI,EAAE,IAAI,GAAC,IAAI,EAAE,IAAI,GAAC,IAAI,EAAE,IAAI,GAAC,IAAI,EAAE,IAAI,GAAC,IAAI,EAAE,IAAI,GAAC,IAAI,EAAE,IAAI,GAAC,IAAI,EAAE,IAAI,GAAC,IAAI,EAAE,IAAI,GAAC,IAAI,EAAE,IAAI,GAAC,IAAI,EAAE,IAAI,GAAC,IAAI,EAAE,CAAC,IAAI,GAAC,IAAI,EAAE,CAAC,IAAI,GAAC,IAAI,EAAE,CAAC,IAAI,GAAC,IAAI,EAAE,CAAC,IAAI,GAAC,IAAI,EAAE,CAAC,IAAI,GAAC,IAAI,EAAE,CAAC,IAAI,GAAC,IAAI,EAAE,CAAC,IAAI,GAAC,IAAI,EAAE,CAAC,IAAI,GAAC,IAAI,EAAE,CAAC,IAAI,GAAC,IAAI,EAAE,CAAC,IAAI,GAAC,IAAI,EAAE,CAAC,IAAI,GAAC,IAAI,EAAE,CAAC,GAAG,GAAC,IAAI,EAAE,CAAC,GAAG,GAAC,IAAI,EAAE,CAAC,GAAG,GAAC,IAAI,EAAE,CAAC,GAAG,GAAC,IAAI,EAAE,CAAC,GAAG,GAAC,IAAI,CAAC,CAAC;QAC1X,MAAM,CAAC,WAAW,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;IAC7G,IAAA,MAAM,CAAC,WAAW,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC;IAC3G,IAAA,MAAM,CAAC,WAAW,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;IACpD,IAAA,MAAM,CAAC,WAAW,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC;IACzX,IAAA,MAAM,CAAC,WAAW,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAA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C,WAAW,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;IAC/F,IAAA,MAAM,CAAC,WAAW,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC;IACjnB,IAAA,MAAM,CAAC,WAAW,CAAC,CAAC,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,CAAC,CAAC;QAC1D,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,KAAK,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,KAAK,EAAE,CAAC,KAAK,EAAE,CAAC,GAAG,EAAE,CAAC,KAAK,EAAE,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,KAAK,EAAE,CAAC,IAAI,EAAE,CAAC,KAAK,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,IAAI,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,KAAK,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,EAAE,GAAG,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,KAAK,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC;QACjmB,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,KAAK,EAAE,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,KAAK,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,KAAK,EAAE,CAAC,IAAI,EAAE,CAAC,KAAK,EAAE,CAAC,GAAG,EAAE,CAAC,KAAK,EAAE,CAAC,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,KA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AE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC;IACzX,IAAA,MAAM,CAAC,WAAW,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC;IAClrC,IAAA,MAAM,CAAC,WAAW,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC;IAC/E,IAAA,MAAM,CAAC,WAAW,CAAC,CAAC,GAAG,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,GAAG,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,GAAG,EAAE,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,EAAE,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,GAAG,CAAC,CAAC;IACtP,IAAA,MAAM,CAAC,WAAW,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,CAAC,CAAC;QACvG,MAAM,CAAC,WAAW,CAAC,CAAC,GAAG,GAAG,IAAI,EAAE,GAAG,GAAG,IAAI,EAAE,GAAG,GAAG,IAAI,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;QACnE,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC;QACvD,MAAM,CAAC,WAAW,CAAC,CAAC,GAAG,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,KAAK,EAAE,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,KAAK,EAAE,CAAC,KAAK,EAAE,CAAC,KAAK,EAAE,CAAC,KAAK,EAAE,CAAC,KAAK,EAAE,CAAC,KAAK,EAAE,CAAC,KAAK,EAAE,CAAC,GAAG,EAAE,CAAC,KAAK,EAAE,CAAC,KAAK,EAAE,CAAC,GAAG,EAAE,CAAC,KAAK,EAAE,CAAC,IAAI,EAAE,CAAC,KAAK,EAAE,CAAC,IAAI,EAAE,CAAC,IAAI,EAAE,CAAC,KAAK,EAAE,CAAC,CAAC,EAAE,CAAC,KAAK,EAAE,CAAC,IAAI,EAAE,CAAC,IAAI,EAAE,CAAC,KAAK,EAAE,CAAC,IAAI,EAAE,CAAC,KAAK,EAAE,CAAC,GAAG,EAAE,CAAC,KAAK,EAAE,CAAC,KAAK,EAAE,CAAC,GAAG,EAAE,CAAC,KAAK,EAAE,CAAC,KAAK,EAAE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AC,KAAK,EAAE,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,KAAK,EAAE,CAAC,IAAI,EAAE,CAAC,KAAK,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,IAAI,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,KAAK,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,EAAE,GAAG,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,KAAK,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC;QACjmB,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,KAAK,EAAE,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,KAAK,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,KAAK,EAAE,CAAC,IAAI,EAAE,CAAC,KAAK,EAAE,CAAC,GAAG,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CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,EAAE,EAAC,EAAE,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,EAAE,EAAC,CAAC,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,CAAC,CAAC;IACvW,IAAA,CAAA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"}