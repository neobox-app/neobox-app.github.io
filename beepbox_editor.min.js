var beepbox=function(t){"use strict";function e(t,e){for(let n=0;n<t.length;n++)t[n]*=e}function n(t){if(!function(t){return!(!t||t&t-1)}(t))throw new Error("FFT array length must be a power of 2.");return Math.round(Math.log(t)/Math.log(2))}function i(t){const e=t.length,i=n(e);if(e<4)throw new Error("FFT array length must be at least 4.");for(let n=i-1;n>=2;n--){const i=1<<n,s=i>>1,h=i<<1,a=2*Math.PI/h,r=Math.cos(a),o=Math.sin(a),c=2*r;for(let n=0;n<e;n+=h){const e=n,h=e+s,a=e+i,l=a+s,p=a+i,f=t[e],d=t[a];t[e]=f+d,t[h]*=2,t[a]=f-d,t[l]*=2;let y=r,m=-o,u=1,b=0;for(let n=1;n<s;n++){const i=e+n,s=a-n,h=a+n,r=p-n,o=t[i],l=t[s],f=t[h],d=t[r],g=o-l,x=f+d;t[i]=o+l,t[s]=d-f,t[h]=g*y-x*m,t[r]=x*y+g*m;const w=c*y-u,v=c*m-b;u=y,b=m,y=w,m=v}}}for(let n=0;n<e;n+=4){const e=n+1,i=n+2,s=n+3,h=t[n],a=2*t[e],r=t[i],o=2*t[s],c=h+r,l=h-r;t[n]=c+a,t[e]=c-a,t[i]=l+o,t[s]=l-o}!function(t){const e=t.length,i=n(e);if(i>16)throw new Error("FFT array length must not be greater than 2^16.");const s=16-i;for(let n=0;n<e;n++){let e;if(e=(43690&n)>>1|(21845&n)<<1,e=(52428&e)>>2|(13107&e)<<2,e=(61680&e)>>4|(3855&e)<<4,e=(e>>8|(255&e)<<8)>>s,e>n){let i=t[n];t[n]=t[e],t[e]=i}}}(t)}
/*!
    Copyright (c) 2012-2022 John Nesky and contributing authors

    Permission is hereby granted, free of charge, to any person obtaining a copy of
    this software and associated documentation files (the "Software"), to deal in
    the Software without restriction, including without limitation the rights to
    use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
    of the Software, and to permit persons to whom the Software is furnished to do
    so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE.
    */class s{static t(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];const n=e/t.length;for(let e=0;e<t.length;e++)t[e]-=n;return new Float64Array(t)}static getDrumWave(t){let n=s.i[t];if(null==n)if(n=new Float32Array(32768),s.i[t]=n,0==t){let t=1;for(let e=0;e<32768;e++){n[e]=2*(1&t)-1;let i=t>>1;1==(t+i&1)&&(i+=16384),t=i}}else if(1==t)for(let t=0;t<32768;t++)n[t]=2*Math.random()-1;else if(2==t){let t=1;for(let e=0;e<32768;e++){n[e]=2*(1&t)-1;let i=t>>1;1==(t+i&1)&&(i+=32768),t=i}}else if(3==t){let t=1;for(let e=0;e<32767;e++){n[e]=2*(1&t)-1;let i=t>>2;1==(t+i&1)&&(i+=65536),t=i}}else if(4==t){let t=1;for(let e=0;e<32768;e++){n[e]=2*(1&t)-1;let i=t>>1;1==(t+i&1)&&(i+=40),t=i}}else if(5==t)s.drawNoiseSpectrum(n,10,11,1,1,0),s.drawNoiseSpectrum(n,11,14,-2,-2,0),i(n),e(n,1/Math.sqrt(n.length));else if(6==t)s.drawNoiseSpectrum(n,1,10,1,1,0),s.drawNoiseSpectrum(n,20,14,-2,-2,0),i(n),e(n,1/Math.sqrt(n.length));else if(7==t){let t=1;for(let e=0;e<32768;e++){n[e]=4*(1&t)*Math.random();let i=t>>1;1==(t+i&1)&&(i+=60),t=i}}else if(8==t){let t=1;for(let e=0;e<32768;e++){n[e]=(1&t)/2+.5;let i=t>>1;1==(t+i&1)&&(i-=40),t=i}}else{if(9!=t)throw new Error("Unrecognized drum index: "+t);for(let t=0;t<32768;t++)n[t]=2*Math.random()-1}return n}static drawNoiseSpectrum(t,e,n,i,s,h){const a=0|Math.pow(2,e),r=0|Math.pow(2,n),o=Math.log(2);for(let c=a;c<r;c++){let a=Math.pow(2,i+(s-i)*(Math.log(c)/o-e)/(n-e));a*=Math.pow(c/2048,h);const r=Math.random()*Math.PI*2;t[c]=Math.cos(r)*a,t[32768-c]=Math.sin(r)*a}}static generateSineWave(){const t=new Float64Array(s.sineWaveLength+1);for(let e=0;e<s.sineWaveLength+1;e++)t[e]=Math.sin(e*Math.PI*2/s.sineWaveLength);return t}}function h(t){const e={};for(let n=0;n<t.length;n++){const i=t[n];i.index=n,e[i.name]=i}const n=t;return n.dictionary=e,n}s.scales=h([{name:"easy :)",realName:"pentatonic major",flags:[!0,!1,!0,!1,!0,!1,!1,!0,!1,!0,!1,!1]},{name:"easy :(",realName:"pentatonic minor",flags:[!0,!1,!1,!0,!1,!0,!1,!0,!1,!1,!0,!1]},{name:"island :)",realName:"ryukyu",flags:[!0,!1,!1,!1,!0,!0,!1,!0,!1,!1,!1,!0]},{name:"island :(",realName:"pelog selisir",flags:[!0,!0,!1,!0,!1,!1,!1,!0,!0,!1,!1,!1]},{name:"blues :)",realName:"blues major",flags:[!0,!1,!0,!0,!0,!1,!1,!0,!1,!0,!1,!1]},{name:"blues :(",realName:"blues",flags:[!0,!1,!1,!0,!1,!0,!0,!0,!1,!1,!0,!1]},{name:"normal :)",realName:"ionian",flags:[!0,!1,!0,!1,!0,!0,!1,!0,!1,!0,!1,!0]},{name:"normal :(",realName:"aeolian",flags:[!0,!1,!0,!0,!1,!0,!1,!0,!0,!1,!0,!1]},{name:"dbl harmonic :)",realName:"double harmonic major",flags:[!0,!0,!1,!1,!0,!0,!1,!0,!0,!1,!1,!0]},{name:"dbl harmonic :(",realName:"double harmonic minor",flags:[!0,!1,!0,!0,!1,!1,!0,!0,!0,!1,!1,!0]},{name:"enigma",realName:"whole tone",flags:[!0,!1,!0,!1,!0,!1,!0,!1,!0,!1,!0,!1]},{name:"expert",realName:"chromatic",flags:[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0]},{name:"monotonic",realName:"monotonic",flags:[!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1]},{name:"no dabbing",realName:"no dabbing",flags:[!0,!0,!1,!0,!0,!0,!0,!0,!0,!1,!0,!1]}]),s.blackKeyNameParents=[-1,1,-1,1,-1,1,-1,-1,1,-1,1,-1],s.pitchNames=["C",null,"D",null,"E","F",null,"G",null,"A",null,"B"],s.oldKeys=["B","Aâ™¯","A","Gâ™¯","Fâ™¯","F","E","Dâ™¯","D","Câ™¯","C"],s.keys=h([{name:"C",isWhiteKey:!0,basePitch:12},{name:"Câ™¯",isWhiteKey:!1,basePitch:13},{name:"D",isWhiteKey:!0,basePitch:14},{name:"Dâ™¯",isWhiteKey:!1,basePitch:15},{name:"E",isWhiteKey:!0,basePitch:16},{name:"F",isWhiteKey:!0,basePitch:17},{name:"Fâ™¯",isWhiteKey:!1,basePitch:18},{name:"G",isWhiteKey:!0,basePitch:19},{name:"Gâ™¯",isWhiteKey:!1,basePitch:20},{name:"A",isWhiteKey:!0,basePitch:21},{name:"Aâ™¯",isWhiteKey:!1,basePitch:22},{name:"B",isWhiteKey:!0,basePitch:23}]),s.mixNames=["Type A (B & S)","Type B (M)","Type C"],s.sampleRateNames=["44100kHz","48000kHz","default","Ã—4","Ã—2","Ã·2","Ã·4","Ã·8","Ã·16"],s.tempoMin=1,s.tempoMax=500,s.reverbRange=5,s.blendRange=4,s.riffRange=11,s.detuneRange=24,s.muffRange=24,s.beatsPerBarMin=1,s.beatsPerBarMax=24,s.barCountMin=1,s.barCountMax=256,s.patternsPerChannelMin=1,s.patternsPerChannelMax=64,s.instrumentsPerChannelMin=1,s.instrumentsPerChannelMax=64,s.pitchesPerOctave=12,s.drumCount=12,s.pitchOctaves=7,s.partNames=["Ã·3 (triplets)","Ã·4 (standard)","Ã·6","Ã·8","Ã·16 (arpfest)","Ã·12","Ã·9","Ã·5","Ã·50","Ã·24"],s.partCounts=[3,4,6,8,16,12,9,5,50,24],s.waveNames=["triangle","square","pulse wide","pulse narrow","sawtooth","double saw","double pulse","spiky","plateau","glitch","10% pulse","sunsoft bass","loud pulse","sax","guitar","sine","atari bass","atari pulse","1% pulse","curved sawtooth","viola","brass","acoustic bass","lyre","ramp pulse","piccolo","squaretooth","flatline","pnryshk a (u5)","pnryshk b (riff)"],s.waveVolumes=[1,.5,.5,.5,.65,.5,.4,.4,.94,.5,.5,1,.6,.1,.25,1,1,1,1,1,1,1,1,.2,.2,.9,.9,1,.4,.5],s.drumNames=["retro","white","periodic","detuned periodic","shine","hollow","deep","cutter","metallic","snare"],s.drumVolumes=[.25,1,.4,.3,.3,1.5,1.5,.25,1,1],s.drumBasePitches=[69,69,69,69,69,96,120,96,96,69],s.drumPitchFilterMult=[100,8,100,100,100,1,100,100,100,100],s.drumWaveIsSoft=[!1,!0,!1,!1,!1,!0,!0,!1,!1,!1],s.i=[null,null,null,null,null,null,null,null,null,null],s.pwmwaveNames=["5%","10%","15%","20%","25%","30%","35%","40%","45%","50%"],s.pwmwaveVolumes=[1,1,1,1,1,1,1,1,1,1],s.filterNames=["none","sustain sharp","sustain medium","sustain soft","decay sharp","decay medium","decay soft","decay drawn","fade sharp","fade medium","fade soft","ring","muffled","submerged","shift","overtone","woosh","undertone"],s.filterBases=[0,2,3.5,5,1,2.5,4,1,5,7.5,10,-1,4,6,0,1,2,5],s.filterDecays=[0,0,0,0,10,7,4,.5,-10,-7,-4,.2,.2,.3,0,0,-6,0],s.filterVolumes=[.2,.4,.7,1,.5,.75,1,.5,.4,.7,1,.5,.75,.4,.4,1,.5,1.75],s.transitionNames=["seamless","sudden","smooth","slide","trill","click","bow","blip"],s.effectNames=["none","vibrato light","vibrato delayed","vibrato heavy","tremolo light","tremolo heavy","alien","stutter","strum"],s.effectVibratos=[0,.15,.3,.45,0,0,1,0,.05],s.effectTremolos=[0,0,0,0,.25,.5,0,1,.025],s.effectVibratoDelays=[0,0,3,0,0,0,0,0],s.chorusNames=["union","shimmer","hum","honky tonk","dissonant","fifths","octaves","spinner","detune","bowed","rising","vibrate","fourths","bass","dirty","stationary","harmonic (legacy)","recurve","voiced","fluctuate"],s.chorusIntervals=[0,.02,.05,.1,.25,3.5,6,.02,0,.02,1,3.5,4,0,0,3.5,0,.005,.25,12],s.chorusOffsets=[0,0,0,0,0,3.5,6,0,.25,0,.7,7,4,-7,.1,0,0,0,3,0],s.chorusVolumes=[.9,.9,1,1,.95,.95,.9,1,1,1,.95,.975,.95,1,.975,.9,1,1,.9,1],s.chorusSigns=[1,1,1,1,1,1,1,1,1,-1,1,1,1,1,1,-1,1,-1,1,1],s.chorusRiffApp=[0,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1],s.chorusHarmonizes=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],s.harmDisplay=["arpeggio","duet","chord","seventh","half arpeggio","arp-chord"],s.harmNames=[0,1,2,3,4,5],s.fmChorusDisplay=["none","default","detune","honky tonk","consecutive","alt. major thirds","alt. minor thirds","fifths","octaves"],s.fmChorusNames=[0,1,2,3,4,5,6,7,8],s.imuteNames=["â—‰","â—Ž"],s.imuteValues=[1,0],s.octoffNames=["none","+2 (2 octaves)","+1 1/2 (octave and fifth)","+1 (octave)","+1/2 (fifth)","-1/2 (fifth)","-1 (octave)","-1 1/2 (octave and fifth)","-2 (2 octaves"],s.octoffValues=[0,24,19,12,7,-7,-12,-19,-24],s.volumeNames=["loudest","loud","medium","quiet","quietest","mute","i","couldnt","be","bothered"],s.volumeValues=[0,.25,.5,.75,1,1.25,1.5,1.75,2,-1],s.volumeMValues=[0,.5,1,1.5,2,-1],s.ipanValues=[-1,-.75,-.5,-.25,0,.25,.5,.75,1],s.operatorCount=4,s.operatorAlgorithmNames=["1â†(2â€‚3â€‚4)","1â†(2â€‚3â†4)","1â†2â†(3â€‚4)","1â†(2â€‚3)â†4","1â†2â†3â†4","1â†3â€ƒ2â†4","1â€ƒ2â†(3â€‚4)","1â€ƒ2â†3â†4","(1â€‚2)â†3â†4","(1â€‚2)â†(3â€‚4)","1â€ƒ2â€ƒ3â†4","(1â€‚2â€‚3)â†4","1â€ƒ2â€ƒ3â€ƒ4"],s.midiAlgorithmNames=["1<(2 3 4)","1<(2 3<4)","1<2<(3 4)","1<(2 3)<4","1<2<3<4","1<3 2<4","1 2<(3 4)","1 2<3<4","(1 2)<3<4","(1 2)<(3 4)","1 2 3<4","(1 2 3)<4","1 2 3 4"],s.operatorModulatedBy=[[[2,3,4],[],[],[]],[[2,3],[],[4],[]],[[2],[3,4],[],[]],[[2,3],[4],[4],[]],[[2],[3],[4],[]],[[3],[4],[],[]],[[],[3,4],[],[]],[[],[3],[4],[]],[[3],[3],[4],[]],[[3,4],[3,4],[],[]],[[],[],[4],[]],[[4],[4],[4],[]],[[],[],[],[]]],s.operatorAssociatedCarrier=[[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,2,1,2],[1,2,2,2],[1,2,2,2],[1,2,2,2],[1,2,2,2],[1,2,3,3],[1,2,3,3],[1,2,3,4]],s.operatorCarrierCounts=[1,1,1,1,1,2,2,2,2,2,3,3,4],s.operatorCarrierChorus=[[0,0,0,0],[0,.04,-.073,.091],[.5,.54,.427,.591],[0,.26,-.45,.67],[0,1,2,3],[0,4,7,11],[0,3,7,10],[0,7,14,21],[0,12,24,36]],s.operatorAmplitudeMax=15,s.operatorFrequencyNames=["1Ã—","~1Ã—","2Ã—","~2Ã—","3Ã—","4Ã—","5Ã—","6Ã—","7Ã—","8Ã—","9Ã—","10Ã—","11Ã—","13Ã—","16Ã—","20Ã—"],s.midiFrequencyNames=["1x","~1x","2x","~2x","3x","4x","5x","6x","7x","8x","9x","10x","11x","13x","16x","20x"],s.operatorFrequencies=[1,1,2,2,3,4,5,6,7,8,9,10,11,13,16,20],s.operatorHzOffsets=[0,1.5,0,-1.3,0,0,0,0,0,0,0,0,0,0,0,0],s.operatorAmplitudeSigns=[1,-1,1,-1,1,1,1,1,1,1,1,1,1,1,1,1],s.operatorEnvelopeNames=["custom","steady","punch","flare 1","flare 2","flare 3","pluck 1","pluck 2","pluck 3","swell 1","swell 2","swell 3","tremolo1","tremolo2","tremolo3","custom flare","custom tremolo","flute 1","flute 2","flute 3"],s.operatorEnvelopeType=[0,1,2,3,3,3,4,4,4,4,4,4,5,5,5,3,5,6,6,6],s.operatorSpecialCustomVolume=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!1,!1,!1],s.operatorEnvelopeSpeed=[0,0,0,32,8,2,32,8,2,32,8,2,4,2,1,8,0,16,8,4],s.operatorEnvelopeInverted=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!0,!1,!1,!1,!1,!1,!1,!1,!1],s.operatorFeedbackNames=["1âŸ²","2âŸ²","3âŸ²","4âŸ²","1âŸ²â€ƒ2âŸ²","3âŸ²â€ƒ4âŸ²","1âŸ²â€ƒ2âŸ²â€ƒ3âŸ²â€ƒ","2âŸ²â€ƒ3âŸ²â€ƒ4âŸ²â€ƒ","1âŸ²â€ƒ2âŸ²â€ƒ3âŸ²â€ƒ4âŸ²â€ƒ","1â†’2","1â†’3","1â†’4","2â†’3","2â†’4","3â†’4","1â†’3â€ƒ2â†’4","1â†’4â€ƒ2â†’3","1â†’2â†’3â†’4","1ðŸ—˜2","1ðŸ—˜3","1ðŸ—˜4","2ðŸ—˜3","2ðŸ—˜4","3ðŸ—˜4"],s.midiFeedbackNames=["1","2","3","4","1 2","3 4","1 2 3","2 3 4","1 2 3 4","1>2","1>3","1>4","2>3","2>4","3>4","1>3 2>4","1>4 2>3","1>2>3>4","1-2","1-3","1-4","2-3","2-4","3-4"],s.operatorFeedbackIndices=[[[1],[],[],[]],[[],[2],[],[]],[[],[],[3],[]],[[],[],[],[4]],[[1],[2],[],[]],[[],[],[3],[4]],[[1],[2],[3],[]],[[],[2],[3],[4]],[[1],[2],[3],[4]],[[],[1],[],[]],[[],[],[1],[]],[[],[],[],[1]],[[],[],[2],[]],[[],[],[],[2]],[[],[],[],[3]],[[],[],[1],[2]],[[],[],[2],[1]],[[],[1],[2],[3]],[[2],[1],[],[]],[[3],[],[1],[]],[[4],[],[],[1]],[[],[3],[2],[]],[[],[4],[],[2]],[[],[],[4],[3]]],s.pitchChannelTypeNames=["chip","FM (expert)","PWM (beta)"],s.pitchChannelTypeValues=[0,1,3],s.drumChannelTypeNames=["noise"],s.instrumentTypeNames=["chip","FM","noise","PWM"],s.oldThemeNames=["Default","ModBox 2.0","Artic","Cinnamon Roll [!]","Ocean","Rainbow [!]","Float [!]","Windows","Grassland","Dessert","Kahootiest","Beam to the Bit [!]","Pretty Egg","Poniryoshka","Gameboy [!]","Woodkid","Midnight","Snedbox","unnamed","Piano [!] [â†»]","Halloween","FrozenOverâ„ï¸"],s.channelOneBrightColorPallet="#25f3ff",s.channelTwoBrightColorPallet="#44ff44",s.channelThreeBrightColorPallet="#ffff25",s.channelFourBrightColorPallet="#ff9752",s.channelFiveBrightColorPallet="#ff90ff",s.channelSixBrightColorPallet="#9f31ea",s.channelSevenBrightColorPallet="#2b6aff",s.channelEightBrightColorPallet="#00ff9f",s.channelNineBrightColorPallet="#ffbf00",s.channelTenBrightColorPallet="#d85d00",s.channelElevenBrightColorPallet="#ff00a1",s.channelTwelveBrightColorPallet="#c26afc",s.channelThirteenBrightColorPallet="#ff1616",s.channelFourteenBrightColorPallet="#ffffff",s.channelFifteenBrightColorPallet="#768dfc",s.channelSixteenBrightColorPallet="#a5ff00",s.channelOneDimColorPallet="#0099a1",s.channelTwoDimColorPallet="#439143",s.channelThreeDimColorPallet="#a1a100",s.channelFourDimColorPallet="#c75000",s.channelFiveDimColorPallet="#d020d0",s.channelSixDimColorPallet="#552377",s.channelSevenDimColorPallet="#221b89",s.channelEightDimColorPallet="#00995f",s.channelNineDimColorPallet="#d6b03e",s.channelTenDimColorPallet="#b25915",s.channelElevenDimColorPallet="#891a60",s.channelTwelveDimColorPallet="#965cbc",s.channelThirteenDimColorPallet="#991010",s.channelFourteenDimColorPallet="#aaaaaa",s.channelFifteenDimColorPallet="#5869BD",s.channelSixteenDimColorPallet="#7c9b42",s.pitchChannelColorsDim=[s.channelOneDimColorPallet,s.channelTwoDimColorPallet,s.channelThreeDimColorPallet,s.channelFourDimColorPallet,s.channelFiveDimColorPallet,s.channelSixDimColorPallet,s.channelSevenDimColorPallet,s.channelEightDimColorPallet,s.channelNineDimColorPallet,s.channelTenDimColorPallet,s.channelElevenDimColorPallet,s.channelTwelveDimColorPallet],s.pitchChannelColorsBright=[s.channelOneBrightColorPallet,s.channelTwoBrightColorPallet,s.channelThreeBrightColorPallet,s.channelFourBrightColorPallet,s.channelFiveBrightColorPallet,s.channelSixBrightColorPallet,s.channelSevenBrightColorPallet,s.channelEightBrightColorPallet,s.channelNineBrightColorPallet,s.channelTenBrightColorPallet,s.channelElevenBrightColorPallet,s.channelTwelveBrightColorPallet],s.pitchNoteColorsDim=[s.channelOneDimColorPallet,s.channelTwoDimColorPallet,s.channelThreeDimColorPallet,s.channelFourDimColorPallet,s.channelFiveDimColorPallet,s.channelSixDimColorPallet,s.channelSevenDimColorPallet,s.channelEightDimColorPallet,s.channelNineDimColorPallet,s.channelTenDimColorPallet,s.channelElevenDimColorPallet,s.channelTwelveDimColorPallet],s.pitchNoteColorsBright=[s.channelOneBrightColorPallet,s.channelTwoBrightColorPallet,s.channelThreeBrightColorPallet,s.channelFourBrightColorPallet,s.channelFiveBrightColorPallet,s.channelSixBrightColorPallet,s.channelSevenBrightColorPallet,s.channelEightBrightColorPallet,s.channelNineBrightColorPallet,s.channelTenBrightColorPallet,s.channelElevenBrightColorPallet,s.channelTwelveBrightColorPallet],s.drumChannelColorsDim=[s.channelThirteenDimColorPallet,s.channelFourteenDimColorPallet,s.channelFifteenDimColorPallet,s.channelSixteenDimColorPallet],s.drumChannelColorsBright=[s.channelThirteenBrightColorPallet,s.channelFourteenBrightColorPallet,s.channelFifteenBrightColorPallet,s.channelSixteenBrightColorPallet],s.drumNoteColorsDim=[s.channelThirteenDimColorPallet,s.channelFourteenDimColorPallet,s.channelFifteenDimColorPallet,s.channelSixteenDimColorPallet],s.drumNoteColorsBright=[s.channelThirteenBrightColorPallet,s.channelFourteenBrightColorPallet,s.channelFifteenBrightColorPallet,s.channelSixteenBrightColorPallet],s.midiPitchChannelNames=["cyan channel","yellow channel","orange channel","green channel","purple channel","blue channel"],s.midiDrumChannelNames=["gray channel","brown channel","indigo channel"],s.midiSustainInstruments=[71,80,70,68,81,81,81,81,74],s.midiDecayInstruments=[46,46,6,24,25,25,106,106,33],s.drumInterval=6,s.pitchCount=37,s.maxPitch=84,s.pitchChannelCountMin=0,s.pitchChannelCountMax=12,s.drumChannelCountMin=0,s.drumChannelCountMax=4,s.waves=[s.t([1/15,.2,5/15,7/15,.6,11/15,13/15,1,1,13/15,11/15,.6,7/15,5/15,.2,1/15,-1/15,-.2,-5/15,-7/15,-.6,-11/15,-13/15,-1,-1,-13/15,-11/15,-.6,-7/15,-5/15,-.2,-1/15]),s.t([1,-1]),s.t([1,-1,-1,-1]),s.t([1,-1,-1,-1,-1,-1,-1,-1]),s.t([1/31,3/31,5/31,7/31,9/31,11/31,13/31,15/31,17/31,19/31,21/31,23/31,25/31,27/31,29/31,1,-1,-29/31,-27/31,-25/31,-23/31,-21/31,-19/31,-17/31,-15/31,-13/31,-11/31,-9/31,-7/31,-5/31,-3/31,-1/31]),s.t([0,-.2,-.4,-.6,-.8,-1,1,-.8,-.6,-.4,-.2,1,.8,.6,.4,.2]),s.t([1,1,1,1,1,-1,-1,-1,1,1,1,1,-1,-1,-1,-1]),s.t([1,-1,1,-1,1,0]),s.t([0,.2,.4,.5,.6,.7,.8,.85,.9,.95,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.95,.9,.85,.8,.7,.6,.5,.4,.2,0,-.2,-.4,-.5,-.6,-.7,-.8,-.85,-.9,-.95,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-.95,-.9,-.85,-.8,-.7,-.6,-.5,-.4,-.2]),s.t([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1]),s.t([1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),s.t([0,.1875,.3125,.5625,.5,.75,.875,1,1,.6875,.5,.625,.625,.5,.375,.5625,.4375,.5625,.4375,.4375,.3125,.1875,.1875,.375,.5625,.5625,.5625,.5625,.5625,.4375,.25,0]),s.t([1,.7,.1,.1,0,0,0,0,0,.1,.2,.15,.25,.125,.215,.345,4]),s.t([1/15,.2,5/15,9,.06]),s.t([-.5,3.5,3,-.5,-.25,-1]),s.t([0,.05,.125,.2,.25,.3,.425,.475,.525,.625,.675,.725,.775,.8,.825,.875,.9,.925,.95,.975,.98,.99,.995,1,.995,.99,.98,.975,.95,.925,.9,.875,.825,.8,.775,.725,.675,.625,.525,.475,.425,.3,.25,.2,.125,.05,0,-.05,-.125,-.2,-.25,-.3,-.425,-.475,-.525,-.625,-.675,-.725,-.775,-.8,-.825,-.875,-.9,-.925,-.95,-.975,-.98,-.99,-.995,-1,-.995,-.99,-.98,-.975,-.95,-.925,-.9,-.875,-.825,-.8,-.775,-.725,-.675,-.625,-.525,-.475,-.425,-.3,-.25,-.2,-.125,-.05]),s.t([1,1,1,1,0,1,0,1,1,0,0,1,0,0,0]),s.t([0,0,1,1,1,1,1,1,1,1,1,1,1,1,1]),s.t([1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),s.t([1,.5,1/3,1/4]),s.t([-.9,-1,-.85,-.775,-.7,-.6,-.5,-.4,-.325,-.225,-.2,-.125,-.1,-.11,-.125,-.15,-.175,-.18,-.2,-.21,-.22,-.21,-.2,-.175,-.15,-.1,-.5,.75,.11,.175,.2,.25,.26,.275,.26,.25,.225,.2,.19,.18,.19,.2,.21,.22,.23,.24,.25,.26,.275,.28,.29,.3,.29,.28,.27,.26,.25,.225,.2,.175,.15,.1,.075,0,-.01,-.025,.025,.075,.2,.3,.475,.6,.75,.85,.85,1,.99,.95,.8,.675,.475,.275,.01,-.15,-.3,-.475,-.5,-.6,-.71,-.81,-.9,-1,-.9]),s.t([-1,-.95,-.975,-.9,-.85,-.8,-.775,-.65,-.6,-.5,-.475,-.35,-.275,-.2,-.125,-.05,0,.075,.125,.15,.2,.21,.225,.25,.225,.21,.2,.19,.175,.125,.1,.075,.06,.05,.04,.025,.04,.05,.1,.15,.225,.325,.425,.575,.7,.85,.95,1,.9,.675,.375,.2,.275,.4,.5,.55,.6,.625,.65,.65,.65,.65,.64,.6,.55,.5,.4,.325,.25,.15,.05,-.05,-.15,-.275,-.35,-.45,-.55,-.65,-.7,-.78,-.825,-.9,-.925,-.95,-.975]),s.t([1,0,.1,-.1,-.2,-.4,-.3,-1]),s.t([1,-1,4,2.15,4.13,5.15,0,-.05,1]),s.t([6.1,-2.9,1.4,-2.9]),s.t([1,4,2,1,-.1,-1,-.12]),s.t([.2,1,2.6,1,0,-2.4]),s.t([1,.9,.8,.7,.6,.5,.4,.3,.2,.1,0,.1,.2,.3,.4,.5,.6,.7,.8,.9]),s.t([1,.9,.8,.7,.6,.5,.4,.3,.2,.1,0]),s.t([1,-.9,.8,-.7,.6,-.5,.4,-.3,.2,-.1,0,-.1,.2,-.3,.4,-.5,.6,-.7,.8,-.9,1])],s.wavesMixC=[s.t([1/15,.2,5/15,7/15,.6,11/15,13/15,1,1,13/15,11/15,.6,7/15,5/15,.2,1/15,-1/15,-.2,-5/15,-7/15,-.6,-11/15,-13/15,-1,-1,-13/15,-11/15,-.6,-7/15,-5/15,-.2,-1/15]),s.t([1,-1]),s.t([1,-1,-1,-1]),s.t([1,-1,-1,-1,-1,-1,-1,-1]),s.t([1/31,3/31,5/31,7/31,9/31,11/31,13/31,15/31,17/31,19/31,21/31,23/31,25/31,27/31,29/31,1,-1,-29/31,-27/31,-25/31,-23/31,-21/31,-19/31,-17/31,-15/31,-13/31,-11/31,-9/31,-7/31,-5/31,-3/31,-1/31]),s.t([0,-.2,-.4,-.6,-.8,-1,1,-.8,-.6,-.4,-.2,1,.8,.6,.4,.2]),s.t([1,1,1,1,1,-1,-1,-1,1,1,1,1,-1,-1,-1,-1]),s.t([1,-1,1,-1,1,0]),s.t([0,.2,.4,.5,.6,.7,.8,.85,.9,.95,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.95,.9,.85,.8,.7,.6,.5,.4,.2,0,-.2,-.4,-.5,-.6,-.7,-.8,-.85,-.9,-.95,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-.95,-.9,-.85,-.8,-.7,-.6,-.5,-.4,-.2]),s.t([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1]),s.t([1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),s.t([0,.1875,.3125,.5625,.5,.75,.875,1,1,.6875,.5,.625,.625,.5,.375,.5625,.4375,.5625,.4375,.4375,.3125,.1875,.1875,.375,.5625,.5625,.5625,.5625,.5625,.4375,.25,0]),s.t([1,.7,.1,.1,0,0,0,0,0,.1,.2,.15,.25,.125,.215,.345,4]),s.t([1/15,.2,5/15,9,.06]),s.t([-.5,3.5,3,-.5,-.25,-1]),s.t([0,.05,.125,.2,.25,.3,.425,.475,.525,.625,.675,.725,.775,.8,.825,.875,.9,.925,.95,.975,.98,.99,.995,1,.995,.99,.98,.975,.95,.925,.9,.875,.825,.8,.775,.725,.675,.625,.525,.475,.425,.3,.25,.2,.125,.05,0,-.05,-.125,-.2,-.25,-.3,-.425,-.475,-.525,-.625,-.675,-.725,-.775,-.8,-.825,-.875,-.9,-.925,-.95,-.975,-.98,-.99,-.995,-1,-.995,-.99,-.98,-.975,-.95,-.925,-.9,-.875,-.825,-.8,-.775,-.725,-.675,-.625,-.525,-.475,-.425,-.3,-.25,-.2,-.125,-.05]),s.t([1,1,1,1,0,1,0,1,1,0,0,1,0,0,0]),s.t([0,0,1,1,1,1,1,1,1,1,1,1,1,1,1]),s.t([1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),s.t([1,.5,1/3,1/4]),s.t([-.9,-1,-.85,-.775,-.7,-.6,-.5,-.4,-.325,-.225,-.2,-.125,-.1,-.11,-.125,-.15,-.175,-.18,-.2,-.21,-.22,-.21,-.2,-.175,-.15,-.1,-.5,.75,.11,.175,.2,.25,.26,.275,.26,.25,.225,.2,.19,.18,.19,.2,.21,.22,.23,.24,.25,.26,.275,.28,.29,.3,.29,.28,.27,.26,.25,.225,.2,.175,.15,.1,.075,0,-.01,-.025,.025,.075,.2,.3,.475,.6,.75,.85,.85,1,.99,.95,.8,.675,.475,.275,.01,-.15,-.3,-.475,-.5,-.6,-.71,-.81,-.9,-1,-.9]),s.t([-1,-.95,-.975,-.9,-.85,-.8,-.775,-.65,-.6,-.5,-.475,-.35,-.275,-.2,-.125,-.05,0,.075,.125,.15,.2,.21,.225,.25,.225,.21,.2,.19,.175,.125,.1,.075,.06,.05,.04,.025,.04,.05,.1,.15,.225,.325,.425,.575,.7,.85,.95,1,.9,.675,.375,.2,.275,.4,.5,.55,.6,.625,.65,.65,.65,.65,.64,.6,.55,.5,.4,.325,.25,.15,.05,-.05,-.15,-.275,-.35,-.45,-.55,-.65,-.7,-.78,-.825,-.9,-.925,-.95,-.975]),s.t([.7,0,.1,-.1,-.2,-.4,-.3,-.7]),s.t([1,-1,4,2.15,4.1,5.05,0,-.05,1]),s.t([4.5,-1.7,1,-1.7]),s.t([.1,.4,.2,.1,-.1,-1,-.12]),s.t([.03,.13,.3,1,0,-.26]),s.t([2,1.75,1.5,1.25,1,.75,.5,.25,0,.25,.5,.75,1,1.25,1.5,1.75]),s.t([1,1.9,1.8,1.7,1.6,1.5,1.4,1.3,1.2,1.1,1]),s.t([-1,-.9,.8,-.7,.6,-.5,.4,-.3,.2,-.1,0,-.1,.2,-.3,.4,-.5,.6,-.7,.8,-.9,-1])],s.pwmwaves=[s.t([1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),s.t([1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),s.t([1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),s.t([1,1,-1,-1,-1,-1,-1,-1,-1,-1]),s.t([1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),s.t([1,1,1,-1,-1,-1,-1,-1,-1,-1]),s.t([1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),s.t([1,1,1,1,-1,-1,-1,-1,-1,-1]),s.t([1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),s.t([1,1,1,1,1,-1,-1,-1,-1,-1])],s.sineWaveLength=256,s.sineWaveMask=s.sineWaveLength-1,s.sineWave=s.generateSineWave();var a=t&&t.h||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},r=t&&t.o||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,s,h=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=h.next()).done;)a.push(i.value)}catch(t){s={error:t}}finally{try{i&&!i.done&&(n=h.return)&&n.call(h)}finally{if(s)throw s.error}}return a},o=t&&t.l||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(r(arguments[e]));return t};function c(t,e){var n,i,s,h,r,l;try{for(var p=a(e),f=p.next();!f.done;f=p.next()){var d=f.value;if(d instanceof Node)t.appendChild(d);else if("string"==typeof d)t.appendChild(document.createTextNode(d));else if("function"==typeof d)c(t,[d()]);else if(Array.isArray(d))c(t,d);else if(d&&"undefined"!=typeof Symbol&&"function"==typeof d[Symbol.iterator])c(t,o(d));else if(d&&d.constructor===Object&&t instanceof Element)try{for(var y=(s=void 0,a(Object.keys(d))),m=y.next();!m.done;m=y.next()){var u=m.value,b=d[u];if("class"===u)"string"==typeof b?t.setAttribute("class",b):Array.isArray(d)||b&&"undefined"!=typeof Symbol&&"function"==typeof b[Symbol.iterator]?t.setAttribute("class",o(b).join(" ")):console.warn("Invalid "+u+' value "'+b+'" on '+t.tagName+" element.");else if("style"===u)if(b&&b.constructor===Object)try{for(var g=(r=void 0,a(Object.keys(b))),x=g.next();!x.done;x=g.next()){var w=x.value;w in t.style?t.style[w]=b[w]:t.style.setProperty(w,b[w])}}catch(t){r={error:t}}finally{try{x&&!x.done&&(l=g.return)&&l.call(g)}finally{if(r)throw r.error}}else t.setAttribute(u,b);else"function"==typeof b?t[u]=b:"boolean"==typeof b?b?t.setAttribute(u,""):t.removeAttribute(u):t.setAttribute(u,b)}}catch(t){s={error:t}}finally{try{m&&!m.done&&(h=y.return)&&h.call(y)}finally{if(s)throw s.error}}else t.appendChild(document.createTextNode(d))}}catch(t){n={error:t}}finally{try{f&&!f.done&&(i=p.return)&&i.call(p)}finally{if(n)throw n.error}}return t}var l="http://www.w3.org/2000/svg";var p,f,d,y,m=t&&t.h||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},u=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return document.createRange().createContextualFragment(t.join())},b=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=document.createDocumentFragment(),i=(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg">'+t.join()+"</svg>","image/svg+xml").documentElement;null!==i.firstChild;)document.importNode(i.firstChild,!0),n.appendChild(i.firstChild);return n},g=function(t){u[t]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return c(document.createElement(t),e)}};try{for(var x=m("a abbr address area article aside audio b base bdi bdo blockquote br button canvas caption cite code col colgroup datalist dd del details dfn dialog div dl dt em embed fieldset figcaption figure footer form h1 h2 h3 h4 h5 h6 header hr i iframe img input ins kbd label legend li link main map mark menu menuitem meta meter nav noscript object ol optgroup option output p param picture pre progress q rp rt ruby s samp script section select small source span strong style sub summary sup table tbody td template textarea tfoot th thead time title tr track u ul var video wbr".split(" ")),w=x.next();!w.done;w=x.next()){g(w.value)}}catch(Tn){p={error:Tn}}finally{try{w&&!w.done&&(f=x.return)&&f.call(x)}finally{if(p)throw p.error}}var v=function(t){if(b[t]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return c(document.createElementNS(l,t),e)},/-/.test(t)){var e=t.replace(/-/g,"_");b[e]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return c(document.createElementNS(l,t),e)}}};try{for(var k=m("a altGlyph altGlyphDef altGlyphItem animate animateMotion animateTransform circle clipPath color-profile cursor defs desc discard ellipse feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feDropShadow feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence filter font font-face font-face-format font-face-name font-face-src font-face-uri foreignObject g glyph glyphRef hkern image line linearGradient marker mask metadata missing-glyph mpath path pattern polygon polyline radialGradient rect script set stop style svg switch symbol text textPath title tref tspan use view vkern".split(" ")),C=k.next();!C.done;C=k.next()){v(C.value)}}catch(On){d={error:On}}finally{try{C&&!C.done&&(y=k.return)&&y.call(k)}finally{if(d)throw d.error}}function L(t,e,n){return n<=(e-=1)?n>=t?n:t:e}class M{constructor(t,e,n,i){this.p=[],this.m=0;for(let s=n;s<i;s++){const n=t[e.charCodeAt(s)];this.p.push(n>>5&1),this.p.push(n>>4&1),this.p.push(n>>3&1),this.p.push(n>>2&1),this.p.push(n>>1&1),this.p.push(1&n)}}read(t){let e=0;for(;t>0;)e<<=1,e+=this.p[this.m++],t--;return e}readLongTail(t,e){let n=t,i=e;for(;this.p[this.m++];)n+=1<<i,i++;for(;i>0;)i--,this.p[this.m++]&&(n+=1<<i);return n}readPartDuration(){return this.readLongTail(1,2)}readPinCount(){return this.readLongTail(1,0)}readPitchInterval(){return this.read(1)?-this.readLongTail(1,3):this.readLongTail(1,3)}}class S{constructor(){this.p=[]}write(t,e){for(t--;t>=0;)this.p.push(e>>>t&1),t--}writeLongTail(t,e,n){if(n<t)throw new Error("value out of bounds");n-=t;let i=e;for(;n>=1<<i;)this.p.push(1),n-=1<<i,i++;for(this.p.push(0);i>0;)i--,this.p.push(n>>>i&1)}writePartDuration(t){this.writeLongTail(1,2,t)}writePinCount(t){this.writeLongTail(1,0,t)}writePitchInterval(t){t<0?(this.write(1,1),this.writeLongTail(1,3,-t)):(this.write(1,0),this.writeLongTail(1,3,t))}concat(t){this.p=this.p.concat(t.p)}encodeBase64(t,e){for(let n=0;n<this.p.length;n+=6){const i=this.p[n]<<5|this.p[n+1]<<4|this.p[n+2]<<3|this.p[n+3]<<2|this.p[n+4]<<1|this.p[n+5];e.push(t[i])}return e}lengthBase64(){return Math.ceil(this.p.length/6)}}class F{constructor(t){this.frequency=0,this.amplitude=0,this.envelope=0,this.reset(t)}reset(t){this.frequency=0,this.amplitude=t<=1?s.operatorAmplitudeMax:0,this.envelope=1}copy(t){this.frequency=t.frequency,this.amplitude=t.amplitude,this.envelope=t.envelope}}function B(t,e,n){return{interval:t,time:e,volume:n}}function P(t,e,n,i,s=!1){return{pitches:[t],pins:[B(0,0,i),B(0,n-e,s?0:i)],start:e,end:n}}class E{constructor(){this.type=0,this.wave=1,this.filter=1,this.transition=1,this.effect=0,this.harm=0,this.fmChorus=1,this.imute=0,this.octoff=0,this.chorus=0,this.volume=0,this.ipan=4,this.algorithm=0,this.feedbackType=0,this.feedbackAmplitude=0,this.feedbackEnvelope=1,this.operators=[];for(let t=0;t<s.operatorCount;t++)this.operators.push(new F(t))}reset(){this.type=0,this.wave=1,this.filter=1,this.transition=1,this.effect=0,this.harm=0,this.fmChorus=1,this.imute=0,this.ipan=4,this.octoff=0,this.chorus=0,this.volume=0,this.algorithm=0,this.feedbackType=0,this.feedbackAmplitude=0,this.feedbackEnvelope=1;for(let t=0;t<this.operators.length;t++)this.operators[t].reset(t)}setTypeAndReset(t){switch(this.type=t,t){case 0:case 3:this.wave=1,this.filter=1,this.transition=1,this.effect=0,this.harm=0,this.imute=0,this.ipan=4,this.octoff=0,this.chorus=0,this.volume=0;break;case 1:this.wave=1,this.transition=1,this.volume=0,this.imute=0,this.ipan=4,this.harm=0,this.octoff=0;break;case 2:this.transition=1,this.octoff=0,this.fmChorus=1,this.ipan=4,this.effect=0,this.algorithm=0,this.feedbackType=0,this.feedbackAmplitude=0,this.feedbackEnvelope=1,this.volume=0;for(let t=0;t<this.operators.length;t++)this.operators[t].reset(t)}}copy(t){this.type=t.type,this.wave=t.wave,this.filter=t.filter,this.transition=t.transition,this.effect=t.effect,this.chorus=t.chorus,this.volume=t.volume,this.harm=t.harm,this.fmChorus=t.fmChorus,this.imute=t.imute,this.ipan=t.ipan,this.octoff=t.octoff,this.algorithm=t.algorithm,this.feedbackType=t.feedbackType,this.feedbackAmplitude=t.feedbackAmplitude,this.feedbackEnvelope=t.feedbackEnvelope;for(let e=0;e<this.operators.length;e++)this.operators[e].copy(t.operators[e])}}class R{constructor(){this.octave=0,this.instruments=[],this.patterns=[],this.bars=[]}}class N{constructor(){this.notes=[],this.instrument=0}cloneNotes(){const t=[];for(const e of this.notes){const n=P(-1,e.start,e.end,3);n.pitches=e.pitches.concat(),n.pins=[];for(const t of e.pins)n.pins.push(B(t.interval,t.time,t.volume));t.push(n)}return t}reset(){this.notes.length=0,this.instrument=0}}class T{constructor(t){this.channels=[],this.u=[],null!=t?this.fromBase64String(t):this.initToDefault(!0)}getChannelCount(){return this.pitchChannelCount+this.drumChannelCount}getChannelUnusedCount(){return s.pitchChannelCountMax+s.drumChannelCountMax-(this.pitchChannelCount+this.drumChannelCount)}getTimeSig(){return this.beatsPerBar+"/"+this.partsPerBeat+" with "+this.barCount+" bars."}getScaleNKey(){return' "'+s.scales[this.scale].name+'" and your key is '+s.keys[this.key].name}getChannelIsDrum(t){return t>=this.pitchChannelCount}getChannelColorDim(t){return t<this.pitchChannelCount?s.pitchChannelColorsDim[t]:s.drumChannelColorsDim[t-this.pitchChannelCount]}getChannelColorBright(t){return t<this.pitchChannelCount?s.pitchChannelColorsBright[t]:s.drumChannelColorsBright[t-this.pitchChannelCount]}getNoteColorDim(t){return t<this.pitchChannelCount?s.pitchNoteColorsDim[t]:s.drumNoteColorsDim[t-this.pitchChannelCount]}getNoteColorBright(t){return t<this.pitchChannelCount?s.pitchNoteColorsBright[t]:s.drumNoteColorsBright[t-this.pitchChannelCount]}initToDefault(t=!0){if(this.scale=0,this.setSongTheme="none",this.key=s.keys.map((t=>t.name)).indexOf("C"),this.mix=1,this.sampleRate=2,this.loopStart=0,this.loopLength=4,this.tempo=151,this.reverb=0,this.blend=0,this.riff=0,this.detune=0,this.muff=0,this.beatsPerBar=8,this.barCount=16,this.patternsPerChannel=8,this.partsPerBeat=4,this.instrumentsPerChannel=1,t){this.pitchChannelCount=4,this.drumChannelCount=1;for(let t=0;t<this.getChannelCount();t++){this.channels.length<=t&&(this.channels[t]=new R);const e=this.channels[t];e.octave=4-t;for(let t=0;t<this.patternsPerChannel;t++)e.patterns.length<=t?e.patterns[t]=new N:e.patterns[t].reset();e.patterns.length=this.patternsPerChannel;for(let t=0;t<this.instrumentsPerChannel;t++)e.instruments.length<=t?e.instruments[t]=new E:e.instruments[t].reset();e.instruments.length=this.instrumentsPerChannel;for(let t=0;t<this.barCount;t++)e.bars[t]=t<4?1:0;e.bars.length=this.barCount}this.channels.length=this.getChannelCount()}}toBase64String(){let t,e=[];const n=T.v;e.push(T.k),e.push(n[T.C]),e.push(110,n[this.pitchChannelCount],n[this.drumChannelCount]),e.push(122);var i=encodeURIComponent(this.setSongTheme);e.push(n[i.length>>6],n[63&i.length]);for(let t=0;t<i.length;t++)e.push(i.charCodeAt(t));e.push(115,n[this.scale]),e.push(117,n[this.mix]),e.push(124,n[this.sampleRate]),e.push(107,n[this.key]),e.push(108,n[this.loopStart>>6],n[63&this.loopStart]),e.push(101,n[this.loopLength-1>>6],n[this.loopLength-1&63]),e.push(116,n[this.tempo>>6],n[63&this.tempo]),e.push(109,n[this.reverb]),e.push(120,n[this.blend]),e.push(121,n[this.riff]),e.push(72,n[this.detune]),e.push(36,n[this.muff]),e.push(97,n[this.beatsPerBar-1]),e.push(103,n[this.barCount-1>>6],n[this.barCount-1&63]),e.push(106,n[this.patternsPerChannel-1]),e.push(105,n[this.instrumentsPerChannel-1]),e.push(114,n[s.partCounts.indexOf(this.partsPerBeat)]),e.push(111);for(let t=0;t<this.getChannelCount();t++)e.push(n[this.channels[t].octave]);for(let t=0;t<this.getChannelCount();t++)for(let i=0;i<this.instrumentsPerChannel;i++){const h=this.channels[t].instruments[i];if(t<this.pitchChannelCount)if(e.push(84,n[h.type]),0==h.type)e.push(119,n[h.wave]),e.push(102,n[h.filter]),e.push(100,n[h.transition]),e.push(99,n[h.effect]),e.push(113,n[h.harm]),e.push(71,n[h.imute]),e.push(76,n[h.ipan]),e.push(66,n[h.octoff]),e.push(104,n[h.chorus]),e.push(118,n[h.volume]);else if(1==h.type){e.push(100,n[h.transition]),e.push(99,n[h.effect]),e.push(66,n[h.octoff]),e.push(35,n[h.fmChorus]),e.push(71,n[h.imute]),e.push(76,n[h.ipan]),e.push(65,n[h.algorithm]),e.push(70,n[h.feedbackType]),e.push(95,n[h.feedbackAmplitude]),e.push(86,n[h.feedbackEnvelope]),e.push(118,n[h.volume]),e.push(81);for(let t=0;t<s.operatorCount;t++)e.push(n[h.operators[t].frequency]);e.push(80);for(let t=0;t<s.operatorCount;t++)e.push(n[h.operators[t].amplitude]);e.push(69);for(let t=0;t<s.operatorCount;t++)e.push(n[h.operators[t].envelope])}else{if(3!=h.type)throw new Error("Unknown instrument type.");e.push(119,n[h.wave]),e.push(102,n[h.filter]),e.push(100,n[h.transition]),e.push(99,n[h.effect]),e.push(113,n[h.harm]),e.push(71,n[h.imute]),e.push(76,n[h.ipan]),e.push(66,n[h.octoff]),e.push(104,n[h.chorus]),e.push(118,n[h.volume])}else e.push(84,n[2]),e.push(119,n[h.wave]),e.push(100,n[h.transition]),e.push(118,n[h.volume]),e.push(71,n[h.imute]),e.push(113,n[h.harm]),e.push(66,n[h.octoff]),e.push(76,n[h.ipan])}e.push(98),t=new S;let h=0;for(;1<<h<this.patternsPerChannel+1;)h++;for(let e=0;e<this.getChannelCount();e++)for(let n=0;n<this.barCount;n++)t.write(h,this.channels[e].bars[n]);t.encodeBase64(n,e),e.push(112),t=new S;let a=0;for(;1<<a<this.instrumentsPerChannel;)a++;for(let e=0;e<this.getChannelCount();e++){const i=this.getChannelIsDrum(e),s=i?0:12*this.channels[e].octave;let h=(i?4:12)+s;const r=i?[4,6,7,2,3,8,0,10]:[12,19,24,31,36,7,0],o=[];for(let t=0;t<r.length;t++)r[t]+=s;for(const i of this.channels[e].patterns)if(t.write(a,i.instrument),i.notes.length>0){t.write(1,1);let e=0;for(const s of i.notes){s.start>e&&(t.write(2,0),t.writePartDuration(s.start-e));const i=new S;for(let t=1;t<s.pitches.length;t++)i.write(1,1);s.pitches.length<4&&i.write(1,0),i.writePinCount(s.pins.length-1),i.write(2,s.pins[0].volume);let a=0,c=s.pitches[0],l=c;const p=[];for(let t=1;t<s.pins.length;t++){const e=s.pins[t],n=c+e.interval;l!=n?(i.write(1,1),p.push(n),l=n):i.write(1,0),i.writePartDuration(e.time-a),a=e.time,i.write(2,e.volume)}const f=String.fromCharCode.apply(null,i.encodeBase64(n,[])),d=o.indexOf(f);-1==d?(t.write(2,1),t.concat(i)):(t.write(1,1),t.writeLongTail(0,0,d),o.splice(d,1)),o.unshift(f),o.length>10&&o.pop();const y=s.pitches.concat(p);for(let e=0;e<y.length;e++){const n=y[e],i=r.indexOf(n);if(-1==i){let e=0,i=h;if(i<n)for(;i!=n;)i++,-1==r.indexOf(i)&&e++;else for(;i!=n;)i--,-1==r.indexOf(i)&&e--;t.write(1,0),t.writePitchInterval(e)}else t.write(1,1),t.write(3,i),r.splice(i,1);r.unshift(n),r.length>8&&r.pop(),h=e==s.pitches.length-1?s.pitches[0]:n}e=s.end}e<this.beatsPerBar*this.partsPerBeat&&(t.write(2,0),t.writePartDuration(this.beatsPerBar*this.partsPerBeat-e))}else t.write(1,0)}let r=t.lengthBase64(),o=[];for(;r>0;)o.unshift(n[63&r]),r>>=6;if(e.push(n[o.length]),Array.prototype.push.apply(e,o),t.encodeBase64(n,e),e.length>=65535)throw new Error("Song hash code too long.");return String.fromCharCode.apply(null,e)}fromBase64String(t){if(null==t||""==t)return void this.initToDefault(!0);let e=0;for(;t.charCodeAt(e)<=32;)e++;if(35==t.charCodeAt(e)&&e++,123==t.charCodeAt(e))return void this.fromJsonObject(JSON.parse(0==e?t:t.substring(e)));let n,i;110==t.charCodeAt(e)?(n=!1,i=!0,e++):(n=!0,i=!1);const h=T.L[t.charCodeAt(e++)];if(n&&(-1==h||h>T.M||h<T.S))return;if(i&&(-1==h||h>T.C||h<T.F))return;const a=h<3,r=h<4,o=h<5,c=h<6,l=T.L;if(this.initToDefault(n&&c||i),n&&a){for(const t of this.channels)t.instruments[0].transition=0;this.channels[3].instruments[0].wave=0}let p=0,f=-1;for(;e<t.length;){const h=t.charCodeAt(e++);let m;if(110==h){this.pitchChannelCount=l[t.charCodeAt(e++)],this.drumChannelCount=l[t.charCodeAt(e++)],this.pitchChannelCount=L(s.pitchChannelCountMin,s.pitchChannelCountMax+1,this.pitchChannelCount),this.drumChannelCount=L(s.drumChannelCountMin,s.drumChannelCountMax+1,this.drumChannelCount);for(let t=this.channels.length;t<this.getChannelCount();t++)this.channels[t]=new R;this.channels.length=this.getChannelCount()}else if(115==h)this.scale=l[t.charCodeAt(e++)],n&&a&&10==this.scale&&(this.scale=11);else if(117==h)this.mix=l[t.charCodeAt(e++)];else if(107==h)this.key=l[t.charCodeAt(e++)];else if(122==h)if(n){var d=l[t.charCodeAt(e++)];this.setSongTheme=["none","modbox2","artic","Cinnamon Roll","Ocean","rainbow","float","windows","grassland","dessert","kahootiest","beambit","egg","Poniryoshka","gameboy","woodkid","midnight","snedbox","unnamed","piano","halloween","frozen"][d]}else{var y=(l[t.charCodeAt(e++)]<<6)+l[t.charCodeAt(e++)];this.setSongTheme=decodeURIComponent(t.substring(e,e+y)),e+=y}else if(108==h)this.loopStart=n&&o?l[t.charCodeAt(e++)]:(l[t.charCodeAt(e++)]<<6)+l[t.charCodeAt(e++)];else if(101==h)this.loopLength=n&&o?l[t.charCodeAt(e++)]:(l[t.charCodeAt(e++)]<<6)+l[t.charCodeAt(e++)]+1;else if(116==h)this.tempo=n?r?[1,4,7,10][l[t.charCodeAt(e++)]]:[88,95,103,111,120,130,140,151,163,176,190,206,222,240,259][l[t.charCodeAt(e++)]]:(l[t.charCodeAt(e++)]<<6)+l[t.charCodeAt(e++)],this.tempo=L(s.tempoMin,s.tempoMax,this.tempo);else if(109==h)this.reverb=l[t.charCodeAt(e++)],this.reverb=L(0,s.reverbRange,this.reverb);else if(120==h)this.blend=L(0,s.blendRange,l[t.charCodeAt(e++)]);else if(121==h)this.riff=L(0,s.riffRange,l[t.charCodeAt(e++)]);else if(124==h)this.sampleRate=l[t.charCodeAt(e++)];else if(72==h)this.detune=L(0,s.detuneRange,l[t.charCodeAt(e++)]);else if(36==h)this.muff=L(0,s.muffRange,l[t.charCodeAt(e++)]);else if(97==h)this.beatsPerBar=n&&a?[6,7,8,9,10][l[t.charCodeAt(e++)]]:l[t.charCodeAt(e++)]+1,this.beatsPerBar=Math.max(s.beatsPerBarMin,Math.min(s.beatsPerBarMax,this.beatsPerBar));else if(103==h){this.barCount=(l[t.charCodeAt(e++)]<<6)+l[t.charCodeAt(e++)]+1,this.barCount=Math.max(s.barCountMin,Math.min(s.barCountMax,this.barCount));for(let t=0;t<this.getChannelCount();t++){for(let e=this.channels[t].bars.length;e<this.barCount;e++)this.channels[t].bars[e]=1;this.channels[t].bars.length=this.barCount}}else if(106==h){this.patternsPerChannel=l[t.charCodeAt(e++)]+1,this.patternsPerChannel=Math.max(1,Math.min(s.barCountMax,this.patternsPerChannel));for(let t=0;t<this.getChannelCount();t++){for(let e=this.channels[t].patterns.length;e<this.patternsPerChannel;e++)this.channels[t].patterns[e]=new N;this.channels[t].patterns.length=this.patternsPerChannel}}else if(105==h){this.instrumentsPerChannel=l[t.charCodeAt(e++)]+1,this.instrumentsPerChannel=Math.max(s.instrumentsPerChannelMin,Math.min(s.instrumentsPerChannelMax,this.instrumentsPerChannel));for(let t=0;t<this.getChannelCount();t++){for(let e=this.channels[t].instruments.length;e<this.instrumentsPerChannel;e++)this.channels[t].instruments[e]=new E;this.channels[t].instruments.length=this.instrumentsPerChannel}}else if(114==h)this.partsPerBeat=s.partCounts[l[t.charCodeAt(e++)]];else if(111==h)if(n&&a)m=l[t.charCodeAt(e++)],this.channels[m].octave=L(0,5,l[t.charCodeAt(e++)]);else for(m=0;m<this.getChannelCount();m++)this.channels[m].octave=L(0,5,l[t.charCodeAt(e++)]);else if(84==h){f++,f>=this.instrumentsPerChannel&&(p++,f=0);const n=p<this.pitchChannelCount,i=this.channels[p].instruments[f];let s=L(0,4,l[t.charCodeAt(e++)]);2==s&&n&&(s=3),i.setTypeAndReset(s)}else if(119==h)if(n&&a)m=l[t.charCodeAt(e++)],this.channels[m].instruments[0].wave=L(0,s.waveNames.length,l[t.charCodeAt(e++)]);else if(n&&c)for(m=0;m<this.getChannelCount();m++){const n=m>=this.pitchChannelCount;for(let i=0;i<this.instrumentsPerChannel;i++)this.channels[m].instruments[i].wave=L(0,n?s.drumNames.length:s.waveNames.length,l[t.charCodeAt(e++)])}else{const n=p>=this.pitchChannelCount;this.channels[p].instruments[f].wave=L(0,n?s.drumNames.length:s.waveNames.length,l[t.charCodeAt(e++)])}else if(102==h)if(n&&a)m=l[t.charCodeAt(e++)],this.channels[m].instruments[0].filter=[1,3,4,5][L(0,s.filterNames.length,l[t.charCodeAt(e++)])];else if(n&&c)for(m=0;m<this.getChannelCount();m++)for(let n=0;n<this.instrumentsPerChannel;n++)this.channels[m].instruments[n].filter=L(0,s.filterNames.length,l[t.charCodeAt(e++)]+1);else this.channels[p].instruments[f].filter=L(0,s.filterNames.length,l[t.charCodeAt(e++)]);else if(100==h)if(n&&a)m=l[t.charCodeAt(e++)],this.channels[m].instruments[0].transition=L(0,s.transitionNames.length,l[t.charCodeAt(e++)]);else if(n&&c)for(m=0;m<this.getChannelCount();m++)for(let n=0;n<this.instrumentsPerChannel;n++)this.channels[m].instruments[n].transition=L(0,s.transitionNames.length,l[t.charCodeAt(e++)]);else this.channels[p].instruments[f].transition=L(0,s.transitionNames.length,l[t.charCodeAt(e++)]);else if(99==h)if(n&&a){m=l[t.charCodeAt(e++)];let n=L(0,s.effectNames.length,l[t.charCodeAt(e++)]);1==n?n=3:3==n&&(n=5),this.channels[m].instruments[0].effect=n}else if(n&&c)for(m=0;m<this.getChannelCount();m++)for(let n=0;n<this.instrumentsPerChannel;n++)this.channels[m].instruments[n].effect=L(0,s.effectNames.length,l[t.charCodeAt(e++)]);else this.channels[p].instruments[f].effect=L(0,s.effectNames.length,l[t.charCodeAt(e++)]);else if(104==h)if(n&&a)m=l[t.charCodeAt(e++)],this.channels[m].instruments[0].chorus=L(0,s.chorusNames.length,l[t.charCodeAt(e++)]);else if(n&&c)for(m=0;m<this.getChannelCount();m++)for(let n=0;n<this.instrumentsPerChannel;n++)this.channels[m].instruments[n].chorus=L(0,s.chorusNames.length,l[t.charCodeAt(e++)]);else this.channels[p].instruments[f].chorus=L(0,s.chorusNames.length,l[t.charCodeAt(e++)]);else if(113==h)if(n&&c)for(m=0;m<this.getChannelCount();m++)for(let n=0;n<this.instrumentsPerChannel;n++)this.channels[m].instruments[n].harm=L(0,s.harmNames.length,l[t.charCodeAt(e++)]);else this.channels[p].instruments[f].harm=L(0,s.harmNames.length,l[t.charCodeAt(e++)]);else if(35==h)this.channels[p].instruments[f].fmChorus=L(0,s.fmChorusNames.length,l[t.charCodeAt(e++)]);else if(71==h)this.channels[p].instruments[f].imute=L(0,s.imuteNames.length,l[t.charCodeAt(e++)]);else if(76==h)this.channels[p].instruments[f].ipan=L(0,s.ipanValues.length,l[t.charCodeAt(e++)]);else if(66==h)if(n&&c)for(m=0;m<this.getChannelCount();m++)for(let n=0;n<this.instrumentsPerChannel;n++)this.channels[m].instruments[n].octoff=L(0,s.octoffNames.length,l[t.charCodeAt(e++)]);else this.channels[p].instruments[f].octoff=L(0,s.octoffNames.length,l[t.charCodeAt(e++)]);else if(118==h)if(n&&a)m=l[t.charCodeAt(e++)],this.channels[m].instruments[0].volume=L(0,s.volumeNames.length,l[t.charCodeAt(e++)]);else if(n&&c)for(m=0;m<this.getChannelCount();m++)for(let n=0;n<this.instrumentsPerChannel;n++)this.channels[m].instruments[n].volume=L(0,s.volumeNames.length,l[t.charCodeAt(e++)]);else this.channels[p].instruments[f].volume=L(0,s.volumeNames.length,l[t.charCodeAt(e++)]);else if(65==h)this.channels[p].instruments[f].algorithm=L(0,s.operatorAlgorithmNames.length,l[t.charCodeAt(e++)]);else if(70==h)this.channels[p].instruments[f].feedbackType=L(0,s.operatorFeedbackNames.length,l[t.charCodeAt(e++)]);else if(95==h)this.channels[p].instruments[f].feedbackAmplitude=L(0,s.operatorAmplitudeMax+1,l[t.charCodeAt(e++)]);else if(86==h)this.channels[p].instruments[f].feedbackEnvelope=L(0,s.operatorEnvelopeNames.length,l[t.charCodeAt(e++)]);else if(81==h)for(let n=0;n<s.operatorCount;n++)this.channels[p].instruments[f].operators[n].frequency=L(0,s.operatorFrequencyNames.length,l[t.charCodeAt(e++)]);else if(80==h)for(let n=0;n<s.operatorCount;n++)this.channels[p].instruments[f].operators[n].amplitude=L(0,s.operatorAmplitudeMax+1,l[t.charCodeAt(e++)]);else if(69==h)for(let n=0;n<s.operatorCount;n++)this.channels[p].instruments[f].operators[n].envelope=L(0,s.operatorEnvelopeNames.length,l[t.charCodeAt(e++)]);else if(98==h){let i;if(n&&a){m=l[t.charCodeAt(e++)];const n=l[t.charCodeAt(e++)];i=Math.ceil(.5*n);const s=new M(l,t,e,e+i);for(let t=0;t<n;t++)this.channels[m].bars[t]=s.read(3)+1}else if(n&&o){let n=0;for(;1<<n<this.patternsPerChannel;)n++;i=Math.ceil(this.getChannelCount()*this.barCount*n/6);const s=new M(l,t,e,e+i);for(m=0;m<this.getChannelCount();m++)for(let t=0;t<this.barCount;t++)this.channels[m].bars[t]=s.read(n)+1}else{let n=0;for(;1<<n<this.patternsPerChannel+1;)n++;i=Math.ceil(this.getChannelCount()*this.barCount*n/6);const s=new M(l,t,e,e+i);for(m=0;m<this.getChannelCount();m++)for(let t=0;t<this.barCount;t++)this.channels[m].bars[t]=s.read(n)}e+=i}else if(112==h){let s=0;if(n&&a)m=l[t.charCodeAt(e++)],e++,s=l[t.charCodeAt(e++)],s<<=6,s+=l[t.charCodeAt(e++)];else{m=0;let n=l[t.charCodeAt(e++)];for(;n>0;)s<<=6,s+=l[t.charCodeAt(e++)],n--}const h=new M(l,t,e,e+s);e+=s;let r=0;for(;1<<r<this.instrumentsPerChannel;)r++;for(;;){const t=this.getChannelIsDrum(m),e=t?0:12*this.channels[m].octave;let s=null,o=null,c=(t?4:12)+e;const l=t?[4,6,7,2,3,8,0,10]:[12,19,24,31,36,7,0],p=[];for(let t=0;t<l.length;t++)l[t]+=e;for(let t=0;t<this.patternsPerChannel;t++){const e=this.channels[m].patterns[t];if(e.reset(),e.instrument=h.read(r),(n&&!a||i)&&0==h.read(1))continue;let f=0;const d=e.notes;for(;f<this.beatsPerBar*this.partsPerBeat;){const t=1==h.read(1);let e=!1,n=0;if(t?n=h.readLongTail(0,0):e=1==h.read(1),t||e){let e,i,a;if(t)e=p[n],p.splice(n,1);else{for(e={},e.pitchCount=1;e.pitchCount<4&&1==h.read(1);)e.pitchCount++;e.pinCount=h.readPinCount(),e.initialVolume=h.read(2),e.pins=[],e.length=0,e.bendCount=0;for(let t=0;t<e.pinCount;t++)i={},i.pitchBend=1==h.read(1),i.pitchBend&&e.bendCount++,e.length+=h.readPartDuration(),i.time=e.length,i.volume=h.read(2),e.pins.push(i)}p.unshift(e),p.length>10&&p.pop(),s=P(0,f,f+e.length,e.initialVolume),s.pitches=[],s.pins.length=1;const r=[];for(let t=0;t<e.pitchCount+e.bendCount;t++){if(1==h.read(1)){const t=h.read(3);a=l[t],l.splice(t,1)}else{a=c;let t=h.readPitchInterval();for(;t>0;){for(a++;-1!=l.indexOf(a);)a++;t--}for(;t<0;){for(a--;-1!=l.indexOf(a);)a--;t++}}l.unshift(a),l.length>8&&l.pop(),t<e.pitchCount?s.pitches.push(a):r.push(a),c=t==e.pitchCount-1?s.pitches[0]:a}r.unshift(s.pitches[0]);for(const t of e.pins)t.pitchBend&&r.shift(),o=B(r[0]-s.pitches[0],t.time,t.volume),s.pins.push(o);f=s.end,d.push(s)}else{f+=h.readPartDuration()}}}if(n&&a)break;if(m++,m>=this.getChannelCount())break}}}}toJsonObject(t=!0,e=1,n=!0){const i=[];for(let h=0;h<this.getChannelCount();h++){const a=[],r=this.getChannelIsDrum(h);for(let t=0;t<this.instrumentsPerChannel;t++){const e=this.channels[h].instruments[t];if(r)a.push({type:s.instrumentTypeNames[2],volume:20*(5-e.volume),imute:s.imuteNames[e.imute],wave:s.drumNames[e.wave],transition:s.transitionNames[e.transition],octoff:s.octoffNames[e.octoff],ipan:s.ipanValues[e.ipan]});else if(0==e.type)a.push({type:s.instrumentTypeNames[e.type],volume:20*(5-e.volume),wave:s.waveNames[e.wave],transition:s.transitionNames[e.transition],filter:s.filterNames[e.filter],chorus:s.chorusNames[e.chorus],effect:s.effectNames[e.effect],harm:s.harmNames[e.harm],imute:s.imuteNames[e.imute],octoff:s.octoffNames[e.octoff],ipan:s.ipanValues[e.ipan]});else if(1==e.type){const t=[];for(const n of e.operators)t.push({frequency:s.operatorFrequencyNames[n.frequency],amplitude:n.amplitude,envelope:s.operatorEnvelopeNames[n.envelope]});a.push({type:s.instrumentTypeNames[e.type],volume:20*(5-e.volume),transition:s.transitionNames[e.transition],effect:s.effectNames[e.effect],octoff:s.octoffNames[e.octoff],fmChorus:s.fmChorusNames[e.fmChorus],algorithm:s.operatorAlgorithmNames[e.algorithm],feedbackType:s.operatorFeedbackNames[e.feedbackType],feedbackAmplitude:e.feedbackAmplitude,feedbackEnvelope:s.operatorEnvelopeNames[e.feedbackEnvelope],operators:t,ipan:s.ipanValues[e.ipan],imute:s.imuteNames[e.imute]})}else{if(3!=e.type)throw new Error("Unrecognized instrument type");a.push({type:s.instrumentTypeNames[2],volume:20*(5-e.volume),wave:s.pwmwaveNames[e.wave],transition:s.transitionNames[e.transition],filter:s.filterNames[e.filter],chorus:s.chorusNames[e.chorus],effect:s.effectNames[e.effect],harm:s.harmNames[e.harm],imute:s.imuteNames[e.imute],octoff:s.octoffNames[e.octoff],ipan:s.ipanValues[e.ipan]})}}const o=[];for(const t of this.channels[h].patterns){const e=[];for(const n of t.notes){const t=[];for(const e of n.pins)t.push({tick:e.time+n.start,pitchBend:e.interval,volume:Math.round(100*e.volume/3)});e.push({pitches:n.pitches,points:t})}o.push({instrument:t.instrument+1,notes:e})}const c=[];if(t)for(let t=0;t<this.loopStart;t++)c.push(this.channels[h].bars[t]);for(let t=0;t<e;t++)for(let t=this.loopStart;t<this.loopStart+this.loopLength;t++)c.push(this.channels[h].bars[t]);if(n)for(let t=this.loopStart+this.loopLength;t<this.barCount;t++)c.push(this.channels[h].bars[t]);i.push({type:r?"drum":"pitch",octaveScrollBar:this.channels[h].octave,instruments:a,patterns:o,sequence:c})}return{format:T.B,version:T.C,theme:this.setSongTheme,scale:s.scales[this.scale].name,mix:s.mixNames[this.mix],sampleRate:s.sampleRateNames[this.sampleRate],key:s.keys[this.key].name,introBars:this.loopStart,loopBars:this.loopLength,beatsPerBar:this.beatsPerBar,ticksPerBeat:this.partsPerBeat,beatsPerMinute:this.getBeatsPerMinute(),reverb:this.reverb,blend:this.blend,riff:this.riff,detune:this.detune,muff:this.muff,channels:i}}fromJsonObject(t){if(this.initToDefault(!0),!t)return;const e=t.format;if(t.version>T.B)return;if(this.scale=11,null!=t.scale)if("BeepBox"==e){const e={"romani :)":8,"romani :(":9},n=null!=e[t.scale]?e[t.scale]:s.scales.map((t=>t.name)).indexOf(t.scale);-1!=n&&(this.scale=n)}else this.scale=s.scales.map((t=>t.name)).indexOf(t.scale);if(null!=t.theme)if("BeepBox"==e)if("Nepbox"!=t.theme&&"Laffey"!=t.theme&&"ModBox"!=t.theme){var n=["none","modbox2","artic","Cinnamon Roll","Ocean","rainbow","float","windows","grassland","dessert","kahootiest","beambit","egg","Poniryoshka","gameboy","woodkid","midnight","snedbox","unnamed","piano","halloween","frozen"],i=s.oldThemeNames.indexOf(t.theme);this.setSongTheme=n[i]}else{n=["none","nepbox","laffey"],i=["ModBox","Nepbox","Laffey"].indexOf(t.theme);this.setSongTheme=n[i]}else this.setSongTheme=t.theme;null!=t.mix&&(this.mix=s.mixNames.indexOf(t.mix),-1==this.mix&&(this.mix=1)),null!=t.sampleRate&&(this.sampleRate=s.sampleRateNames.indexOf(t.sampleRate),-1==this.sampleRate&&(this.sampleRate=2)),null!=t.key&&("BeepBox"==e?"number"==typeof t.key?this.key=s.oldKeys.length-1-(t.key+1200>>>0)%s.oldKeys.length:"string"==typeof t.key&&(this.key=s.keys.map((t=>t.name)).indexOf(t.key)):this.key=s.keys.map((t=>t.name)).indexOf(t.key)),null!=t.beatsPerMinute&&(this.tempo=t.beatsPerMinute,this.tempo=L(s.tempoMin,s.tempoMax,this.tempo)),null!=t.reverb&&(this.reverb=L(0,s.reverbRange,0|t.reverb)),null!=t.blend&&(this.blend=L(0,s.blendRange,0|t.blend)),null!=t.riff&&(this.riff=L(0,s.riffRange,0|t.riff)),null!=t.detune&&(this.detune=L(0,s.detuneRange,0|t.detune)),null!=t.muff&&(this.muff=L(0,s.muffRange,0|t.muff)),null!=t.beatsPerBar&&(this.beatsPerBar=Math.max(s.beatsPerBarMin,Math.min(s.beatsPerBarMax,0|t.beatsPerBar))),null!=t.ticksPerBeat&&(this.partsPerBeat=0|t.ticksPerBeat,-1==s.partCounts.indexOf(this.partsPerBeat)&&(this.partsPerBeat=s.partCounts[s.partCounts.length-1]));let h=1,a=1,r=1;if(t.channels)for(const e of t.channels)e.instruments&&(h=Math.max(h,0|e.instruments.length)),e.patterns&&(a=Math.max(a,0|e.patterns.length)),e.sequence&&(r=Math.max(r,0|e.sequence.length));this.instrumentsPerChannel=h,this.patternsPerChannel=a,this.barCount=r,null!=t.introBars&&(this.loopStart=L(0,this.barCount,0|t.introBars)),null!=t.loopBars&&(this.loopLength=L(1,this.barCount-this.loopStart+1,0|t.loopBars));let o=0,c=0;if(t.channels)for(let e=0;e<t.channels.length;e++){let n=t.channels[e];this.channels.length<=e&&(this.channels[e]=new R),null!=n.octaveScrollBar&&(this.channels[e].octave=L(0,5,0|n.octaveScrollBar));for(let t=this.channels[e].instruments.length;t<this.instrumentsPerChannel;t++)this.channels[e].instruments[t]=new E;this.channels[e].instruments.length=this.instrumentsPerChannel;for(let t=this.channels[e].patterns.length;t<this.patternsPerChannel;t++)this.channels[e].patterns[t]=new N;this.channels[e].patterns.length=this.patternsPerChannel;for(let t=0;t<this.barCount;t++)this.channels[e].bars[t]=1;this.channels[e].bars.length=this.barCount;let i=!1;i=n.type?"drum"==n.type:e>=3,i?c++:o++;for(let t=0;t<this.instrumentsPerChannel;t++){const h=this.channels[e].instruments[t];let a;n.instruments&&(a=n.instruments[t]),null==a&&(a={});const r={binary:0},o=a.transition||a.envelope;if(h.transition=null!=r[o]?r[o]:s.transitionNames.indexOf(o),-1==h.transition&&(h.transition=1),i)null!=a.volume?h.volume=L(0,s.volumeNames.length,Math.round(5-(0|a.volume)/20)):h.volume=0,h.wave=s.drumNames.indexOf(a.wave),-1==h.wave&&(h.wave=1),h.imute=s.imuteNames.indexOf(a.imute),-1==h.imute&&(h.imute=0),h.ipan=s.ipanValues.indexOf(a.ipan),-1==h.ipan&&(h.ipan=4);else if(h.type=s.instrumentTypeNames.indexOf(a.type),null==h.type&&(h.type=0),0==h.type){null!=a.volume?h.volume=L(0,s.volumeNames.length,Math.round(5-(0|a.volume)/20)):h.volume=0,h.wave=s.waveNames.indexOf(a.wave),-1==h.wave&&(h.wave=1);const t={"sustain sharp":1,"sustain medium":2,"sustain soft":3,"decay sharp":4};h.filter=null!=t[a.filter]?t[a.filter]:s.filterNames.indexOf(a.filter),-1==h.filter&&(h.filter=0),h.chorus=s.chorusNames.indexOf(a.chorus),-1==h.chorus&&(h.chorus=0),h.effect=s.effectNames.indexOf(a.effect),-1==h.effect&&(h.effect=0),h.harm=s.harmNames.indexOf(a.harm),-1==h.harm&&(h.harm=0),h.octoff=s.octoffNames.indexOf(a.octoff),-1==h.octoff&&(h.octoff=0),h.imute=s.imuteNames.indexOf(a.imute),-1==h.imute&&(h.imute=0),h.ipan=s.ipanValues.indexOf(a.ipan),-1==h.ipan&&(h.ipan=4)}else if(3==h.type||2==h.type){2==h.type&&(h.type=3),null!=a.volume?h.volume=L(0,s.volumeNames.length,Math.round(5-(0|a.volume)/20)):h.volume=0,h.wave=s.pwmwaveNames.indexOf(a.wave),-1==h.wave&&(h.wave=1);const t={"sustain sharp":1,"sustain medium":2,"sustain soft":3,"decay sharp":4};h.filter=null!=t[a.filter]?t[a.filter]:s.filterNames.indexOf(a.filter),-1==h.filter&&(h.filter=0),h.chorus=s.chorusNames.indexOf(a.chorus),-1==h.chorus&&(h.chorus=0),h.effect=s.effectNames.indexOf(a.effect),-1==h.effect&&(h.effect=0),h.harm=s.harmNames.indexOf(a.harm),-1==h.harm&&(h.harm=0),h.octoff=s.octoffNames.indexOf(a.octoff),-1==h.octoff&&(h.octoff=0),h.imute=s.imuteNames.indexOf(a.imute),-1==h.imute&&(h.imute=0),h.ipan=s.ipanValues.indexOf(a.ipan),-1==h.ipan&&(h.ipan=4)}else{if(1!=h.type)throw new Error("Unrecognized instrument type.");h.effect=s.effectNames.indexOf(a.effect),-1==h.effect&&(h.effect=0),h.octoff=s.octoffNames.indexOf(a.octoff),-1==h.octoff&&(h.octoff=0),h.fmChorus=s.fmChorusNames.indexOf(a.fmChorus),-1==h.fmChorus&&(h.fmChorus=0),h.algorithm=s.operatorAlgorithmNames.indexOf(a.algorithm),-1==h.algorithm&&(h.algorithm=0),h.feedbackType=s.operatorFeedbackNames.indexOf(a.feedbackType),-1==h.feedbackType&&(h.feedbackType=0),null!=a.feedbackAmplitude?h.feedbackAmplitude=L(0,s.operatorAmplitudeMax+1,0|a.feedbackAmplitude):h.feedbackAmplitude=0,h.feedbackEnvelope=s.operatorEnvelopeNames.indexOf(a.feedbackEnvelope),-1==h.feedbackEnvelope&&(h.feedbackEnvelope=0);for(let t=0;t<s.operatorCount;t++){const e=h.operators[t];let n;a.operators&&(n=a.operators[t]),null==n&&(n={}),e.frequency=s.operatorFrequencyNames.indexOf(n.frequency),-1==e.frequency&&(e.frequency=0),null!=n.amplitude?e.amplitude=L(0,s.operatorAmplitudeMax+1,0|n.amplitude):e.amplitude=0,e.envelope=s.operatorEnvelopeNames.indexOf(n.envelope),-1==e.envelope&&(e.envelope=0)}h.ipan=s.ipanValues.indexOf(a.ipan),-1==h.ipan&&(h.ipan=4),h.imute=s.imuteNames.indexOf(a.imute),-1==h.imute&&(h.imute=0)}}for(let t=0;t<this.patternsPerChannel;t++){const h=this.channels[e].patterns[t];let a;if(n.patterns&&(a=n.patterns[t]),null!=a&&(h.instrument=L(0,this.instrumentsPerChannel,(0|a.instrument)-1),a.notes&&a.notes.length>0)){const t=Math.min(this.beatsPerBar*this.partsPerBeat,a.notes.length>>>0);let e=0;for(let n=0;n<a.notes.length&&!(n>=t);n++){const t=a.notes[n];if(!(t&&t.pitches&&t.pitches.length>=1&&t.points&&t.points.length>=2))continue;const r=P(0,0,0,0);r.pitches=[],r.pins=[];for(let e=0;e<t.pitches.length;e++){const n=0|t.pitches[e];if(-1==r.pitches.indexOf(n)&&(r.pitches.push(n),r.pitches.length>=4))break}if(r.pitches.length<1)continue;let o=e,c=0;for(let e=0;e<t.points.length;e++){const n=t.points[e];if(null==n||null==n.tick)continue;const i=null==n.pitchBend?0:0|n.pitchBend,s=0|n.tick,h=null==n.volume?3:Math.max(0,Math.min(3,Math.round(3*(0|n.volume)/100)));if(!(s>this.beatsPerBar*this.partsPerBeat)){if(0==r.pins.length){if(s<o)continue;r.start=s,c=i}else if(s<=o)continue;o=s,r.pins.push(B(i-c,s-r.start,h))}}if(r.pins.length<2)continue;r.end=r.pins[r.pins.length-1].time+r.start;const l=i?s.drumCount-1:s.maxPitch;let p=l,f=0;for(let t=0;t<r.pitches.length;t++)r.pitches[t]+=c,(r.pitches[t]<0||r.pitches[t]>l)&&(r.pitches.splice(t,1),t--),r.pitches[t]<p&&(p=r.pitches[t]),r.pitches[t]>f&&(f=r.pitches[t]);if(!(r.pitches.length<1)){for(let t=0;t<r.pins.length;t++){const e=r.pins[t];e.interval+p<0&&(e.interval=-p),e.interval+f>l&&(e.interval=l-f),t>=2&&e.interval==r.pins[t-1].interval&&e.interval==r.pins[t-2].interval&&e.volume==r.pins[t-1].volume&&e.volume==r.pins[t-2].volume&&(r.pins.splice(t-1,1),t--)}h.notes.push(r),e=r.end}}}}for(let t=0;t<this.barCount;t++)this.channels[e].bars[t]=n.sequence?Math.min(this.patternsPerChannel,n.sequence[t]>>>0):0}this.pitchChannelCount=o,this.drumChannelCount=c,this.channels.length=this.getChannelCount()}getPattern(t,e){const n=this.channels[t].bars[e];return 0==n?null:this.channels[t].patterns[n-1]}getPatternInstrument(t,e){const n=this.getPattern(t,e);return null==n?0:n.instrument}getPatternInstrumentMute(t,e){const n=this.getPattern(t,e),i=this.getPatternInstrument(t,e),s=this.channels[t].instruments[i];return null==n?0:s.imute}getPatternInstrumentVolume(t,e){const n=this.getPattern(t,e),i=this.getPatternInstrument(t,e),s=this.channels[t].instruments[i];return null==n?0:s.volume}getBeatsPerMinute(){return this.tempo}getChannelFingerprint(t){const e=this.getChannelCount();let n=0;for(let i=0;i<e;i++)if(i<this.pitchChannelCount){const e=this.getPatternInstrument(i,t),s=this.channels[i].instruments[e];if(0==s.type)this.u[n++]="c";else if(1==s.type)this.u[n++]="f",this.u[n++]=s.algorithm,this.u[n++]=s.feedbackType;else{if(3!=s.type)throw new Error("Unknown instrument type.");this.u[n++]="p"}}else this.u[n++]="d";return this.u.length=n,this.u.join("")}}T.B="NepBox",T.S=2,T.M=6,T.F=1,T.C=1,T.k=110,T.L=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,62,62,0,0,1,2,3,4,5,6,7,8,9,0,0,0,0,0,0,0,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,0,0,0,0,63,0,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,0,0,0,0,0],T.v=[48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,45,95];class O{constructor(){this.P=!0}R(){this.P=!1}isNoop(){return this.P}commit(){}}class D extends O{constructor(t){super(),this.N=t,this.T=!t}undo(){this.N?(this.O(),this.T=!0):(this.D(),this.T=!1)}redo(){this.N?(this.D(),this.T=!1):(this.O(),this.T=!0)}I(){return this.T}O(){throw new Error("Change.doForwards(): Override me.")}D(){throw new Error("Change.doBackwards(): Override me.")}}class I extends O{constructor(){super()}append(t){t.isNoop()||this.R()}}class A extends D{constructor(t){super(!1),this.A=null==t?[]:t.concat()}append(t){t.isNoop()||(this.A[this.A.length]=t,this.R())}O(){for(let t=0;t<this.A.length;t++)this.A[t].redo()}D(){for(let t=this.A.length-1;t>=0;t--)this.A[t].undo()}}class $ extends D{constructor(t,e){super(!1),this.$=t,this.j=e,this._=this.j.start,this.W=this.j.end,this.V=this.j.start,this.U=this.j.end,this.H=this.j.pins,this.G=[],this.Y=this.j.pitches,this.q=[]}K(){for(let t=0;t<this.G.length-1;)this.G[t].time>=this.G[t+1].time?this.G.splice(t,1):t++;for(let t=1;t<this.G.length-1;)this.G[t-1].interval==this.G[t].interval&&this.G[t].interval==this.G[t+1].interval&&this.G[t-1].volume==this.G[t].volume&&this.G[t].volume==this.G[t+1].volume?this.G.splice(t,1):t++;const t=this.G[0].interval,e=this.G[0].time;for(let e=0;e<this.Y.length;e++)this.q[e]=this.Y[e]+t;for(let n=0;n<this.G.length;n++)this.G[n].interval-=t,this.G[n].time-=e;this.V=this._+e,this.U=this.V+this.G[this.G.length-1].time,this.O(),this.R()}O(){this.j.pins=this.G,this.j.pitches=this.q,this.j.start=this.V,this.j.end=this.U,this.$.notifier.changed()}D(){this.j.pins=this.H,this.j.pitches=this.Y,this.j.start=this._,this.j.end=this.W,this.$.notifier.changed()}}class j extends O{constructor(t,e){super();if(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].type!=e){if(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].type=e,0==e){const e=t.song.channels[t.channel].instruments[t.getCurrentInstrument()];e.wave=Math.max(0,Math.min(s.waves.length-1,e.wave))}else if(3==e){const e=t.song.channels[t.channel].instruments[t.getCurrentInstrument()];e.wave=Math.max(0,Math.min(s.pwmwaves.length-1,e.wave))}t.notifier.changed(),this.R()}}}class z extends O{constructor(t,e){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].transition!=e&&(this.R(),t.song.channels[t.channel].instruments[t.getCurrentInstrument()].transition=e,t.notifier.changed())}}class _ extends O{constructor(t,e,n){if(super(),this.oldValue=e,n>t.song.patternsPerChannel)throw new Error("invalid pattern");t.song.channels[t.channel].bars[t.bar]=n,t.notifier.changed(),e!=n&&this.R()}}class W extends O{constructor(t,e){if(super(),t.song.barCount!=e){for(let n=0;n<t.song.getChannelCount();n++){for(let i=t.song.barCount;i<e;i++)t.song.channels[n].bars[i]=0;t.song.channels[n].bars.length=e}let n=t.bar,i=t.barScrollPos,s=t.song.loopStart,h=t.song.loopLength;t.song.barCount>e&&(n=Math.min(n,e-1),i=Math.max(0,Math.min(e-t.trackVisibleBars,i)),h=Math.min(e,h),s=Math.min(e-h,s)),t.bar=n,t.barScrollPos=i,t.song.loopStart=s,t.song.loopLength=h,t.song.barCount=e,t.notifier.changed(),this.R()}}}class V extends O{constructor(t,e,n){super();const i=Math.min(s.barCountMax,t.song.barCount+n);if(0!=(n=i-t.song.barCount)){for(const n of t.song.channels)for(;n.bars.length<i;)n.bars.splice(e,0,0);t.song.barCount=i,t.bar+=n,t.barScrollPos+=n,t.song.loopStart>=e?t.song.loopStart+=n:t.song.loopStart+t.song.loopLength>=e&&(t.song.loopLength+=n),t.notifier.changed(),this.R()}}}class U extends O{constructor(t,e,n){super();for(const i of t.song.channels)i.bars.splice(e,n),0==i.bars.length&&i.bars.push(0);t.song.barCount=Math.max(1,t.song.barCount-n),t.bar=Math.max(0,t.bar-n),t.barScrollPos=Math.max(0,t.barScrollPos-n),t.song.loopStart>=e?t.song.loopStart=Math.max(0,t.song.loopStart-n):t.song.loopStart+t.song.loopLength>e&&(t.song.loopLength-=n),t.song.loopLength=Math.max(1,Math.min(t.song.barCount-t.song.loopStart,t.song.loopLength)),t.notifier.changed(),this.R()}}class H extends O{constructor(t,e,n){if(super(),t.song.pitchChannelCount!=e||t.song.drumChannelCount!=n){const i=[];for(let n=0;n<e;n++){const e=n,s=n;if(n<t.song.pitchChannelCount)i[e]=t.song.channels[s];else{i[e]=new R,i[e].octave=2;for(let n=0;n<t.song.instrumentsPerChannel;n++)i[e].instruments[n]=new E;for(let n=0;n<t.song.patternsPerChannel;n++)i[e].patterns[n]=new N;for(let n=0;n<t.song.barCount;n++)i[e].bars[n]=0}}for(let s=0;s<n;s++){const n=s+e,h=s+t.song.pitchChannelCount;if(s<t.song.drumChannelCount)i[n]=t.song.channels[h];else{i[n]=new R,i[n].octave=0;for(let e=0;e<t.song.instrumentsPerChannel;e++)i[n].instruments[e]=new E;for(let e=0;e<t.song.patternsPerChannel;e++)i[n].patterns[e]=new N;for(let e=0;e<t.song.barCount;e++)i[n].bars[e]=0}}t.song.pitchChannelCount=e,t.song.drumChannelCount=n;for(let e=0;e<t.song.getChannelCount();e++)t.song.channels[e]=i[e];t.song.channels.length=t.song.getChannelCount(),t.channel=Math.min(t.channel,e+n-1),t.notifier.changed(),this.R()}}}class G extends O{constructor(t,e){if(super(),t.song.beatsPerBar!=e){if(t.song.beatsPerBar>e){const n=new A;for(let i=0;i<t.song.getChannelCount();i++)for(let s=0;s<t.song.channels[i].patterns.length;s++)n.append(new _t(t,t.song.channels[i].patterns[s],e*t.song.partsPerBeat,t.song.beatsPerBar*t.song.partsPerBeat))}t.song.beatsPerBar=e,t.notifier.changed(),this.R()}}}class Y extends O{constructor(t,e,n,i){super(),t.song.channels.splice(e+i,0,...t.song.channels.splice(e,n-e+1)),t.notifier.changed(),this.R()}}class q extends I{constructor(t,e,n){super();const i=t.song.pitchChannelCount+(n?0:1),h=t.song.drumChannelCount+(n?1:0);if(i<=s.pitchChannelCountMax&&h<=s.drumChannelCountMax){const s=n?t.song.pitchChannelCount+t.song.drumChannelCount:t.song.pitchChannelCount;this.append(new H(t,i,h)),this.append(new Y(t,e,s-1,1))}t.notifier.changed(),this.R()}}class K extends I{constructor(t,e,n){for(super();n>=e;){const e=t.song.getChannelIsDrum(n);t.song.channels.splice(n,1),e?t.song.drumChannelCount--:t.song.pitchChannelCount--,n--}t.song.pitchChannelCount<s.pitchChannelCountMin&&this.append(new H(t,s.pitchChannelCountMin,t.song.drumChannelCount)),this.append(new J(t,Math.max(0,e-1),t.bar)),this.R(),t.notifier.changed()}}class J extends O{constructor(t,e,n){super();const i=t.channel,s=t.bar;t.channel=e,t.bar=n,t.barScrollPos=Math.min(t.bar,Math.max(t.bar-(t.trackVisibleBars-1),t.barScrollPos)),t.notifier.changed(),i==e&&s==n||this.R()}}class Q extends O{constructor(t,e){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].chorus!=e&&(this.R(),t.song.channels[t.channel].instruments[t.getCurrentInstrument()].chorus=e,t.notifier.changed())}}class X extends O{constructor(t,e){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].effect!=e&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].effect=e,t.notifier.changed(),this.R())}}class Z extends O{constructor(t,e){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].harm!=e&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].harm=e,t.notifier.changed(),this.R())}}class tt extends O{constructor(t,e){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].fmChorus!=e&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].fmChorus=e,t.notifier.changed(),this.R())}}class et extends O{constructor(t,e){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].octoff!=e&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].octoff=e,t.notifier.changed(),this.R())}}class nt extends O{constructor(t,e){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].imute!=e&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].imute=e,t.notifier.changed(),this.R())}}class it extends O{constructor(t,e,n){super();t.song.channels[t.channel].instruments[n].imute!=e&&(t.song.channels[t.channel].instruments[n].imute=e,t.notifier.changed(),this.R())}}class st extends O{constructor(t,e,n,i){super();t.song.channels[n].instruments[i].imute!=e&&(t.song.channels[n].instruments[i].imute=e,t.notifier.changed(),this.R())}}class ht extends O{constructor(t,e,n){super(),e!=n&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].ipan=n,t.notifier.changed(),this.R())}}class at extends O{constructor(t,e){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].filter!=e&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].filter=e,t.notifier.changed(),this.R())}}class rt extends O{constructor(t,e){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].algorithm!=e&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].algorithm=e,t.notifier.changed(),this.R())}}class ot extends O{constructor(t,e){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].feedbackType!=e&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].feedbackType=e,t.notifier.changed(),this.R())}}class ct extends O{constructor(t,e){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].feedbackEnvelope!=e&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].feedbackEnvelope=e,t.notifier.changed(),this.R())}}class lt extends O{constructor(t,e,n){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].operators[e].envelope!=n&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].operators[e].envelope=n,t.notifier.changed(),this.R())}}class pt extends O{constructor(t,e,n){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].operators[e].frequency!=n&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].operators[e].frequency=n,t.notifier.changed(),this.R())}}class ft extends O{constructor(t,e,n,i){super(),t.song.channels[t.channel].instruments[t.getCurrentInstrument()].operators[e].amplitude=i,t.notifier.changed(),n!=i&&this.R()}}class dt extends O{constructor(t,e,n){super(),t.song.channels[t.channel].instruments[t.getCurrentInstrument()].feedbackAmplitude=n,t.notifier.changed(),e!=n&&this.R()}}class yt extends O{constructor(t,e){if(super(),t.song.instrumentsPerChannel!=e){for(let n=0;n<t.song.getChannelCount();n++){const i=t.song.channels[n].instruments[t.song.instrumentsPerChannel-1];for(let s=t.song.instrumentsPerChannel;s<e;s++){const e=new E;e.copy(i),t.song.channels[n].instruments[s]=e}t.song.channels[n].instruments.length=e;for(let i=0;i<t.song.patternsPerChannel;i++)t.song.channels[n].patterns[i].instrument>=e&&(t.song.channels[n].patterns[i].instrument=0)}t.song.instrumentsPerChannel=e,t.notifier.changed(),this.R()}}}class mt extends O{constructor(t,e){super(),t.song.key!=e&&(t.song.key=e,t.notifier.changed(),this.R())}}class ut extends O{constructor(t,e,n){super(),n.length>30&&(n=n.substring(0,30)),t.song.setSongTheme=n,t.notifier.changed(),e!=n&&this.R()}}class bt extends O{constructor(t,e,n,i,s){super(),this.$=t,this.oldStart=e,this.oldLength=n,this.newStart=i,this.newLength=s,this.$.song.loopStart=this.newStart,this.$.song.loopLength=this.newLength,this.$.notifier.changed(),this.oldStart==this.newStart&&this.oldLength==this.newLength||this.R()}}class gt extends D{constructor(t,e,n,i,s=!1){super(s),this.$=t,this.j=e,this.J=n,this.X=i,this.R(),this.redo()}O(){this.j.pitches.splice(this.X,0,this.J),this.$.notifier.changed()}D(){this.j.pitches.splice(this.X,1),this.$.notifier.changed()}}class xt extends O{constructor(t,e,n){super(),this.oldValue=e,t.song.channels[t.channel].octave=n,t.notifier.changed(),e!=n&&this.R()}}class wt extends I{constructor(t,e){if(super(),t.song.partsPerBeat!=e){for(let n=0;n<t.song.getChannelCount();n++)for(let i=0;i<t.song.channels[n].patterns.length;i++)this.append(new Ft(t,t.song.channels[n].patterns[i],t.song.partsPerBeat,e));t.song.partsPerBeat=e,t.notifier.changed(),this.R()}}}class vt extends I{constructor(t,e,n,i,s){super(),e.notes=n,t.song.partsPerBeat!=s&&this.append(new Ft(t,e,s,t.song.partsPerBeat)),t.song.beatsPerBar!=i&&this.append(new _t(t,e,t.song.beatsPerBar*t.song.partsPerBeat,i*t.song.partsPerBeat)),t.notifier.changed(),this.R()}}class kt extends O{constructor(t,e,n){super(),n.instrument!=e&&(n.instrument=e,t.notifier.changed(),this.R())}}class Ct extends O{constructor(t,e){if(super(),t.song.patternsPerChannel!=e){for(let n=0;n<t.song.getChannelCount();n++){const i=t.song.channels[n].bars,s=t.song.channels[n].patterns;for(let t=0;t<i.length;t++)i[t]>e&&(i[t]=0);for(let t=s.length;t<e;t++)s[t]=new N;s.length=e}t.song.patternsPerChannel=e,t.notifier.changed(),this.R()}}}class Lt extends D{constructor(t){super(!1),this.Z=null;const e=t.song;if(0!=e.channels[t.channel].bars[t.bar])return;this.$=t,this.tt=t.bar,this.et=t.channel,this.nt=e.patternsPerChannel,this.it=e.patternsPerChannel;let n=null,i=null;for(let s=1;s<=e.patternsPerChannel;s++){let h=!1;for(let n=0;n<e.barCount;n++)if(e.channels[t.channel].bars[n]==s){h=!0;break}if(h)continue;null==i&&(i=s);if(0==e.channels[t.channel].patterns[s-1].notes.length){n=s;break}}if(null!=n)this.st=n;else if(e.patternsPerChannel<e.barCount)this.it=e.patternsPerChannel+1,this.st=e.patternsPerChannel+1;else{if(null==i)throw new Error;this.st=i,this.Z=e.channels[t.channel].patterns[i-1].notes}this.R(),this.O()}O(){const t=this.$.song;for(let e=t.patternsPerChannel;e<this.it;e++)for(let n=0;n<t.getChannelCount();n++)t.channels[n].patterns[e]=new N;t.patternsPerChannel=this.it;t.channels[this.et].patterns[this.st-1].notes=[],t.channels[this.et].bars[this.tt]=this.st,this.$.notifier.changed()}D(){const t=this.$.song,e=t.channels[this.et].patterns[this.st-1];null!=this.Z&&(e.notes=this.Z),t.channels[this.et].bars[this.tt]=0;for(let e=0;e<t.getChannelCount();e++)t.channels[e].patterns.length=this.nt;t.patternsPerChannel=this.nt,this.$.notifier.changed()}}class Mt extends ${constructor(t,e,n,i){super(t,e),i-=this._;const s=this.H[n].time,h=Math.min(s,i),a=Math.max(s,i);let r=!1;for(let t=0;t<this.H.length;t++){const s=e.pins[t],o=s.time;o<h?this.G.push(B(s.interval,o,s.volume)):o>a&&(r||(this.G.push(B(this.H[n].interval,i,this.H[n].volume)),r=!0),this.G.push(B(s.interval,o,s.volume)))}r||this.G.push(B(this.H[n].interval,i,this.H[n].volume)),this.K()}}class St extends ${constructor(t,e,n,i,s,h){super(t,e),n-=this._,i-=this._,s-=e.pitches[h];let a,r,o,c,l=!1,p=!1,f=0,d=3,y=!0;for(i>n?(a=0,r=1,o=e.pins.length,c=t=>{this.G.push(t)}):(a=e.pins.length-1,r=-1,o=-1,c=t=>{this.G.unshift(t)});a!=o;a+=r){const t=e.pins[a],h=t.time;for(;;)if(l){if(p){if(h*r==i*r)break;t.interval!=f&&(y=!1),c(B(y?s:t.interval,h,t.volume));break}if(h*r<=i*r&&(f=t.interval,d=t.volume),h*r<i*r)break;c(B(s,i,d)),p=!0}else{if(h*r<=n*r&&(f=t.interval,d=t.volume),h*r<n*r){c(B(t.interval,h,t.volume));break}c(B(f,n,d)),l=!0}}p||c(B(s,i,d)),this.K()}}class Ft extends A{constructor(t,e,n,i){let s;if(super(),n>i)s=t=>Math.ceil(t*i/n);else{if(!(n<i))throw new Error("ChangeRhythm couldn't handle rhythm change from "+n+" to "+i+".");s=t=>Math.floor(t*i/n)}let h=0;for(;h<e.notes.length;){const n=e.notes[h];s(n.start)>=s(n.end)?this.append(new jt(t,e,n,h,!0)):(this.append(new Bt(t,n,s)),h++)}}}class Bt extends ${constructor(t,e,n){super(t,e);for(const t of this.H)this.G.push(B(t.interval,n(t.time+this._)-this._,t.volume));this.K()}}class Pt extends O{constructor(t,e){super(),t.song.scale!=e&&(t.song.scale=e,t.notifier.changed(),this.R())}}class Et extends O{constructor(t,e){super(),t.song.mix!=e&&(t.song.mix=e,t.notifier.changed(),this.R())}}class Rt extends O{constructor(t,e){super(),t.song.sampleRate!=e&&(t.song.sampleRate=e,t.notifier.changed(),this.R())}}class Nt extends O{constructor(t,e){super(),t.song.fromBase64String(e),t.channel=Math.min(t.channel,t.song.getChannelCount()-1),t.bar=Math.max(0,Math.min(t.song.barCount-1,t.bar)),t.barScrollPos=Math.max(0,Math.min(t.song.barCount-t.trackVisibleBars,t.barScrollPos)),t.barScrollPos=Math.min(t.bar,Math.max(t.bar-(t.trackVisibleBars-1),t.barScrollPos)),t.notifier.changed(),this.R()}}class Tt extends O{constructor(t,e,n){super(),t.song.tempo=n,t.notifier.changed(),e!=n&&this.R()}}class Ot extends O{constructor(t,e,n){super(),t.song.reverb=n,t.notifier.changed(),e!=n&&this.R()}}class Dt extends O{constructor(t,e,n){super(),t.song.blend=n,t.notifier.changed(),e!=n&&this.R()}}class It extends O{constructor(t,e,n){super(),t.song.riff=n,t.notifier.changed(),e!=n&&this.R()}}class At extends O{constructor(t,e,n){super(),t.song.detune=n,t.notifier.changed(),e!=n&&this.R()}}class $t extends O{constructor(t,e,n){super(),t.song.muff=n,t.notifier.changed(),e!=n&&this.R()}}class jt extends D{constructor(t,e,n,i,s=!1){super(s),this.$=t,this.ht=e,this.j=n,this.X=i,this.R(),this.redo()}O(){this.ht.notes.splice(this.X,0,this.j),this.$.notifier.changed()}D(){this.ht.notes.splice(this.X,1),this.$.notifier.changed()}}class zt extends ${constructor(t,e,n,i){super(t,e),n-=this._,i-=this._;let s,h=!1,a=this.H[0].volume,r=this.H[0].interval,o=!0;for(s=0;s<this.H.length;s++){const t=this.H[s];if(t.time<n)a=t.volume,r=t.interval;else{if(!(t.time<=i))break;if(t.time>n&&!h&&this.G.push(B(r,n,a)),this.G.push(B(t.interval,t.time,t.volume)),h=!0,t.time==i){o=!1;break}}}o&&this.G.push(B(this.H[s].interval,i,this.H[s].volume)),this.K()}}class _t extends A{constructor(t,e,n,i,s){super();let h=0;for(;h<e.notes.length;){const a=e.notes[h];if(a==s&&null!=s)h++;else if(a.end<=n)h++;else{if(a.start>=i)break;a.start<n?(this.append(new zt(t,a,a.start,n)),h++):a.end>i?(this.append(new zt(t,a,i,a.end)),h++):this.append(new jt(t,e,a,h,!0))}}}}class Wt extends D{constructor(t,e,n){super(!1),this.$=t,this.j=e,this.H=e.pins,this.G=[],this.Y=e.pitches,this.q=[];const i=t.song.getChannelIsDrum(t.channel)?s.drumCount-1:s.maxPitch;for(let e=0;e<this.Y.length;e++){let h=this.Y[e];if(n){for(let e=h+1;e<=i;e++)if(t.song.getChannelIsDrum(t.channel)||s.scales[t.song.scale].flags[e%12]){h=e;break}}else for(let e=h-1;e>=0;e--)if(t.song.getChannelIsDrum(t.channel)||s.scales[t.song.scale].flags[e%12]){h=e;break}let a=!1;for(let t=0;t<this.q.length;t++)if(this.q[t]==h){a=!0;break}a||this.q.push(h)}let h=0,a=i;for(let t=1;t<this.q.length;t++){const e=this.q[0]-this.q[t];h<e&&(h=e),a>e+i&&(a=e+i)}for(const e of this.H){let i=e.interval+this.Y[0];if(i<h&&(i=h),i>a&&(i=a),n){for(let e=i+1;e<=a;e++)if(t.song.getChannelIsDrum(t.channel)||s.scales[t.song.scale].flags[e%12]){i=e;break}}else for(let e=i-1;e>=h;e--)if(t.song.getChannelIsDrum(t.channel)||s.scales[t.song.scale].flags[e%12]){i=e;break}i-=this.q[0],this.G.push(B(i,e.time,e.volume))}if(0!=this.G[0].interval)throw new Error("wrong pin start interval");for(let t=1;t<this.G.length-1;)this.G[t-1].interval==this.G[t].interval&&this.G[t].interval==this.G[t+1].interval&&this.G[t-1].volume==this.G[t].volume&&this.G[t].volume==this.G[t+1].volume?this.G.splice(t,1):t++;this.O(),this.R()}O(){this.j.pins=this.G,this.j.pitches=this.q,this.$.notifier.changed()}D(){this.j.pins=this.H,this.j.pitches=this.Y,this.$.notifier.changed()}}class Vt extends A{constructor(t,e,n){super();for(let i=0;i<e.notes.length;i++)this.append(new Wt(t,e.notes[i],n))}}class Ut extends O{constructor(t,e,n){super(),t.song.channels[t.channel].instruments[t.getCurrentInstrument()].volume=n,t.notifier.changed(),e!=n&&this.R()}}class Ht extends D{constructor(t,e,n,i,s){super(!1),this.$=t,this.j=e,this.H=e.pins,this.G=[];let h=!1;for(const t of e.pins)t.time<n?this.G.push(t):t.time==n?(this.G.push(B(s,n,i)),h=!0):(h||(this.G.push(B(s,n,i)),h=!0),this.G.push(t));for(let t=1;t<this.G.length-1;)this.G[t-1].interval==this.G[t].interval&&this.G[t].interval==this.G[t+1].interval&&this.G[t-1].volume==this.G[t].volume&&this.G[t].volume==this.G[t+1].volume?this.G.splice(t,1):t++;this.O(),this.R()}O(){this.j.pins=this.G,this.$.notifier.changed()}D(){this.j.pins=this.H,this.$.notifier.changed()}}class Gt extends O{constructor(t,e){super(),t.song.channels[t.channel].instruments[t.getCurrentInstrument()].wave!=e&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].wave=e,t.notifier.changed(),this.R())}}class Yt{static getChannelColor(t,e){return e<t.pitchChannelCount?Yt.pitchChannels[e%Yt.pitchChannels.length]:Yt.noiseChannels[(e-t.pitchChannelCount)%Yt.noiseChannels.length]}static setTheme(t){this.rt.textContent=this.ot[t],this.usesPianoScheme="true"==getComputedStyle(this.rt).getPropertyValue("--use-piano-scheme").trim(),console.log("use-piano-scheme: "+this.usesPianoScheme)}}Yt.colorLookup=new Map,Yt.usesPianoScheme=!1,Yt.ot={default:"\n            :root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #9900cc;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--pitch-background: #444;\n\t\t\t\t--tonic: #864;\n\t\t\t\t--fifth-note: #468;\n                --volume-icon: #777777;\n\t\t\t\t--octave-scrollbar: #444;\n\t\t\t\t--scrollbar-octave: #864;\n\t\t\t\t--channel-box: #444;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n            }\n        ",nepbox:"\n            :root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: #00fff5;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #00fff5;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--pitch-background: #0a2d44;\n\t\t\t\t--tonic: #9150ff;\n\t\t\t\t--fifth-note: #990000;\n                --volume-icon: #00fff5;\n\t\t\t\t--octave-scrollbar: #484848;\n\t\t\t\t--scrollbar-octave: #9150ff;\n\t\t\t\t--channel-box: #444;\n\n\t\t\t\t--pitch1-secondary-channel: #c13cbf;\n\t\t\t\t--pitch1-primary-channel: #f75dff;\n\t\t\t\t--pitch1-secondary-note: #b930a2;\n\t\t\t\t--pitch1-primary-note: #fca5ff;\n\t\t\t\t--pitch2-secondary-channel: #800000;\n\t\t\t\t--pitch2-primary-channel: #f00;\n\t\t\t\t--pitch2-secondary-note: #8c2121;\n\t\t\t\t--pitch2-primary-note: #ff5252;\n\t\t\t\t--pitch3-secondary-channel: #004bb3;\n\t\t\t\t--pitch3-primary-channel: #1792ff;\n\t\t\t\t--pitch3-secondary-note: #005cb3;\n\t\t\t\t--pitch3-primary-note: #00ffe9;\n\t\t\t\t--pitch4-secondary-channel: #a48800;\n\t\t\t\t--pitch4-primary-channel: #fb0;\n\t\t\t\t--pitch4-secondary-note: #9c4100;\n\t\t\t\t--pitch4-primary-note: #ffd84e;\n\t\t\t\t--pitch5-secondary-channel: #6c0000;\n\t\t\t\t--pitch5-primary-channel:   #ff3e3e;\n\t\t\t\t--pitch5-secondary-note:    #6c0000;\n\t\t\t\t--pitch5-primary-note:      #ff3e3e;\n\t\t\t\t--pitch6-secondary-channel:#d25a00;\n\t\t\t\t--pitch6-primary-channel:  #fdff00;\n\t\t\t\t--pitch6-secondary-note:   #d25a00;\n\t\t\t\t--pitch6-primary-note:     #fdff00;\n\t\t\t\t--pitch7-secondary-channel: #046000;\n\t\t\t\t--pitch7-primary-channel:   #0c79ff;\n\t\t\t\t--pitch7-secondary-note:    #046000;\n\t\t\t\t--pitch7-primary-note:      #0c79ff;\n\t\t\t\t--pitch8-secondary-channel:#3b2bae;\n\t\t\t\t--pitch8-primary-channel:  #d85d00;\n\t\t\t\t--pitch8-secondary-note:   #3b2bae;\n\t\t\t\t--pitch8-primary-note:     #d85d00;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #868686;\n\t\t\t\t--noise1-primary-channel: #fff;\n\t\t\t\t--noise1-secondary-note: #868686;\n\t\t\t\t--noise1-primary-note: #fff;\n\t\t\t\t--noise2-secondary-channel: #805300;\n\t\t\t\t--noise2-primary-channel: #ff8c00;\n\t\t\t\t--noise2-secondary-note: #6a3500;\n\t\t\t\t--noise2-primary-note: #a85400;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n            }\n        ",laffey:"\n\t\t\t:root {\n\t\t\t\t--page-margin: #000;\n\t\t\t\t--editor-background: #060606;\n\t\t\t\t--hover-preview: #fff;\n\t\t\t\t--playhead: rgb(0, 242, 255);\n\t\t\t\t--primary-text: #00fff5;\n\t\t\t\t--secondary-text: #a82f2f;\n\t\t\t\t--inverted-text: #000;\n\t\t\t\t--text-selection: rgba(98, 46, 164, .99);\n\t\t\t\t--box-selection-fill: #b74a4a;\n\n\t\t\t\t--loop-accent: #7744FF;\n\n\t\t\t\t--link-accent: #ff00e1;\n\t\t\t\t--ui-widget-background: #484848;\n\t\t\t\t--ui-widget-focus: #3e3e3e;\n\t\t\t\t--pitch-background: #444444;\n\n\t\t\t\t--tonic: #dbbeed;\n\t\t\t\t--pitch1-background: #1a2182; \n\t\t\t\t--pitch2-background: #1a2182; \n\t\t\t\t--pitch3-background: #1a2182; \n\t\t\t\t--pitch4-background: #1a2182;\n\t\t\t\t--pitch5-background: #1a2182; \n\t\t\t\t--pitch6-background: #1a2182; \n\t\t\t\t--fifth-note: #6b1313;\n\t\t\t\t--pitch8-background: #1a2182; \n\t\t\t\t--pitch9-background: #1a2182; \n\t\t\t\t--pitch10-background: #1a2182; \n\t\t\t\t--pitch11-background: #1a2182;\n\t\t\t\t--octave-scrollbar: #852929;\n\t\t\t\t--scrollbar-octave: #f2b3ff;\n\n\t\t\t\t--white-piano-key: #bababa;\n\t\t\t\t--black-piano-key: #444444;\n\n\t\t\t\t--noise-channel-limit: 2;\n\t\t\t\t--pitch1-secondary-channel: #c13cbf;\n\t\t\t\t--pitch1-primary-channel: #f75dff;\n\t\t\t\t--pitch1-secondary-note: #b930a2;\n\t\t\t\t--pitch1-primary-note: #fca5ff;\n\t\t\t\t--pitch2-secondary-channel: #800000;\n\t\t\t\t--pitch2-primary-channel: #f00;\n\t\t\t\t--pitch2-secondary-note: #8c2121;\n\t\t\t\t--pitch2-primary-note: #ff5252;\n\t\t\t\t--pitch3-secondary-channel: #004bb3;\n\t\t\t\t--pitch3-primary-channel: #1792ff;\n\t\t\t\t--pitch3-secondary-note: #005cb3;\n\t\t\t\t--pitch3-primary-note: #00ffe9;\n\t\t\t\t--pitch4-secondary-channel: #a48800;\n\t\t\t\t--pitch4-primary-channel: #fb0;\n\t\t\t\t--pitch4-secondary-note: #9c4100;\n\t\t\t\t--pitch4-primary-note: #ffd84e;\n\t\t\t\t--pitch5-secondary-channel: #6c0000;\n\t\t\t\t--pitch5-primary-channel:   #ff3e3e;\n\t\t\t\t--pitch5-secondary-note:    #6c0000;\n\t\t\t\t--pitch5-primary-note:      #ff3e3e;\n\t\t\t\t--pitch6-secondary-channel:#d25a00;\n\t\t\t\t--pitch6-primary-channel:  #fdff00;\n\t\t\t\t--pitch6-secondary-note:   #d25a00;\n\t\t\t\t--pitch6-primary-note:     #fdff00;\n\t\t\t\t--pitch7-secondary-channel: #046000;\n\t\t\t\t--pitch7-primary-channel:   #0c79ff;\n\t\t\t\t--pitch7-secondary-note:    #046000;\n\t\t\t\t--pitch7-primary-note:      #0c79ff;\n\t\t\t\t--pitch8-secondary-channel:#3b2bae;\n\t\t\t\t--pitch8-primary-channel:  #d85d00;\n\t\t\t\t--pitch8-secondary-note:   #3b2bae;\n\t\t\t\t--pitch8-primary-note:     #d85d00;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #868686;\n\t\t\t\t--noise1-primary-channel: #fff;\n\t\t\t\t--noise1-secondary-note: #868686;\n\t\t\t\t--noise1-primary-note: #fff;\n\t\t\t\t--noise2-secondary-channel: #805300;\n\t\t\t\t--noise2-primary-channel: #ff8c00;\n\t\t\t\t--noise2-secondary-note: #6a3500;\n\t\t\t\t--noise2-primary-note: #a85400;\n\t\t\t\t--noise3-secondary-channel: #868686;\n\t\t\t\t--noise3-primary-channel: #fff;\n\t\t\t\t--noise3-secondary-note: #868686;\n\t\t\t\t--noise3-primary-note: #fff;\n\t\t\t\t--noise4-secondary-channel: #805300;\n\t\t\t\t--noise4-primary-channel: #ff8c00;\n\t\t\t\t--noise4-secondary-note: #6a3500;\n\t\t\t\t--noise4-primary-note: #a85400;\n\t\t\t\t}\n\t\t\t",modbox2:"\n            :root {\n                --page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #00ff00;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--pitch-background: #444;\n\t\t\t\t--tonic: #c4ffa3;\n\t\t\t\t--fifth-note: #96fffb;\n                --volume-icon: #c4ffa3;\n\t\t\t\t--octave-scrollbar: #00ff00;\n\t\t\t\t--scrollbar-octave: #fff;\n\t\t\t\t--channel-box: #444;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n            }\n\t\t",artic:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #ffffff;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--pitch-background: #444;\n\t\t\t\t--tonic: #eafffe;\n\t\t\t\t--fifth-note: #b7f1ff;\n\t\t\t\t--octave-scrollbar: #a5eeff;\n\t\t\t\t--scrollbar-octave: #cefffd;\n\t\t\t\t--volume-icon: #42dcff;\t\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t","Cinnamon Roll":"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #ba8418;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--pitch-background: #444;\n\t\t\t\t--pitch1-background: #f5bb00;\n\t\t\t\t--pitch2-background: #f5bb00;\n\t\t\t\t--pitch3-background: #f5bb00;\n\t\t\t\t--pitch4-background: #f5bb00;\n\t\t\t\t--pitch5-background: #f5bb00;\n\t\t\t\t--pitch6-background: #f5bb00;\n\t\t\t\t--pitch8-background: #f5bb00;\n\t\t\t\t--pitch9-background: #f5bb00;\n\t\t\t\t--pitch10-background: #f5bb00;\n\t\t\t\t--pitch11-background: #f5bb00;\n\t\t\t\t--pitch12-background: #f5bb00;\n\t\t\t\t--tonic: #f5bb00;\n\t\t\t\t--fifth-note: #f5bb00;\n\t\t\t\t--volume-icon: #ba8418;\t\n\n\t\t\t\t--octave-scrollbar: #e59900;\n\t\t\t\t--scrollbar-octave: #ffff25;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",Ocean:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #5982ff;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--pitch-background: #444;\n\t\t\t\t--tonic: #090b3a;\n\t\t\t\t--fifth-note: #3f669b;\n\t\t\t\t--volume-icon: #090b3a;\t\n\n\t\t\t\t--octave-scrollbar: #4449a3;\n\t\t\t\t--scrollbar-octave: #3dffdb;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",rainbow:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #ff0000;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\n\t\t\t\t--pitch-background: #444; \n\t\t\t\t--tonic: #ffaaaa; \n\t\t\t\t--pitch1-background: #ffceaa; \n\t\t\t\t--pitch2-background: #ffdfaa; \n\t\t\t\t--pitch3-background: #fff5aa; \n\t\t\t\t--pitch4-background: #e8ffaa;\n\t\t\t\t--pitch5-background: #bfffb2; \n\t\t\t\t--pitch6-background: #b2ffc8; \n\t\t\t\t--fifth-note: #b2ffe4; \n\t\t\t\t--pitch8-background: #b2f3ff; \n\t\t\t\t--pitch9-background: #b2b3ff; \n\t\t\t\t--pitch10-background: #e0b2ff; \n\t\t\t\t--pitch11-background: #ffafe9; \n\t\t\t\t--octave-scrollbar: #43ff00; \n\t\t\t\t--volume-icon: #ff00cb;\t\n\n\t\t\t\t--octave-scrollbar: #43ff00;\n\t\t\t\t--scrollbar-octave: #0400ff;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",float:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #ff0000;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #878787;\t\n\n\t\t\t\t--pitch-background: #444; \n\t\t\t\t--tonic: #ffffff; \n\t\t\t\t--pitch1-background: #ededed;  \n\t\t\t\t--pitch2-background: #cecece;  \n\t\t\t\t--pitch3-background: #bababa;  \n\t\t\t\t--pitch4-background: #afafaf;\n\t\t\t\t--pitch5-background: #a5a5a5; \n\t\t\t\t--pitch6-background: #999999; \n\t\t\t\t--fifth-note: #8e8e8e; \n\t\t\t\t--pitch8-background: #828282; \n\t\t\t\t--pitch9-background: #777777; \n\t\t\t\t--pitch10-background: #565656; \n\t\t\t\t--pitch11-background: #282828; \n\t\t\t\t--octave-scrollbar: #ffffff; \n\t\t\t\t--scrollbar-octave: #c9c9c9;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",windows:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #ff0000;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #15a0db;\t\n\n\t\t\t\t--tonic: #da4e2a;\n\t\t\t\t--fifth-note: #5d9511;\n\t\t\t\t--pitch-background: #444;\n\n\t\t\t\t--octave-scrollbar: #295294; \n\t\t\t\t--scrollbar-octave: #fdd01d;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",grassland:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #a0d168;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #74bc21;\t\n\n\t\t\t\t--tonic: #20330a;\n\t\t\t\t--fifth-note: #74bc21;\n\t\t\t\t--pitch-background: #444;\n\n\t\t\t\t--octave-scrollbar: #74bc21; \n\t\t\t\t--scrollbar-octave: #20330a;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",dessert:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #ff6254;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #ff0000;\t\n\n\t\t\t\t--tonic: #fffc5b;\n\t\t\t\t--fifth-note: #ff5e3a;\n\t\t\t\t--pitch-background: #444;\n\n\t\t\t\t--octave-scrollbar: #ff5e3a; \n\t\t\t\t--scrollbar-octave: #fffc5b;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",kahootiest:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #ff3355;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #66bf39;\t\n\n\t\t\t\t--tonic: #45a3e5;\n\t\t\t\t--fifth-note: #864cbf;\n\t\t\t\t--pitch-background: #444;\n\n\t\t\t\t--octave-scrollbar: #eb670f; \n\t\t\t\t--scrollbar-octave: #ff3355;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",beambit:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #fefe00;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #fefe00;\t\n\n\t\t\t\t--pitch-background: #444;\n\n\t\t\t\t--tonic: #fefe00;\n\t\t\t\t--pitch1-background: #111111; \n\t\t\t\t--pitch2-background: #111111; \n\t\t\t\t--pitch3-background: #111111; \n\t\t\t\t--pitch4-background: #fa0103;\n\t\t\t\t--pitch5-background: #111111; \n\t\t\t\t--pitch6-background: #111111; \n\t\t\t\t--fifth-note: #111111; \n\t\t\t\t--pitch8-background: #0001fc; \n\t\t\t\t--pitch9-background: #111111; \n\t\t\t\t--pitch10-background: #111111; \n\t\t\t\t--pitch11-background: #111111;\n\n\t\t\t\t--octave-scrollbar: #0001fc; \n\t\t\t\t--scrollbar-octave: #fa0103;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",egg:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #6b003a;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #f01d7a;\t\n\n\t\t\t\t--tonic: #fffafa;\n\t\t\t\t--fifth-note: #ff91ce;\n\t\t\t\t--pitch-background: #444;\n\n\t\t\t\t--octave-scrollbar: #ffb1f4; \n\t\t\t\t--scrollbar-octave: #b4001b;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",Poniryoshka:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #4b4b4b;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #ffc100;\t\n\n\t\t\t\t--tonic: #1a2844;\n\t\t\t\t--fifth-note: #dabbe6;\n\t\t\t\t--pitch4-background: #faf4c3;\n\t\t\t\t--pitch-background: #444;\n\n\t\t\t\t--octave-scrollbar: #5f4c99; \n\t\t\t\t--scrollbar-octave: #ff8291;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",gameboy:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #9bbc0f;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #8bac0f;\t\n\n\t\t\t\t--tonic: #9bbc0f; \n\t\t\t\t--pitch1-background: #9bbc0f; \n\t\t\t\t--pitch2-background: #9bbc0f; \n\t\t\t\t--pitch3-background: #9bbc0f; \n\t\t\t\t--pitch4-background: #9bbc0f;\n\t\t\t\t--pitch5-background: #9bbc0f; \n\t\t\t\t--pitch6-background: #306230; \n\t\t\t\t--fifth-note: #306230; \n\t\t\t\t--pitch8-background: #306230; \n\t\t\t\t--pitch9-background: #0f380f; \n\t\t\t\t--pitch10-background: #0f380f; \n\t\t\t\t--pitch11-background: #0f380f; \n\t\t\t\t--pitch-background: #444;\n\n\t\t\t\t--octave-scrollbar: #9bbc0f; \n\t\t\t\t--scrollbar-octave: #8bac0f;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",woodkid:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #e83c4e;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #ef3027;\t\n\n\t\t\t\t--tonic: #fff6fe;\n\t\t\t\t--pitch1-background: #41323b;\n\t\t\t\t--pitch2-background: #41323b;\n\t\t\t\t--pitch3-background: #41323b;\n\t\t\t\t--pitch4-background: #fff6fe;\n\t\t\t\t--pitch5-background: #41323b;\n\t\t\t\t--pitch6-background: #41323b;\n\t\t\t\t--fifth-note: #fff6fe;\n\t\t\t\t--pitch8-background: #41323b;\n\t\t\t\t--pitch9-background: #41323b;\n\t\t\t\t--pitch10-background: #41323b;\n\t\t\t\t--pitch11-background: #41323b;\n\t\t\t\t--pitch-background: #444;\n\n\t\t\t\t--octave-scrollbar: #ef3027; \n\t\t\t\t--scrollbar-octave: #ffedca;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",midnight:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #445566;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #aa5599;\t\n\n\t\t\t\t--tonic: #222222;\n\t\t\t\t--pitch1-background: #222222;\n\t\t\t\t--pitch2-background: #222222;\n\t\t\t\t--pitch3-background: #222222;\n\t\t\t\t--pitch4-background: #222222;\n\t\t\t\t--pitch5-background: #222222;\n\t\t\t\t--pitch6-background:#222222;\n\t\t\t\t--fifth-note: #444444;\n\t\t\t\t--pitch8-background: #222222;\n\t\t\t\t--pitch9-background: #222222;\n\t\t\t\t--pitch10-background: #222222;\n\t\t\t\t--pitch11-background: #222222;\n\t\t\t\t--pitch-background: #444;\n\n\t\t\t\t--octave-scrollbar: #444444; \n\t\t\t\t--scrollbar-octave: #aa5599;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",snedbox:"\n\t\t:root {\n\t\t\t--page-margin: black;\n\t\t\t--editor-background: black;\n\t\t\t--hover-preview: white;\n\t\t\t--playhead: white;\n\t\t\t--primary-text: white;\n\t\t\t--secondary-text: #999;\n\t\t\t--inverted-text: black;\n\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t--loop-accent: #a53a3d;\n\t\t\t--link-accent: #98f;\n\t\t\t--ui-widget-background: #363636;\n\t\t\t--ui-widget-focus: #777;\n\t\t\t--pitch-background: #444;\n\t\t\t--tonic: #864;\n\t\t\t--fifth-note: #60389b;\n\t\t\t--pitch4-background: #10997e;\n\t\t\t--volume-icon: #a53a3d;\n\t\t\t--octave-scrollbar: #444;\n\t\t\t--scrollbar-octave: #a53a3d;\n\t\t\t--channel-box: #444;\n\n\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t--pitch10-primary-note:     #d85d00;\n\n\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t--pitch11-primary-note:     #ff00a1;\n\n\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t--pitch12-primary-note:     #c26afc;\n\n\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t}\n\t",unnamed:"\n\t:root {\n\t\t\t--page-margin: black;\n\t\t\t--editor-background: black;\n\t\t\t--hover-preview: white;\n\t\t\t--playhead: white;\n\t\t\t--primary-text: white;\n\t\t\t--secondary-text: #999;\n\t\t\t--inverted-text: black;\n\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t--loop-accent: #ffffff;\n\t\t\t--link-accent: #98f;\n\t\t\t--ui-widget-background: #363636;\n\t\t\t--ui-widget-focus: #777;\n\t\t\t--pitch-background: #444;\n\t\t\t--pitch1-background: #ffffa0;\n\t\t\t--pitch2-background: #ffffa0;\n\t\t\t--pitch3-background: #ffffa0;\n\t\t\t--pitch4-background: #ffffa0;\n\t\t\t--pitch5-background: #ffffa0;\n\t\t\t--pitch6-background: #ffffa0;\n\t\t\t--pitch8-background: #ffffa0;\n\t\t\t--pitch9-background: #ffffa0;\n\t\t\t--pitch10-background: #ffffa0;\n\t\t\t--pitch11-background: #ffffa0;\n\t\t\t--pitch12-background: #ffffa0;\n\t\t\t--tonic: #ffffa0;\n\t\t\t--fifth-note: #ffffa0;\n\t\t\t--volume-icon: #ffffff;\t\n\n\t\t\t--octave-scrollbar: #ffffff;\n\t\t\t--scrollbar-octave: #ffffff;\n\n\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t}\n\t",piano:"\n\t:root {\n\t\t\t--page-margin: black;\n\t\t\t--editor-background: black;\n\t\t\t--hover-preview: white;\n\t\t\t--playhead: white;\n\t\t\t--primary-text: white;\n\t\t\t--secondary-text: #999;\n\t\t\t--inverted-text: black;\n\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t--loop-accent: #ffffff;\n\t\t\t--link-accent: #98f;\n\t\t\t--ui-widget-background: #363636;\n\t\t\t--ui-widget-focus: #777;\n\n\t\t\t--use-piano-scheme: true;\n\n\t\t\t--pitch-background: #444;\n\t\t\t--volume-icon: #ff0000;\t\n\n\t\t\t--tonic: #ffffff;\n\t\t\t--white-tonic: #fff;\n\t\t\t--black-tonic: #222;\n\t\t\t--fifth-note: #7a7a7a;\n\n\t\t\t--octave-scrollbar: #211616;\n\t\t\t--scrollbar-octave: #ff4c4c;\n\t\t\t--pitch-white-key: #bfbfbf;\n\t\t\t--pitch-black-key: #7a7a7a;\n\n\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t}\n\t",halloween:"\n\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #9e2200;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #9e2200;\t\n\n\t\t\t\t--tonic: #681701;\n\t\t\t\t--pitch1-background: #754a3f;\n\t\t\t\t--pitch2-background: #754a3f;\n\t\t\t\t--pitch3-background: #754a3f;\n\t\t\t\t--pitch4-background: #754a3f;\n\t\t\t\t--pitch5-background: #754a3f;\n\t\t\t\t--pitch6-background:#754a3f;\n\t\t\t\t--fifth-note: #914300;\n\t\t\t\t--pitch8-background: #754a3f;\n\t\t\t\t--pitch9-background: #754a3f;\n\t\t\t\t--pitch10-background: #754a3f;\n\t\t\t\t--pitch11-background: #754a3f;\n\t\t\t\t--pitch-background: #444;\n\n\t\t\t\t--octave-scrollbar: #9e2200; \n\t\t\t\t--scrollbar-octave: #701800;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t}\n\t",frozen:"\n\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #38ef17;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #ed2d2d;\t\n\n\t\t\t\t--tonic: #88bce8; \n\t\t\t\t--pitch1-background: #99c8ef; \n\t\t\t\t--pitch2-background: #abd3f4; \n\t\t\t\t--pitch3-background: #b8d7f2; \n\t\t\t\t--pitch4-background: #cbe0f2;\n\t\t\t\t--pitch5-background: #e5f0f9; \n\t\t\t\t--pitch6-background: #ffffff; \n\t\t\t\t--fifth-note: #e5f0f9; \n\t\t\t\t--pitch8-background: #cbe0f2; \n\t\t\t\t--pitch9-background: #b8d7f2; \n\t\t\t\t--pitch10-background: #abd3f4; \n\t\t\t\t--pitch11-background: #99c8ef;\n\t\t\t\t--pitch-background: #444;\n\n\t\t\t\t--octave-scrollbar: #ffffff; \n\t\t\t\t--scrollbar-octave: #ed2d2d;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t}\n\t"},Yt.pageMargin="var(--page-margin, black)",Yt.editorBackground="var(--editor-background, black)",Yt.hoverPreview="var(--hover-preview, white)",Yt.playhead="var(--playhead, white)",Yt.primaryText="var(--primary-text, white)",Yt.secondaryText="var(--secondary-text, #999)",Yt.invertedText="var(--inverted-text, black)",Yt.textSelection="var(--text-selection, rgba(119,68,255,0.99))",Yt.boxSelectionFill="var(--box-selection-fill, rgba(255,255,255,0.2))",Yt.loopAccent="var(--loop-accent, #9900cc)",Yt.linkAccent="var(--link-accent, #98f)",Yt.uiWidgetBackground="var(--ui-widget-background, #444)",Yt.uiWidgetFocus="var(--ui-widget-focus)",Yt.pitchBackground="var(--pitch-background, #444)",Yt.tonic="var(--tonic, #864)",Yt.fifthNote="var(--fifth-note, #468)",Yt.pitch1Background="var(--pitch1-background, var(--pitch-background, #444))",Yt.pitch2Background="var(--pitch2-background, var(--pitch-background, #444))",Yt.pitch3Background="var(--pitch3-background, var(--pitch-background, #444))",Yt.pitch4Background="var(--pitch4-background, var(--pitch-background, #444))",Yt.pitch5Background="var(--pitch5-background, var(--pitch-background, #444))",Yt.pitch6Background="var(--pitch6-background, var(--pitch-background, #444))",Yt.pitch8Background="var(--pitch8-background, var(--pitch-background, #444))",Yt.pitch9Background="var(--pitch9-background, var(--pitch-background, #444))",Yt.pitch10Background="var(--pitch10-background, var(--pitch-background, #444))",Yt.pitch11Background="var(--pitch11-background, var(--pitch-background, #444))",Yt.volumeIcon="var(--volume-icon, #777777)",Yt.octaveScrollbar="var(--octave-scrollbar, #444444)",Yt.scrollbarOctave="var(--scrollbar-octave, #886644)",Yt.channelBox="var(--channel-box, #444444)",Yt.blackPianoKey="var(--black-piano-key, #444)",Yt.whitePianoKey="var(--white-piano-key, #bbb)",Yt.pitchChannels=h([{name:"pitch1",secondaryChannel:"var(--pitch1-secondary-channel)",primaryChannel:"var(--pitch1-primary-channel)",secondaryNote:"var(--pitch1-secondary-note)",primaryNote:"var(--pitch1-primary-note)"},{name:"pitch2",secondaryChannel:"var(--pitch2-secondary-channel)",primaryChannel:"var(--pitch2-primary-channel)",secondaryNote:"var(--pitch2-secondary-note)",primaryNote:"var(--pitch2-primary-note)"},{name:"pitch3",secondaryChannel:"var(--pitch3-secondary-channel)",primaryChannel:"var(--pitch3-primary-channel)",secondaryNote:"var(--pitch3-secondary-note)",primaryNote:"var(--pitch3-primary-note)"},{name:"pitch4",secondaryChannel:"var(--pitch4-secondary-channel)",primaryChannel:"var(--pitch4-primary-channel)",secondaryNote:"var(--pitch4-secondary-note)",primaryNote:"var(--pitch4-primary-note)"},{name:"pitch5",secondaryChannel:"var(--pitch5-secondary-channel)",primaryChannel:"var(--pitch5-primary-channel)",secondaryNote:"var(--pitch5-secondary-note)",primaryNote:"var(--pitch5-primary-note)"},{name:"pitch6",secondaryChannel:"var(--pitch6-secondary-channel)",primaryChannel:"var(--pitch6-primary-channel)",secondaryNote:"var(--pitch6-secondary-note)",primaryNote:"var(--pitch6-primary-note)"},{name:"pitch7",secondaryChannel:"var(--pitch7-secondary-channel)",primaryChannel:"var(--pitch7-primary-channel)",secondaryNote:"var(--pitch7-secondary-note)",primaryNote:"var(--pitch7-primary-note)"},{name:"pitch8",secondaryChannel:"var(--pitch8-secondary-channel)",primaryChannel:"var(--pitch8-primary-channel)",secondaryNote:"var(--pitch8-secondary-note)",primaryNote:"var(--pitch8-primary-note)"},{name:"pitch9",secondaryChannel:"var(--pitch9-secondary-channel)",primaryChannel:"var(--pitch9-primary-channel)",secondaryNote:"var(--pitch9-secondary-note)",primaryNote:"var(--pitch9-primary-note)"},{name:"pitch10",secondaryChannel:"var(--pitch10-secondary-channel)",primaryChannel:"var(--pitch10-primary-channel)",secondaryNote:"var(--pitch10-secondary-note)",primaryNote:"var(--pitch10-primary-note)"},{name:"pitch11",secondaryChannel:"var(--pitch11-secondary-channel)",primaryChannel:"var(--pitch11-primary-channel)",secondaryNote:"var(--pitch11-secondary-note)",primaryNote:"var(--pitch11-primary-note)"},{name:"pitch12",secondaryChannel:"var(--pitch12-secondary-channel)",primaryChannel:"var(--pitch12-primary-channel)",secondaryNote:"var(--pitch12-secondary-note)",primaryNote:"var(--pitch12-primary-note)"}]),Yt.noiseChannels=h([{name:"noise1",secondaryChannel:"var(--noise1-secondary-channel)",primaryChannel:"var(--noise1-primary-channel)",secondaryNote:"var(--noise1-secondary-note)",primaryNote:"var(--noise1-primary-note)"},{name:"noise2",secondaryChannel:"var(--noise2-secondary-channel)",primaryChannel:"var(--noise2-primary-channel)",secondaryNote:"var(--noise2-secondary-note)",primaryNote:"var(--noise2-primary-note)"},{name:"noise3",secondaryChannel:"var(--noise3-secondary-channel)",primaryChannel:"var(--noise3-primary-channel)",secondaryNote:"var(--noise3-secondary-note)",primaryNote:"var(--noise3-primary-note)"},{name:"noise4",secondaryChannel:"var(--noise4-secondary-channel)",primaryChannel:"var(--noise4-primary-channel)",secondaryNote:"var(--noise4-secondary-note)",primaryNote:"var(--noise4-primary-note)"}]),Yt.rt=document.head.appendChild(u.style({type:"text/css"}));const{div:qt}=u;function Kt(t){return t.toFixed(2).replace(/\.?0*$/,"")}class Jt{constructor(){this.valid=!1,this.prevNote=null,this.curNote=null,this.nextNote=null,this.pitch=0,this.pitchIndex=-1,this.curIndex=0,this.start=0,this.end=0,this.part=0,this.notePart=0,this.nearPinIndex=0,this.pins=[]}}class Qt{constructor(t){this.$=t,this.ct=b.pattern({id:"patternEditorNoteBackground",x:"0",y:"0",width:"64",height:"156",patternUnits:"userSpaceOnUse"}),this.lt=b.pattern({id:"patternEditorDrumBackground",x:"0",y:"0",width:"64",height:"40",patternUnits:"userSpaceOnUse"}),this.ft=b.rect({x:"0",y:"0",width:"512",height:"481","pointer-events":"none",fill:"url(#patternEditorNoteBackground)"}),this.dt=b.svg(),this.yt=b.rect({id:"",x:"0",y:"0",width:"4",height:"481",fill:"white","pointer-events":"none"}),this.ut=b.path({fill:"none",stroke:"white","stroke-width":"2","pointer-events":"none"}),this.bt=b.svg({style:"touch-action: none; position: absolute;",width:"100%",height:"100%",viewBox:"0 0 512 481",preserveAspectRatio:"none"},[b.defs(void 0,[this.ct,this.lt]),this.ft,this.dt,this.ut,this.yt]),this.container=qt({style:"height: 100%; overflow:hidden; position: relative; flex-grow: 1;"},[this.bt]),this.gt=13,this.xt=40,this.wt=[],this.vt=b.rect(),this.kt=[[B(0,0,3),B(0,2,3)],[B(0,0,3),B(0,2,3)],[B(0,0,3),B(0,2,3)],[B(0,0,3),B(0,2,0)]],this.Ct=481,this.Lt=0,this.Mt=0,this.St=!1,this.Ft=!1,this.Bt=!1,this.Pt=!1,this.Et=!1,this.Rt=[],this.Nt=0,this.Tt=0,this.Ot=0,this.Dt=0,this.It=0,this.At=0,this.$t=0,this.jt=!1,this.zt=null,this._t=new Jt,this.ht=null,this.Wt=0,this.Vt=0,this.Ut=-1,this.Ht=-1,this.Gt=!1,this.Yt=!1,this.qt=!1,this.Kt=!1,this.Jt=1,this.Qt=-1,this.Xt=-1,this.Zt=-1,this.te=-1,this.resetCopiedPins=()=>{const t=this.ee();this.Rt.length=this.$.song.getChannelCount();for(let e=0;e<this.$.song.pitchChannelCount;e++)this.Rt[e]=[B(0,0,3),B(0,t,3)];for(let e=this.$.song.pitchChannelCount;e<this.$.song.getChannelCount();e++)this.Rt[e]=[B(0,0,3),B(0,t,0)]},this.ne=t=>{const e=Math.floor(this.$.synth.playhead);if(this.$.synth.playing&&(null!=this.ht&&this.$.song.getPattern(this.$.channel,Math.floor(this.$.synth.playhead))==this.ht||Math.floor(this.$.synth.playhead)==this.$.bar)){this.yt.setAttribute("visibility","visible");const t=this.$.synth.playhead-e;Math.abs(t-this.Wt)>.1?this.Wt=t:this.Wt+=.2*(t-this.Wt),this.yt.setAttribute("x",""+Kt(this.Wt*this.ie-2))}else this.yt.setAttribute("visibility","hidden");this.$.synth.playing&&this.$.prefs.autoFollow&&this.te!=e&&(new J(this.$,this.$.channel,e),this.$.notifier.notifyWatchers()),this.te=e,window.requestAnimationFrame(this.ne)},this.se=t=>{this.Ft||(this.Ft=!0,this.Et=!1)},this.he=t=>{this.Ft&&(this.Ft=!1)},this.ae=t=>{t.preventDefault();const e=this.bt.getBoundingClientRect();this.Lt=((t.clientX||t.pageX)-e.left)*this.ie/(e.right-e.left),this.Mt=((t.clientY||t.pageY)-e.top)*this.Ct/(e.bottom-e.top),isNaN(this.Lt)&&(this.Lt=0),isNaN(this.Mt)&&(this.Mt=0),this.Et=!1,this.re()},this.oe=t=>{t.preventDefault();const e=this.bt.getBoundingClientRect();this.Lt=(t.touches[0].clientX-e.left)*this.ie/(e.right-e.left),this.Mt=(t.touches[0].clientY-e.top)*this.Ct/(e.bottom-e.top),isNaN(this.Lt)&&(this.Lt=0),isNaN(this.Mt)&&(this.Mt=0),this.Et=!0,this.re()},this.ce=t=>{const e=this.bt.getBoundingClientRect();this.Lt=((t.clientX||t.pageX)-e.left)*this.ie/(e.right-e.left),this.Mt=((t.clientY||t.pageY)-e.top)*this.Ct/(e.bottom-e.top),isNaN(this.Lt)&&(this.Lt=0),isNaN(this.Mt)&&(this.Mt=0),this.Et=!1,this.le()},this.pe=t=>{if(!this.St)return;t.preventDefault();const e=this.bt.getBoundingClientRect();this.Lt=(t.touches[0].clientX-e.left)*this.ie/(e.right-e.left),this.Mt=(t.touches[0].clientY-e.top)*this.Ct/(e.bottom-e.top),isNaN(this.Lt)&&(this.Lt=0),isNaN(this.Mt)&&(this.Mt=0),this.le()},this.fe=t=>{if(!this._t.valid)return;const e=this.$.lastChangeWas(this.zt);if(this.Bt&&e)null!=this.zt&&(this.$.record(this.zt),this.zt=null);else if(this.St&&e)if(null==this._t.curNote){const t=P(this._t.pitch,this._t.start,this._t.end,3,this.$.song.getChannelIsDrum(this.$.channel));t.pins=[];for(const e of this._t.pins)t.pins.push(B(0,e.time,e.volume));const e=new A;e.append(new Lt(this.$));const n=this.$.getCurrentPattern();if(null==n)throw new Error;e.append(new jt(this.$,n,t,this._t.curIndex)),this.$.record(e)}else{if(null==this.ht)throw new Error;if(-1==this._t.pitchIndex){const t=new A;4==this._t.curNote.pitches.length&&t.append(new gt(this.$,this._t.curNote,this._t.curNote.pitches[0],0,!0)),t.append(new gt(this.$,this._t.curNote,this._t.pitch,this._t.curNote.pitches.length)),this.$.record(t),this.de(this._t.curNote)}else 1==this._t.curNote.pitches.length?this.$.record(new jt(this.$,this.ht,this._t.curNote,this._t.curIndex,!0)):this.$.record(new gt(this.$,this._t.curNote,this._t.pitch,this._t.curNote.pitches.indexOf(this._t.pitch),!0))}this.St=!1,this.Bt=!1,this.ye(),this.me()},this.ue=()=>{this.ie=this.$.prefs.showLetters?this.$.prefs.showScrollBar?460:480:this.$.prefs.showScrollBar?492:512,this.ht=this.$.getCurrentPattern(),this.be=this.ie/(this.$.song.beatsPerBar*this.$.song.partsPerBeat),this.ge=this.$.song.getChannelIsDrum(this.$.channel)?this.xt:this.gt,this.xe=this.$.song.getChannelIsDrum(this.$.channel)?s.drumCount:s.pitchCount,this.Vt=12*this.$.song.channels[this.$.channel].octave,this.Qt==this.$.song.partsPerBeat&&this.Xt==this.$.song.pitchChannelCount&&this.Zt==this.$.song.drumChannelCount||(this.Qt=this.$.song.partsPerBeat,this.Xt=this.$.song.pitchChannelCount,this.Zt=this.$.song.drumChannelCount,this.resetCopiedPins()),this.we=this.Rt[this.$.channel],this.Ut!=this.ie&&(this.Ut=this.ie,this.bt.setAttribute("viewBox","0 0 "+this.ie+" 481"),this.ft.setAttribute("width",""+this.ie));const t=this.ie/this.$.song.beatsPerBar;if(this.Ht!=t){this.Ht=t,this.ct.setAttribute("width",""+t),this.lt.setAttribute("width",""+t),this.vt.setAttribute("width",""+(t-2));for(let e=0;e<12;e++)this.wt[e].setAttribute("width",""+(t-2))}this.St||this.ye(),this.dt=function(t){const e=t.cloneNode(!1);return t.parentNode.replaceChild(e,t),e}(this.dt),this.me();for(let t=0;t<12;t++)this.wt[t].style.visibility=s.scales[this.$.song.scale].flags[t]?"visible":"hidden";if(this.$.song.getChannelIsDrum(this.$.channel)?this.Kt||(this.Kt=!0,this.ft.setAttribute("fill","url(#patternEditorDrumBackground)"),this.ft.setAttribute("height",""+this.xt*s.drumCount)):this.Kt&&(this.Kt=!1,this.ft.setAttribute("fill","url(#patternEditorNoteBackground)"),this.ft.setAttribute("height",""+this.Ct)),this.$.prefs.showChannels)for(let t=this.$.song.getChannelCount()-1;t>=0;t--){if(t==this.$.channel)continue;if(this.$.song.getChannelIsDrum(t)!=this.$.song.getChannelIsDrum(this.$.channel))continue;const e=this.$.song.getPattern(t,this.$.bar);if(null!=e)for(const n of e.notes)for(const e of n.pitches){const i=b.path();i.setAttribute("fill",Yt.getChannelColor(this.$.song,t).secondaryNote),i.setAttribute("pointer-events","none"),this.ve(i,e,n.start,n.pins,.19*this.ge,!1,12*this.$.song.channels[t].octave),this.dt.appendChild(i)}}if(null!=this.ht)for(const t of this.ht.notes)for(let e=0;e<t.pitches.length;e++){const n=t.pitches[e];let i=b.path();if(i.setAttribute("fill",Yt.getChannelColor(this.$.song,this.$.channel).secondaryChannel),i.setAttribute("pointer-events","none"),this.ve(i,n,t.start,t.pins,this.ge/2+1,!1,this.Vt),this.dt.appendChild(i),i=b.path(),i.setAttribute("fill",Yt.getChannelColor(this.$.song,this.$.channel).primaryNote),i.setAttribute("pointer-events","none"),this.ve(i,n,t.start,t.pins,this.ge/2+1,!0,this.Vt),this.dt.appendChild(i),t.pitches.length>1){let i=b.text();i.setAttribute("x",""+Kt(this.be*t.start+2)),i.setAttribute("y",""+Kt(this.ke(n-this.Vt))),i.setAttribute("width","30"),i.setAttribute("fill","black"),i.setAttribute("text-anchor","start"),i.setAttribute("dominant-baseline","central"),i.setAttribute("pointer-events","none"),i.textContent=""+(e+1),this.dt.appendChild(i)}}};for(let t=0;t<12;t++){const e=(12-t)%12,n=b.rect();n.setAttribute("x","1"),n.setAttribute("y",""+(e*this.gt+1)),n.setAttribute("height",""+(this.gt-2)),n.setAttribute("fill",0==t?Yt.tonic:Yt.uiWidgetBackground),this.ct.appendChild(n),this.wt[t]=n}this.bt.style.backgroundColor=Yt.editorBackground,this.vt.setAttribute("x","1"),this.vt.setAttribute("y","1"),this.vt.setAttribute("height",""+(this.xt-2)),this.vt.setAttribute("fill","#444444"),this.lt.appendChild(this.vt),this.$.notifier.watch(this.ue),this.ue(),this.ye(),this.me(),window.requestAnimationFrame(this.ne),this.bt.addEventListener("mousedown",this.ae),document.addEventListener("mousemove",this.ce),document.addEventListener("mouseup",this.fe),this.bt.addEventListener("mouseover",this.se),this.bt.addEventListener("mouseout",this.he),this.bt.addEventListener("touchstart",this.oe),this.bt.addEventListener("touchmove",this.pe),this.bt.addEventListener("touchend",this.fe),this.bt.addEventListener("touchcancel",this.fe),this.resetCopiedPins()}ee(){return this.$.song.partsPerBeat%3==0?this.$.song.partsPerBeat/3:this.$.song.partsPerBeat%2==0?this.$.song.partsPerBeat/2:this.$.song.partsPerBeat}ye(){if(this._t=new Jt,this.Lt<0||this.Lt>this.ie||this.Mt<0||this.Mt>this.Ct)return;if(this._t.part=Math.floor(Math.max(0,Math.min(this.$.song.beatsPerBar*this.$.song.partsPerBeat-1,this.Lt/this.be))),null!=this.ht)for(const t of this.ht.notes)if(t.end<=this._t.part)this._t.prevNote=t,this._t.curIndex++;else if(t.start<=this._t.part&&t.end>this._t.part)this._t.curNote=t;else if(t.start>this._t.part){this._t.nextNote=t;break}let t=this.Ce(this.Mt);if(null!=this._t.curNote){this._t.start=this._t.curNote.start,this._t.end=this._t.curNote.end,this._t.pins=this._t.curNote.pins;let e,n=0,i=0,h=this._t.curNote.pins[0];for(let t=1;t<this._t.curNote.pins.length;t++){e=h,h=this._t.curNote.pins[t];const s=this.be*(this._t.curNote.start+e.time),a=this.be*(this._t.curNote.start+h.time);if(this.Lt>a)continue;if(this.Lt<s)throw new Error;const r=(this.Lt-s)/(a-s),o=Math.sqrt(1/Math.sqrt(4)-Math.pow(r-.5,2))-.5,c=Math.abs(h.interval-e.interval);n=e.interval*(1-r)+h.interval*r,i=o*c+1;break}let a=Number.MAX_VALUE,r=-Number.MAX_VALUE,o=Number.MAX_VALUE;for(const t of this._t.curNote.pins){a>t.interval&&(a=t.interval),r<t.interval&&(r=t.interval);const e=Math.abs(this._t.curNote.start+t.time-this.Lt/this.be);o>e&&(o=e,this._t.nearPinIndex=this._t.curNote.pins.indexOf(t))}if(t-=n,this._t.pitch=this.Le(t,-a,(this.$.song.getChannelIsDrum(this.$.channel)?s.drumCount-1:s.maxPitch)-r),3!=this.$.channel){let e=i;for(let n=0;n<this._t.curNote.pitches.length;n++){const i=Math.abs(this._t.curNote.pitches[n]-t+.5);i>e||(e=i,this._t.pitch=this._t.curNote.pitches[n])}}for(let t=0;t<this._t.curNote.pitches.length;t++)if(this._t.curNote.pitches[t]==this._t.pitch){this._t.pitchIndex=t;break}}else{this._t.pitch=this.Le(t,0,s.maxPitch);const e=this.we[this.we.length-1].time,n=Math.floor(this._t.part/this.$.song.partsPerBeat),i=this.ee(),h=this._t.part%this.$.song.partsPerBeat;if(1==e)this._t.start=this._t.part;else if(e>this.$.song.partsPerBeat)this._t.start=n*this.$.song.partsPerBeat;else if(e==this.$.song.partsPerBeat)this._t.start=n*this.$.song.partsPerBeat,i<this.$.song.partsPerBeat&&h>i&&(this._t.start+=Math.floor(h/i)*i);else{this._t.start=n*this.$.song.partsPerBeat;let t=this.$.song.partsPerBeat%e==0?e:Math.min(e,i);for(;t<i&&this.$.song.partsPerBeat%t!=0;)t++;this._t.start+=Math.floor(h/t)*t}this._t.end=this._t.start+e;let a=0,r=this.$.song.beatsPerBar*this.$.song.partsPerBeat;if(null!=this._t.prevNote&&(a=this._t.prevNote.end),null!=this._t.nextNote&&(r=this._t.nextNote.start),this._t.start<a?(this._t.start=a,this._t.end=this._t.start+e,this._t.end>r&&(this._t.end=r)):this._t.end>r&&(this._t.end=r,this._t.start=this._t.end-e,this._t.start<a&&(this._t.start=a)),this._t.end-this._t.start==e)this._t.pins=this.we;else{this._t.pins=[];for(const t of this.we){if(!(t.time<=this._t.end-this._t.start)){this._t.pins.push(B(0,this._t.end-this._t.start,t.volume));break}if(this._t.pins.push(B(0,t.time,t.volume)),t.time==this._t.end-this._t.start)break}}}this._t.valid=!0}Ce(t){return Math.max(0,Math.min(this.xe-1,this.xe-t/this.ge))+this.Vt}Le(t,e,n){t<e&&(t=e),t>n&&(t=n);const i=s.scales[this.$.song.scale].flags;if(i[Math.floor(t)%12]||this.$.song.getChannelIsDrum(this.$.channel))return Math.floor(t);{let s=Math.floor(t)+1,h=Math.floor(t)-1;for(;!i[s%12];)s++;for(;!i[h%12];)h--;if(s>n)return h<e?e:h;if(h<e)return s;let a=s,r=h+1;return s%12!=0&&s%12!=7||(a-=.5),h%12!=0&&h%12!=7||(r+=.5),t-r>a-t?s:h}}de(t){this.we=[];for(const e of t.pins)this.we.push(B(0,e.time,e.volume));for(let t=1;t<this.we.length-1;)this.we[t-1].volume==this.we[t].volume&&this.we[t].volume==this.we[t+1].volume?this.we.splice(t,1):t++;this.Rt[this.$.channel]=this.we}re(){this.St=!0,this.Nt=this.Lt,this.Tt=this.Mt,this.Ot=this.Lt,this.Dt=this.Mt,this.ye(),this.me(),this.zt=new A,this.$.setProspectiveChange(this.zt)}le(){let t,e;const n=this.$.lastChangeWas(this.zt);if(this.St&&this._t.valid&&n){if(!this.Bt){const t=this.Lt-this.Nt,e=this.Mt-this.Tt;Math.sqrt(t*t+e*e)>5&&(this.Bt=!0,this.Pt=Math.abs(t)>=Math.abs(e))}if(this.Bt){null!=this.zt&&this.zt.undo();const n=Math.floor(this.Lt/this.be),i=new A;if(this.zt=i,this.$.setProspectiveChange(this.zt),null==this._t.curNote){let s,h;n<this._t.start?(s=!0,h=this._t.start-n):(s=!1,h=n-this._t.start+1);let a=1;for(let t=0;t<=this.$.song.beatsPerBar*this.$.song.partsPerBeat;t++){if(t>=5&&t%this.$.song.partsPerBeat!=0&&t!=3*this.$.song.partsPerBeat/2&&t!=4*this.$.song.partsPerBeat/3&&t!=5*this.$.song.partsPerBeat/3)continue;const e=t;if(e==h){a=e;break}if(e<h&&(a=e),e>h){a<h-1&&(a=e);break}}if(s?(e=this._t.start,t=e-a):(t=this._t.start,e=t+a),t<0&&(t=0),e>this.$.song.beatsPerBar*this.$.song.partsPerBeat&&(e=this.$.song.beatsPerBar*this.$.song.partsPerBeat),t<e){i.append(new Lt(this.$));const n=this.$.getCurrentPattern();if(null==n)throw new Error;let h;for(i.append(new _t(this.$,n,t,e)),h=0;h<n.notes.length&&!(n.notes[h].start>=e);h++);const a=P(this._t.pitch,t,e,3,this.$.song.getChannelIsDrum(this.$.channel));i.append(new jt(this.$,n,a,h)),this.de(a),this.It=s?t:e,this.At=this._t.pitch,this.$t=a.pins[s?0:1].volume,this.jt=!0}this.ht=this.$.getCurrentPattern()}else if(this.Pt){const n=Math.round((this.Lt-this.Nt)/this.be),s=this._t.curNote.pins[this._t.nearPinIndex];let h=this._t.curNote.start+s.time+n;if(h<0&&(h=0),h>this.$.song.beatsPerBar*this.$.song.partsPerBeat&&(h=this.$.song.beatsPerBar*this.$.song.partsPerBeat),null==this.ht)throw new Error;if(h<=this._t.curNote.start&&this._t.nearPinIndex==this._t.curNote.pins.length-1||h>=this._t.curNote.end&&0==this._t.nearPinIndex)i.append(new jt(this.$,this.ht,this._t.curNote,this._t.curIndex,!0)),this.jt=!1;else{if(t=Math.min(this._t.curNote.start,h),e=Math.max(this._t.curNote.end,h),this.It=h,this.At=this._t.curNote.pitches[-1==this._t.pitchIndex?0:this._t.pitchIndex]+this._t.curNote.pins[this._t.nearPinIndex].interval,this.$t=this._t.curNote.pins[this._t.nearPinIndex].volume,this.jt=!0,null==this.ht)throw new Error;i.append(new _t(this.$,this.ht,t,e,this._t.curNote)),i.append(new Mt(this.$,this._t.curNote,this._t.nearPinIndex,h)),this.de(this._t.curNote)}}else if(-1==this._t.pitchIndex){const t=Math.round(Math.max(this._t.curNote.start,Math.min(this._t.curNote.end,this.Lt/this.be)))-this._t.curNote.start;let e,n=this._t.curNote.pins[0],h=0,a=0;for(let i=1;i<this._t.curNote.pins.length;i++){if(e=n,n=this._t.curNote.pins[i],t>n.time)continue;if(t<e.time)throw new Error;const r=(t-e.time)/(n.time-e.time);h=Math.round(e.volume*(1-r)+n.volume*r+(this.Tt-this.Mt)/20),h<0&&(h=0),h>3&&(h=3),a=this.Le(e.interval*(1-r)+n.interval*r+this._t.curNote.pitches[0],0,s.maxPitch)-this._t.curNote.pitches[0];break}this.It=this._t.curNote.start+t,this.At=this._t.curNote.pitches[-1==this._t.pitchIndex?0:this._t.pitchIndex]+a,this.$t=h,this.jt=!0,i.append(new Ht(this.$,this._t.curNote,t,h,a)),this.de(this._t.curNote)}else{if(this.$t=this._t.curNote.pins[this._t.nearPinIndex].volume,null==this.ht)throw new Error;let t,e;this.Lt>=this.Nt?(t=this._t.part,e=n+1):(t=this._t.part+1,e=n),e<0&&(e=0),e>this.$.song.beatsPerBar*this.$.song.partsPerBeat&&(e=this.$.song.beatsPerBar*this.$.song.partsPerBeat),e>this._t.curNote.end&&i.append(new _t(this.$,this.ht,this._t.curNote.start,e,this._t.curNote)),e<this._t.curNote.start&&i.append(new _t(this.$,this.ht,e,this._t.curNote.end,this._t.curNote));let h=Number.MAX_VALUE,a=-Number.MAX_VALUE;for(const t of this._t.curNote.pitches)h>t&&(h=t),a<t&&(a=t);h-=this._t.curNote.pitches[this._t.pitchIndex],a-=this._t.curNote.pitches[this._t.pitchIndex];const r=this.Le(this.Ce(this.Mt),-h,(this.$.song.getChannelIsDrum(this.$.channel)?s.drumCount-1:s.maxPitch)-a);i.append(new St(this.$,this._t.curNote,t,e,r,this._t.pitchIndex)),this.de(this._t.curNote),this.It=e,this.At=r,this.jt=!0}}this.Ot=this.Lt,this.Dt=this.Mt}else this.ye(),this.me()}me(){if(this.Et)if(this.St&&this._t.valid&&this.Bt&&this.jt){this.ut.setAttribute("visibility","visible");const t=this.be*this.It,e=this.ke(this.At-this.Vt),n=this.ge/2,i=80,s=60;let h="";h+="M "+Kt(t)+" "+Kt(e-n*(this.$t/3))+" ",h+="L "+Kt(t)+" "+Kt(e-n*(this.$t/3)-s)+" ",h+="M "+Kt(t)+" "+Kt(e+n*(this.$t/3))+" ",h+="L "+Kt(t)+" "+Kt(e+n*(this.$t/3)+s)+" ",h+="M "+Kt(t)+" "+Kt(e-n*(this.$t/3))+" ",h+="L "+Kt(t+i)+" "+Kt(e-n*(this.$t/3))+" ",h+="M "+Kt(t)+" "+Kt(e+n*(this.$t/3))+" ",h+="L "+Kt(t+i)+" "+Kt(e+n*(this.$t/3))+" ",h+="M "+Kt(t)+" "+Kt(e-n*(this.$t/3))+" ",h+="L "+Kt(t-i)+" "+Kt(e-n*(this.$t/3))+" ",h+="M "+Kt(t)+" "+Kt(e+n*(this.$t/3))+" ",h+="L "+Kt(t-i)+" "+Kt(e+n*(this.$t/3))+" ",this.ut.setAttribute("d",h)}else this.ut.setAttribute("visibility","hidden");else this.Ft&&!this.St&&this._t.valid?(this.ut.setAttribute("visibility","visible"),this.ve(this.ut,this._t.pitch,this._t.start,this._t.pins,this.ge/2+1,!0,this.Vt)):this.ut.setAttribute("visibility","hidden")}render(){0==this.$.prefs.showMore?(this.Gt!=this.$.prefs.showFifth&&(this.Gt=this.$.prefs.showFifth,this.wt[7].setAttribute("fill",this.$.prefs.showFifth?Yt.fifthNote:Yt.pitchBackground)),1==this.qt&&(this.qt=!1),this.Yt!=this.$.prefs.showMore&&(this.wt[0].setAttribute("fill",Yt.tonic),this.wt[1].setAttribute("fill",this.$.prefs.showMore?Yt.pitch1Background:Yt.pitchBackground),this.wt[2].setAttribute("fill",this.$.prefs.showMore?Yt.pitch2Background:Yt.pitchBackground),this.wt[3].setAttribute("fill",this.$.prefs.showMore?Yt.pitch3Background:Yt.pitchBackground),this.wt[4].setAttribute("fill",this.$.prefs.showMore?Yt.pitch4Background:Yt.pitchBackground),this.wt[5].setAttribute("fill",this.$.prefs.showMore?Yt.pitch5Background:Yt.pitchBackground),this.wt[6].setAttribute("fill",this.$.prefs.showMore?Yt.pitch6Background:Yt.pitchBackground),this.wt[7].setAttribute("fill",this.$.prefs.showFifth?Yt.fifthNote:Yt.pitchBackground),this.wt[8].setAttribute("fill",this.$.prefs.showMore?Yt.pitch8Background:Yt.pitchBackground),this.wt[9].setAttribute("fill",this.$.prefs.showMore?Yt.pitch9Background:Yt.pitchBackground),this.wt[10].setAttribute("fill",this.$.prefs.showMore?Yt.pitch10Background:Yt.pitchBackground),this.wt[11].setAttribute("fill",this.$.prefs.showMore?Yt.pitch11Background:Yt.pitchBackground),this.Yt=this.$.prefs.showMore,console.log("this._renderedACS (acs disabled): "+this.Yt)),this.Jt=-1):0==Yt.usesPianoScheme?(this.Yt==this.$.prefs.showMore&&1!=this.qt||(this.wt[0].setAttribute("fill",(this.$.prefs.showMore,Yt.tonic)),this.wt[1].setAttribute("fill",this.$.prefs.showMore?Yt.pitch1Background:Yt.pitchBackground),this.wt[2].setAttribute("fill",this.$.prefs.showMore?Yt.pitch2Background:Yt.pitchBackground),this.wt[3].setAttribute("fill",this.$.prefs.showMore?Yt.pitch3Background:Yt.pitchBackground),this.wt[4].setAttribute("fill",this.$.prefs.showMore?Yt.pitch4Background:Yt.pitchBackground),this.wt[5].setAttribute("fill",this.$.prefs.showMore?Yt.pitch5Background:Yt.pitchBackground),this.wt[6].setAttribute("fill",this.$.prefs.showMore?Yt.pitch6Background:Yt.pitchBackground),this.wt[7].setAttribute("fill",this.$.prefs.showFifth?Yt.fifthNote:Yt.pitchBackground),this.wt[8].setAttribute("fill",this.$.prefs.showMore?Yt.pitch8Background:Yt.pitchBackground),this.wt[9].setAttribute("fill",this.$.prefs.showMore?Yt.pitch9Background:Yt.pitchBackground),this.wt[10].setAttribute("fill",this.$.prefs.showMore?Yt.pitch10Background:Yt.pitchBackground),this.wt[11].setAttribute("fill",this.$.prefs.showMore?Yt.pitch11Background:Yt.pitchBackground),this.Yt=this.$.prefs.showMore,console.log("this._renderedACS (acs enabled): "+this.Yt)),1==this.qt&&(this.qt=!1,this.Jt=-1,console.log("this._renderedACS (disabiling piano): "+this.Yt))):this.Jt!=this.$.song.key&&(this.Jt=this.$.song.key,this.qt=!0,console.log("piano key"+this.Jt),0==this.Jt||2==this.Jt||4==this.Jt||6==this.Jt||7==this.Jt||9==this.Jt||11==this.Jt?this.wt[0].setAttribute("fill",this.$.prefs.showMore?"var(--white-tonic, var(--pitch-white-key, var(--pitch-background)))":Yt.pitchBackground):this.wt[0].setAttribute("fill",this.$.prefs.showMore?"var(--black-tonic, var(--pitch-black-key, var(--pitch-background))":Yt.pitchBackground),0==this.Jt||1==this.Jt||3==this.Jt||5==this.Jt||7==this.Jt||8==this.Jt||10==this.Jt?this.wt[1].setAttribute("fill",this.$.prefs.showMore?"var(--pitch-white-key, var(--pitch-background))":Yt.pitchBackground):this.wt[1].setAttribute("fill",this.$.prefs.showMore?"var(--pitch-black-key, var(--pitch-background))":Yt.pitchBackground),1==this.Jt||2==this.Jt||4==this.Jt||6==this.Jt||8==this.Jt||9==this.Jt||11==this.Jt?this.wt[2].setAttribute("fill",this.$.prefs.showMore?"var(--pitch-white-key, var(--pitch-background))":Yt.pitchBackground):this.wt[2].setAttribute("fill",this.$.prefs.showMore?"var(--pitch-black-key, var(--pitch-background))":Yt.pitchBackground),0==this.Jt||2==this.Jt||3==this.Jt||5==this.Jt||7==this.Jt||9==this.Jt||10==this.Jt?this.wt[3].setAttribute("fill",this.$.prefs.showMore?"var(--pitch-white-key, var(--pitch-background))":Yt.pitchBackground):this.wt[3].setAttribute("fill",this.$.prefs.showMore?"var(--pitch-black-key, var(--pitch-background))":Yt.pitchBackground),1==this.Jt||3==this.Jt||4==this.Jt||6==this.Jt||8==this.Jt||10==this.Jt||11==this.Jt?this.wt[4].setAttribute("fill",this.$.prefs.showMore?" var(--pitch-white-key, var(--pitch-background))":Yt.pitchBackground):this.wt[4].setAttribute("fill",this.$.prefs.showMore?" var(--pitch-black-key, var(--pitch-background))":Yt.pitchBackground),0==this.Jt||2==this.Jt||4==this.Jt||5==this.Jt||7==this.Jt||9==this.Jt||11==this.Jt?this.wt[5].setAttribute("fill",this.$.prefs.showMore?"var(--pitch-white-key, var(--pitch-background))":Yt.pitchBackground):this.wt[5].setAttribute("fill",this.$.prefs.showMore?"var(--pitch-black-key, var(--pitch-background))":Yt.pitchBackground),0==this.Jt||1==this.Jt||3==this.Jt||5==this.Jt||6==this.Jt||8==this.Jt||10==this.Jt?this.wt[6].setAttribute("fill",this.$.prefs.showMore?"var(--pitch-white-key, var(--pitch-background))":Yt.pitchBackground):this.wt[6].setAttribute("fill",this.$.prefs.showMore?"var(--pitch-black-key, var(--pitch-background))":Yt.pitchBackground),1==this.Jt||2==this.Jt||4==this.Jt||6==this.Jt||7==this.Jt||9==this.Jt||11==this.Jt?1==this.$.prefs.showFifth?this.wt[7].setAttribute("fill",this.$.prefs.showMore?"var(--white-fifth-note, var(--pitch-white-key, var(--pitch-background)))":Yt.pitchBackground):this.wt[7].setAttribute("fill",this.$.prefs.showMore?" var(--pitch-white-key, var(--pitch-background))":Yt.pitchBackground):1==this.$.prefs.showFifth?this.wt[7].setAttribute("fill",this.$.prefs.showMore?"var(--black-fifth-note, var(--pitch-black-key, var(--pitch-background)))":Yt.pitchBackground):this.wt[7].setAttribute("fill",this.$.prefs.showMore?"var(--pitch-black-key, var(--pitch-background))":Yt.pitchBackground),0==this.Jt||2==this.Jt||3==this.Jt||5==this.Jt||7==this.Jt||8==this.Jt||10==this.Jt?this.wt[8].setAttribute("fill",this.$.prefs.showMore?"var(--pitch-white-key, var(--pitch-background))":Yt.pitchBackground):this.wt[8].setAttribute("fill",this.$.prefs.showMore?"var(--pitch-black-key, var(--pitch-background))":Yt.pitchBackground),1==this.Jt||3==this.Jt||4==this.Jt||6==this.Jt||8==this.Jt||9==this.Jt||11==this.Jt?this.wt[9].setAttribute("fill",this.$.prefs.showMore?"var(--pitch-white-key, var(--pitch-background))":Yt.pitchBackground):this.wt[9].setAttribute("fill",this.$.prefs.showMore?"var(--pitch-black-key, var(--pitch-background))":Yt.pitchBackground),0==this.Jt||2==this.Jt||4==this.Jt||5==this.Jt||7==this.Jt||9==this.Jt||10==this.Jt?this.wt[10].setAttribute("fill",this.$.prefs.showMore?"var(--pitch-white-key, var(--pitch-background))":Yt.pitchBackground):this.wt[10].setAttribute("fill",this.$.prefs.showMore?"var(--pitch-black-key, var(--pitch-background))":Yt.pitchBackground),1==this.Jt||3==this.Jt||5==this.Jt||6==this.Jt||8==this.Jt||10==this.Jt||11==this.Jt?this.wt[11].setAttribute("fill",this.$.prefs.showMore?"var(--pitch-white-key, var(--pitch-background))":Yt.pitchBackground):this.wt[11].setAttribute("fill",this.$.prefs.showMore?"var(--pitch-black-key, var(--pitch-background))":Yt.pitchBackground),this.Yt!=this.$.prefs.showMore&&(this.Yt=this.$.prefs.showMore,console.log("this._renderedACS (in piano): "+this.Yt)))}ve(t,e,n,i,s,h,a){let r=i[0],o="M "+Kt(this.be*(n+r.time)+1)+" "+Kt(this.ke(e-a)+s*(h?r.volume/3:1))+" ";for(let t=1;t<i.length;t++){let c=r;r=i[t];let l=this.be*(n+c.time)+(1==t?1:0),p=this.be*(n+r.time)-(t==i.length-1?1:0),f=this.ke(e+c.interval-a),d=this.ke(e+r.interval-a),y=h?c.volume/3:1,m=h?r.volume/3:1;o+="L "+Kt(l)+" "+Kt(f-s*y)+" ",c.interval>r.interval&&(o+="L "+Kt(l+1)+" "+Kt(f-s*y)+" "),c.interval<r.interval&&(o+="L "+Kt(p-1)+" "+Kt(d-s*m)+" "),o+="L "+Kt(p)+" "+Kt(d-s*m)+" "}for(let t=i.length-2;t>=0;t--){let c=r;r=i[t];let l=this.be*(n+c.time)-(t==i.length-2?1:0),p=this.be*(n+r.time)+(0==t?1:0),f=this.ke(e+c.interval-a),d=this.ke(e+r.interval-a),y=h?c.volume/3:1,m=h?r.volume/3:1;o+="L "+Kt(l)+" "+Kt(f+s*y)+" ",c.interval<r.interval&&(o+="L "+Kt(l-1)+" "+Kt(f+s*y)+" "),c.interval>r.interval&&(o+="L "+Kt(p+1)+" "+Kt(d+s*m)+" "),o+="L "+Kt(p)+" "+Kt(d+s*m)+" "}o+="z",t.setAttribute("d",o)}ke(t){return this.ge*(this.xe-t-.5)}}const{select:Xt,div:Zt,option:te}=u;class ee{constructor(t,e,n,i,s){this.Me=b.text({x:16,y:23,"font-family":"sans-serif","font-size":20,"text-anchor":"middle","font-weight":"bold",fill:Yt.invertedText},"1"),this.Se=b.rect({width:30,height:27,x:1,y:1}),this.Fe=b.rect({width:6,height:3,x:24,y:5}),this.Be=b.rect({width:6,height:18,x:24,y:5}),this.container=b.svg(this.Se,this.Be,this.Fe,this.Me),this.Pe=1,this.Ee=!0,this.Re=!1,this.Ne="",this.container.setAttribute("x",""+32*e),this.container.setAttribute("y",""+32*n),this.Se.setAttribute("fill","#444444"),this.Fe.setAttribute("fill","#444444"),this.Be.setAttribute("fill","#444444"),this.Me.setAttribute("fill",i)}setSquashed(t,e){t?(this.container.setAttribute("y",""+27*e),this.Se.setAttribute("height","25"),this.Fe.setAttribute("height","2.7"),this.Be.setAttribute("height","18"),this.Me.setAttribute("y","21")):(this.container.setAttribute("y",""+32*e),this.Se.setAttribute("height","30"),this.Fe.setAttribute("height","3"),this.Be.setAttribute("height","18"),this.Me.setAttribute("y","23"))}setIndex(t,e,n,i,s,h,a,r,o){2==o?(this.Fe.setAttribute("height",""+(18-2*h)),this.Fe.setAttribute("y",""+(5+2*h))):(this.Fe.setAttribute("height",""+(18-3.6*h)),this.Fe.setAttribute("y",""+(5+3.6*h))),this.Pe!=t&&(this.Re||0==t==(0==this.Pe)||(this.Se.setAttribute("fill",0==t?Yt.editorBackground:Yt.channelBox),this.Fe.setAttribute("fill",0==t?Yt.editorBackground:Yt.channelBox),this.Be.setAttribute("fill",0==t?Yt.editorBackground:Yt.channelBox)),this.Pe=t,this.Me.innerHTML=String(t)),this.Ee==e&&this.Ne==s||(this.Ee=e,n?this.Me.setAttribute("fill",Yt.invertedText):this.Me.setAttribute("fill",s)),this.Re==n&&this.Ne==s||(this.Re=n,n?(this.Se.setAttribute("fill",s),this.Fe.setAttribute("fill",s),this.Be.setAttribute("fill",s),this.Me.setAttribute("fill",Yt.invertedText)):(this.Se.setAttribute("fill",0==this.Pe?Yt.editorBackground:Yt.channelBox),this.Fe.setAttribute("fill",0==this.Pe?Yt.editorBackground:s),this.Be.setAttribute("fill",0==this.Pe?Yt.editorBackground:a),this.Me.setAttribute("fill",s))),r?(this.Me.setAttribute("x","12"),this.Fe.style.visibility="visible",this.Be.style.visibility="visible"):(this.Me.setAttribute("x","16"),this.Fe.style.visibility="hidden",this.Be.style.visibility="hidden"),this.Ne=s}}class ne{constructor(t){this.$=t,this.Te=32,this.bt=b.svg({style:"position: absolute;",height:128}),this.Oe=Xt({class:"trackSelectBox",style:"width: 32px; height: 32px; background: none; border: none; appearance: none; color: transparent; position: absolute;"}),this.container=Zt({style:"height: 128px; position: relative; overflow:hidden;"},[this.bt,this.Oe]),this.De=b.g(),this.Ie=b.rect({fill:"white",x:0,y:0,width:4,height:128}),this.Ae=b.rect({fill:"none",stroke:"white","stroke-width":2,"pointer-events":"none",x:1,y:1,width:30,height:30}),this.$e=b.path({fill:"black",stroke:"black","stroke-width":1,"pointer-events":"none"}),this.je=b.path({fill:"black",stroke:"black","stroke-width":1,"pointer-events":"none"}),this.ze=[],this.Lt=0,this.Mt=0,this.ht=null,this.Ft=!1,this._e="",this.Ct=128,this.We=32,this.Ve=0,this.Ue=0,this.He=0,this.Ge=-1,this.Ye=!1,this.qe=null,this.Ke=()=>{this.Je(this.Oe.selectedIndex)},this.ne=t=>{const e=this.Te*this.$.synth.playhead-2;this.Ge!=e&&(this.Ge=e,this.Ie.setAttribute("x",""+e)),window.requestAnimationFrame(this.ne)},this.se=t=>{this.Ft||(this.Ft=!0)},this.he=t=>{this.Ft&&(this.Ft=!1)},this.ae=t=>{t.preventDefault();const e=this.bt.getBoundingClientRect();this.Lt=(t.clientX||t.pageX)-e.left,this.Mt=(t.clientY||t.pageY)-e.top;const n=Math.floor(Math.min(this.$.song.getChannelCount()-1,Math.max(0,this.Mt/this.We))),i=Math.floor(Math.min(this.$.song.barCount-1,Math.max(0,this.Lt/this.Te)));if(this.$.channel==n&&this.$.bar==i){const t=this.Mt%this.We<this.We/2,e=this.$.song.patternsPerChannel;this.Je((this.$.song.channels[n].bars[i]+(t?1:e))%(e+1))}else this.Qe(n,i)},this.ce=t=>{const e=this.bt.getBoundingClientRect();this.Lt=(t.clientX||t.pageX)-e.left,this.Mt=(t.clientY||t.pageY)-e.top,this.me()},this.Xe=t=>{},this.bt.appendChild(this.De),this.bt.appendChild(this.Ae),this.bt.appendChild(this.$e),this.bt.appendChild(this.je),this.bt.appendChild(this.Ie),this.bt.style.backgroundColor=Yt.editorBackground,window.requestAnimationFrame(this.ne),this.bt.addEventListener("mousedown",this.ae),document.addEventListener("mousemove",this.ce),document.addEventListener("mouseup",this.Xe),this.bt.addEventListener("mouseover",this.se),this.bt.addEventListener("mouseout",this.he),this.Oe.addEventListener("change",this.Ke)}Qe(t,e){new J(this.$,t,e),this._e="",this.$.forgetLastChange()}Je(t){const e=this.$.song.channels[this.$.channel].bars[this.$.bar],n=this.$.lastChangeWas(this.qe),i=n?this.qe.oldValue:e;t!=e&&(this.qe=new _(this.$,i,t),this.$.record(this.qe,n))}Ze(t){this._e+=t;let e=parseInt(this._e);e<=this.$.song.patternsPerChannel?this.Je(e):(this._e=t,e=parseInt(this._e),e<=this.$.song.patternsPerChannel?this.Je(e):this._e="")}me(){let t=Math.floor(Math.min(this.$.song.getChannelCount()-1,Math.max(0,this.Mt/this.We))),e=Math.floor(Math.min(this.$.song.barCount-1,Math.max(0,this.Lt/this.Te)));const n=window.innerWidth>700;n||(e=this.$.bar,t=this.$.channel);const i=e==this.$.bar&&t==this.$.channel;if(this.Ft&&!i?(this.Ae.setAttribute("x",""+(1+this.Te*e)),this.Ae.setAttribute("y",""+(1+this.We*t)),this.Ae.setAttribute("height",""+(this.We-2)),this.Ae.style.visibility="visible"):this.Ae.style.visibility="hidden",!this.Ft&&n||!i)this.$e.style.visibility="hidden",this.je.style.visibility="hidden";else{const i=this.Mt%this.We<this.We/2,s=this.Te*(e+.8),h=this.We*(t+.5),a=.1*this.We,r=.4*this.We,o=.175*this.We;this.$e.setAttribute("fill",i&&n?"#fff":"#000"),this.je.setAttribute("fill",!i&&n?"#fff":"#000"),this.$e.setAttribute("d",`M ${s} ${h-r} L ${s+o} ${h-a} L ${s-o} ${h-a} z`),this.je.setAttribute("d",`M ${s} ${h+r} L ${s+o} ${h+a} L ${s-o} ${h+a} z`),this.$e.style.visibility="visible",this.je.style.visibility="visible"}this.Oe.style.left=this.Te*this.$.bar+"px",this.Oe.style.top=this.We*this.$.channel+"px",this.Oe.style.height=this.We+"px";const s=this.$.song.patternsPerChannel;for(let t=this.He;t<s;t++)this.Oe.appendChild(te({value:t},t));for(let t=s;t<this.He;t++)this.Oe.removeChild(this.Oe.lastChild);this.He=s;const h=this.$.song.channels[this.$.channel].bars[this.$.bar];this.Oe.selectedIndex!=h&&(this.Oe.selectedIndex=h)}render(){this.ht=this.$.getCurrentPattern();const t=!(window.innerWidth>700)||this.$.song.getChannelCount()>5||this.$.song.barCount>this.$.trackVisibleBars&&this.$.song.getChannelCount()>3;if(this.We=t?27:32,this.Ve!=this.$.song.getChannelCount()){for(let e=this.Ve;e<this.$.song.getChannelCount();e++){this.ze[e]=[];for(let n=0;n<this.Ue;n++){const i=new ee(e,n,e,Yt.getChannelColor(this.$.song,e).secondaryChannel,this.$.prefs.showVolumeBar);i.setSquashed(t,e),this.De.appendChild(i.container),this.ze[e][n]=i}}for(let t=this.$.song.getChannelCount();t<this.Ve;t++)for(let e=0;e<this.Ue;e++)this.De.removeChild(this.ze[t][e].container);this.ze.length=this.$.song.getChannelCount()}if(this.Ue<this.$.song.barCount)for(let e=0;e<this.$.song.getChannelCount();e++){for(let n=this.Ue;n<this.$.song.barCount;n++){const i=new ee(e,n,e,Yt.getChannelColor(this.$.song,e).secondaryChannel,this.$.prefs.showVolumeBar);i.setSquashed(t,e),this.De.appendChild(i.container),this.ze[e][n]=i}for(let t=this.$.song.barCount;t<this.Ue;t++)this.De.removeChild(this.ze[e][t].container);this.ze[e].length=this.$.song.barCount}if(this.Ue!=this.$.song.barCount){this.Ue=this.$.song.barCount;const t=32*this.$.song.barCount;this.container.style.width=t+"px",this.bt.setAttribute("width",t+"")}if(this.Ye!=t)for(let e=0;e<this.$.song.getChannelCount();e++)for(let n=0;n<this.Ue;n++)this.ze[e][n].setSquashed(t,e);this.Ye==t&&this.Ve==this.$.song.getChannelCount()||(this.Ye=t,this.Ve=this.$.song.getChannelCount(),this.Ct=this.$.song.getChannelCount()*this.We,this.bt.setAttribute("height",""+this.Ct),this.Ie.setAttribute("height",""+this.Ct),this.container.style.height=this.Ct+"px");for(let t=0;t<this.$.song.getChannelCount();t++)for(let e=0;e<this.Ue;e++){const n=this.$.song.getPattern(t,e),i=this.$.song.getPatternInstrumentMute(t,e),s=this.$.song.getPatternInstrumentVolume(t,e),h=e==this.$.bar&&t==this.$.channel,a=null==n||0==n.notes.length,r=1==i,o=s,c=this.ze[t][e];e<this.$.song.barCount?(c.setIndex(this.$.song.channels[t].bars[e],a,h,t,!a||h||r?r&&!h?"#161616":Yt.getChannelColor(this.$.song,t).primaryChannel:Yt.getChannelColor(this.$.song,t).secondaryChannel,o,(!a||h||r)&&r&&!h?"#9b9b9b":Yt.getChannelColor(this.$.song,t).secondaryChannel,this.$.prefs.showVolumeBar,this.$.song.mix),c.container.style.visibility="visible"):c.container.style.visibility="hidden"}this.me()}}const{div:ie}=u;class se{constructor(t){this.$=t,this.Te=32,this.Ct=20,this.tn=0,this.en=1,this.nn=2,this.sn=b.path({fill:"none",stroke:Yt.loopAccent,"stroke-width":4}),this.hn=b.path({fill:"white","pointer-events":"none"}),this.bt=b.svg({style:"touch-action: pan-y; position: absolute;",height:this.Ct},[this.sn,this.hn]),this.container=ie({style:"height: 20px; position: relative; margin: 5px 0;"},[this.bt]),this.an=null,this._t={startBar:-1,mode:-1},this.Lt=0,this.Mt=0,this.rn=0,this.cn=0,this.ln=!1,this.pn=!1,this.St=!1,this.Ft=!1,this.fn=-1,this.dn=-1,this.Ue=0,this.se=t=>{this.Ft||(this.Ft=!0,this.me())},this.he=t=>{this.Ft&&(this.Ft=!1,this.me())},this.ae=t=>{t.preventDefault(),this.St=!0;const e=this.bt.getBoundingClientRect();this.Lt=(t.clientX||t.pageX)-e.left,this.Mt=(t.clientY||t.pageY)-e.top,this.ye(),this.me(),this.ce(t)},this.oe=t=>{this.St=!0;const e=this.bt.getBoundingClientRect();this.Lt=t.touches[0].clientX-e.left,this.Mt=t.touches[0].clientY-e.top,this.ye(),this.me(),this.rn=t.touches[0].clientX,this.cn=t.touches[0].clientY,this.pn=!1,this.ln=!1},this.ce=t=>{const e=this.bt.getBoundingClientRect();this.Lt=(t.clientX||t.pageX)-e.left,this.Mt=(t.clientY||t.pageY)-e.top,this.le()},this.pe=t=>{if(!this.St)return;const e=this.bt.getBoundingClientRect();this.Lt=t.touches[0].clientX-e.left,this.Mt=t.touches[0].clientY-e.top,this.pn||this.ln||(Math.abs(t.touches[0].clientY-this.cn)>10?this.ln=!0:Math.abs(t.touches[0].clientX-this.rn)>10&&(this.pn=!0)),this.pn&&(this.le(),t.preventDefault())},this.yn=t=>{t.preventDefault(),this.ln||(this.le(),this.Ft=!1,this.fe(t),this.me())},this.fe=t=>{null!=this.an&&this.$.record(this.an),this.an=null,this.St=!1,this.ye(),this.mn()},this.ue=()=>{this.mn()},this.ye(),this.mn(),this.$.notifier.watch(this.ue),this.bt.style.backgroundColor=Yt.editorBackground,this.container.addEventListener("mousedown",this.ae),document.addEventListener("mousemove",this.ce),document.addEventListener("mouseup",this.fe),this.container.addEventListener("mouseover",this.se),this.container.addEventListener("mouseout",this.he),this.container.addEventListener("touchstart",this.oe),this.container.addEventListener("touchmove",this.pe),this.container.addEventListener("touchend",this.yn),this.container.addEventListener("touchcancel",this.yn)}ye(){const t=this.Lt/this.Te;this._t.startBar=t,t>this.$.song.loopStart-.25&&t<this.$.song.loopStart+this.$.song.loopLength+.25?t-this.$.song.loopStart<.5*this.$.song.loopLength?this._t.mode=this.tn:this._t.mode=this.en:this._t.mode=this.nn}un(t){let e=Math.round(t-this.$.song.loopLength/2),n=e+this.$.song.loopLength;return e<0&&(n-=e,e=0),n>this.$.song.barCount&&(e-=n-this.$.song.barCount,n=this.$.song.barCount),{start:e,length:n-e}}le(){if(this.St){let t=this.$.song.loopStart,e=this.$.song.loopStart+this.$.song.loopLength;null!=this.an&&this.$.lastChangeWas(this.an)&&(t=this.an.oldStart,e=t+this.an.oldLength);const n=this.Lt/this.Te;let i,s,h;if(this._t.mode==this.tn)i=t+Math.round(n-this._t.startBar),s=e,i<0&&(i=0),i>=this.$.song.barCount&&(i=this.$.song.barCount),i==s?i=s-1:i>s&&(h=i,i=s,s=h),this.an=new bt(this.$,t,e-t,i,s-i);else if(this._t.mode==this.en)i=t,s=e+Math.round(n-this._t.startBar),s<0&&(s=0),s>=this.$.song.barCount&&(s=this.$.song.barCount),s==i?s=i+1:s<i&&(h=i,i=s,s=h),this.an=new bt(this.$,t,e-t,i,s-i);else if(this._t.mode==this.nn){const i=this.un(n);this.an=new bt(this.$,t,e-t,i.start,i.length)}this.$.setProspectiveChange(this.an)}else this.ye(),this.me()}me(){const t=this.Ft&&!this.St;if(this.hn.style.visibility=t?"visible":"hidden",t){const t=this.Ct/2;let e=this.$.song.loopStart*this.Te,n=(this.$.song.loopStart+this.$.song.loopLength)*this.Te;if(this._t.mode==this.tn)n=this.$.song.loopStart*this.Te+2*t;else if(this._t.mode==this.en)e=(this.$.song.loopStart+this.$.song.loopLength)*this.Te-2*t;else{const t=this.un(this._t.startBar);e=t.start*this.Te,n=(t.start+t.length)*this.Te}this.hn.setAttribute("d",`M ${e+t} 4 L ${n-t} 4 A ${t-4} ${t-4} 0 0 1 ${n-t} ${this.Ct-4} L ${e+t} ${this.Ct-4} A ${t-4} ${t-4} 0 0 1 ${e+t} 4 z`)}}mn(){const t=this.Ct/2,e=this.$.song.loopStart*this.Te,n=(this.$.song.loopStart+this.$.song.loopLength)*this.Te;if(this.Ue!=this.$.song.barCount){this.Ue=this.$.song.barCount;const t=32*this.$.song.barCount;this.container.style.width=t+"px",this.bt.setAttribute("width",t+"")}this.fn==e&&this.dn==n||(this.fn=e,this.dn=n,this.sn.setAttribute("d",`M ${e+t} 2 L ${n-t} 2 A ${t-2} ${t-2} 0 0 1 ${n-t} ${this.Ct-2} L ${e+t} ${this.Ct-2} A ${t-2} ${t-2} 0 0 1 ${e+t} 2 z`)),this.me()}}const{div:he}=u;class ae{constructor(t,e){this.$=t,this.bn=e,this.ie=512,this.Ct=20,this.gn=b.svg({"pointer-events":"none"}),this.xn=b.rect({fill:"#444444",x:0,y:2,width:10,height:this.Ct-4}),this.wn=b.rect({fill:"none",stroke:"white","stroke-width":2,"pointer-events":"none",x:0,y:1,width:10,height:this.Ct-2}),this.vn=b.path({fill:"white","pointer-events":"none"}),this.kn=b.path({fill:"white","pointer-events":"none"}),this.bt=b.svg({style:"background-color: #000000; touch-action: pan-y; position: absolute;",width:this.ie,height:this.Ct},[this.gn,this.xn,this.wn,this.vn,this.kn]),this.container=he({class:"barScrollBar",style:"width: 512px; height: 20px; overflow: hidden; position: relative;"},[this.bt]),this.Lt=0,this.Mt=0,this.St=!1,this.Ft=!1,this.Cn=!1,this.Ln=-1,this.Mn=-1,this.Sn=t=>{this.$.barScrollPos=this.bn.scrollLeft/32},this.se=t=>{this.Ft||(this.Ft=!0,this.me())},this.he=t=>{this.Ft&&(this.Ft=!1,this.me())},this.ae=t=>{t.preventDefault(),this.St=!0;const e=this.bt.getBoundingClientRect();this.Lt=(t.clientX||t.pageX)-e.left,this.Mt=(t.clientY||t.pageY)-e.top,this.me(),this.Lt>=this.$.barScrollPos*this.Te&&this.Lt<=(this.$.barScrollPos+this.$.trackVisibleBars)*this.Te&&(this.Cn=!0,this.Fn=this.Lt)},this.oe=t=>{t.preventDefault(),this.St=!0;const e=this.bt.getBoundingClientRect();this.Lt=t.touches[0].clientX-e.left,this.Mt=t.touches[0].clientY-e.top,this.me(),this.Lt>=this.$.barScrollPos*this.Te&&this.Lt<=(this.$.barScrollPos+this.$.trackVisibleBars)*this.Te&&(this.Cn=!0,this.Fn=this.Lt)},this.ce=t=>{const e=this.bt.getBoundingClientRect();this.Lt=(t.clientX||t.pageX)-e.left,this.Mt=(t.clientY||t.pageY)-e.top,this.le()},this.pe=t=>{if(!this.St)return;t.preventDefault();const e=this.bt.getBoundingClientRect();this.Lt=t.touches[0].clientX-e.left,this.Mt=t.touches[0].clientY-e.top,this.le()},this.fe=t=>{!this.Cn&&this.St&&(this.Lt<(this.$.barScrollPos+8)*this.Te?(this.$.barScrollPos>0&&this.$.barScrollPos--,this.$.notifier.changed()):(this.$.barScrollPos<this.$.song.barCount-this.$.trackVisibleBars&&this.$.barScrollPos++,this.$.notifier.changed())),this.St=!1,this.Cn=!1,this.me()};const n=.5*this.Ct;this.vn.setAttribute("d",`M 9 ${n} L 20 ${n+6} L 20 ${n-6} z`),this.kn.setAttribute("d",`M ${this.ie-9} ${n} L ${this.ie-20} ${n+6} L ${this.ie-20} ${n-6} z`),this.container.addEventListener("mousedown",this.ae),document.addEventListener("mousemove",this.ce),document.addEventListener("mouseup",this.fe),this.container.addEventListener("mouseover",this.se),this.container.addEventListener("mouseout",this.he),this.container.addEventListener("touchstart",this.oe),this.container.addEventListener("touchmove",this.pe),this.container.addEventListener("touchend",this.fe),this.container.addEventListener("touchcancel",this.fe),this.bn.addEventListener("scroll",this.Sn,{capture:!1,passive:!0})}le(){if(this.Cn){for(;this.Lt-this.Fn<.5*-this.Te&&this.$.barScrollPos>0;)this.$.barScrollPos--,this.Fn-=this.Te,this.$.notifier.changed();for(;this.Lt-this.Fn>.5*this.Te&&this.$.barScrollPos<this.$.song.barCount-this.$.trackVisibleBars;)this.$.barScrollPos++,this.Fn+=this.Te,this.$.notifier.changed()}this.Ft&&this.me()}me(){let t=!1,e=!1,n=!1;this.Ft&&!this.St&&(this.Lt<this.$.barScrollPos*this.Te?t=!0:this.Lt>(this.$.barScrollPos+this.$.trackVisibleBars)*this.Te?e=!0:n=!0),this.vn.style.visibility=t?"visible":"hidden",this.kn.style.visibility=e?"visible":"hidden",this.wn.style.visibility=n?"visible":"hidden"}render(){this.Te=(this.ie-1)/Math.max(this.$.trackVisibleBars,this.$.song.barCount);const t=this.Ln!=this.$.song.barCount;if(t){for(this.Ln=this.$.song.barCount;this.gn.firstChild;)this.gn.removeChild(this.gn.firstChild);for(let t=0;t<=this.$.song.barCount;t++){const e=t%16==0?0:t%4==0?this.Ct/8:this.Ct/3;this.gn.appendChild(b.rect({fill:"#444444",x:t*this.Te-1,y:e,width:2,height:this.Ct-2*e}))}}(t||this.Mn!=this.$.barScrollPos)&&(this.Mn=this.$.barScrollPos,this.xn.setAttribute("x",""+this.Te*this.$.barScrollPos),this.xn.setAttribute("width",""+this.Te*this.$.trackVisibleBars),this.wn.setAttribute("x",""+this.Te*this.$.barScrollPos),this.wn.setAttribute("width",""+this.Te*this.$.trackVisibleBars)),this.me(),this.bn.scrollLeft=32*this.$.barScrollPos}}const{div:re}=u;class oe{constructor(t,e){this.$=t,this.Bn=e,this.ie=20,this.Ct=481,this.Pn=4,this.En=7,this.Rn=(this.Ct-this.Pn)/this.En,this.Nn=3*this.Rn+this.Pn,this.xn=b.rect({fill:Yt.octaveScrollbar,x:2,y:0,width:this.ie-4,height:this.Nn}),this.wn=b.rect({fill:"none",stroke:"white","stroke-width":2,"pointer-events":"none",x:1,y:0,width:this.ie-2,height:this.Nn}),this.$e=b.path({fill:"white","pointer-events":"none"}),this.je=b.path({fill:"white","pointer-events":"none"}),this.bt=b.svg({style:"touch-action: pan-x; position: absolute;",width:this.ie,height:"100%",viewBox:"0 0 20 481",preserveAspectRatio:"none"}),this.container=re({id:"octaveScrollBarContainer",style:"width: 20px; height: 100%; overflow: hidden; position: relative; flex-shrink: 0;"},[this.bt]),this.Lt=0,this.Mt=0,this.St=!1,this.Ft=!1,this.Cn=!1,this.Tn=-1,this.an=null,this.se=t=>{this.Ft||(this.Ft=!0,this.me())},this.he=t=>{this.Ft&&(this.Ft=!1,this.me())},this.ae=t=>{t.preventDefault(),this.St=!0;const e=this.bt.getBoundingClientRect();this.Lt=(t.clientX||t.pageX)-e.left,this.Mt=((t.clientY||t.pageY)-e.top)*this.Ct/(e.bottom-e.top),isNaN(this.Mt)&&(this.Mt=0),this.$.song.getChannelIsDrum(this.$.channel)||(this.me(),this.Mt>=this.On-this.Nn&&this.Mt<=this.On&&(this.Cn=!0,this.an=null,this.Fn=this.Mt))},this.oe=t=>{t.preventDefault(),this.St=!0;const e=this.bt.getBoundingClientRect();this.Lt=t.touches[0].clientX-e.left,this.Mt=(t.touches[0].clientY-e.top)*this.Ct/(e.bottom-e.top),isNaN(this.Mt)&&(this.Mt=0),this.$.song.getChannelIsDrum(this.$.channel)||(this.me(),this.Mt>=this.On-this.Nn&&this.Mt<=this.On&&(this.Cn=!0,this.an=null,this.Fn=this.Mt))},this.ce=t=>{const e=this.bt.getBoundingClientRect();this.Lt=(t.clientX||t.pageX)-e.left,this.Mt=((t.clientY||t.pageY)-e.top)*this.Ct/(e.bottom-e.top),isNaN(this.Mt)&&(this.Mt=0),this.le()},this.pe=t=>{if(!this.St)return;t.preventDefault();const e=this.bt.getBoundingClientRect();this.Lt=t.touches[0].clientX-e.left,this.Mt=(t.touches[0].clientY-e.top)*this.Ct/(e.bottom-e.top),isNaN(this.Mt)&&(this.Mt=0),this.le()},this.fe=t=>{if(!this.$.song.getChannelIsDrum(this.$.channel)&&this.St)if(this.Cn)null!=this.an&&this.$.record(this.an);else{const t=this.$.lastChangeWas(this.an),e=t?this.an.oldValue:this.$.song.channels[this.$.channel].octave,n=this.$.song.channels[this.$.channel].octave;this.Mt<this.On-.5*this.Nn?n<4&&(this.an=new xt(this.$,e,n+1),this.$.record(this.an,t)):n>0&&(this.an=new xt(this.$,e,n-1),this.$.record(this.an,t))}this.St=!1,this.Cn=!1,this.me()},this.ue=()=>{this.On=this.Ct-this.Rn*this.$.song.channels[this.$.channel].octave,this.mn(),this.Bn.forceRender()},this.$.notifier.watch(this.ue),this.ue(),this.bt.appendChild(this.xn);for(let t=0;t<=this.En;t++)this.bt.appendChild(b.rect({fill:Yt.scrollbarOctave,x:0,y:t*this.Rn,width:this.ie,height:this.Pn}));this.bt.appendChild(this.wn),this.bt.appendChild(this.$e),this.bt.appendChild(this.je),this.bt.style.backgroundColor=Yt.editorBackground;const n=.5*this.ie;this.$e.setAttribute("d",`M ${n} 9 L ${n+6} 20 L ${n-6} 20 z`),this.je.setAttribute("d",`M ${n} ${this.Ct-9} L ${n+6} ${this.Ct-20} L ${n-6} ${this.Ct-20} z`),this.container.addEventListener("mousedown",this.ae),document.addEventListener("mousemove",this.ce),document.addEventListener("mouseup",this.fe),this.container.addEventListener("mouseover",this.se),this.container.addEventListener("mouseout",this.he),this.container.addEventListener("touchstart",this.oe),this.container.addEventListener("touchmove",this.pe),this.container.addEventListener("touchend",this.fe),this.container.addEventListener("touchcancel",this.fe)}le(){if(!this.$.song.getChannelIsDrum(this.$.channel)){if(this.Cn){const t=this.$.song.channels[this.$.channel].octave,e=this.$.lastChangeWas(this.an)?this.an.oldValue:t;let n=t;for(;this.Mt-this.Fn<.5*-this.Rn&&n<4;)n++,this.Fn-=this.Rn;for(;this.Mt-this.Fn>.5*this.Rn&&n>0;)n--,this.Fn+=this.Rn;this.an=new xt(this.$,e,n),this.$.setProspectiveChange(this.an)}this.Ft&&this.me()}}me(){let t=!1,e=!1,n=!1;this.Ft&&!this.St&&(this.Mt<this.On-this.Nn?t=!0:this.Mt>this.On?e=!0:n=!0),this.$e.style.visibility=t?"inherit":"hidden",this.je.style.visibility=e?"inherit":"hidden",this.wn.style.visibility=n?"inherit":"hidden"}mn(){this.bt.style.visibility=this.$.song.getChannelIsDrum(this.$.channel)?"hidden":"visible",this.Tn!=this.On&&(this.Tn=this.On,this.xn.setAttribute("y",""+(this.On-this.Nn)),this.wn.setAttribute("y",""+(this.On-this.Nn))),this.me()}}const{canvas:ce,div:le}=u;class pe{constructor(t){this.$=t,this.Dn=u.div({style:"width: 100%; height: 100%; display: flex; flex-direction: column-reverse; align-items: stretch;"}),this.In=u.div({style:"width: 100%; height: 100%; display: flex; flex-direction: column-reverse; align-items: stretch;"}),this.An=ce({width:"32",height:"40"}),this.container=le({style:"width: 32px; height: 100%; overflow:hidden; position: relative; flex-shrink: 0; touch-action: none;"},[this.Dn,this.In,this.An]),this.Ct=481,this.$n=[],this.jn=[],this.Lt=0,this.Mt=0,this.St=!1,this.Ft=!1,this.zn=-1,this.Kt=!1,this._n=-1,this.Wn=-1,this.Vn=[],this.se=t=>{this.Ft||(this.Ft=!0,this.me())},this.he=t=>{this.Ft&&(this.Ft=!1,this.me())},this.ce=t=>{const e=this.container.getBoundingClientRect();this.Lt=(t.clientX||t.pageX)-e.left,this.Mt=((t.clientY||t.pageY)-e.top)*this.Ct/(e.bottom-e.top),isNaN(this.Mt)&&(this.Mt=0),this.Un(),this.$.synth.pianoPitch[0]=this.Hn+12*this.$.song.channels[this.$.channel].octave,this.me()},this.Xe=t=>{this.St=!1,this.$.synth.pianoPressed=!1,this.me()},this.pe=t=>{t.preventDefault();const e=this.container.getBoundingClientRect();this.Lt=t.touches[0].clientX-e.left,this.Mt=(t.touches[0].clientY-e.top)*this.Ct/(e.bottom-e.top),isNaN(this.Mt)&&(this.Mt=0),this.Un(),this.$.synth.pianoPitch[0]=this.Hn+12*this.$.song.channels[this.$.channel].octave},this.yn=t=>{t.preventDefault(),this.$.synth.pianoPressed=!1},this.ue=()=>{const t=this.$.song.getChannelIsDrum(this.$.channel);if(this.xe=t?s.drumCount:this.$.getVisiblePitchCount(),this.ge=this.Ct/this.xe,this.Un(),this.$.prefs.showLetters&&(this.zn!=this.$.song.scale||this._n!=this.$.song.key||this.Kt!=t||this.Wn!=this.xe)){if(this.zn=this.$.song.scale,this._n=this.$.song.key,this.Kt=t,this.Dn.style.display=t?"none":"flex",this.In.style.display=t?"flex":"none",!t){if(this.Wn!=this.xe){this.Dn.innerHTML="";for(let t=0;t<this.xe;t++){const e=u.div({class:"piano-label",style:"font-weight: bold; -webkit-text-stroke-width: 0; font-size: 11px; font-family: sans-serif; position: absolute; padding-left: 15px;"}),n=u.div({class:"piano-button",style:"background: gray;"},e);this.Dn.appendChild(n),this.jn[t]=e,this.$n[t]=n}this.jn.length=this.xe,this.$n.length=this.xe,this.Wn=this.xe}for(let t=0;t<this.xe;t++){const e=(t+s.keys[this.$.song.key].basePitch)%s.pitchesPerOctave,n=s.keys[e].isWhiteKey;if(this.$n[t].style.background=n?Yt.whitePianoKey:Yt.blackPianoKey,s.scales[this.$.song.scale].flags[t%s.pitchesPerOctave]){this.$n[t].classList.remove("disabled"),this.jn[t].style.display="";const n=this.jn[t];n.style.transform=t%12==0?"translate(-5px, 0px)":"translate(0px, 0px)",n.style.color=s.keys[e].isWhiteKey?"black":"white",n.textContent=pe.getPitchName(e,t,this.$.getBaseVisibleOctave(this.$.channel))}else this.$n[t].classList.add("disabled"),this.jn[t].style.display="none"}}this.me()}};for(let t=0;t<s.drumCount;t++){const e=100*(1-t/s.drumCount*.35);this.In.appendChild(u.div({class:"drum-button",style:`background-size: ${e}% ${e}%;`}))}this.$.notifier.watch(this.ue),this.ue(),document.addEventListener("mousemove",this.ce),document.addEventListener("mouseup",this.Xe),this.container.addEventListener("mouseover",this.se),this.container.addEventListener("mouseout",this.he),this.container.addEventListener("touchmove",this.pe),this.container.addEventListener("touchend",this.yn),this.container.addEventListener("touchcancel",this.yn)}forceRender(){this.zn=-1,this.ue()}Un(){const t=s.scales[this.$.song.scale].flags,e=Math.max(0,Math.min(this.xe-1,this.xe-this.Mt/this.ge));if(t[Math.floor(e)%s.pitchesPerOctave]||this.$.song.getChannelIsDrum(this.$.channel))this.Hn=Math.floor(e);else{let n=Math.floor(e)+1,i=Math.floor(e)-1;for(;!t[n%s.pitchesPerOctave];)n++;for(;!t[i%s.pitchesPerOctave];)i--;let h=n,a=i+1;n%s.pitchesPerOctave!=0&&n%s.pitchesPerOctave!=7||(h-=.5),i%s.pitchesPerOctave!=0&&i%s.pitchesPerOctave!=7||(a+=.5),this.Hn=e-a>h-e?n:i}}me(){if(this.An.style.visibility=!this.Ft||this.St?"hidden":"visible",this.Ft&&!this.St){const t=this.container.getBoundingClientRect(),e=this.ge/(this.Ct/(t.bottom-t.top));this.An.style.left="0px",this.An.style.top=e*(this.xe-this.Hn-1)+"px",this.An.style.height=e+"px"}const t=this.$.getBaseVisibleOctave(this.$.channel)*s.pitchesPerOctave,e=(this.$.song.getChannelIsDrum(this.$.channel)?this.In:this.Dn).children;for(let n=0;n<e.length;n++){const i=e[n];-1==this.Vn.indexOf(n+t)?i.classList.remove("pressed"):i.classList.add("pressed")}}static getPitchName(t,e,n){let i;if(s.keys[t].isWhiteKey)i=s.keys[t].name;else{const n=s.blackKeyNameParents[e%s.pitchesPerOctave];i=s.keys[(t+s.pitchesPerOctave+n)%s.pitchesPerOctave].name,1==n?i+="â™­":-1==n&&(i+="â™¯")}return e%12==0&&(i+=Math.floor(e/12)+n),i}}const{button:fe,div:de}=u;class ye{constructor(t){this.$=t,this.Gn=fe({},[de("Close")]),this.container=de({class:"prompt",style:"width: 300px;"},[de({style:"font-size: 2em"},[de("Mixing Styles")]),de({style:"text-align: left; margin: 0.5em 0;"},[de("Mixing styles are a way how changing how loud or soft different sounds are and can change the way different sounds blend and mix together. Using different mixing styles can drastically change your song.")]),de({style:"text-align: left; margin: 0.5em 0;"},[de("Type A Mixing is akin to mixing in vanilla Beepbox, Sandbox, and most other beepbox mods. In this mixing type, the drums are about twice as loud as in Type B mixing and the sound is generally a bit sharper and blends together differently.")]),de({style:"text-align: left; margin: 0.5em 0;"},[de("Type B Mixing is regular Modbox mixing.")]),de({style:"text-align: left; margin: 0.5em 0;"},[de("Type C Mixing is like Type B, save for a few upgrades. There are more volume options in Type C mixing, certain waves (acoustic bass, lyre, ramp pulse, and piccolo) are a bit quieter, the flatline wave is a bit louder, and blending works slightly differently.")]),de({style:"text-align: left; margin: 0.5em 0;"},[de("Type D Mixing includes slightly quieter drums from Type B, but also includes sharper sounds for regular notes in pitch channels.")]),this.Gn]),this.Yn=()=>{this.$.undo()},this.cleanUp=()=>{this.Gn.removeEventListener("click",this.Yn)},this.Gn.addEventListener("click",this.Yn)}}const{button:me,div:ue}=u;class be{constructor(t){this.$=t,this.Gn=me({},[ue("Close")]),this.container=ue({class:"prompt",style:"width: 250px;"},[ue({style:"font-size: 2em"},[ue("Custom Harmony")]),ue({style:"text-align: left;"},[ue('BeepBox "chip" instruments play two waves at once, each with their own pitch.')]),ue({style:"text-align: left;"},[ue('By placing two notes one above another it will play two indivdual sounds. This replaces the "arpeggio/trill" effect, and gives you greater control over your harmony. ')]),ue({style:"text-align: left;"},[ue("In older versions of Modbox, union would not allow notes to harmonize properly and needed a special harmonic chorus in order to work. This has been patched in Modbox 3.1.0. ")]),this.Gn]),this.Yn=()=>{this.$.undo()},this.cleanUp=()=>{this.Gn.removeEventListener("click",this.Yn)},this.Gn.addEventListener("click",this.Yn)}}class ge{constructor(){this.sampleLeft=0,this.sampleRight=0,this.phases=[],this.phaseDeltas=[],this.volumeStarts=[],this.volumeDeltas=[],this.volumeLeft=[],this.volumeRight=[],this.phaseDeltaScale=0,this.filter=0,this.filterScale=0,this.vibratoScale=0,this.harmonyMult=0,this.harmonyVolumeMult=1,this.feedbackOutputs=[],this.feedbackMult=0,this.feedbackDelta=0,this.reset()}reset(){for(let t=0;t<s.operatorCount;t++)this.phases[t]=0,this.feedbackOutputs[t]=0;this.sampleLeft=0,this.sampleRight=0}}class xe{static warmUpSynthesizer(t){if(null!=t){for(let e=0;e<t.instrumentsPerChannel;e++)for(let n=t.pitchChannelCount;n<t.pitchChannelCount+t.drumChannelCount;n++)s.getDrumWave(t.channels[n].instruments[e].wave);for(let e=0;e<t.barCount;e++)xe.getGeneratedSynthesizer(t,e)}}static operatorAmplitudeCurve(t){return(Math.pow(16,t/15)-1)/15}get playing(){return this.isPlaying}get playhead(){return this.playheadInternal}set playhead(t){if(null!=this.song){this.playheadInternal=Math.max(0,Math.min(this.song.barCount,t));let e=this.playheadInternal;this.bar=Math.floor(e),e=this.song.beatsPerBar*(e-this.bar),this.beat=Math.floor(e),e=this.song.partsPerBeat*(e-this.beat),this.part=Math.floor(e),e=4*(e-this.part),this.arpeggio=Math.floor(e);const n=this.getSamplesPerArpeggio();e=n*(e-this.arpeggio),this.arpSampleCountdown=Math.floor(n-e),this.bar<this.song.loopStart&&(this.enableIntro=!0),this.bar>this.song.loopStart+this.song.loopLength&&(this.enableOutro=!0)}}get totalSamples(){if(null==this.song)return 0;const t=4*this.getSamplesPerArpeggio()*this.song.partsPerBeat*this.song.beatsPerBar;let e=this.loopCount;e<0&&(e=1);let n=this.song.loopLength*e;return this.enableIntro&&(n+=this.song.loopStart),this.enableOutro&&(n+=this.song.barCount-(this.song.loopStart+this.song.loopLength)),n*t}get totalSeconds(){return Math.round(this.totalSamples/this.samplesPerSecond)}get totalBars(){return null==this.song?0:this.song.barCount}constructor(t=null){this.samplesPerSecond=44100,this.effectDuration=.14,this.effectAngle=2*Math.PI/(this.effectDuration*this.samplesPerSecond),this.effectYMult=2*Math.cos(this.effectAngle),this.limitDecay=1/(2*this.samplesPerSecond),this.song=null,this.pianoPressed=!1,this.pianoPitch=[0],this.pianoChannel=0,this.enableIntro=!0,this.enableOutro=!1,this.loopCount=-1,this.volume=1,this.liveInputDuration=0,this.liveInputStarted=!1,this.liveInputPitches=[],this.liveInputChannel=0,this.playheadInternal=0,this.bar=0,this.beat=0,this.part=0,this.arpeggio=0,this.arpSampleCountdown=0,this.isPlaying=!1,this.liveInputEndTime=0,this.browserAutomaticallyClearsAudioBuffer=!0,this.channels=[],this.stillGoing=!1,this.effectPhase=0,this.limit=0,this.delayLineLeft=new Float32Array(16384),this.delayLineRight=new Float32Array(16384),this.delayPosLeft=0,this.delayPosRight=0,this.delayFeedback0Left=0,this.delayFeedback0Right=0,this.delayFeedback1Left=0,this.delayFeedback1Right=0,this.delayFeedback2Left=0,this.delayFeedback2Right=0,this.delayFeedback3Left=0,this.delayFeedback3Right=0,this.audioCtx=null,this.scriptNode=null,this.audioProcessCallback=t=>{const e=t.outputBuffer,n=e.getChannelData(0),i=e.getChannelData(1);if(!this.browserAutomaticallyClearsAudioBuffer||0==n[0]&&0==i[0]&&0==n[e.length-1]&&0==i[e.length-1]||(this.browserAutomaticallyClearsAudioBuffer=!1),!this.browserAutomaticallyClearsAudioBuffer){const t=e.length;for(let e=0;e<t;e++)n[e]=0,i[e]=0}!this.isPlaying&&performance.now()>=this.liveInputEndTime?this.deactivateAudio():this.synthesize(n,i,e.length,this.isPlaying)},null!=t&&this.setSong(t)}setSong(t){"string"==typeof t?this.song=new T(t):t instanceof T&&(this.song=t)}spsCalc(){return xe.warmUpSynthesizer(this.song),0==this.song.sampleRate?44100:1==this.song.sampleRate?48e3:2==this.song.sampleRate?this.audioCtx.sampleRate:3==this.song.sampleRate?4*this.audioCtx.sampleRate:4==this.song.sampleRate?2*this.audioCtx.sampleRate:5==this.song.sampleRate?this.audioCtx.sampleRate/2:6==this.song.sampleRate?this.audioCtx.sampleRate/4:7==this.song.sampleRate?this.audioCtx.sampleRate/8:8==this.song.sampleRate?this.audioCtx.sampleRate/16:this.audioCtx.sampleRate}activateAudio(){null!=this.audioCtx&&null!=this.scriptNode||(null!=this.scriptNode&&this.deactivateAudio(),this.audioCtx=this.audioCtx||new(window.AudioContext||window.webkitAudioContext),this.samplesPerSecond=this.spsCalc(),this.scriptNode=this.audioCtx.createScriptProcessor?this.audioCtx.createScriptProcessor(2048,0,2):this.audioCtx.createJavaScriptNode(2048,0,2),this.scriptNode.onaudioprocess=this.audioProcessCallback,this.scriptNode.channelCountMode="explicit",this.scriptNode.channelInterpretation="speakers",this.effectAngle=2*Math.PI/(this.effectDuration*this.samplesPerSecond),this.effectYMult=2*Math.cos(this.effectAngle),this.limitDecay=1/(2*this.samplesPerSecond),this.scriptNode.connect(this.audioCtx.destination)),this.audioCtx.resume()}deactivateAudio(){null!=this.audioCtx&&null!=this.scriptNode&&(this.scriptNode.disconnect(this.audioCtx.destination),this.scriptNode=null,this.audioCtx.close&&this.audioCtx.close(),this.audioCtx=null)}maintainLiveInput(){this.activateAudio(),this.liveInputEndTime=performance.now()+1e4}play(){this.isPlaying||(this.isPlaying=!0,xe.warmUpSynthesizer(this.song),this.activateAudio())}pause(){this.isPlaying&&(this.isPlaying=!1,this.deactivateAudio(),this.scriptNode=null)}snapToStart(){this.bar=0,this.enableIntro=!0,this.snapToBar()}snapToBar(t){void 0!==t&&(this.bar=t),this.playheadInternal=this.bar,this.beat=0,this.part=0,this.arpeggio=0,this.arpSampleCountdown=0,this.effectPhase=0;for(const t of this.channels)t.reset();this.delayPosLeft=0,this.delayPosRight=0,this.delayFeedback0Left=0,this.delayFeedback0Right=0,this.delayFeedback1Left=0,this.delayFeedback1Right=0,this.delayFeedback2Left=0,this.delayFeedback2Right=0,this.delayFeedback3Left=0,this.delayFeedback3Right=0;for(let t=0;t<this.delayLineLeft.length;t++)this.delayLineLeft[t]=0;for(let t=0;t<this.delayLineRight.length;t++)this.delayLineRight[t]=0}nextBar(){if(!this.song)return;const t=this.bar;this.bar++,this.enableOutro?this.bar>=this.song.barCount&&(this.bar=this.enableIntro?0:this.song.loopStart):(this.bar>=this.song.loopStart+this.song.loopLength||this.bar>=this.song.barCount)&&(this.bar=this.song.loopStart),this.playheadInternal+=this.bar-t}prevBar(){if(!this.song)return;const t=this.bar;this.bar--,this.bar<0&&(this.bar=this.song.loopStart+this.song.loopLength-1),this.bar>=this.song.barCount&&(this.bar=this.song.barCount-1),this.bar<this.song.loopStart&&(this.enableIntro=!0),!this.enableOutro&&this.bar>=this.song.loopStart+this.song.loopLength&&(this.bar=this.song.loopStart+this.song.loopLength-1),this.playheadInternal+=this.bar-t}synthesize(t,e,n,i=!0){if(null==this.song){for(let i=0;i<n;i++)t[i]=0,e[i]=0;return void this.deactivateAudio()}const s=this.song.getChannelCount();for(let t=this.channels.length;t<s;t++)this.channels[t]=new ge;this.channels.length=s;const h=this.getSamplesPerArpeggio();let a=0,r=!1;for((0==this.arpSampleCountdown||this.arpSampleCountdown>h)&&(this.arpSampleCountdown=h),i&&(this.part>=this.song.partsPerBeat&&(this.beat++,this.part=0,this.arpeggio=0,this.arpSampleCountdown=h),this.beat>=this.song.beatsPerBar&&(this.bar++,this.beat=0,this.part=0,this.arpeggio=0,this.arpSampleCountdown=h,-1==this.loopCount&&(this.bar<this.song.loopStart&&!this.enableIntro&&(this.bar=this.song.loopStart),this.bar>=this.song.loopStart+this.song.loopLength&&!this.enableOutro&&(this.bar=this.song.loopStart))),this.bar>=this.song.barCount&&(this.enableOutro?(this.bar=0,this.enableIntro=!0,r=!0,this.pause()):this.bar=this.song.loopStart),this.bar>=this.song.loopStart&&(this.enableIntro=!1));;){if(r){for(;a<n;)t[a]=0,e[a]=0,a++;break}a=xe.getGeneratedSynthesizer(this.song,this.bar)(this,this.song,t,e,n,a,h);if(-1==a)break;this.beat=0,this.effectPhase=0,this.bar++,this.bar<this.song.loopStart?this.enableIntro||(this.bar=this.song.loopStart):this.enableIntro=!1,this.bar>=this.song.loopStart+this.song.loopLength&&(this.loopCount>0&&this.loopCount--,(this.loopCount>0||!this.enableOutro)&&(this.bar=this.song.loopStart)),this.bar>=this.song.barCount&&(this.bar=0,this.enableIntro=!0,r=!0,this.pause())}this.playheadInternal=(((this.arpeggio+1-this.arpSampleCountdown/h)/4+this.part)/this.song.partsPerBeat+this.beat)/this.song.beatsPerBar+this.bar}static computeOperatorEnvelope(t,e,n,i){switch(s.operatorEnvelopeType[t]){case 0:return i;case 1:return 1;case 4:let h=1/(1+e*s.operatorEnvelopeSpeed[t]);return s.operatorEnvelopeInverted[t]?1-h:h;case 5:return s.operatorSpecialCustomVolume[t]?.5-.5*Math.cos(2*n*Math.PI*(4*i)):.5-.5*Math.cos(2*n*Math.PI*s.operatorEnvelopeSpeed[t]);case 2:return Math.max(1,2-10*e);case 3:if(s.operatorSpecialCustomVolume[t]){const t=.25/Math.sqrt(i);return e<t?e/t:1/(1+16*i*(e-t))}{const n=s.operatorEnvelopeSpeed[t],i=.25/Math.sqrt(n);return e<i?e/i:1/(1+(e-i)*n)}case 6:return Math.max(-1-e,-2+e);default:throw new Error("Unrecognized operator envelope type.")}}static computeChannelInstrument(t,e,n,i,h,a,r){const o=e.getChannelIsDrum(n),c=t.channels[n],l=e.getPattern(n,t.bar),p=e.channels[n].instruments[null==l?0:l.instrument],f=t.pianoPressed&&n==t.pianoChannel,d=o?s.drumBasePitches[p.wave]:s.keys[e.key].basePitch,y=o?s.drumInterval:1,m=o?s.drumWaveIsSoft[p.wave]?24:60:48,u=4*a/t.samplesPerSecond,b=1/e.partsPerBeat;c.phaseDeltaScale=0,c.filter=1,c.filterScale=1,c.vibratoScale=0,c.harmonyMult=1,c.harmonyVolumeMult=1;let g=0,x=t.arpeggio,w=t.arpSampleCountdown,v=null,k=!0,C=0,L=0,M=1,S=1,F=0,B=0,P=0,E=0,R=0,N=0;for(let t=0;t<s.operatorCount;t++)c.phaseDeltas[t]=0,c.volumeStarts[t]=0,c.volumeDeltas[t]=0,c.volumeLeft[0]=0,c.volumeRight[0]=0;if(f)v=t.pianoPitch,M=S=1,F=B=1,k=!1;else if(null!=l){let n=null,s=null,h=null;for(let t=0;t<l.notes.length;t++)if(l.notes[t].end<=i)s=l.notes[t];else if(l.notes[t].start<=i&&l.notes[t].end>i)n=l.notes[t];else if(l.notes[t].start>i){h=l.notes[t];break}if(null!=n&&null!=s&&s.end!=n.start&&(s=null),null!=n&&null!=h&&h.start!=n.end&&(h=null),null!=n){let o;for(v=n.pitches,g=i-n.start,o=1;o<n.pins.length-1&&!(n.pins[o].time+n.start>i);o++);const c=n.pins[o-1],l=n.pins[o],f=4*n.start,d=4*n.end,y=4*(n.start+c.time),m=4*(n.start+l.time),u=4*i+x,b=4*i+x+1,T=(u-y)/(m-y),O=(b-y)/(m-y);let D=c.volume+(l.volume-c.volume)*T,I=c.volume+(l.volume-c.volume)*O,A=1,$=1,j=c.interval+(l.interval-c.interval)*T,z=c.interval+(l.interval-c.interval)*O,_=c.time+(l.time-c.time)*T,W=c.time+(l.time-c.time)*O,V=_,U=W;const H=1-(w+r)/a,G=1-w/a;k=u+H-f==0;const Y=p.transition;u==f&&(0==Y?k=!1:2==Y?A=0:3==Y?null==s||0==s.pins[s.pins.length-1].volume||0==n.pins[0].volume?A=0:(j=.5*(s.pitches[0]+s.pins[s.pins.length-1].interval-n.pitches[0]),V=.5*s.pins[s.pins.length-1].time,k=!1):4==Y?$=0:5==Y?j=100:6==Y?j=-1:7==Y&&(A=6)),b==d&&(0==Y?null==h&&n.start+l.time!=e.partsPerBeat*e.beatsPerBar&&($=0):1==Y||2==Y?$=0:3==Y&&(null==h||0==n.pins[n.pins.length-1].volume||0==h.pins[0].volume?$=0:(z=.5*(h.pitches[0]-n.pitches[0]+n.pins[n.pins.length-1].interval),U*=.5))),C=j+(z-j)*H,L=j+(z-j)*G,F=t.volumeConversion(D+(I-D)*H),B=t.volumeConversion(D+(I-D)*G),M=A+($-A)*H,S=A+($-A)*G,P=n.start+_+(W-_)*H,E=n.start+_+(W-_)*G,R=V+(U-V)*H,N=V+(U-V)*G}}if(null!=v){if(o||1!=p.type){let n=v[0];if(o)0==s.harmNames[p.harm]?1==v.length?n=v[0]+s.octoffValues[p.octoff]:2==v.length?n=v[x>>1]+s.octoffValues[p.octoff]:3==v.length?n=v[3==x?1:x]+s.octoffValues[p.octoff]:4==v.length&&(n=v[x]+s.octoffValues[p.octoff]):1==s.harmNames[p.harm]?1==v.length?n=v[0]+s.octoffValues[p.octoff]:2==v.length?n=(v[1]+v[0])/2+s.octoffValues[p.octoff]:3==v.length?n=(v[1+(x>>1)]+v[0])/2+s.octoffValues[p.octoff]:4==v.length&&(n=(v[(3==x?1:x)+1]+v[0])/2+s.octoffValues[p.octoff]):2==s.harmNames[p.harm]?1==v.length?n=v[0]+s.octoffValues[p.octoff]:2==v.length?n=(v[1]+v[0])/2+s.octoffValues[p.octoff]:3==v.length?n=(v[2]+v[0])/2+s.octoffValues[p.octoff]:4==v.length&&(n=(v[(3==x?2:x)+1]+v[0])/2+s.octoffValues[p.octoff]):3==s.harmNames[p.harm]?1==v.length?n=v[0]+s.octoffValues[p.octoff]:2==v.length?n=(v[1]+v[0])/2+s.octoffValues[p.octoff]:3==v.length?n=(v[2]+v[0])/2+s.octoffValues[p.octoff]:4==v.length&&(n=(v[3]+v[0])/2+s.octoffValues[p.octoff]):4==s.harmNames[p.harm]&&(1==v.length?n=v[0]+s.octoffValues[p.octoff]:2==v.length?n=(v[1]+v[0])/2+s.octoffValues[p.octoff]:3==v.length?n=(v[1+(x>>1)]+v[0])/2+s.octoffValues[p.octoff]:4==v.length&&(n=v[2+(x>>1)]+v[0]+s.octoffValues[p.octoff]));else if(1==s.harmNames[p.harm]){let t=0;2==v.length?t=v[1]-v[0]:3==v.length?t=v[1+(x>>1)]-v[0]:4==v.length&&(t=v[(3==x?1:x)+1]-v[0]),c.harmonyMult=Math.pow(2,t/12),c.harmonyVolumeMult=Math.pow(2,-t/m)}else if(2==s.harmNames[p.harm]){let t=0;2==v.length?t=v[1]-v[0]:3==v.length?t=v[2]-v[0]:4==v.length&&(t=v[(3==x?2:x)+1]-v[0]),c.harmonyMult=Math.pow(2,t/12),c.harmonyVolumeMult=Math.pow(2,-t/m)}else if(3==s.harmNames[p.harm]){let t=0;2==v.length?t=v[1]-v[0]:3==v.length?t=v[2]-v[0]:4==v.length&&(t=v[3]-v[0]),c.harmonyMult=Math.pow(2,t/12),c.harmonyVolumeMult=Math.pow(2,-t/m)}else if(4==s.harmNames[p.harm]){let t=0;2==v.length?t=v[1]-v[0]:3==v.length?t=v[1+(x>>1)]-v[0]:4==v.length&&(t=v[2+(x>>1)]-v[0]),c.harmonyMult=Math.pow(2,t/12),c.harmonyVolumeMult=Math.pow(2,-t/m)}else if(5==s.harmNames[p.harm]){let t=0;2==v.length?t=v[1]-v[0]:3==v.length?t=v[2]-v[0]:4==v.length&&(t=v[3==x?2:x]-v[0]),c.harmonyMult=Math.pow(2,t/12),c.harmonyVolumeMult=Math.pow(2,-t/m)}else 0==s.harmNames[p.harm]&&(2==v.length?n=v[x>>1]:3==v.length?n=v[3==x?1:x]:4==v.length&&(n=v[x]));const i=(n+C)*y,a=(n+L)*y,l=t.frequencyFromPitch(d+i),f=Math.pow(2,-i/m),b=Math.pow(2,-a/m);let g;if(o&&s.drumWaveIsSoft[p.wave]&&(c.filter=Math.min(1,l*h*s.drumPitchFilterMult[p.wave])),o)g=0==e.mix?.19*s.drumVolumes[p.wave]:3==e.mix?.12*s.drumVolumes[p.wave]:.09*s.drumVolumes[p.wave];else{const t=s.filterDecays[p.filter];c.filter=Math.pow(2,-t*u*R);const e=Math.pow(2,-t*u*N);c.filterScale=Math.pow(e/c.filter,1/r),g=.135*s.waveVolumes[p.wave]*s.filterVolumes[p.filter]*s.chorusVolumes[p.chorus]}k&&!o&&c.reset(),c.phaseDeltas[0]=l*h;let w=0;w=2==e.mix?9==p.volume?0:Math.pow(3,-s.volumeValues[p.volume])*s.imuteValues[p.imute]:1==e.mix?p.volume>=5?0:Math.pow(3,-s.volumeMValues[p.volume])*s.imuteValues[p.imute]:p.volume>=5?0:Math.pow(2,-s.volumeMValues[p.volume])*s.imuteValues[p.imute],c.volumeStarts[0]=M*F*f*g*w;const P=S*B*b*g*w;c.volumeDeltas[0]=(P-c.volumeStarts[0])/r,c.volumeLeft[0]=Math.min(1,1+s.ipanValues[p.ipan]),c.volumeRight[0]=Math.min(1,1-s.ipanValues[p.ipan])}else{let n=1,i=0;const a=s.operatorCarrierCounts[p.algorithm];for(let o=0;o<s.operatorCount;o++){const l=o<s.operatorCarrierCounts[p.algorithm],f=s.operatorAssociatedCarrier[p.algorithm][o]-1,g=v[o<v.length?o:f<v.length?f:0]+s.octoffValues[p.octoff]+e.detune/24,x=s.operatorFrequencies[p.operators[o].frequency],w=(g+C)*y+s.operatorCarrierChorus[s.fmChorusNames[p.fmChorus]][f],T=x*t.frequencyFromPitch(d+w)+s.operatorHzOffsets[p.operators[o].frequency];c.phaseDeltas[o]=T*h*s.sineWaveLength,k&&c.reset();const O=xe.operatorAmplitudeCurve(p.operators[o].amplitude);let D=0;-1!=s.volumeValues[p.volume]&&2==e.mix||-1!=s.volumeMValues[p.volume]&&2!=e.mix?D=2==e.mix?l?O*s.operatorAmplitudeSigns[p.operators[o].frequency]*(1-s.volumeValues[p.volume]/2.3):O*s.operatorAmplitudeSigns[p.operators[o].frequency]:O*s.operatorAmplitudeSigns[p.operators[o].frequency]*(1-s.volumeMValues[p.volume]/2.3):(-1!=s.volumeValues[p.volume]||-1!=s.volumeMValues[p.volume])&&(D=0);let I=D*s.imuteValues[p.imute],A=D*s.imuteValues[p.imute];if(c.volumeLeft[0]=Math.min(1,1+s.ipanValues[p.ipan]),c.volumeRight[0]=Math.min(1,1-s.ipanValues[p.ipan]),o<a){const t=.03,n=(g+L)*y;let s=0,h=0;3==e.mix?(s=Math.pow(5,-w/m),h=Math.pow(5,-n/m)):(s=Math.pow(2,-w/m),h=Math.pow(2,-n/m)),I*=s*t*M,A*=h*t*S,i+=O}else I*=1.5*s.sineWaveLength,A*=1.5*s.sineWaveLength,n*=1-Math.min(1,p.operators[o].amplitude/15);const $=p.operators[o].envelope;I*=xe.computeOperatorEnvelope($,u*R,b*P,F),A*=xe.computeOperatorEnvelope($,u*N,b*E,B),c.volumeStarts[o]=I,c.volumeDeltas[o]=(A-I)/r}const o=.3*s.sineWaveLength*p.feedbackAmplitude/15;let l=o*xe.computeOperatorEnvelope(p.feedbackEnvelope,u*R,b*P,F),f=o*xe.computeOperatorEnvelope(p.feedbackEnvelope,u*N,b*E,B);c.feedbackMult=l,c.feedbackDelta=(f-c.feedbackMult)/r,n*=1-p.feedbackAmplitude/15,n*=1-Math.min(1,Math.max(0,i-1)/2);for(let t=0;t<a;t++)c.volumeStarts[t]*=1+3*n,c.volumeDeltas[t]*=1+3*n}c.phaseDeltaScale=Math.pow(2,(L-C)*y/12/r),c.vibratoScale=g<s.effectVibratoDelays[p.effect]?0:Math.pow(2,s.effectVibratos[p.effect]/12)-1}else{c.reset();for(let t=0;t<s.operatorCount;t++)c.phaseDeltas[0]=0,c.volumeStarts[0]=0,c.volumeDeltas[0]=0,c.volumeLeft[0]=0,c.volumeRight[0]=0}}static getGeneratedSynthesizer(t,e){const n=t.getChannelFingerprint(e);if(null==xe.generatedSynthesizers[n]){const i=[],h=[];for(let n=0;n<t.pitchChannelCount;n++)h[n]=t.channels[n].instruments[t.getPatternInstrument(n,e)];for(const e of xe.synthSourceTemplate)if(-1!=e.indexOf("#"))if(-1!=e.indexOf("// PITCH"))for(let n=0;n<t.pitchChannelCount;n++)i.push(e.replace(/#/g,n+""));else if(-1!=e.indexOf("// JCHIP"))for(let n=0;n<t.pitchChannelCount;n++)0==h[n].type&&i.push(e.replace(/#/g,n+""));else if(-1!=e.indexOf("// CHIP"))for(let n=0;n<t.pitchChannelCount;n++)(0==h[n].type||3==h[n].type)&&i.push(e.replace(/#/g,n+""));else if(-1!=e.indexOf("// FM")){for(let n=0;n<t.pitchChannelCount;n++)if(1==h[n].type)if(-1!=e.indexOf("$"))for(let t=0;t<s.operatorCount;t++)i.push(e.replace(/#/g,n+"").replace(/\$/g,t+""));else i.push(e.replace(/#/g,n+""))}else if(-1!=e.indexOf("// PWM"))for(let n=0;n<t.pitchChannelCount;n++)3==h[n].type&&i.push(e.replace(/#/g,n+""));else if(-1!=e.indexOf("// CARRIER OUTPUTS")){for(let n=0;n<t.pitchChannelCount;n++)if(1==h[n].type){const t=[];for(let e=0;e<s.operatorCarrierCounts[h[n].algorithm];e++)t.push("channel"+n+"Operator"+e+"Scaled");i.push(e.replace(/#/g,n+"").replace("/*channel"+n+"Operator$Scaled*/",t.join(" + ")))}}else if(-1!=e.indexOf("// NOISE"))for(let n=t.pitchChannelCount;n<t.pitchChannelCount+t.drumChannelCount;n++)i.push(e.replace(/#/g,n+""));else{if(-1==e.indexOf("// ALL"))throw new Error("Missing channel type annotation for line: "+e);for(let n=0;n<t.pitchChannelCount+t.drumChannelCount;n++)i.push(e.replace(/#/g,n+""))}else if(-1!=e.indexOf("// INSERT OPERATOR COMPUTATION HERE")){for(let e=s.operatorCount-1;e>=0;e--)for(const n of xe.operatorSourceTemplate)for(let a=0;a<t.pitchChannelCount;a++)if(1==h[a].type)if(-1!=n.indexOf("/* + channel#Operator@Scaled*/")){let t="";for(const n of s.operatorModulatedBy[h[a].algorithm][e])t+=" + channel"+a+"Operator"+(n-1)+"Scaled";const r=s.operatorFeedbackIndices[h[a].feedbackType][e];if(r.length>0){t+=" + channel"+a+"FeedbackMult * (";const e=[];for(const t of r)e.push("channel"+a+"Operator"+(t-1)+"Output");t+=e.join(" + ")+")"}i.push(n.replace(/#/g,a+"").replace(/\$/g,e+"").replace("/* + channel"+a+"Operator@Scaled*/",t))}else i.push(n.replace(/#/g,a+"").replace(/\$/g,e+""))}else i.push(e);xe.generatedSynthesizers[n]=new Function("synth","song","dataLeft","dataRight","bufferLength","bufferIndex","samplesPerTick",i.join("\n"))}return xe.generatedSynthesizers[n]}frequencyFromPitch(t){return 440*Math.pow(2,(t-69)/12)}volumeConversion(t){return Math.pow(t/3,1.5)}getSamplesPerArpeggio(){if(null==this.song)return 0;const t=4*(this.song.getBeatsPerMinute()/60*this.song.partsPerBeat);return Math.floor(this.samplesPerSecond/t)}}xe.negativePhaseGuard=1e3,xe.generatedSynthesizers={},xe.synthSourceTemplate=("\n\t\t\tvar sampleTime = 1.0 / synth.samplesPerSecond;\n\t\t\tvar effectYMult = +synth.effectYMult;\n\t\t\tvar limitDecay = +synth.limitDecay;\n\t\t\tvar volume = +synth.volume;\n\t\t\tvar delayLineLeft = synth.delayLineLeft;\n\t\t\tvar delayLineRight = synth.delayLineRight;\n\t\t\tvar reverb = Math.pow(song.reverb / beepbox.Config.reverbRange, 0.667) * 0.425;\n\t\t\tvar blend = Math.pow(song.blend / beepbox.Config.blendRange, 0.667) * 0.425;\n\t\t\tvar mix = song.mix;\n\t\t\tvar muff = Math.pow(song.muff / beepbox.Config.muffRange, 0.667) * 0.425;\n\t\t\tvar detune = song.detune;\n\t\t\tvar riff = Math.pow(song.riff / beepbox.Config.riffRange, 0.667) * 0.425; \n\t\t\tvar sineWave = beepbox.Config.sineWave;\n\t\t\t\n\t\t\t// Initialize instruments based on current pattern.\n\t\t\tvar instrumentChannel# = song.getPatternInstrument(#, synth.bar); // ALL\n\t\t\tvar instrument# = song.channels[#].instruments[instrumentChannel#]; // ALL\n\t\t\tvar channel#Wave = (mix <= 1) ? beepbox.Config.waves[instrument#.wave] : beepbox.Config.wavesMixC[instrument#.wave]; // CHIP\n\t\t\tvar channel#Wave = beepbox.Config.getDrumWave(instrument#.wave); // NOISE\n\t\t\tvar channel#WaveLength = channel#Wave.length; // CHIP\n\t\t\tvar channel#Wave = beepbox.Config.pwmwaves[instrument#.wave]; // PWM\n\t\t\tvar channel#WaveLength = channel#Wave.length; // PWM\n\t\t\tvar channel#FilterBase = (song.mix == 2) ? Math.pow(2 - (blend * 2) + (muff * 2), -beepbox.Config.filterBases[instrument#.filter]) : Math.pow(2, -beepbox.Config.filterBases[instrument#.filter] + (blend * 4) - (muff * 4)); // CHIP\n\t\t\tvar channel#TremoloScale = beepbox.Config.effectTremolos[instrument#.effect]; // PITCH\n\t\t\t\n\t\t\twhile (bufferIndex < bufferLength) {\n\t\t\t\t\n\t\t\t\tvar samples;\n\t\t\t\tvar samplesLeftInBuffer = bufferLength - bufferIndex;\n\t\t\t\tif (synth.arpSampleCountdown <= samplesLeftInBuffer) {\n\t\t\t\t\tsamples = synth.arpSampleCountdown;\n\t\t\t\t} else {\n\t\t\t\t\tsamples = samplesLeftInBuffer;\n\t\t\t\t}\n\t\t\t\tsynth.arpSampleCountdown -= samples;\n\t\t\t\t\n\t\t\t\tvar time = synth.part + synth.beat * song.partsPerBeat;\n\t\t\t\t\n\t\t\t\tbeepbox.Synth.computeChannelInstrument(synth, song, #, time, sampleTime, samplesPerTick, samples); // ALL\n\t\t\t\tvar synthChannel# = synth.channels[#]; // ALL\n\t\t\t\t\n\t\t\t\tvar channel#ChorusA = Math.pow(2.0, (beepbox.Config.chorusOffsets[instrument#.chorus] + beepbox.Config.chorusIntervals[instrument#.chorus] + beepbox.Config.octoffValues[instrument#.octoff] + (detune / 24) * ((riff * beepbox.Config.chorusRiffApp[instrument#.chorus]) + 1)) / 12.0); // CHIP\n\t\t\t\tvar channel#ChorusB = Math.pow(2.0, (beepbox.Config.chorusOffsets[instrument#.chorus] - beepbox.Config.chorusIntervals[instrument#.chorus] + beepbox.Config.octoffValues[instrument#.octoff] + (detune / 24) * ((riff * beepbox.Config.chorusRiffApp[instrument#.chorus]) + 1)) / 12.0); // CHIP\n\t\t\t\tvar channel#ChorusSign = synthChannel#.harmonyVolumeMult * (beepbox.Config.chorusSigns[instrument#.chorus]); // CHIP\n\t\t\t\tchannel#ChorusB *= synthChannel#.harmonyMult; // CHIP\n\t\t\t\tvar channel#ChorusDeltaRatio = channel#ChorusB / channel#ChorusA * ((riff * beepbox.Config.chorusRiffApp[instrument#.chorus]) + 1); // CHIP\n\t\t\t\t\n\t\t\t\tvar channel#PhaseDelta = synthChannel#.phaseDeltas[0] * channel#ChorusA * ((riff * beepbox.Config.chorusRiffApp[instrument#.chorus]) + 1); // CHIP\n\t\t\t\tvar channel#PhaseDelta = synthChannel#.phaseDeltas[0] / 32768.0; // NOISE\n\t\t\t\tvar channel#PhaseDeltaScale = synthChannel#.phaseDeltaScale; // ALL\n\t\t\t\tvar channel#Volume = synthChannel#.volumeStarts[0]; // CHIP\n\t\t\t\tvar channel#Volume = synthChannel#.volumeStarts[0]; // NOISE\n\t\t\t\tvar channel#VolumeLeft = synthChannel#.volumeLeft[0]; // ALL\n\t\t\t\tvar channel#VolumeRight = synthChannel#.volumeRight[0]; // ALL\n\t\t\t\tvar channel#VolumeDelta = synthChannel#.volumeDeltas[0]; // CHIP\n\t\t\t\tvar channel#VolumeDelta = synthChannel#.volumeDeltas[0]; // NOISE\n\t\t\t\tvar channel#Filter = synthChannel#.filter * channel#FilterBase; // CHIP\n\t\t\t\tvar channel#Filter = synthChannel#.filter; // NOISE\n\t\t\t\tvar channel#FilterScale = synthChannel#.filterScale; // CHIP\n\t\t\t\tvar channel#VibratoScale = synthChannel#.vibratoScale; // PITCH\n\t\t\t\t\n\t\t\t\tvar effectY     = Math.sin(synth.effectPhase);\n\t\t\t\tvar prevEffectY = Math.sin(synth.effectPhase - synth.effectAngle);\n\t\t\t\t\n\t\t\t\tvar channel#PhaseA = synth.channels[#].phases[0] % 1; // CHIP\n\t\t\t\tvar channel#PhaseB = synth.channels[#].phases[1] % 1; // CHIP\n\t\t\t\tvar channel#Phase  = synth.channels[#].phases[0] % 1; // NOISE\n\t\t\t\t\n\t\t\t\tvar channel#Operator$Phase       = ((synth.channels[#].phases[$] % 1) + "+xe.negativePhaseGuard+") * "+s.sineWaveLength+"; // FM\n\t\t\t\tvar channel#Operator$PhaseDelta  = synthChannel#.phaseDeltas[$]; // FM\n\t\t\t\tvar channel#Operator$OutputMult  = synthChannel#.volumeStarts[$]; // FM\n\t\t\t\tvar channel#Operator$OutputDelta = synthChannel#.volumeDeltas[$]; // FM\n\t\t\t\tvar channel#Operator$Output      = synthChannel#.feedbackOutputs[$]; // FM\n\t\t\t\tvar channel#FeedbackMult         = synthChannel#.feedbackMult; // FM\n\t\t\t\tvar channel#FeedbackDelta        = synthChannel#.feedbackDelta; // FM\n\t\t\t\t\n\t\t\t\tvar channel#SampleLeft = +synth.channels[#].sampleLeft; // ALL\n\t\t\t\tvar channel#SampleRight = +synth.channels[#].sampleRight; // ALL\n\t\t\t\t\n\t\t\t\tvar delayPosLeft = 0|synth.delayPosLeft;\n\t\t\t\tvar delayFeedback0Left = +synth.delayFeedback0Left;\n\t\t\t\tvar delayFeedback1Left = +synth.delayFeedback1Left;\n\t\t\t\tvar delayFeedback2Left = +synth.delayFeedback2Left;\n\t\t\t\tvar delayFeedback3Left = +synth.delayFeedback3Left;\n\t\t\t\tvar delayPosRight = 0|synth.delayPosRight;\n\t\t\t\tvar delayFeedback0Right = +synth.delayFeedback0Right;\n\t\t\t\tvar delayFeedback1Right = +synth.delayFeedback1Right;\n\t\t\t\tvar delayFeedback2Right = +synth.delayFeedback2Right;\n\t\t\t\tvar delayFeedback3Right = +synth.delayFeedback3Right;\n\t\t\t\tvar limit = +synth.limit;\n\t\t\t\t\n\t\t\t\twhile (samples) {\n\t\t\t\t\tvar channel#Vibrato = 1.0 + channel#VibratoScale * effectY; // PITCH\n\t\t\t\t\tvar channel#Tremolo = 1.0 + channel#TremoloScale * (effectY - 1.0); // PITCH\n\t\t\t\t\tvar temp = effectY;\n\t\t\t\t\teffectY = effectYMult * effectY - prevEffectY;\n\t\t\t\t\tprevEffectY = temp;\n\t\t\t\t\t\n\t\t\t\t\tchannel#SampleLeft += ((channel#Wave[0|(channel#PhaseA * channel#WaveLength)] + channel#Wave[0|(channel#PhaseB * channel#WaveLength)] * channel#ChorusSign) * channel#Volume * channel#Tremolo - channel#SampleLeft) * channel#Filter * channel#VolumeLeft; // CHIP \n\t\t\t\t\tchannel#SampleLeft += (channel#Wave[0|(channel#Phase * 32768.0)] * channel#Volume - channel#SampleLeft) * channel#Filter * channel#VolumeLeft; // NOISE\n\t\t\t\t\tchannel#SampleRight += ((channel#Wave[0|(channel#PhaseA * channel#WaveLength)] + channel#Wave[0|(channel#PhaseB * channel#WaveLength)] * channel#ChorusSign) * channel#Volume * channel#Tremolo - channel#SampleRight) * channel#Filter * channel#VolumeRight; // CHIP \n\t\t\t\t\tchannel#SampleRight += (channel#Wave[0|(channel#Phase * 32768.0)] * channel#Volume - channel#SampleRight) * channel#Filter * channel#VolumeRight; // NOISE\n\t\t\t\t\tchannel#Volume += channel#VolumeDelta; // CHIP\n\t\t\t\t\tchannel#Volume += channel#VolumeDelta; // NOISE\n\t\t\t\t\tchannel#PhaseA += channel#PhaseDelta * channel#Vibrato; // CHIP\n\t\t\t\t\tchannel#PhaseB += channel#PhaseDelta * channel#Vibrato * channel#ChorusDeltaRatio; // CHIP\n\t\t\t\t\tchannel#Phase += channel#PhaseDelta; // NOISE\n\t\t\t\t\tchannel#Filter *= channel#FilterScale; // CHIP\n\t\t\t\t\tchannel#PhaseA -= 0|channel#PhaseA; // CHIP\n\t\t\t\t\tchannel#PhaseB -= 0|channel#PhaseB; // CHIP\n\t\t\t\t\tchannel#Phase -= 0|channel#Phase; // NOISE\n\t\t\t\t\tchannel#PhaseDelta *= channel#PhaseDeltaScale; // CHIP\n\t\t\t\t\tchannel#PhaseDelta *= channel#PhaseDeltaScale; // NOISE\n\t\t\t\t\t\n\t\t\t\t\t// INSERT OPERATOR COMPUTATION HERE\n\t\t\t\t\tchannel#SampleLeft = channel#Tremolo * (/*channel#Operator$Scaled*/) * channel#VolumeLeft; // CARRIER OUTPUTS\n\t\t\t\t\tchannel#SampleRight = channel#Tremolo * (/*channel#Operator$Scaled*/) * channel#VolumeRight; // CARRIER OUTPUTS\n\t\t\t\t\tchannel#FeedbackMult += channel#FeedbackDelta; // FM\n\t\t\t\t\tchannel#Operator$OutputMult += channel#Operator$OutputDelta; // FM\n\t\t\t\t\tchannel#Operator$Phase += channel#Operator$PhaseDelta * channel#Vibrato; // FM\n\t\t\t\t\tchannel#Operator$PhaseDelta *= channel#PhaseDeltaScale; // FM\n\t\t\t\t\t\n\t\t\t\t\t// Reverb, implemented using a feedback delay network with a Hadamard matrix and lowpass filters.\n\t\t\t\t\t// good ratios:    0.555235 + 0.618033 + 0.818 +   1.0 = 2.991268\n\t\t\t\t\t// Delay lengths:  3041     + 3385     + 4481  +  5477 = 16384 = 2^14\n\t\t\t\t\t// Buffer offsets: 3041    -> 6426   -> 10907 -> 16384\n\t\t\t\t\tvar delayPos1Left = (delayPosLeft +  3041) & 0x3FFF;\n\t\t\t\t\tvar delayPos2Left = (delayPosLeft +  6426) & 0x3FFF;\n\t\t\t\t\tvar delayPos3Left = (delayPosLeft + 10907) & 0x3FFF;\n\t\t\t\t\tvar delaySampleLeft0 = (delayLineLeft[delayPosLeft]\n\t\t\t\t\t\t+ channel#SampleLeft // PITCH\n\t\t\t\t\t);\n\t\t\t\t\tvar delayPos1Right = (delayPosRight +  3041) & 0x3FFF;\n\t\t\t\t\tvar delayPos2Right = (delayPosRight +  6426) & 0x3FFF;\n\t\t\t\t\tvar delayPos3Right = (delayPosRight + 10907) & 0x3FFF;\n\t\t\t\t\tvar delaySampleRight0 = (delayLineRight[delayPosRight]\n\t\t\t\t\t\t+ channel#SampleRight // PITCH\n\t\t\t\t\t);\n\t\t\t\t\tvar delaySampleLeft1 = delayLineLeft[delayPos1Left];\n\t\t\t\t\tvar delaySampleLeft2 = delayLineLeft[delayPos2Left];\n\t\t\t\t\tvar delaySampleLeft3 = delayLineLeft[delayPos3Left];\n\t\t\t\t\tvar delayTemp0Left = -delaySampleLeft0 + delaySampleLeft1;\n\t\t\t\t\tvar delayTemp1Left = -delaySampleLeft0 - delaySampleLeft1;\n\t\t\t\t\tvar delayTemp2Left = -delaySampleLeft2 + delaySampleLeft3;\n\t\t\t\t\tvar delayTemp3Left = -delaySampleLeft2 - delaySampleLeft3;\n\t\t\t\t\tdelayFeedback0Left += ((delayTemp0Left + delayTemp2Left) * reverb - delayFeedback0Left) * 0.5;\n\t\t\t\t\tdelayFeedback1Left += ((delayTemp1Left + delayTemp3Left) * reverb - delayFeedback1Left) * 0.5;\n\t\t\t\t\tdelayFeedback2Left += ((delayTemp0Left - delayTemp2Left) * reverb - delayFeedback2Left) * 0.5;\n\t\t\t\t\tdelayFeedback3Left += ((delayTemp1Left - delayTemp3Left) * reverb - delayFeedback3Left) * 0.5;\n\t\t\t\t\tdelayLineLeft[delayPos1Left] = delayFeedback0Left;\n\t\t\t\t\tdelayLineLeft[delayPos2Left] = delayFeedback1Left;\n\t\t\t\t\tdelayLineLeft[delayPos3Left] = delayFeedback2Left;\n\t\t\t\t\tdelayLineLeft[delayPosLeft ] = delayFeedback3Left;\n\t\t\t\t\tdelayPosLeft = (delayPosLeft + 1) & 0x3FFF;\n\t\t\t\t\t\n\t\t\t\t\tvar delaySampleRight1 = delayLineRight[delayPos1Right];\n\t\t\t\t\tvar delaySampleRight2 = delayLineRight[delayPos2Right];\n\t\t\t\t\tvar delaySampleRight3 = delayLineRight[delayPos3Right];\n\t\t\t\t\tvar delayTemp0Right = -delaySampleRight0 + delaySampleRight1;\n\t\t\t\t\tvar delayTemp1Right = -delaySampleRight0 - delaySampleRight1;\n\t\t\t\t\tvar delayTemp2Right = -delaySampleRight2 + delaySampleRight3;\n\t\t\t\t\tvar delayTemp3Right = -delaySampleRight2 - delaySampleRight3;\n\t\t\t\t\tdelayFeedback0Right += ((delayTemp0Right + delayTemp2Right) * reverb - delayFeedback0Right) * 0.5;\n\t\t\t\t\tdelayFeedback1Right += ((delayTemp1Right + delayTemp3Right) * reverb - delayFeedback1Right) * 0.5;\n\t\t\t\t\tdelayFeedback2Right += ((delayTemp0Right - delayTemp2Right) * reverb - delayFeedback2Right) * 0.5;\n\t\t\t\t\tdelayFeedback3Right += ((delayTemp1Right - delayTemp3Right) * reverb - delayFeedback3Right) * 0.5;\n\t\t\t\t\tdelayLineRight[delayPos1Right] = delayFeedback0Right;\n\t\t\t\t\tdelayLineRight[delayPos2Right] = delayFeedback1Right;\n\t\t\t\t\tdelayLineRight[delayPos3Right] = delayFeedback2Right;\n\t\t\t\t\tdelayLineRight[delayPosRight ] = delayFeedback3Right;\n\t\t\t\t\tdelayPosRight = (delayPosRight + 1) & 0x3FFF;\n\t\t\t\t\t\n\t\t\t\t\tvar sampleLeft = delaySampleLeft0 + delaySampleLeft1 + delaySampleLeft2 + delaySampleLeft3\n\t\t\t\t\t\t+ channel#SampleLeft // NOISE\n\t\t\t\t\t;\n\t\t\t\t\t\n\t\t\t\t\tvar sampleRight = delaySampleRight0 + delaySampleRight1 + delaySampleRight2 + delaySampleRight3\n\t\t\t\t\t\t+ channel#SampleRight // NOISE\n\t\t\t\t\t;\n\t\t\t\t\t\n\t\t\t\t\tvar abs = sampleLeft < 0.0 ? -sampleLeft : sampleLeft;\n\t\t\t\t\tlimit -= limitDecay;\n\t\t\t\t\tif (limit < abs) limit = abs;\n\t\t\t\t\tsampleLeft /= limit * 0.75 + 0.25;\n\t\t\t\t\tsampleLeft *= volume;\n\t\t\t\t\tsampleLeft = sampleLeft;\n\t\t\t\t\tdataLeft[bufferIndex] = sampleLeft;\n\t\t\t\t\tsampleRight /= limit * 0.75 + 0.25;\n\t\t\t\t\tsampleRight *= volume;\n\t\t\t\t\tsampleRight = sampleRight;\n\t\t\t\t\tdataRight[bufferIndex] = sampleRight;\n\t\t\t\t\tbufferIndex++;\n\t\t\t\t\tsamples--;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tsynthChannel#.phases[0] = channel#PhaseA; // CHIP\n\t\t\t\tsynthChannel#.phases[1] = channel#PhaseB; // CHIP\n\t\t\t\tsynthChannel#.phases[0] = channel#Phase; // NOISE\n\t\t\t\tsynthChannel#.phases[$] = channel#Operator$Phase / "+s.sineWaveLength+"; // FM\n\t\t\t\tsynthChannel#.feedbackOutputs[$] = channel#Operator$Output; // FM\n\t\t\t\tsynthChannel#.sampleLeft = channel#SampleLeft; // ALL\n\t\t\t\tsynthChannel#.sampleRight = channel#SampleRight; // ALL\n\t\t\t\t\n\t\t\t\tsynth.delayPosLeft = delayPosLeft;\n\t\t\t\tsynth.delayFeedback0Left = delayFeedback0Left;\n\t\t\t\tsynth.delayFeedback1Left = delayFeedback1Left;\n\t\t\t\tsynth.delayFeedback2Left = delayFeedback2Left;\n\t\t\t\tsynth.delayFeedback3Left = delayFeedback3Left;\n\t\t\t\tsynth.delayPosRight = delayPosRight;\n\t\t\t\tsynth.delayFeedback0Right = delayFeedback0Right;\n\t\t\t\tsynth.delayFeedback1Right = delayFeedback1Right;\n\t\t\t\tsynth.delayFeedback2Right = delayFeedback2Right;\n\t\t\t\tsynth.delayFeedback3Right = delayFeedback3Right;\n\t\t\t\tsynth.limit = limit;\n\t\t\t\t\n\t\t\t\tif (effectYMult * effectY - prevEffectY > prevEffectY) {\n\t\t\t\t\tsynth.effectPhase = Math.asin(effectY);\n\t\t\t\t} else {\n\t\t\t\t\tsynth.effectPhase = Math.PI - Math.asin(effectY);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (synth.arpSampleCountdown == 0) {\n\t\t\t\t\tsynth.arpeggio++;\n\t\t\t\t\tsynth.arpSampleCountdown = samplesPerTick;\n\t\t\t\t\tif (synth.arpeggio == 4) {\n\t\t\t\t\t\tsynth.arpeggio = 0;\n\t\t\t\t\t\tsynth.part++;\n\t\t\t\t\t\tif (synth.part == song.partsPerBeat) {\n\t\t\t\t\t\t\tsynth.part = 0;\n\t\t\t\t\t\t\tsynth.beat++;\n\t\t\t\t\t\t\tif (synth.beat == song.beatsPerBar) {\n\t\t\t\t\t\t\t\t// The bar ended, may need to regenerate synthesizer.\n\t\t\t\t\t\t\t\treturn bufferIndex;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t// Indicate that the buffer is finished generating.\n\t\t\treturn -1;\n\t\t").split("\n"),xe.operatorSourceTemplate=("\n\t\t\t\t\t\tvar channel#Operator$PhaseMix = channel#Operator$Phase/* + channel#Operator@Scaled*/;\n\t\t\t\t\t\tvar channel#Operator$PhaseInt = channel#Operator$PhaseMix|0;\n\t\t\t\t\t\tvar channel#Operator$Index    = channel#Operator$PhaseInt & "+s.sineWaveMask+";\n\t\t\t\t\t\tvar channel#Operator$Sample   = sineWave[channel#Operator$Index];\n\t\t\t\t\t\tchannel#Operator$Output       = channel#Operator$Sample + (sineWave[channel#Operator$Index + 1] - channel#Operator$Sample) * (channel#Operator$PhaseMix - channel#Operator$PhaseInt);\n\t\t\t\t\t\tvar channel#Operator$Scaled   = channel#Operator$OutputMult * channel#Operator$Output;\n\t\t").split("\n");const{button:we,div:ve,input:ke}=u;function Ce(t,e){if(navigator.msSaveOrOpenBlob)return void navigator.msSaveOrOpenBlob(t,e);const n=document.createElement("a");if(null!=n.download){const i=URL.createObjectURL(t);setTimeout((function(){URL.revokeObjectURL(i)}),6e4),n.href=i,n.download=e,setTimeout((function(){n.dispatchEvent(new MouseEvent("click"))}),0)}else{const e=URL.createObjectURL(t);setTimeout((function(){URL.revokeObjectURL(e)}),6e4),window.open(e,"_blank")||(window.location.href=e)}}class Le{constructor(t){this.$=t,this.qn=ke({type:"text",style:"width: 10em;",value:"Modbox-Song",maxlength:250}),this.Kn=ke({type:"checkbox"}),this.Jn=ke({style:"width: 2em;",type:"number",min:"1",max:"4",step:"1"}),this.Qn=ke({type:"checkbox"}),this.Xn=we({},[ve("Export to .wav file")]),this.Zn=we({},[ve("Export to .json file")]),this.Gn=we({},[ve("Cancel")]),this.container=ve({class:"prompt",style:"width: 200px;"},[ve({style:"font-size: 2em"},[ve("Export Options")]),ve({style:"display: flex; flex-direction: row; align-items: center; justify-content: space-between;"},[ve("File name:"),this.qn]),ve({style:"display: table; width: 100%;"},[ve({style:"display: table-row;"},[ve({style:"display: table-cell;"},[ve("Intro:")]),ve({style:"display: table-cell;"},[ve("Loop Count:")]),ve({style:"display: table-cell;"},[ve("Outro:")])]),ve({style:"display: table-row;"},[ve({style:"display: table-cell; vertical-align: middle;"},[this.Kn]),ve({style:"display: table-cell; vertical-align: middle;"},[this.Jn]),ve({style:"display: table-cell; vertical-align: middle;"},[this.Qn])])]),this.Xn,this.Zn,this.Gn]),this.Yn=()=>{this.$.undo()},this.cleanUp=()=>{this.qn.removeEventListener("input",Le.ti),this.Jn.removeEventListener("blur",Le.ei),this.Xn.removeEventListener("click",this.ni),this.Zn.removeEventListener("click",this.ii),this.Gn.removeEventListener("click",this.Yn)},this.ni=()=>{const t=new xe(this.$.song);if(t.enableIntro=this.Kn.checked,t.enableOutro=this.Qn.checked,t.loopCount=Number(this.Jn.value),!t.enableIntro)for(let e=0;e<this.$.song.loopStart;e++)t.nextBar();const e=t.totalSamples,n=new Float32Array(e),i=new Float32Array(e);t.synthesize(n,i,e);const s=t.samplesPerSecond,h=2*e;let a=0;const r=new ArrayBuffer(44+2*h),o=new DataView(r);let c,l,p,f;o.setUint32(a,1380533830,!1),a+=4,o.setUint32(a,36+2*h,!0),a+=4,o.setUint32(a,1463899717,!1),a+=4,o.setUint32(a,1718449184,!1),a+=4,o.setUint32(a,16,!0),a+=4,o.setUint16(a,1,!0),a+=2,o.setUint16(a,2,!0),a+=2,o.setUint32(a,s,!0),a+=4,o.setUint32(a,2*s*2,!0),a+=4,o.setUint16(a,2,!0),a+=2,o.setUint16(a,16,!0),a+=2,o.setUint32(a,1684108385,!1),a+=4,o.setUint32(a,2*h,!0),a+=4,c=1,l=1;for(let t=0;t<e;t++){p=Math.floor(32767*n[1*t]),f=Math.floor(32767*i[1*t]);for(let t=0;t<1;t++)o.setInt16(a,p,!0),a+=2,o.setInt16(a,f,!0),a+=2}Ce(new Blob([r],{type:"audio/wav"}),this.qn.value.trim()+".wav"),this.Yn()},this.ii=()=>{const t=this.$.song.toJsonObject(this.Kn.checked,Number(this.Jn.value),this.Qn.checked),e=JSON.stringify(t,null,"\t");Ce(new Blob([e],{type:"application/json"}),this.qn.value.trim()+".json"),this.Yn()},this.Jn.value="1",0==this.$.song.loopStart?(this.Kn.checked=!1,this.Kn.disabled=!0):(this.Kn.checked=!0,this.Kn.disabled=!1),this.$.song.loopStart+this.$.song.loopLength==this.$.song.barCount?(this.Qn.checked=!1,this.Qn.disabled=!0):(this.Qn.checked=!0,this.Qn.disabled=!1),this.qn.addEventListener("input",Le.ti),this.Jn.addEventListener("blur",Le.ei),this.Xn.addEventListener("click",this.ni),this.Zn.addEventListener("click",this.ii),this.Gn.addEventListener("click",this.Yn)}static ti(t){const e=t.target,n=/[\+\*\$\?\|\{\}\\\/<>#%!`&'"=:@]/gi;if(n.test(e.value)){let t=e.selectionStart;e.value=e.value.replace(n,""),t--,e.setSelectionRange(t,t)}}static ei(t){const e=t.target;e.value=Math.floor(Math.max(Number(e.min),Math.min(Number(e.max),Number(e.value))))+""}}const{button:Me,div:Se,input:Fe}=u;class Be{constructor(t){this.$=t,this.si=Fe({type:"file",accept:".json,application/json"}),this.Gn=Me({},[Se("Cancel")]),this.container=Se({class:"prompt",style:"width: 200px;"},[Se({style:"font-size: 2em"},[Se("Import")]),Se({style:"text-align: left;"},[Se("BeepBox songs can be exported and re-imported as .json files. You could also use other means to make .json files for BeepBox as long as they follow the same structure.")]),this.si,this.Gn]),this.Yn=()=>{this.$.undo()},this.cleanUp=()=>{this.si.removeEventListener("change",this.hi),this.Gn.removeEventListener("click",this.Yn)},this.hi=()=>{const t=this.si.files[0];if(!t)return;const e=new FileReader;e.addEventListener("load",(t=>{this.$.prompt=null,this.$.record(new Nt(this.$,e.result),!0)})),e.readAsText(t)},this.si.addEventListener("change",this.hi),this.Gn.addEventListener("click",this.Yn)}}const{button:Pe,div:Ee,a:Re}=u;class Ne{constructor(t){this.$=t,this.Gn=Pe({},Ee("No thanks!")),this.container=Ee({class:"prompt",style:"width: 250px;"},Ee({style:"font-size: 2em"},Ee("Archives")),Ee({style:"text-align: center;"},Ee("These are the Archives. Below are previous versions of Modded Beepbox/Sandbox that you are able to play around with, changelog included. Go nuts!")),Ee({style:"text-align: center;"},Re({target:"_blank",href:"https://moddedbeepbox.github.io/beta/mb-archives/1.3.0.htm"},Ee("MB 1.3.0")),Ee(" | "),Re({target:"_blank",href:"https://moddedbeepbox.github.io/beta/mb-archives/1.6.0.htm"},Ee("MB 1.6.0")),Ee(" | "),Re({target:"_blank",href:"https://moddedbeepbox.github.io/beta/mb-archives/1.9.1.htm"},Ee("MB 1.9.1")),Ee(" | "),Re({target:"_blank",href:"https://moddedbeepbox.github.io/beta/mb-archives/2.0.0.htm"},Ee("MB v2.0.0")),Ee(" | "),Re({target:"_blank",href:"https://moddedbeepbox.github.io/beta/mb-archives/2.3.0.htm"},Ee("MB v2.2.2")),Ee(" | "),Re({target:"_blank",href:"https://moddedbeepbox.github.io/beta/mb-archives/2.3.html"},Ee("MB v2.3.0")),Ee(" | "),Re({target:"_blank",href:"https://moddedbeepbox.github.io/beta/mb-archives/3.0.html"},Ee("MB v3.0.3")),Ee(" | "),Re({target:"_blank",href:"https://moddedbeepbox.github.io/beta/sb-archives/1.2.1.htm"},Ee("SB v1.2.1")),Ee(" | "),Re({target:"_blank",href:"https://moddedbeepbox.github.io/beta/sb-archives/1.3.0.htm"},Ee("SB v1.3.0")),Ee(" | "),Re({target:"_blank",href:"https://moddedbeepbox.github.io/beta/sb-archives/1.4.0.htm"},Ee("SB v1.4.0")),Ee(" | "),Re({target:"_blank",href:"https://moddedbeepbox.github.io/beta/sb-archives/2.0.6.1.htm"},Ee("SB v2.0.6.1")),Ee(" | "),Re({target:"_blank",href:"https://moddedbeepbox.github.io/beta/sb-archives/2.1.3.htm"},Ee("SB v2.1.3")),Ee(" | "),Re({target:"_blank",href:"https://moddedbeepbox.github.io/beta/sb-archives/3.0.0.htm"},Ee("SB v3.0.0")),Ee(" | "),Re({target:"_blank",href:"https://moddedbeepbox.github.io/beta/changelogs/mbchangelog.html"},Ee("Changelog"))),this.Gn),this.Yn=()=>{this.$.undo()},this.cleanUp=()=>{this.Gn.removeEventListener("click",this.Yn)},this.Gn.addEventListener("click",this.Yn)}}const{button:Te,div:Oe}=u;class De{constructor(t){this.$=t,this.Gn=Te({},[Oe("Close")]),this.container=Oe({class:"prompt",style:"width: 250px;"},[Oe({style:"font-size: 2em"},[Oe("Song Data")]),Oe({style:"text-align: left;"},[Oe("You are on update Modbox 3.3.0-B_1.")]),Oe({style:"text-align: left;"},[Oe("Your song is "+this.$.synth.totalSeconds+" seconds long.")]),Oe({style:"text-align: left;"},[Oe("Your song runs at "+this.$.song.getBeatsPerMinute()+" beats per minute.")]),Oe({style:"text-align: left;"},[Oe("There are currently "+this.$.song.getChannelUnusedCount()+" unused channels in your song out of 16.")]),Oe({style:"text-align: left;"},[Oe("none"==this.$.song.setSongTheme?"You are using your personal theme.":"Your are using the "+this.$.song.setSongTheme+" theme.")]),Oe({style:"text-align: left;"},[Oe("Your time signuature is "+this.$.song.getTimeSig())]),Oe({style:"text-align: left;"},[Oe("Your scale is "+this.$.song.getScaleNKey()+".")]),this.Gn]),this.Yn=()=>{this.$.undo()},this.cleanUp=()=>{this.Gn.removeEventListener("click",this.Yn)},this.Gn.addEventListener("click",this.Yn)}}const{button:Ie,div:Ae}=u;class $e{constructor(t,e,n){this.$=t,this.ai=e,this.ri=n,this.oi=Ie({},[Ae("Refresh")]),this.container=Ae({class:"prompt",style:"width: 200px;"},[Ae({style:"font-size: 1em"},[Ae("Refresh")]),Ae({style:"text-align: left; margin: 0.5em 0;"},[Ae("Due to you using the Piano theme, you will need to refresh to display the change in key colors.")]),Ae({style:"text-align: left; margin: 0.5em 0;"},[Ae("You must refresh to continue.")]),this.oi]),this.ci=()=>{this.$.prompt=null,this.$.record(new mt(this.$,this.ri)),this.ai.refreshNow()},this.cleanUp=()=>{this.oi.addEventListener("click",this.ci)},this.oi.addEventListener("click",this.ci)}}const{button:je,div:ze,input:_e,span:We}=u;class Ve{constructor(t){this.$=t,this.li=_e({style:"width: 3em; margin-left: 1em;",type:"number",step:"1"}),this.pi=_e({style:"width: 3em; margin-left: 1em;",type:"number",step:"1"}),this.fi=_e({style:"width: 3em; margin-left: 1em;",type:"number",step:"1"}),this.di=_e({style:"width: 3em; margin-left: 1em;",type:"number",step:"1"}),this.yi=_e({style:"width: 3em; margin-left: 1em;",type:"number",step:"1"}),this.mi=_e({style:"width: 3em; margin-left: 1em;",type:"number",step:"1"}),this.ui=je({style:"width:45%;"},[ze("Okay")]),this.Gn=je({style:"width:45%;"},[ze("Cancel")]),this.container=ze({class:"prompt",style:"width: 250px;"},[ze({style:"font-size: 2em"},[ze("Custom Song Size")]),ze({style:"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;"},[ze({style:"text-align: right;"},[ze("Beats per bar:"),We({style:"font-size: smaller; color: #888888;"},[ze("(Multiples of 3 or 4 are recommended)")])]),this.li]),ze({style:"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;"},[ze({style:"display: inline-block; text-align: right;"},[ze("Bars per song:"),We({style:"font-size: smaller; color: #888888;"},[ze("(Multiples of 2 or 4 are recommended)")])]),this.pi]),ze({style:"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;"},[ze("Patterns per channel:"),this.fi]),ze({style:"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;"},[ze("Instruments per channel:"),this.di]),ze({style:"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;"},[ze("Number of pitch channels:"),this.yi]),ze({style:"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;"},[ze("Number of drum channels:"),this.mi]),ze({style:"display: flex; flex-direction: row; justify-content: space-between;"},[this.ui,this.Gn])]),this.Yn=()=>{this.$.undo()},this.cleanUp=()=>{this.ui.removeEventListener("click",this.bi),this.Gn.removeEventListener("click",this.Yn),this.li.removeEventListener("keypress",Ve.gi),this.pi.removeEventListener("keypress",Ve.gi),this.fi.removeEventListener("keypress",Ve.gi),this.di.removeEventListener("keypress",Ve.gi),this.yi.removeEventListener("keypress",Ve.gi),this.mi.removeEventListener("keypress",Ve.gi),this.li.removeEventListener("blur",Ve.ei),this.pi.removeEventListener("blur",Ve.ei),this.fi.removeEventListener("blur",Ve.ei),this.di.removeEventListener("blur",Ve.ei),this.yi.removeEventListener("blur",Ve.ei),this.mi.removeEventListener("blur",Ve.ei)},this.bi=()=>{const t=new I;t.append(new G(this.$,Ve.xi(this.li))),t.append(new W(this.$,Ve.xi(this.pi))),t.append(new Ct(this.$,Ve.xi(this.fi))),t.append(new yt(this.$,Ve.xi(this.di))),t.append(new H(this.$,Ve.xi(this.yi),Ve.xi(this.mi))),this.$.prompt=null,this.$.record(t,!0)},this.li.value=this.$.song.beatsPerBar+"",this.li.min=s.beatsPerBarMin+"",this.li.max=s.beatsPerBarMax+"",this.pi.value=this.$.song.barCount+"",this.pi.min=s.barCountMin+"",this.pi.max=s.barCountMax+"",this.fi.value=this.$.song.patternsPerChannel+"",this.fi.min=s.patternsPerChannelMin+"",this.fi.max=s.patternsPerChannelMax+"",this.di.value=this.$.song.instrumentsPerChannel+"",this.di.min=s.instrumentsPerChannelMin+"",this.di.max=s.instrumentsPerChannelMax+"",this.yi.value=this.$.song.pitchChannelCount+"",this.yi.min=s.pitchChannelCountMin+"",this.yi.max=s.pitchChannelCountMax+"",this.mi.value=this.$.song.drumChannelCount+"",this.mi.min=s.drumChannelCountMin+"",this.mi.max=s.drumChannelCountMax+"",this.ui.addEventListener("click",this.bi),this.Gn.addEventListener("click",this.Yn),this.li.addEventListener("keypress",Ve.gi),this.pi.addEventListener("keypress",Ve.gi),this.fi.addEventListener("keypress",Ve.gi),this.di.addEventListener("keypress",Ve.gi),this.yi.addEventListener("keypress",Ve.gi),this.mi.addEventListener("keypress",Ve.gi),this.li.addEventListener("blur",Ve.ei),this.pi.addEventListener("blur",Ve.ei),this.fi.addEventListener("blur",Ve.ei),this.di.addEventListener("blur",Ve.ei),this.yi.addEventListener("blur",Ve.ei),this.mi.addEventListener("blur",Ve.ei)}static gi(t){const e=t.which?t.which:t.keyCode;return 46!=e&&e>31&&(e<48||e>57)&&(t.preventDefault(),!0)}static ei(t){const e=t.target;e.value=Math.floor(Math.max(Number(e.min),Math.min(Number(e.max),Number(e.value))))+""}static xi(t){return Math.floor(Number(t.value))}}const{button:Ue,div:He,a:Ge}=u;class Ye{constructor(t){this.$=t,this.Gn=Ue({},[He("Close")]),this.container=He({class:"prompt",style:"width: 300px;"},[He({style:"font-size: 2em"},[He("FM Synthesis")]),He({style:"text-align: left; margin: 0.5em 0;"},[He("Popularized by the Sega Genesis and Yamaha keyboards, FM Synthesis is a mysterious but powerful technique for crafting sounds. It may seem confusing, but just play around with the options until you get a feel for it, check out some examples in "),Ge({target:"_blank",href:"#6n10s0kbl00e07t5m0a7g07j7i7r1o2T1d2c0A0F1B0V1Q0200Pff00E0411T1d1c0A0F0B0V1Q2800Pf700E0711T1d2c0A0F1B4VaQ0200Pfb00E0911T1d1c2A0F9B3V1Q1000Pfbc0E0191T1d2c0AcF8B5V1Q0259PffffE0000T1d3c1AcF4B5V4Q2600Pff00E0011T1d1c0AbF0B0V1Q2580PfffaE2226T1d1c0A1F0B0V1Q520dPff4dEd41eb4zhmu0p21h5dfxd7ij7XrjfiAjPudUTtUSRsTzudTudJvdUTztTzrpPudUTtUSSYTzudTudJTdUTztTzrvPudUTtUSQ"},[He("this demo")]),He(", or find some instruments to use in the Beepbox Discord's FM sheet "),Ge({target:"_blank",href:"https://docs.google.com/spreadsheets/d/1ddbXnrP7yvv5X4oUur9boi3AxcI-Xxz1XIHIAo-wi0s/edit#gid=230623845"},[He("right here")]),He(".")]),He({style:"text-align: left; margin: 0.5em 0;"},[He("This FM instrument uses up to four waves, numbered 1, 2, 3, and 4. Each wave may have its own frequency, volume, and volume envelope to control its effect over time. ")]),He({style:"text-align: left; margin: 0.5em 0;"},[He('There are two kinds of waves: "carrier" waves play a tone out loud, but "modulator" waves distort other waves instead. Wave 1 is always a carrier and plays a tone, but other waves may distort it. The "Algorithm" setting determines which waves are modulators, and which other waves those modulators distort. ')]),He({style:"text-align: left; margin: 0.5em 0;"},[He('Modulators distort in one direction (like 1â†2), but you can also use "Feedback" to make any wave distort in the opposite direction (1â†’2), in both directions (1ðŸ—˜2), or even itself (1âŸ²). ')]),He({style:"text-align: left; margin: 0.5em 0;"},[He("You can set the pitch of each wave independently by adding simultaneous notes, one above another. This often sounds harsh or dissonant, but can make cool sound effects! ")]),this.Gn]),this.Yn=()=>{this.$.undo()},this.cleanUp=()=>{this.Gn.removeEventListener("click",this.Yn)},this.Gn.addEventListener("click",this.Yn)}}const{button:qe,div:Ke,form:Je,label:Qe,input:Xe}=u;class Ze{constructor(t){this.$=t,this.hasChanged=!1,this.wi=qe({style:"flex: 1; width: 0;"},"Close"),this.ki=qe({style:"flex: 1; width: 0;"},"Preview"),this.Ci=Ke({style:"opacity: 0; position:absolute; left: 8px; top: 24px; font-size: 32px; font-weight:bold;"},"Previewing..."),this.previewExit=Ke({style:"width: 100vw; height: 100vh; position: fixed; left: 0; top: -2vh; display: flex; pointer-events: none;"},this.Ci),this.Li=Je({style:"display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; max-height:265px; overflow-y: scroll; overflow-x: hidden;"},Qe({title:"Default",class:"theme-option"},Xe({type:"radio",name:"theme",value:"default",style:"display:none;"}),Ke({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},Ke({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},Ke({style:"width: 58px; height: 58px; background: #606060; border-radius: 35px;"})),Ke({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Default"))),Qe({title:"NepBox",class:"theme-option"},Xe({type:"radio",name:"theme",value:"nepbox",style:"display:none;"}),Ke({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},Ke({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},Ke({style:"width: 58px; height: 58px; background: #9150ff; border-radius: 35px;"})),Ke({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"NepBox"))),Qe({title:"Laffey",class:"theme-option"},Xe({type:"radio",name:"theme",value:"laffey",style:"display:none;"}),Ke({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},Ke({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},Ke({style:"width: 58px; height: 58px; background: #dbbeed; border-radius: 35px;"})),Ke({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Laffey"))),Qe({title:"ModBox 2.0",class:"theme-option"},Xe({type:"radio",name:"theme",value:"modbox2",style:"display:none;"}),Ke({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},Ke({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},Ke({style:"width: 58px; height: 58px; background: #c4ffa3; border-radius: 35px;"})),Ke({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"ModBox 2.0"))),Qe({title:"Artic",class:"theme-option"},Xe({type:"radio",name:"theme",value:"artic",style:"display:none;"}),Ke({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},Ke({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},Ke({style:"width: 58px; height: 58px; background: #a5eeff; border-radius: 35px;"})),Ke({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Artic"))),Qe({title:"Cinnamon Roll [!]",class:"theme-option"},Xe({type:"radio",name:"theme",value:"Cinnamon Roll",style:"display:none;"}),Ke({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},Ke({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},Ke({style:"width: 58px; height: 58px; background: #f5bb00; border-radius: 35px;"})),Ke({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"CinnaBun [!]"))),Qe({title:"Ocean",class:"theme-option"},Xe({type:"radio",name:"theme",value:"Ocean",style:"display:none;"}),Ke({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},Ke({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},Ke({style:"width: 58px; height: 58px; background: #4449a3; border-radius: 35px;"})),Ke({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Ocean"))),Qe({title:"Rainbow [!]",class:"theme-option"},Xe({type:"radio",name:"theme",value:"rainbow",style:"display:none;"}),Ke({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},Ke({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},Ke({style:"width: 58px; height: 58px; background: linear-gradient(140deg, #faa, #ffceaa, #ffdfaa, #fff5aa, #e8ffaa, #bfffb2, #b2ffc8, #b2ffe4, #b2b3ff, #e0b2ff, #ffafe9); border-radius: 35px;"})),Ke({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Rainbow [!]"))),Qe({title:"Float",class:"theme-option"},Xe({type:"radio",name:"theme",value:"float",style:"display:none;"}),Ke({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},Ke({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},Ke({style:"width: 58px; height: 58px; background: linear-gradient(140deg, #fff, #282828); border-radius: 35px;"})),Ke({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Float [!]"))),Qe({title:"Windows",class:"theme-option"},Xe({type:"radio",name:"theme",value:"windows",style:"display:none;"}),Ke({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},Ke({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},Ke({style:"width: 58px; height: 58px; background: #295294; border-radius: 35px;"})),Ke({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Windows"))),Qe({title:"Grassland",class:"theme-option"},Xe({type:"radio",name:"theme",value:"grassland",style:"display:none;"}),Ke({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},Ke({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},Ke({style:"width: 58px; height: 58px; background: #74bc21; border-radius: 35px;"})),Ke({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Grassland"))),Qe({title:"Dessert",class:"theme-option"},Xe({type:"radio",name:"theme",value:"dessert",style:"display:none;"}),Ke({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},Ke({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},Ke({style:"width: 58px; height: 58px; background: #fffc5b; border-radius: 35px;"})),Ke({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Dessert"))),Qe({title:"Kahootiest",class:"theme-option"},Xe({type:"radio",name:"theme",value:"kahootiest",style:"display:none;"}),Ke({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},Ke({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},Ke({style:"width: 58px; height: 58px; background: #864cbf; border-radius: 35px;"})),Ke({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Kahoot"))),Qe({title:"Beam to the Bit [!]",class:"theme-option"},Xe({type:"radio",name:"theme",value:"beambit",style:"display:none;"}),Ke({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},Ke({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},Ke({style:"width: 58px; height: 58px; background: #fa0103; border-radius: 35px;"})),Ke({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Beambit [!]"))),Qe({title:"Pretty Egg",class:"theme-option"},Xe({type:"radio",name:"theme",value:"egg",style:"display:none;"}),Ke({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},Ke({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},Ke({style:"width: 58px; height: 58px; background: #ffb1f4; border-radius: 35px;"})),Ke({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Pretty Egg"))),Qe({title:"Poniryoshka",class:"theme-option"},Xe({type:"radio",name:"theme",value:"Poniryoshka",style:"display:none;"}),Ke({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},Ke({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},Ke({style:"width: 58px; height: 58px; background: #dabbe6; border-radius: 35px;"})),Ke({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Poni"))),Qe({title:"Gameboy [!]",class:"theme-option"},Xe({type:"radio",name:"theme",value:"gameboy",style:"display:none;"}),Ke({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},Ke({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},Ke({style:"width: 58px; height: 58px; background: #306230; border-radius: 35px;"})),Ke({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Gameboy [!]"))),Qe({title:"Woodkid",class:"theme-option"},Xe({type:"radio",name:"theme",value:"woodkid",style:"display:none;"}),Ke({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},Ke({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},Ke({style:"width: 58px; height: 58px; background: #41323b; border-radius: 35px;"})),Ke({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Woodkid"))),Qe({title:"Midnight",class:"theme-option"},Xe({type:"radio",name:"theme",value:"midnight",style:"display:none;"}),Ke({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},Ke({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},Ke({style:"width: 58px; height: 58px; background: #445566; border-radius: 35px;"})),Ke({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Midnight"))),Qe({title:"Snedbox",class:"theme-option"},Xe({type:"radio",name:"theme",value:"snedbox",style:"display:none;"}),Ke({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},Ke({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},Ke({style:"width: 58px; height: 58px; background: #10997e; border-radius: 35px;"})),Ke({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Snedbox"))),Qe({title:"unnamed",class:"theme-option"},Xe({type:"radio",name:"theme",value:"unnamed",style:"display:none;"}),Ke({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},Ke({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},Ke({style:"width: 58px; height: 58px; background: #ffffa0; border-radius: 35px;"})),Ke({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"unnamed"))),Qe({title:"Piano",class:"theme-option"},Xe({type:"radio",name:"theme",value:"piano",style:"display:none;"}),Ke({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},Ke({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},Ke({style:"width: 58px; height: 58px; background: #bfbfbf; border-radius: 35px;"})),Ke({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Piano [!]"))),Qe({title:"Halloween",class:"theme-option"},Xe({type:"radio",name:"theme",value:"halloween",style:"display:none;"}),Ke({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},Ke({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},Ke({style:"width: 58px; height: 58px; background: #914300; border-radius: 35px;"})),Ke({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Halloween"))),Qe({title:"FrozenOverâ„ï¸",class:"theme-option"},Xe({type:"radio",name:"theme",value:"frozen",style:"display:none;"}),Ke({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},Ke({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},Ke({style:"width: 58px; height: 58px; background: #99c8ef; border-radius: 35px;"})),Ke({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Frozen")))),this.themeContainer=Ke({class:"prompt",style:"width: 330px; max-height: 600px;"},Ke({style:"font-size: 2em"},Ke("Themes")),this.Li,Ke({style:"display:flex; flex-direction:row; width:100%; gap: 16px;"},this.ki,this.wi)),this.container=Ke({},this.themeContainer,this.previewExit),this.Yn=()=>{0==this.hasChanged?(window.localStorage.getItem("modboxTheme")?Yt.setTheme(String(window.localStorage.getItem("modboxTheme"))):Yt.setTheme("default"),this.$.prompt=null,this.$.undo()):(window.localStorage.setItem("modboxTheme",this.Li.elements.theme.value),this.$.prompt=null,this.$.undo())},this.Mi=()=>{Yt.setTheme(this.Li.elements.theme.value),this.Li.elements.theme.value!=window.localStorage.getItem("modboxTheme")?(this.hasChanged=!0,this.wi.innerHTML="Save"):(this.hasChanged=!1,this.wi.innerHTML="Cancel")},this.Si=()=>{this.themeContainer.style.opacity="0",this.previewExit.style.pointerEvents="",this.Ci.style.opacity="1"},this.Fi=()=>{this.themeContainer.style.opacity="1",this.previewExit.style.pointerEvents="none",this.Ci.style.opacity="0"},this.cleanUp=()=>{this.wi.removeEventListener("click",this.Yn)},this.wi.addEventListener("click",this.Yn),this.ki.addEventListener("click",this.Si),this.previewExit.addEventListener("click",this.Fi),this.Li.addEventListener("change",this.Mi),null!=window.localStorage.getItem("modboxTheme")&&(this.Li.elements.theme.value=window.localStorage.getItem("modboxTheme"))}}const{button:tn,div:en,form:nn,label:sn,input:hn}=u;class an{constructor(t){this.$=t,this.hasChanged=!1,this.wi=tn({style:"flex: 1; width: 0;"},"Close"),this.ki=tn({style:"flex: 1; width: 0;"},"Preview"),this.Ci=en({style:"opacity: 0; position:absolute; left: 8px; top: 24px; font-size: 32px; font-weight:bold;"},"Previewing..."),this.previewExit=en({style:"width: 100vw; height: 100vh; position: fixed; left: 0; top: -2vh; display: flex; pointer-events: none;"},this.Ci),this.Li=nn({style:"display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; max-height:265px; overflow-y: scroll; overflow-x: hidden;"},sn({title:"None",class:"theme-option"},hn({type:"radio",name:"theme",value:"none",style:"display:none;"}),en({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},en({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},en({style:"width: 58px; height: 58px; background:rgb(0, 0, 0); border-radius: 35px;"})),en({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"None"))),sn({title:"Default",class:"theme-option"},hn({type:"radio",name:"theme",value:"default",style:"display:none;"}),en({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},en({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},en({style:"width: 58px; height: 58px; background: #606060; border-radius: 35px;"})),en({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Default"))),sn({title:"Laffey",class:"theme-option"},hn({type:"radio",name:"theme",value:"laffey",style:"display:none;"}),en({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},en({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},en({style:"width: 58px; height: 58px; background: #dbbeed; border-radius: 35px;"})),en({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Laffey"))),sn({title:"NepBox",class:"theme-option"},hn({type:"radio",name:"theme",value:"nepbox",style:"display:none;"}),en({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},en({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},en({style:"width: 58px; height: 58px; background: #9150ff; border-radius: 35px;"})),en({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"NepBox"))),sn({title:"ModBox 2.0",class:"theme-option"},hn({type:"radio",name:"theme",value:"modbox2",style:"display:none;"}),en({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},en({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},en({style:"width: 58px; height: 58px; background: #c4ffa3; border-radius: 35px;"})),en({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"ModBox 2.0"))),sn({title:"Artic",class:"theme-option"},hn({type:"radio",name:"theme",value:"artic",style:"display:none;"}),en({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},en({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},en({style:"width: 58px; height: 58px; background: #a5eeff; border-radius: 35px;"})),en({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Artic"))),sn({title:"Cinnamon Roll [!]",class:"theme-option"},hn({type:"radio",name:"theme",value:"Cinnamon Roll",style:"display:none;"}),en({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},en({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},en({style:"width: 58px; height: 58px; background: #f5bb00; border-radius: 35px;"})),en({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"CinnaBun [!]"))),sn({title:"Ocean",class:"theme-option"},hn({type:"radio",name:"theme",value:"Ocean",style:"display:none;"}),en({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},en({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},en({style:"width: 58px; height: 58px; background: #4449a3; border-radius: 35px;"})),en({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Ocean"))),sn({title:"Rainbow [!]",class:"theme-option"},hn({type:"radio",name:"theme",value:"rainbow",style:"display:none;"}),en({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},en({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},en({style:"width: 58px; height: 58px; background: linear-gradient(140deg, #faa, #ffceaa, #ffdfaa, #fff5aa, #e8ffaa, #bfffb2, #b2ffc8, #b2ffe4, #b2b3ff, #e0b2ff, #ffafe9); border-radius: 35px;"})),en({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Rainbow [!]"))),sn({title:"Float",class:"theme-option"},hn({type:"radio",name:"theme",value:"float",style:"display:none;"}),en({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},en({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},en({style:"width: 58px; height: 58px; background: linear-gradient(140deg, #fff, #282828); border-radius: 35px;"})),en({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Float [!]"))),sn({title:"Windows",class:"theme-option"},hn({type:"radio",name:"theme",value:"windows",style:"display:none;"}),en({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},en({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},en({style:"width: 58px; height: 58px; background: #295294; border-radius: 35px;"})),en({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Windows"))),sn({title:"Grassland",class:"theme-option"},hn({type:"radio",name:"theme",value:"grassland",style:"display:none;"}),en({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},en({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},en({style:"width: 58px; height: 58px; background: #74bc21; border-radius: 35px;"})),en({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Grassland"))),sn({title:"Dessert",class:"theme-option"},hn({type:"radio",name:"theme",value:"dessert",style:"display:none;"}),en({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},en({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},en({style:"width: 58px; height: 58px; background: #fffc5b; border-radius: 35px;"})),en({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Dessert"))),sn({title:"Kahootiest",class:"theme-option"},hn({type:"radio",name:"theme",value:"kahootiest",style:"display:none;"}),en({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},en({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},en({style:"width: 58px; height: 58px; background: #864cbf; border-radius: 35px;"})),en({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Kahoot"))),sn({title:"Beam to the Bit [!]",class:"theme-option"},hn({type:"radio",name:"theme",value:"beambit",style:"display:none;"}),en({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},en({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},en({style:"width: 58px; height: 58px; background: #fa0103; border-radius: 35px;"})),en({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Beambit [!]"))),sn({title:"Pretty Egg",class:"theme-option"},hn({type:"radio",name:"theme",value:"egg",style:"display:none;"}),en({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},en({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},en({style:"width: 58px; height: 58px; background: #ffb1f4; border-radius: 35px;"})),en({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Pretty Egg"))),sn({title:"Poniryoshka",class:"theme-option"},hn({type:"radio",name:"theme",value:"Poniryoshka",style:"display:none;"}),en({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},en({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},en({style:"width: 58px; height: 58px; background: #dabbe6; border-radius: 35px;"})),en({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Poni"))),sn({title:"Gameboy [!]",class:"theme-option"},hn({type:"radio",name:"theme",value:"gameboy",style:"display:none;"}),en({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},en({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},en({style:"width: 58px; height: 58px; background: #306230; border-radius: 35px;"})),en({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Gameboy [!]"))),sn({title:"Woodkid",class:"theme-option"},hn({type:"radio",name:"theme",value:"woodkid",style:"display:none;"}),en({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},en({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},en({style:"width: 58px; height: 58px; background: #41323b; border-radius: 35px;"})),en({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Woodkid"))),sn({title:"Midnight",class:"theme-option"},hn({type:"radio",name:"theme",value:"midnight",style:"display:none;"}),en({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},en({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},en({style:"width: 58px; height: 58px; background: #445566; border-radius: 35px;"})),en({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Midnight"))),sn({title:"Snedbox",class:"theme-option"},hn({type:"radio",name:"theme",value:"snedbox",style:"display:none;"}),en({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},en({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},en({style:"width: 58px; height: 58px; background: #10997e; border-radius: 35px;"})),en({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Snedbox"))),sn({title:"unnamed",class:"theme-option"},hn({type:"radio",name:"theme",value:"unnamed",style:"display:none;"}),en({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},en({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},en({style:"width: 58px; height: 58px; background: #ffffa0; border-radius: 35px;"})),en({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"unnamed"))),sn({title:"Piano",class:"theme-option"},hn({type:"radio",name:"theme",value:"piano",style:"display:none;"}),en({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},en({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},en({style:"width: 58px; height: 58px; background: #bfbfbf; border-radius: 35px;"})),en({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Piano [!]"))),sn({title:"Halloween",class:"theme-option"},hn({type:"radio",name:"theme",value:"halloween",style:"display:none;"}),en({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},en({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},en({style:"width: 58px; height: 58px; background: #914300; border-radius: 35px;"})),en({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Halloween"))),sn({title:"FrozenOverâ„ï¸",class:"theme-option"},hn({type:"radio",name:"theme",value:"frozen",style:"display:none;"}),en({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},en({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},en({style:"width: 58px; height: 58px; background: #99c8ef; border-radius: 35px;"})),en({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Frozen")))),this.themeContainer=en({class:"prompt",style:"width: 330px; max-height: 600px;"},en({style:"font-size: 2em"},en("Song Themes")),this.Li,en({style:"display:flex; flex-direction:row; width:100%; gap: 16px;"},this.ki,this.wi)),this.container=en({},this.themeContainer,this.previewExit),this.Yn=()=>{0==this.hasChanged?("none"==this.$.song.setSongTheme?window.localStorage.getItem("modboxTheme")?Yt.setTheme(String(window.localStorage.getItem("modboxTheme"))):Yt.setTheme("default"):Yt.setTheme(this.$.song.setSongTheme),this.$.prompt=null,this.$.undo()):(this.$.prompt=null,this.$.record(new ut(this.$,this.$.song.setSongTheme,this.Li.elements.theme.value),!0))},this.Mi=()=>{"none"!=this.Li.elements.theme.value?Yt.setTheme(this.Li.elements.theme.value):window.localStorage.getItem("modboxTheme")?Yt.setTheme(String(window.localStorage.getItem("modboxTheme"))):Yt.setTheme("default"),this.Li.elements.theme.value!=this.$.song.setSongTheme?(this.hasChanged=!0,this.wi.innerHTML="Save"):(this.hasChanged=!1,this.wi.innerHTML="Cancel")},this.Si=()=>{this.themeContainer.style.opacity="0",this.previewExit.style.pointerEvents="",this.Ci.style.opacity="1"},this.Fi=()=>{this.themeContainer.style.opacity="1",this.previewExit.style.pointerEvents="none",this.Ci.style.opacity="0"},this.cleanUp=()=>{this.wi.removeEventListener("click",this.Yn)},this.wi.addEventListener("click",this.Yn),this.ki.addEventListener("click",this.Si),this.previewExit.addEventListener("click",this.Fi),this.Li.addEventListener("change",this.Mi),"none"!=this.$.song.setSongTheme?this.Li.elements.theme.value=this.$.song.setSongTheme:this.Li.elements.theme.value="none"}}class rn{static setLayout(t){this.rt.textContent=this.Bi[t]}}rn.Bi={small:"",full:"\t\tbody {\n\t\t\tmargin: 0;\n\t\t}\n\n\t\t.centerDiv {\n\t\t\twidth: unset !important;\n\t\t}\n\n\t\t#beepboxEditorContainer {\n\t\t\twidth: 100% !important;\n\t\t\theight: 100vh !important;\n\t\t}\n\t\t\n\t\t.modTitle {\n\t\tdisplay: none;\n\t\t}\n\n\t\t.beepboxEditor {\n\t\t\twidth: 100%;\n\t\t\theight: 100vh;\n\t\t\tgrid-template-columns: var(--full-layout-columns);\n\t\t\tgrid-template-rows: minmax(0px, min-content) minmax(0px, 1fr) minmax(0, min-content);\n\t\t\toverflow-y: hidden;\n\t\t}\n\n\t\t.editorBox {\n\t\t\theight: unset !important;\n\t\t}\n\n\t\t.trackContainer {\n\t\t\twidth: unset !important;\n\t\t\toverflow-x: scroll !important;\n\t\t}\n\n\t\t.beepboxEditor .trackAndMuteContainer {\n\t\t\twidth: 100%;\n\t\t\tmin-height: 0;\n\t\t\tflex: 1;\n\t\t\toverflow: auto;\n\t\t}\n\n\t\t.trackArea {\n\t\t\toverflow-y: scroll;\n\t\t}\n\n\t\t.barScrollBar {\n\t\t\tdisplay: none !important;\n\t\t}\n\t\t",middle:'\t\t\t\tbody {\n\t\t\tmargin: 0;\n\t\t}\n\n\t\t.centerDiv {\n\t\t\twidth: unset !important;\n\t\t}\n\n\t\t.modTitle {\n\t\tdisplay: none;\n\t\t}\n\n\t\t#beepboxEditorContainer {\n\t\t\twidth: 100% !important;\n\t\t\theight: 100vh !important;\n\t\t}\n\t\t\n\t\t.beepboxEditor {\n\t\t\twidth: 100%;\n\t\t\theight: 100vh;\n\t\t\tgrid-template-areas:\n\t\t\t\t"settings-area      pattern-area  advanced-settings-area" \n\t\t\t\t"song-settings-area pattern-area  advanced-settings-area" \n\t\t\t\t"song-settings-area track-area    advanced-settings-area" !important;\n\t\t\tgrid-template-columns: var(--middle-layout-columns);\n\t\t\tgrid-template-rows: minmax(0px, min-content) minmax(0px, 1fr) minmax(0, min-content);\n\t\t\toverflow-y: hidden;\n\t\t}\n\n\t\t.settings-area {\n\t\t\tmargin-left: 0 !important;\n\t\t\tmargin-right: 6px !important;\n\t\t}\n\n\t\t.song-settings-area {\n\t\t\tmargin-left: 0 !important;\n\t\t\tmargin-right: 6px !important;\n\t\t}\n\n\t\t.editorBox {\n\t\t\theight: unset !important;\n\t\t}\n\n\t\t.trackContainer {\n\t\t\twidth: unset !important;\n\t\t\toverflow-x: scroll !important;\n\t\t}\n\n\t\t.trackArea {\n\t\t\toverflow-y: scroll;\n\t\t}\n\n\t\t.beepboxEditor .trackAndMuteContainer {\n\t\t\twidth: 100%;\n\t\t\tmin-height: 0;\n\t\t\tflex: 1;\n\t\t\toverflow: auto;\n\t\t}\n\n\t\t.barScrollBar {\n\t\t\tdisplay: none !important;\n\t\t}\n\t\t',flow:'\t\tbody {\n\t\t\tmargin: 0;\n\t\t}\n\n\t\t.beepboxEditor {\n\t\t\twidth: 100%;\n\t\t\theight: 100vh;\n\t\t\tgrid-template-areas:\n\t\t\t\t"settings-area settings-area         " \n\t\t\t\t"song-settings-area     pattern-area" \n\t\t\t\t"advanced-settings-area pattern-area"\n\t\t\t\t"advanced-settings-area track-area  " !important;\n\t\t\tgrid-template-columns: 190px minmax(0, 1fr);\n\t\t\tgrid-template-rows: minmax(0px, min-content) minmax(0px, min-content) minmax(0px, 1fr);\n\t\t\toverflow-y: hidden;\n\t\t}\n\n\t\t.advanced-settings-area {\n\t\toverflow-y: scroll;\n\t\t}\n\n\t\t.centerDiv {\n\t\t\twidth: unset !important;\n\t\t}\n\n\t\t#beepboxEditorContainer {\n\t\t\twidth: 100% !important;\n\t\t\theight: 100vh !important;\n\t\t}\n\t\t\n\t\t.modTitle {\n\t\tdisplay: none;\n\t\t}\n\n\t\t.editorBox {\n\t\t\theight: unset !important;\n\t\t}\n\n\t\t.trackContainer {\n\t\t\twidth: unset !important;\n\t\t\toverflow-x: scroll !important;\n\t\t}\n\n\t\t.beepboxEditor .trackAndMuteContainer {\n\t\t\twidth: 100%;\n\t\t\tmin-height: 0;\n\t\t\tflex: 1;\n\t\t\toverflow: auto;\n\t\t}\n\n\t\t.trackArea {\n\t\t\toverflow-y: scroll;\n\t\t}\n\n\t\t.barScrollBar {\n\t\t\tdisplay: none !important;\n\t\t}\n\n\t\t.beepboxEditor .editor-settings {\n\t\t\tmargin-right: 6px;\n\t\t}\n\n\t\t.settings-area {\n\t\t\twidth: 50% !important;\n  \t\t\tgap: 3px !important;\n\t\t\tflex-direction: row !important;\n\t\t}\n\n\t\t.settings-area .title {\n\t\t\tflex: 1;\n\t\t}\n\n\t\t.settings-area .controller {\n\t\t\tflex-direction: row-reverse !important;\n\t\t\tflex: 3;\n\t\t}\n\n\t\t.settings-area .controller div {\n\t\t\tflex: 1;\n\t\t}\n\n\t\t.settings-area .editor-widgets {\n\t\t\tflex: 1;\n\t\t}\n\n\t\t.settings-area .editor-widgets .editor-menus {\n\t\t\tflex-direction: row;\n\t\t\tgap: 3px;\n\t\t\tmargin-top: .2em;\n\t\t\twidth: 0 !important;\n\t\t}\n\n\t\t.settings-area .editor-widgets .editor-menus .selectContainer {\n\t\t\tdisplay: flex;\n  \t\t\tjustify-content: center;\n\t\t}\n\n\t\t.settings-area .editor-widgets .editor-menus svg {\n\t\t\tleft: unset !important;\n\t\t}\n\n\t\t.settings-area .editor-widgets .editor-menus .selectContainer select {\n\t\t\twidth: 0 !important;\n\t\t}\n\n\t\t.beepboxEditor .selectContainer.menu::after {\n\t\t\tcontent: none !important;\n\t\t}\n\n\t\t.beepboxEditor .settings-area .editor-widgets .editor-menus {\n\t\t\twidth: 8em !important;\n\t\t}\n\n\t\t'},rn.rt=document.head.appendChild(u.style({type:"text/css"}));const{button:on,label:cn,div:ln,form:pn,input:fn}=u;class dn{constructor(t){this.$=t,this.si=fn({type:"file",accept:".json,application/json,.mid,.midi,audio/midi,audio/x-midi"}),this.ui=on({class:"okayButton",style:"flex:1;"},"Okay"),this.Gn=on({style:"flex: 1; width: 0;"},"Cancel"),this.Li=pn({style:"display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; max-height: 265px; overflow-y: scroll; overflow-x: hidden;"},cn({class:"layout-option"},fn({type:"radio",name:"layout",value:"small"}),b('\t\t\t\t\t<svg viewBox="-4 -1 28 22">\n\t\t\t\t\t\t<rect x="0" y="0" width="20" height="20" fill="none" stroke="currentColor" stroke-width="1"/>\n\t\t\t\t\t\t<rect x="2" y="2" width="11" height="10" fill="currentColor"/>\n\t\t\t\t\t\t<rect x="14" y="2" width="4" height="16" fill="currentColor"/>\n\t\t\t\t\t\t<rect x="2" y="13" width="11" height="5" fill="currentColor"/>\n\t\t\t\t\t</svg>\n\t\t\t\t'),ln("Small")),cn({class:"layout-option"},fn({type:"radio",name:"layout",value:"full"}),b('\t\t\t\t\t<svg viewBox="-1 -1 28 22">\n\t\t\t\t\t\t<rect x="0" y="0" width="26" height="20" fill="none" stroke="currentColor" stroke-width="1"/>\n\t\t\t\t\t\t<rect x="2" y="2" width="12" height="10" fill="currentColor"/>\n\t\t\t\t\t\t<rect x="15" y="2" width="4" height="16" fill="currentColor"/>\n\t\t\t\t\t\t<rect x="20" y="2" width="4" height="16" fill="currentColor"/>\n\t\t\t\t\t\t<rect x="2" y="13" width="12" height="5" fill="currentColor"/>\n\t\t\t\t\t</svg>\n\t\t\t\t'),ln("Full")),cn({class:"layout-option"},fn({type:"radio",name:"layout",value:"middle"}),b('\t\t\t\t\t<svg viewBox="-1 -1 28 22">\n\t\t\t\t\t\t<rect x="0" y="0" width="26" height="20" fill="none" stroke="currentColor" stroke-width="1"/>\n\t\t\t\t\t\t<rect x="7" y="2" width="12" height="10" fill="currentColor"/>\n\t\t\t\t\t\t<rect x="2" y="2" width="4" height="16" fill="currentColor"/>\n\t\t\t\t\t\t<rect x="20" y="2" width="4" height="16" fill="currentColor"/>\n\t\t\t\t\t\t<rect x="7" y="13" width="12" height="5" fill="currentColor"/>\n\t\t\t\t\t</svg>\n\t\t\t\t'),ln("Middle")),cn({class:"layout-option"},fn({type:"radio",name:"layout",value:"flow"}),b('\t\t\t\t\t<svg viewBox="-1 -1 28 22">\n\t\t\t\t\t\t<rect x="0" y="0" width="26" height="20" fill="none" stroke="currentColor" stroke-width="1"/>\n\t\t\t\t\t\t<rect x="7" y="5" width="17" height="7" fill="currentColor"/>\n\t\t\t\t\t\t<rect x="2" y="2" width="22" height="2" fill="currentColor"/>\n\t\t\t\t\t\t<rect x="2" y="5" width="4" height="13" fill="currentColor"/>\n\t\t\t\t\t\t<rect x="7" y="13" width="17" height="5" fill="currentColor"/>\n\t\t\t\t\t</svg>\n\t\t\t\t'),ln("Flow"))),this.container=ln({class:"prompt noSelection",style:"width: 300px;"},ln({style:"font-size: 2em"},ln("Layouts")),this.Li,ln({style:"display: flex; flex-direction: row; justify-content: space-between; gap: 3px;"},this.Gn,this.ui)),this.Yn=()=>{this.$.undo()},this.cleanUp=()=>{this.ui.removeEventListener("click",this.Pi),this.Gn.removeEventListener("click",this.Yn),this.container.removeEventListener("keydown",this.Ei)},this.Ei=t=>{"BUTTON"!=t.target.tagName&&13==t.keyCode&&this.Pi()},this.Pi=()=>{window.localStorage.setItem("layout",this.Li.elements.layout.value),this.$.prefs.layout=this.Li.elements.layout.value,rn.setLayout(this.$.prefs.layout),this.Yn()},this.si.select(),setTimeout((()=>this.si.focus())),this.ui.addEventListener("click",this.Pi),this.Gn.addEventListener("click",this.Yn),this.container.addEventListener("keydown",this.Ei),this.Li.elements.layout.value=this.$.prefs.layout}}const{button:yn,div:mn,span:un,select:bn,option:gn,input:xn,a:wn}=u,vn=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|android|ipad|playbook|silk/i.test(navigator.userAgent);let kn="none";function Cn(t,e){for(let n=0;n<e.length;n++)t.appendChild(gn({value:n},e[n]));return t}function Ln(t,e){t.selectedIndex!=e&&(t.selectedIndex=e)}class Mn{constructor(t,e,n){this.input=t,this.$=e,this.Ri=n,this.an=null,this.Ni=0,this.Ti=0,this.Oi=()=>{this.$.lastChangeWas(this.an)||(this.Ti=this.Ni),this.an=this.Ri(this.Ti,parseInt(this.input.value)),this.$.setProspectiveChange(this.an)},this.Di=()=>{this.$.record(this.an),this.an=null},t.addEventListener("input",this.Oi),t.addEventListener("change",this.Di)}updateValue(t){this.Ni=t,this.input.value=String(t)}}class Sn{constructor(t){this.$=t,this.prompt=null,this.Ii=new Qt(this.$),this.Ai=new ne(this.$),this.$i=new se(this.$),this.bn=mn({class:"trackContainer"},this.Ai.container,this.$i.container),this.ji=mn({style:"position: absolute; width: 100%; height: 100%; pointer-events: none;"}),this.zi=new ae(this.$,this.bn),this.Bn=new pe(this.$),this._i=new oe(this.$,this.Bn),this.Wi=mn({class:"editorBox",style:"height: 481px; display: flex; flex-direction: row; margin-bottom: 6px;"},this.Bn.container,this.Ii.container,this._i.container),this.Vi=mn({class:"trackAndMuteContainer prefers-big-scrollbars"},this.bn,this.ji),this.Ui=mn({class:"track-area"},this.Vi,this.zi.container),this.Hi=yn({style:"width:0; flex:2;",type:"button"}),this.Gi=yn({class:"prevBarButton",style:"width: 0; margin: 0px; flex:1; margin-left: 0px;",type:"button",title:"Prev Bar (left bracket)"}),this.Yi=yn({class:"nextBarButton",style:"width: 0; margin: 0px; flex:1; margin-left: 0px;",type:"button",title:"Next Bar (right bracket)"}),this.qi=xn({title:"main volume",style:"flex:1; margin: 0px;",type:"range",min:"0",max:"100",value:"50",step:"1"}),this.Ki=bn({style:"width: 100%;"},gn({selected:!0,disabled:!0,hidden:!1},"File Menu"),gn({value:"cleanS"},"New Song"),gn({value:"import"},"Import JSON..."),gn({value:"export"},"Export Song..."),gn({value:"shortenUrl"},"Shorten Song Url..."),gn({value:"songdata"},"Song Data..."),gn({value:"manual"},"Open Manual...")),this.Ji=bn({style:"width: 100%;"},gn({selected:!0,disabled:!0,hidden:!1},"Edit Menu"),gn({value:"undo"},"Undo (Z)"),gn({value:"redo"},"Redo (Y)"),gn({value:"copy"},"Copy Pattern (C)"),gn({value:"cut"},"Cut Pattern (X)"),gn({value:"paste"},"Paste Pattern (V)"),gn({value:"transposeUp"},"Shift Notes Up (+)"),gn({value:"transposeDown"},"Shift Notes Down (-)"),gn({value:"duration"},"Custom Song Size (Q)"),gn({value:"songTheme"},"Set Song Theme...")),this.Qi=bn({style:"width: 100%;"},gn({selected:!0,disabled:!0,hidden:!1},"Preferences Menu"),gn({value:"autoPlay"},"Auto Play On Load"),gn({value:"autoFollow"},"Auto Follow Track"),gn({value:"showLetters"},"Show Piano"),gn({value:"showFifth"},"Highlight 'Fifth' Notes"),gn({value:"showMore"},"Advanced Color Scheme"),gn({value:"showChannels"},"Show All Channels"),gn({value:"showScrollBar"},"Octave Scroll Bar"),gn({value:"showVolumeBar"},"Show Channel Volume"),gn({value:"advancedSettings"},"Enable Advanced Settings"),gn({value:"themes"},"Set Theme..."),gn({value:"layouts"},"Set Layout...")),this.Xi=yn({type:"button"},mn({},"New"),un({class:"fullWidthOnly"},mn({}," Song")),b.svg({style:"flex-shrink: 0; position: absolute; left: 0; top: 50%; margin-top: -1em; pointer-events: none;",width:"2em",height:"2em",viewBox:"-5 -21 26 26"},b.path({d:"M 2 0 L 2 -16 L 10 -16 L 14 -12 L 14 0 z M 3 -1 L 13 -1 L 13 -11 L 9 -11 L 9 -15 L 3 -15 z",fill:"currentColor"}))),this.Zi=yn({type:"button"},mn({},"Song Data"),b.svg({style:"flex-shrink: 0; position: absolute; left: 0; top: 50%; margin-top: -1em; pointer-events: none;",width:"2em",height:"2em",viewBox:"-5 -21 26 26"},b.path({d:"M 0 0 L 16 0 L 16 -13 L 10 -13 L 8 -16 L 0 -16 L 0 -13 z",fill:"currentColor"}))),this.ts=yn({type:"button"},un({class:"center"},mn({},"Custom Song Size")),b.svg({style:"flex-shrink: 0; position: absolute; left: 0; top: 50%; margin-top: -1em; pointer-events: none;",width:"2em",height:"2em",viewBox:"-13 -13 26 26"},b.path({d:"M -8 2 L -2 2 L -2 8 L 2 8 L 2 2 L 8 2 L 8 -2 L 2 -2 L 2 -8 L -2 -8 L -2 -2 L -8 -2 z M 0 2 L -4 -2 L -1 -2 L -1 -8 L 1 -8 L 1 -2 L 4 -2 z M -8 -8 L 8 -8 L 8 -9 L -8 -9 L -8 -8 z",fill:"currentColor"}))),this.es=yn({type:"button"},un({class:"center"},mn({},"Load Mods...")),b.svg({style:"flex-shrink: 0; position: absolute; left: 0; top: 50%; margin-top: -1em; pointer-events: none;",width:"2em",height:"2em",viewBox:"-13 -13 26 26"},b.path({d:"M 5.78 -1.6 L 7.93 -0.94 L 7.93 0.94 L 5.78 1.6 L 4.85 3.53 L 5.68 5.61 L 4.21 6.78 L 2.36 5.52 L 0.27 5.99 L -0.85 7.94 L -2.68 7.52 L -2.84 5.28 L -4.52 3.95 L -6.73 4.28 L -7.55 2.59 L -5.9 1.07 L -5.9 -1.07 L -7.55 -2.59 L -6.73 -4.28 L -4.52 -3.95 L -2.84 -5.28 L -2.68 -7.52 L -0.85 -7.94 L 0.27 -5.99 L 2.36 -5.52 L 4.21 -6.78 L 5.68 -5.61 L 4.85 -3.53 M 2.92 0.67 L 2.92 -0.67 L 2.35 -1.87 L 1.3 -2.7 L 0 -3 L -1.3 -2.7 L -2.35 -1.87 L -2.92 -0.67 L -2.92 0.67 L -2.35 1.87 L -1.3 2.7 L -0 3 L 1.3 2.7 L 2.35 1.87 z",fill:"currentColor"}))),this.ns=yn({type:"button",style:"width: 45%; margin: 0px; margin-top: -2px;"},mn({},"Undo")),this.ss=yn({type:"button",style:"width: 45%; margin: 0px; margin-top: -2px;"},mn({},"Redo")),this.hs=yn({type:"button"},mn({},"Export"),b.svg({style:"flex-shrink: 0; position: absolute; left: 0; top: 50%; margin-top: -1em; pointer-events: none;",width:"2em",height:"2em",viewBox:"-13 -13 26 26"},b.path({d:"M -8 3 L -8 8 L 8 8 L 8 3 L 6 3 L 6 6 L -6 6 L -6 3 z M 0 2 L -4 -2 L -1 -2 L -1 -8 L 1 -8 L 1 -2 L 4 -2 z",fill:"currentColor"}))),this.rs=Cn(bn({}),s.scales.map((t=>t.name))),this.os=Cn(bn({}),s.mixNames),this.cs=Cn(bn({}),s.sampleRateNames),this.ls=wn({class:"hintButton"},mn({},"?")),this.ps=wn({class:"hintButton"},mn({},"?")),this.fs=mn({class:"selectRow"},this.os),this.ds=wn({class:"hintButton"},mn({},"?")),this.ys=Cn(bn({}),s.keys.map((t=>t.name)).reverse()),this.us=xn({class:"numberInput",style:"margin-left:0.5em",type:"number",min:s.tempoMin,max:s.tempoMax}),this.bs=new Mn(xn({style:"margin: 0px;",type:"range",min:s.tempoMin,max:s.tempoMax,value:"160",step:"1"}),this.$,((t,e)=>new Tt(this.$,t,e))),this.gs=new Mn(xn({style:"margin: 0px;",type:"range",min:"0",max:s.reverbRange-1,value:"0",step:"1"}),this.$,((t,e)=>new Ot(this.$,t,e))),this.xs=new Mn(xn({style:"margin: 0px;",type:"range",min:"0",max:s.blendRange-1,value:"0",step:"1"}),this.$,((t,e)=>new Dt(this.$,t,e))),this.ws=new Mn(xn({style:"margin: 0px;",type:"range",min:"0",max:s.riffRange-1,value:"0",step:"1"}),this.$,((t,e)=>new It(this.$,t,e))),this.vs=new Mn(xn({style:"margin: 0px;",type:"range",min:"0",max:s.detuneRange-1,value:"0",step:"1"}),this.$,((t,e)=>new At(this.$,t,e))),this.ks=new Mn(xn({style:"margin: 0px;",type:"range",min:"0",max:s.muffRange-1,value:"0",step:"1"}),this.$,((t,e)=>new $t(this.$,t,e))),this.Cs=yn({style:"width: 27px; margin-left: 0.5em;",type:"button"}),this.Ls=yn({style:"width: 27px; margin-left: 0.5em;",type:"button"}),this.Ms=Cn(bn({}),s.partNames),this.Ss=function(t,e,n){if(e.length!=n.length)throw new Error("items and values don't have the same length");for(let i=0;i<e.length;i++){const s=e[i],h=n[i];t.appendChild(gn({value:h},s))}return t}(bn({}),s.pitchChannelTypeNames,s.pitchChannelTypeValues),this.Fs=mn({class:"selectRow"},un({},mn({style:"display:flex;"},"Type: ",this.ds)),mn({class:"selectContainer"},this.Ss)),this.Bs=Cn(bn({}),s.operatorAlgorithmNames),this.Ps=mn({class:"selectRow"},un({},mn({},"Algorithm: ")),mn({class:"selectContainer"},this.Bs)),this.Es=bn({}),this.Rs=xn({class:"numberInput",type:"number",min:1}),this.Ns=mn({class:"selectRow",style:"display: none;"},un({},mn({},"Instrument: ")),mn({class:"inputContainer"},this.Rs)),this.Ts=new Mn(xn({type:"range",min:"-9",max:"0",value:"0",step:"1"}),this.$,((t,e)=>new Ut(this.$,t,-e))),this.Os=new Mn(xn({type:"range",min:"-5",max:"0",value:"0",step:"1"}),this.$,((t,e)=>new Ut(this.$,t,-e))),this.Ds=mn({class:"selectRow"},un({},mn({},"Volume: ")),mn({style:"display: flex; flex-direction: row;"},this.Ts.input,this.Cs)),this.Is=mn({class:"selectRow"},un({},mn({},"Volume: ")),mn({style:"display: flex; flex-direction: row;"},this.Os.input,this.Ls)),this.As=mn({style:"margin: 3px 0; text-align: center; color: rgb(170, 170, 170);"},mn({},"Settings")),this.$s=mn({style:"margin: 3px 0; text-align: center;"},mn({},"Advanced Instrument Settings")),this.js=Cn(bn({}),s.waveNames),this.zs=Cn(bn({}),s.drumNames),this._s=Cn(bn({}),s.pwmwaveNames),this.Ws=mn({class:"selectRow"},un({},mn({},"Wave: ")),mn({class:"selectContainer"},this.js,this._s,this.zs)),this.Vs=Cn(bn({}),s.transitionNames),this.Us=Cn(bn({}),s.filterNames),this.Hs=mn({class:"selectRow"},un({},mn({},"Filter: ")),mn({class:"selectContainer"},this.Us)),this.Gs=Cn(bn({}),s.chorusNames),this.Ys=wn({class:"hintButton"},mn({},"?")),this.qs=mn({class:"selectRow"},un({},mn({},"Chorus: ")),mn({class:"selectContainer"},this.Gs)),this.Ks=Cn(bn({}),s.effectNames),this.Js=mn({class:"selectRow"},un({},mn({},"Effect: ")),mn({class:"selectContainer"},this.Ks)),this.Qs=Cn(bn({}),s.harmDisplay),this.Xs=mn({class:"selectRow"},un({},mn({style:"display:flex;"},"Chord: ",this.Ys)),mn({class:"selectContainer"},this.Qs)),this.Zs=Cn(bn({}),s.octoffNames),this.th=mn({class:"selectRow"},un({},mn({},"Octave Offset: ")),mn({class:"selectContainer"},this.Zs)),this.eh=Cn(bn({}),s.fmChorusDisplay),this.nh=mn({class:"selectRow"},un({},mn({},"FM Chorus: ")),mn({class:"selectContainer"},this.eh)),this.ih=new Mn(xn({type:"range",min:"-8",max:"0",value:"0",step:"1"}),this.$,((t,e)=>new ht(this.$,t,-e))),this.sh=mn({class:"selectRow"},un({},mn({},"Panning: ")),mn({style:"display:flex;"},un({style:"margin-right: 0.5em; align-content: center;"},mn({},"L")),this.ih.input,un({style:"margin-left: 0.5em; align-content: center;"},mn({},"R")))),this.hh=mn({style:"display: flex; flex-direction: column; display: none;"}),this.ah=Cn(bn({}),s.operatorFeedbackNames),this.rh=mn({class:"selectRow"},un({},mn({},"Feedback:")),mn({class:"selectContainer"},this.ah)),this.oh=new Mn(xn({style:"margin: 0px; flex: 1; width: 4em;",type:"range",min:"0",max:s.operatorAmplitudeMax,value:"0",step:"1",title:"Feedback Amplitude"}),this.$,((t,e)=>new dt(this.$,t,e))),this.ph=Cn(bn({style:"width: 100%;",title:"Feedback Envelope"}),s.operatorEnvelopeNames),this.fh=mn({class:"operatorRow"},this.oh.input,mn({class:"selectContainer",style:"width:0; margin-left: .3em;"},this.ph)),this.dh=yn({style:"flex: 1; border-bottom: solid 2px var(--link-accent);"},"Song"),this.yh=yn({style:"flex: 1;"},"Instrument"),this.mh=mn({style:"display: flex; gap: 3px;"},this.dh,this.yh),this.uh=mn({style:"display:none;"},this.Ns,this.Fs,this.Is,this.Ds,this.Ws,mn({class:"selectRow"},un({},mn({},"Transitions: ")),mn({class:"selectContainer"},this.Vs)),this.Hs,this.qs,this.Js,this.Ps,this.hh,this.rh,this.fh),this.bh=mn({class:"editor-song-settings"},mn({class:"selectRow"},un({},mn({},"Scale: ")),mn({class:"selectContainer",style:"margin: 3px 0; text-align: center; color: #ccc;"},this.rs)),mn({class:"selectRow"},un({},mn({},"Key: ")),mn({class:"selectContainer",style:"margin: 3px 0; text-align: center; color: #ccc;"},this.ys)),mn({class:"selectRow"},un({},mn({},"Tempo: ")),mn({style:"display: flex; flex-direction: row;"},this.bs.input,this.us)),mn({class:"selectRow"},un({},mn({},"Reverb: ")),this.gs.input),mn({class:"selectRow"},un({},mn({},"Rhythm: ")),mn({class:"selectContainer",style:"margin: 3px 0; text-align: center; color: #ccc;"},this.Ms))),this.gh=mn({},this.$s,this.sh,this.Xs,this.th,this.nh),this.xh=mn({class:"promptContainer",id:"promptContainer",style:"display: none;"}),this.wh=mn({class:"editor-song-settings",style:"margin: 0px 5px;"},mn({style:"margin: 3px 0; text-align: center;"},mn({},"Advanced Song Settings")),mn({class:"selectRow"},un({},mn({style:"display: flex;"},"Mix: ",this.ls)),mn({class:"selectContainer"},this.fs)),mn({class:"selectRow"},un({},mn({},"Sample Rate: ")),mn({class:"selectContainer"},this.cs)),mn({class:"selectRow"},un({},mn({},"Blending: ")),this.xs.input),mn({class:"selectRow"},un({},mn({},"Riff: ")),this.ws.input),mn({class:"selectRow"},un({},mn({},"Detune: ")),this.vs.input),mn({class:"selectRow"},un({},mn({},"Muff: ")),this.ks.input)),this.kh=mn({class:"advanced-settings-area",style:"margin: 0px 5px;"},mn({class:"editor-widgets"},mn({style:"text-align: center;"},mn({},"Advanced Settings")),mn({style:"margin: 2px 0; display: flex; flex-direction: row; align-items: center;"}),mn({class:"editor-menus"},mn({style:"margin: 5px 0; display: flex; flex-direction: row; justify-content: space-between;"},this.Gi,this.ns,this.ss,this.Yi)),mn({class:"editor-settings"},this.wh,mn({class:"editor-instrument-settings"},this.gh)))),this.mainLayer=mn({class:"beepboxEditor",tabIndex:"0"},this.Wi,this.Ui,mn({class:"settings-area"},mn({class:"title",style:"align-items: center; display: flex; justify-content: center;"},mn({},"Neo NepBox")),mn({class:"controller",style:"margin: 5px 0; gap: 3px; display: flex; flex-direction: column; align-items: center;"},mn({style:"display:flex; flex-direction:row;"},b.svg({width:"2em",height:"2em",viewBox:"0 0 26 26"},b.path({d:"M 4 17 L 4 9 L 8 9 L 12 5 L 12 21 L 8 17 z",fill:Yt.volumeIcon}),b.path({d:"M 15 11 L 16 10 A 7.2 7.2 0 0 1 16 16 L 15 15 A 5.8 5.8 0 0 0 15 12 z",fill:Yt.volumeIcon}),b.path({d:"M 18 8 L 19 7 A 11.5 11.5 0 0 1 19 19 L 18 18 A 10.1 10.1 0 0 0 18 8 z",fill:Yt.volumeIcon})),this.qi),mn({style:"display: flex; flex-direction: row; align-items: center; width:100%; gap: 3px;"},this.Hi,this.Gi,this.Yi)),mn({class:"editor-widgets"},mn({class:"editor-menus"},mn({class:"selectContainer menu"},this.Ki,b.svg({style:"flex-shrink: 0; position: absolute; left: 0; top: 50%; margin-top: -1em; pointer-events: none;",width:"2em",height:"2em",viewBox:"-5 -21 26 26"},b.path({d:"M 0 0 L 16 0 L 16 -13 L 10 -13 L 8 -16 L 0 -16 L 0 -13 z",fill:"currentColor"}))),mn({class:"selectContainer menu"},this.Ji,b.svg({style:"flex-shrink: 0; position: absolute; left: 0; top: 50%; margin-top: -1em; pointer-events: none;",width:"2em",height:"2em",viewBox:"-5 -21 26 26"},b.path({d:"M 0 0 L 1 -4 L 4 -1 z M 2 -5 L 10 -13 L 13 -10 L 5 -2 zM 11 -14 L 13 -16 L 14 -16 L 16 -14 L 16 -13 L 14 -11 z",fill:"currentColor"}))),mn({class:"selectContainer menu"},this.Qi,b.svg({style:"flex-shrink: 0; position: absolute; left: 0; top: 50%; margin-top: -1em; pointer-events: none;",width:"2em",height:"2em",viewBox:"-13 -13 26 26"},b.path({d:"M 5.78 -1.6 L 7.93 -0.94 L 7.93 0.94 L 5.78 1.6 L 4.85 3.53 L 5.68 5.61 L 4.21 6.78 L 2.36 5.52 L 0.27 5.99 L -0.85 7.94 L -2.68 7.52 L -2.84 5.28 L -4.52 3.95 L -6.73 4.28 L -7.55 2.59 L -5.9 1.07 L -5.9 -1.07 L -7.55 -2.59 L -6.73 -4.28 L -4.52 -3.95 L -2.84 -5.28 L -2.68 -7.52 L -0.85 -7.94 L 0.27 -5.99 L 2.36 -5.52 L 4.21 -6.78 L 5.68 -5.61 L 4.85 -3.53 M 2.92 0.67 L 2.92 -0.67 L 2.35 -1.87 L 1.3 -2.7 L 0 -3 L -1.3 -2.7 L -2.35 -1.87 L -2.92 -0.67 L -2.92 0.67 L -2.35 1.87 L -1.3 2.7 L -0 3 L 1.3 2.7 L 2.35 1.87 z",fill:"currentColor"})))))),mn({class:"song-settings-area editor-settings"},this.As,this.mh,this.bh,mn({class:"editor-instrument-settings"},this.uh)),this.kh,this.xh),this.Ch=null,this.Lh=[],this.Mh=[],this.Sh=[],this.Fh=[],this.Bh=()=>{this.mainLayer.focus()},this.whenUpdated=()=>{const t=this.bn.getBoundingClientRect();this.$.trackVisibleBars=Math.floor((t.right-t.left)/32),this.zi.render(),this.Ai.render(),this.Ii.render(),this.$.song.setSongTheme!=kn&&("none"==this.$.song.setSongTheme?null!=window.localStorage.getItem("modboxTheme")?Yt.setTheme(String(window.localStorage.getItem("modboxTheme"))):(window.localStorage.setItem("modboxTheme","default"),Yt.setTheme("default")):Yt.setTheme(this.$.song.setSongTheme),kn=this.$.song.setSongTheme),document.documentElement.style.setProperty("--full-layout-columns",this.$.prefs.advancedSettings?"minmax(0, 1fr) 190px 200px":"minmax(0, 1fr) 190px"),document.documentElement.style.setProperty("--middle-layout-columns",this.$.prefs.advancedSettings?"190px minmax(0, 1fr) 200px":"190px minmax(0, 1fr)");const e=[(this.$.prefs.autoPlay?"âœ“ ":"âœ— ")+"Auto Play On Load",(this.$.prefs.autoFollow?"âœ“ ":"âœ— ")+"Auto Follow Track",(this.$.prefs.showLetters?"âœ“ ":"âœ— ")+"Show Piano",(this.$.prefs.showFifth?"âœ“ ":"âœ— ")+"Highlight 'Fifth' Notes",(this.$.prefs.showMore?"âœ“ ":"âœ— ")+"Advanced Color Scheme",(this.$.prefs.showChannels?"âœ“ ":"âœ— ")+"Show All Channels",(this.$.prefs.showScrollBar?"âœ“ ":"âœ— ")+"Octave Scroll Bar",(this.$.prefs.showVolumeBar?"âœ“ ":"âœ— ")+"Show Channel Volume",(this.$.prefs.advancedSettings?"âœ“ ":"âœ— ")+"Enable Advanced Settings","  Set Theme..."];for(let t=0;t<e.length;t++){const n=this.Qi.children[t+1];n.innerText!=e[t]&&(n.innerText=e[t])}const n=this.$.song.channels[this.$.channel],i=this.$.getCurrentPattern(),h=this.$.getCurrentInstrument(),a=n.instruments[h],r=this.mainLayer.contains(document.activeElement);let o=(document.activeElement,document.activeElement);var c,l;this.$.channel>=this.$.song.pitchChannelCount+this.$.song.drumChannelCount&&this.Bn.forceRender(),Ln(this.rs,this.$.song.scale),Ln(this.os,this.$.song.mix),Ln(this.cs,this.$.song.sampleRate),Ln(this.ys,s.keys.length-1-this.$.song.key),this.bs.updateValue(this.$.song.tempo),this.us.value=String(this.$.song.tempo),this.bs.input.title=this.$.song.getBeatsPerMinute()+" beats per minute",this.gs.updateValue(this.$.song.reverb),this.kh.style.display=this.$.prefs.advancedSettings?"":"none",this.xs.updateValue(this.$.song.blend),this.ws.updateValue(this.$.song.riff),this.vs.updateValue(this.$.song.detune),this.ks.updateValue(this.$.song.muff),Ln(this.Ms,s.partCounts.indexOf(this.$.song.partsPerBeat)),this.$.song.getChannelIsDrum(this.$.channel)?(2==this.$.song.mix?(this.Ds.style.display="",this.Is.style.display="none"):(this.Ds.style.display="none",this.Is.style.display=""),this.zs.style.display="",this.Ws.style.display="",this.Fs.style.display="none",this.Ss.style.display="none",this.Ps.style.display="none",this.hh.style.display="none",this.rh.style.display="none",this.fh.style.display="none",this.js.style.display="none",this._s.style.display="none",this.Hs.style.display="none",this.qs.style.display="none",this.Js.style.display="none",this.sh.style.display="",this.Xs.style.display="",this.th.style.display="",this.nh.style.display="none"):(this.Fs.style.display="",this.Ss.style.display="",this.Js.style.display="",2==this.$.song.mix?(this.Ds.style.display="",this.Is.style.display="none"):(this.Ds.style.display="none",this.Is.style.display=""),this.zs.style.display="none",0==a.type?(this.js.style.display="",this._s.style.display="none",this.Ws.style.display="",this.Hs.style.display="",this.qs.style.display="",this.Xs.style.display="",this.Ps.style.display="none",this.hh.style.display="none",this.rh.style.display="none",this.fh.style.display="none",this.sh.style.display="",this.th.style.display="",this.nh.style.display="none"):3==a.type?(this.js.style.display="none",this._s.style.display="",this.Ws.style.display="",this.Hs.style.display="none",this.qs.style.display="none",this.Xs.style.display="none",this.Ps.style.display="none",this.hh.style.display="none",this.rh.style.display="none",this.fh.style.display="none",this.sh.style.display="",this.th.style.display="",this.nh.style.display="none"):(this.Ps.style.display="",this.hh.style.display="",this.rh.style.display="",this.fh.style.display="",this.Xs.style.display="none",this.Ws.style.display="none",this.Hs.style.display="none",this.qs.style.display="none",this.sh.style.display="",this.th.style.display="",this.nh.style.display="")),this.Ss.value=a.type+"",Ln(this.Bs,a.algorithm),this.Ns.style.display=this.$.song.instrumentsPerChannel>1?"":"none",this.Ns.style.visibility=null==i?"hidden":"",this.Rs.max!=String(this.$.song.instrumentsPerChannel)&&(this.Rs.max=String(this.$.song.instrumentsPerChannel)),0==a.imute?(this.uh.style.color=this.$.song.getNoteColorBright(this.$.channel),this.gh.style.color=this.$.song.getNoteColorDim(this.$.channel),this.wh.style.color="#aaaaaa",this.Cs.innerText="â—‰",this.Ls.innerText="â—‰"):(this.uh.style.color="#cccccc",this.gh.style.color="#aaaaaa",this.wh.style.color="#aaaaaa",this.Cs.innerText="â—Ž",this.Ls.innerText="â—Ž"),Ln(this.js,a.wave),Ln(this.zs,a.wave),Ln(this._s,a.wave),Ln(this.Us,a.filter),Ln(this.Vs,a.transition),Ln(this.Ks,a.effect),Ln(this.Gs,a.chorus),Ln(this.Qs,a.harm),Ln(this.Zs,a.octoff),Ln(this.eh,a.fmChorus),Ln(this.ah,a.feedbackType),this.oh.updateValue(a.feedbackAmplitude),Ln(this.ph,a.feedbackEnvelope),this.ph.parentElement.style.color=a.feedbackAmplitude>0?"":"#999",this.Ts.updateValue(-a.volume),this.Os.updateValue(-a.volume),this.ih.updateValue(-a.ipan),Ln(this.Es,h),c=this.Rs,l=String(h+1),c.value!=l&&(c.value=l);for(let t=0;t<s.operatorCount;t++){const e=t<s.operatorCarrierCounts[a.algorithm];this.Lh[t].style.color=e?"white":"",Ln(this.Fh[t],a.operators[t].frequency),this.Mh[t].updateValue(a.operators[t].amplitude),Ln(this.Sh[t],a.operators[t].envelope);const n=(e?"Voice ":"Modulator ")+(t+1);this.Fh[t].title=n+" Frequency",this.Mh[t].input.title=n+(e?" Volume":" Amplitude"),this.Sh[t].title=n+" Envelope",this.Sh[t].parentElement.style.color=a.operators[t].amplitude>0?"":"#999"}this.Bn.container.style.display=this.$.prefs.showLetters?"":"none",this._i.container.style.display=this.$.prefs.showScrollBar?"":"none",this.zi.container.style.display=this.$.song.barCount>this.$.trackVisibleBars?"":"none",this.ds.style.display=1==a.type?"":"none",this.ls.style.display=1!=this.$.song.mix?"":"none",this.Ys.style.display=s.harmNames[a.harm]?"":"none";let p=512;this.$.prefs.showLetters&&(p-=32),this.$.prefs.showScrollBar&&(p-=20),this.Ii.container.style.width=String(p)+"px",this.qi.value=String(this.$.prefs.volume),r&&0==o.clientWidth&&this.Bh(),this.Ph(this.$.prompt),this.$.prefs.autoFollow&&!this.$.synth.playing&&this.$.synth.snapToBar(this.$.bar)},this.Eh=()=>{this.bh.style.display="flex",this.uh.style.display="none",this.dh.style.borderBottom="solid 2px var(--link-accent)",this.yh.style.borderBottom=""},this.Rh=()=>{this.uh.style.display="unset",this.bh.style.display="none",this.yh.style.borderBottom="solid 2px var(--link-accent)",this.dh.style.borderBottom=""},this.Nh=()=>{const t=this.$.song.channels[this.$.channel],e=this.$.getCurrentInstrument(),n=t.instruments[e],i=1==n.imute?0:1;this.$.record(new nt(this.$,i)),0==n.imute?(this.uh.style.color=this.$.song.getNoteColorBright(this.$.channel),this.gh.style.color=this.$.song.getNoteColorDim(this.$.channel),this.wh.style.color="#aaaaaa",this.Cs.innerText="â—‰",this.Ls.innerText="â—‰"):(this.uh.style.color="#cccccc",this.gh.style.color="#aaaaaa",this.wh.style.color="#aaaaaa",this.Cs.innerText="â—Ž",this.Ls.innerText="â—Ž"),this.whenUpdated()},this.Th=()=>{this.$.record(new Tt(this.$,-1,0|parseInt(this.us.value)))},this.Oh=t=>{switch(t.keyCode){case 8:case 13:case 38:case 40:case 37:case 39:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:t.stopPropagation()}},this.Ei=t=>{if(this.prompt)27==t.keyCode&&window.history.back();else switch(t.keyCode){case 8:t.ctrlKey?this.$.channel>0&&this.$.record(new K(this.$,this.$.channel,this.$.channel)):this.$.record(new U(this.$,this.$.bar,1)),t.preventDefault();break;case 13:t.ctrlKey||t.metaKey?this.$.selection.insertChannel():this.$.record(new V(this.$,this.$.bar+1,1)),t.preventDefault();break;case 38:this.Ai.Qe((this.$.channel-1+this.$.song.getChannelCount())%this.$.song.getChannelCount(),this.$.bar),t.preventDefault();break;case 40:this.Ai.Qe((this.$.channel+1)%this.$.song.getChannelCount(),this.$.bar),t.preventDefault();break;case 37:this.Ai.Qe(this.$.channel,(this.$.bar+this.$.song.barCount-1)%this.$.song.barCount),t.preventDefault();break;case 39:this.Ai.Qe(this.$.channel,(this.$.bar+1)%this.$.song.barCount),t.preventDefault();break;case 48:this.Ai.Ze("0"),t.preventDefault();break;case 49:this.Ai.Ze("1"),t.preventDefault();break;case 50:this.Ai.Ze("2"),t.preventDefault();break;case 51:this.Ai.Ze("3"),t.preventDefault();break;case 52:this.Ai.Ze("4"),t.preventDefault();break;case 53:this.Ai.Ze("5"),t.preventDefault();break;case 54:this.Ai.Ze("6"),t.preventDefault();break;case 55:this.Ai.Ze("7"),t.preventDefault();break;case 56:this.Ai.Ze("8"),t.preventDefault();break;case 57:this.Ai.Ze("9"),t.preventDefault();break;default:this.Ai._e="";break;case 77:t.shiftKey?this.$.selection.muteAllInstruments():(this.Nh(),t.preventDefault());break;case 83:t.ctrlKey||t.metaKey?(this.Dh("export"),t.preventDefault()):(this.$.selection.soloChannels(t.shiftKey),t.preventDefault());break;case 79:(t.ctrlKey||t.metaKey)&&(this.Dh("import"),t.preventDefault());break;case 32:this.Ih(),t.preventDefault();break;case 90:t.shiftKey?this.$.redo():this.$.undo(),t.preventDefault();break;case 89:this.$.redo(),t.preventDefault();break;case 88:this.Ah(),t.preventDefault();break;case 67:this.$h(),t.preventDefault();break;case 70:t.shiftKey?this.$.synth.snapToBar(this.$.song.loopStart):this.$.synth.snapToStart(),t.preventDefault();break;case 86:this.jh(),t.preventDefault();break;case 219:this.$.synth.prevBar(),this.$.prefs.autoFollow&&new J(this.$,this.$.channel,Math.floor(this.$.synth.playhead)),t.preventDefault();break;case 221:this.$.synth.nextBar(),this.$.prefs.autoFollow&&new J(this.$,this.$.channel,Math.floor(this.$.synth.playhead)),t.preventDefault();break;case 189:case 173:this.zh(!1),t.preventDefault();break;case 187:case 61:this.zh(!0),t.preventDefault();break;case 81:this.Dh("duration"),t.preventDefault()}},this._h=()=>{this.$.synth.prevBar()},this.Wh=()=>{this.$.synth.nextBar()},this.Ih=()=>{this.$.synth.playing?this.Vh():this.Uh()},this.Hh=()=>{this.$.setVolume(Number(this.qi.value)),this.Ai.render()},this.Gh=()=>{this.$.record(new Nt(this.$,"")),this.Ii.resetCopiedPins()},this.Yh=()=>{this.Dh("duration")},this.qh=()=>{this.$.undo()},this.Kh=()=>{this.$.redo()},this.Jh=()=>{this.Dh("export")},this.Qh=()=>{this.Dh("songdata")},this.Xh=()=>{this.Dh("instrumentType")},this.Zh=()=>{this.Dh("mix")},this.ta=()=>{this.Dh("chorus")},this.ea=()=>{this.Dh("archive")},this.refreshNow=()=>{setTimeout((()=>{location.reload()}),500)},this.na=()=>{this.$.record(new Pt(this.$,this.rs.selectedIndex))},this.ia=()=>{this.$.record(new Et(this.$,this.os.selectedIndex))},this.sa=()=>{this.$.record(new Rt(this.$,this.cs.selectedIndex))},this.ha=()=>{this.$.record(new mt(this.$,s.keys.length-1-this.ys.selectedIndex))},this.aa=()=>{this.$.record(new wt(this.$,s.partCounts[this.Ms.selectedIndex]))},this.ra=()=>{this.$.record(new j(this.$,+this.Ss.value))},this.oa=()=>{this.$.record(new ot(this.$,this.ah.selectedIndex))},this.ca=()=>{this.$.record(new ct(this.$,this.ph.selectedIndex))},this.la=()=>{this.$.record(new rt(this.$,this.Bs.selectedIndex))},this.pa=()=>{const t=this.$.getCurrentPattern();null!=t&&this.$.record(new kt(this.$,Number(this.Rs.value)-1,t))},this.fa=()=>{this.$.record(new Gt(this.$,this.js.selectedIndex))},this.da=()=>{this.$.record(new Gt(this.$,this.zs.selectedIndex))},this.ya=()=>{this.$.record(new Gt(this.$,this._s.selectedIndex))},this.ma=()=>{this.$.record(new at(this.$,this.Us.selectedIndex))},this.ua=()=>{this.$.record(new z(this.$,this.Vs.selectedIndex))},this.ba=()=>{this.$.record(new X(this.$,this.Ks.selectedIndex))},this.ga=()=>{this.$.record(new Z(this.$,this.Qs.selectedIndex))},this.xa=()=>{this.$.record(new tt(this.$,this.eh.selectedIndex))},this.wa=()=>{this.$.record(new et(this.$,this.Zs.selectedIndex))},this.va=()=>{this.$.record(new Q(this.$,this.Gs.selectedIndex))},this.ka=t=>{switch(this.Ki.value){case"import":this.Dh("import");break;case"export":this.Dh("export");break;case"cleanS":this.Gh();break;case"songdata":this.Dh("songdata");break;case"manual":window.open("./manual.html");break;case"shortenUrl":window.open("https://tinyurl.com/api-create.php?url="+encodeURIComponent(new URL("#"+this.$.song.toBase64String(),location.href).href))}this.Ki.selectedIndex=0},this.Ca=t=>{switch(this.Ji.value){case"undo":this.$.undo();break;case"redo":this.$.redo();break;case"cut":this.Ah();break;case"copy":this.$h();break;case"paste":this.jh();break;case"transposeUp":this.zh(!0);break;case"transposeDown":this.zh(!1);break;case"duration":this.Dh("duration");break;case"archive":this.Dh("archive");break;case"songTheme":this.Dh("songTheme")}this.Ji.selectedIndex=0},this.La=t=>{switch(this.Qi.value){case"autoPlay":this.$.prefs.autoPlay=!this.$.prefs.autoPlay;break;case"autoFollow":this.$.prefs.autoFollow=!this.$.prefs.autoFollow;break;case"showLetters":this.$.prefs.showLetters=!this.$.prefs.showLetters;break;case"showFifth":this.$.prefs.showFifth=!this.$.prefs.showFifth;break;case"showMore":this.$.prefs.showMore=!this.$.prefs.showMore;break;case"showChannels":this.$.prefs.showChannels=!this.$.prefs.showChannels;break;case"showScrollBar":this.$.prefs.showScrollBar=!this.$.prefs.showScrollBar;break;case"showVolumeBar":this.$.prefs.showVolumeBar=!this.$.prefs.showVolumeBar;break;case"advancedSettings":this.$.prefs.advancedSettings=!this.$.prefs.advancedSettings;break;case"themes":this.Dh("themes");break;case"layouts":this.Dh("layouts")}this.Qi.selectedIndex=0,this.$.notifier.changed(),this.$.prefs.save()},this.$.notifier.watch(this.whenUpdated),this.hh.appendChild(mn({class:"operatorRow",style:"height: 1em; margin-top: 0.5em;"},mn({style:"margin-right: .1em; visibility: hidden;"},mn({},"1.")),mn({style:"width: 3em; margin-right: .3em;"},mn({},"Freq:")),mn({style:"width: 4em; margin: 0;"},mn({},"Volume:")),mn({style:"width: 5em; margin-left: .3em;"},mn({},"Envelope:"))));for(let t=0;t<s.operatorCount;t++){const e=t,n=mn({style:"margin-right: .1em; color: #999;"},mn({},t+1+".")),i=Cn(bn({style:"width: 100%;",title:"Frequency"}),s.operatorFrequencyNames),h=new Mn(xn({style:"margin: 0; width: 4em;",type:"range",min:"0",max:s.operatorAmplitudeMax,value:"0",step:"1",title:"Volume"}),this.$,((t,n)=>new ft(this.$,e,t,n))),a=Cn(bn({style:"width: 100%;",title:"Envelope"}),s.operatorEnvelopeNames),r=mn({class:"operatorRow"},n,mn({class:"selectContainer",style:"width: 3em; margin-right: .3em;"},i),h.input,mn({class:"selectContainer",style:"width: 5em; margin-left: .3em;"},a));this.hh.appendChild(r),this.Lh[t]=r,this.Mh[t]=h,this.Sh[t]=a,this.Fh[t]=i,a.addEventListener("change",(()=>{this.$.record(new lt(this.$,e,a.selectedIndex))})),i.addEventListener("change",(()=>{this.$.record(new pt(this.$,e,i.selectedIndex))}))}this.Ki.addEventListener("change",this.ka),this.Ji.addEventListener("change",this.Ca),this.Qi.addEventListener("change",this.La),this.rs.addEventListener("change",this.na),this.os.addEventListener("change",this.ia),this.cs.addEventListener("change",this.sa),this.ys.addEventListener("change",this.ha),this.Ms.addEventListener("change",this.aa),this.Ss.addEventListener("change",this.ra),this.Bs.addEventListener("change",this.la),this.Rs.addEventListener("change",this.pa),this.ah.addEventListener("change",this.oa),this.ph.addEventListener("change",this.ca),this.js.addEventListener("change",this.fa),this.zs.addEventListener("change",this.da),this._s.addEventListener("change",this.ya),this.Vs.addEventListener("change",this.ua),this.Us.addEventListener("change",this.ma),this.Gs.addEventListener("change",this.va),this.Ks.addEventListener("change",this.ba),this.Qs.addEventListener("change",this.ga),this.Zs.addEventListener("change",this.wa),this.eh.addEventListener("change",this.xa),this.Cs.addEventListener("click",this.Nh),this.Ls.addEventListener("click",this.Nh),this.Hi.addEventListener("click",this.Ih),this.Gi.addEventListener("click",this._h),this.Yi.addEventListener("click",this.Wh),this.Xi.addEventListener("click",this.Gh),this.Zi.addEventListener("click",this.Qh),this.ts.addEventListener("click",this.Yh),this.ns.addEventListener("click",this.qh),this.ss.addEventListener("click",this.Kh),this.hs.addEventListener("click",this.Jh),this.es.addEventListener("click",this.ea),this.qi.addEventListener("input",this.Hh),this.ds.addEventListener("click",this.Xh),this.ls.addEventListener("click",this.Zh),this.Ys.addEventListener("click",this.ta),this.ps.addEventListener("click",this.ea),this.us.addEventListener("change",this.Th),this.Rs.addEventListener("keydown",this.Oh,!1),this.us.addEventListener("keydown",this.Oh,!1),this.Wi.addEventListener("mousedown",this.Bh),this.mainLayer.addEventListener("keydown",this.Ei),this.dh.addEventListener("click",this.Eh),this.yh.addEventListener("click",this.Rh),vn&&(this.Qi.children[1].disabled=!0)}Dh(t){this.$.openPrompt(t),this.Ph(t)}Ph(t){if(this.prompt&&(this.Ma&&this.Uh(),this.Ma=!1,this.xh.style.display="none",this.xh.removeChild(this.prompt.container),this.prompt.cleanUp(),this.prompt=null,this.mainLayer.focus()),t){switch(t){case"export":this.prompt=new Le(this.$);break;case"import":this.prompt=new Be(this.$);break;case"duration":this.prompt=new Ve(this.$);break;case"archive":case"archive":this.prompt=new Ne(this.$);break;case"instrumentType":this.prompt=new Ye(this.$);break;case"mix":this.prompt=new ye(this.$);break;case"chorus":this.prompt=new be(this.$);break;case"songdata":this.prompt=new De(this.$);break;case"refresh key":this.prompt=new $e(this.$,this,this.ys.selectedIndex);break;case"themes":this.prompt=new Ze(this.$);break;case"songTheme":this.prompt=new an(this.$);break;case"layouts":this.prompt=new dn(this.$);break;default:throw new Error("Unrecognized prompt type.")}this.prompt&&(this.Ma=this.$.synth.playing,this.Vh(),this.xh.style.display="",this.xh.appendChild(this.prompt.container))}}updatePlayButton(){this.$.synth.playing?(this.Hi.classList.remove("playButton"),this.Hi.classList.add("pauseButton"),this.Hi.title="Pause (Space)",this.Hi.innerText="Pause"):(this.Hi.classList.remove("pauseButton"),this.Hi.classList.add("playButton"),this.Hi.title="Play (Space)",this.Hi.innerText="Play")}Uh(){this.$.synth.play(),this.updatePlayButton()}Vh(){this.$.synth.pause(),this.$.prefs.autoFollow?this.$.synth.snapToBar(this.$.bar):this.$.synth.snapToBar(),this.updatePlayButton()}Ah(){const t=this.$.getCurrentPattern();null!=t&&(window.localStorage.setItem("patternCopy",JSON.stringify({notes:t.notes,beatsPerBar:this.$.song.beatsPerBar,partsPerBeat:this.$.song.partsPerBeat,drums:this.$.song.getChannelIsDrum(this.$.channel)})),this.$.record(new vt(this.$,t,[],this.$.song.beatsPerBar,this.$.song.partsPerBeat)))}$h(){const t=this.$.getCurrentPattern();let e=[];null!=t&&(e=t.notes);const n={notes:e,beatsPerBar:this.$.song.beatsPerBar,partsPerBeat:this.$.song.partsPerBeat,drums:this.$.song.getChannelIsDrum(this.$.channel)};window.localStorage.setItem("patternCopy",JSON.stringify(n))}jh(){const t=JSON.parse(String(window.localStorage.getItem("patternCopy")));if(null!=t&&t.drums==this.$.song.getChannelIsDrum(this.$.channel)){new Lt(this.$);const e=this.$.getCurrentPattern();if(null==e)throw new Error;this.$.record(new vt(this.$,e,t.notes,t.beatsPerBar,t.partsPerBeat))}}zh(t){const e=this.$.getCurrentPattern();if(null==e)return;const n=this.$.lastChangeWas(this.Ch);this.Ch=new Vt(this.$,e,t),this.$.record(this.Ch,n)}}class Fn{constructor(){this.Sa=[],this.Fa=!1}watch(t){-1==this.Sa.indexOf(t)&&this.Sa.push(t)}unwatch(t){const e=this.Sa.indexOf(t);-1!=e&&this.Sa.splice(e,1)}changed(){this.Fa=!0}notifyWatchers(){if(this.Fa){this.Fa=!1;for(const t of this.Sa.concat())t()}}}class Bn{constructor(t){this.$=t}muteAllInstruments(){let t=!1;0==this.$.song.channels[this.$.channel].instruments[0].imute&&(t=!0);for(let e=0;e<this.$.song.channels[this.$.channel].instruments.length;e++)this.$.record(new it(this.$,Number(t),e));this.$.notifier.changed()}soloChannels(t){let e=0;for(let n=0;n<this.$.song.channels.length;n++)for(let i=0;i<this.$.song.channels[n].instruments.length;i++)this.$.song.channels[n].instruments[i].imute==(t?0:1)&&n!=this.$.channel&&e++,n!=this.$.channel?this.$.record(new st(this.$,Number(!t),n,i)):this.$.record(new st(this.$,Number(t),n,i));if(e>=this.$.song.pitchChannelCount+this.$.song.drumChannelCount-1)for(let e=0;e<this.$.song.channels.length;e++)for(let n=0;n<this.$.song.channels[e].instruments.length;n++)this.$.record(new st(this.$,Number(t),e,n));this.$.notifier.changed()}insertChannel(){const t=new I,e=this.$.channel,n=this.$.song.getChannelIsDrum(e);t.append(new q(this.$,e+1,n)),t.isNoop()||(t.append(new J(this.$,e,this.$.bar)),this.$.record(t)),!n&&this.$.channel<s.pitchChannelCountMax-1&&this.$.channel++,n&&this.$.channel<s.drumChannelCountMax+this.$.song.pitchChannelCount-1&&this.$.channel++}}class Pn{constructor(){this.autoPlay="true"==localStorage.getItem("autoPlay"),this.autoFollow="true"==localStorage.getItem("autoFollow"),this.showFifth="false"!=localStorage.getItem("showFifth"),this.showMore="true"==localStorage.getItem("showMore"),this.showLetters="false"!=localStorage.getItem("showLetters"),this.showChannels="true"==localStorage.getItem("showChannels"),this.showScrollBar="false"!=localStorage.getItem("showScrollBar"),this.showVolumeBar="true"==localStorage.getItem("showVolumeBar"),this.advancedSettings="false"!=localStorage.getItem("advancedSettings"),this.visibleOctaves=null!=localStorage.getItem("visibleOctaves")?Number(localStorage.getItem("visibleOctaves")):Pn.defaultVisibleOctaves,this.layout=localStorage.getItem("layout")||"small",this.volume=null!=localStorage.getItem("volume")?Number(localStorage.getItem("volume")):75}save(){localStorage.setItem("autoPlay",this.autoPlay?"true":"false"),localStorage.setItem("autoFollow",this.autoFollow?"true":"false"),localStorage.setItem("showFifth",this.showFifth?"true":"false"),localStorage.setItem("showMore",this.showMore?"true":"false"),localStorage.setItem("showLetters",this.showLetters?"true":"false"),localStorage.setItem("showChannels",this.showChannels?"true":"false"),localStorage.setItem("showScrollBar",this.showScrollBar?"true":"false"),localStorage.setItem("showVolumeBar",this.showVolumeBar?"true":"false"),localStorage.setItem("advancedSettings",this.advancedSettings?"true":"false"),localStorage.setItem("visibleOctaves",String(this.visibleOctaves)),localStorage.setItem("volume",String(this.volume))}}Pn.defaultVisibleOctaves=3;class En{constructor(t){this.notifier=new Fn,this.selection=new Bn(this),this.channel=0,this.bar=0,this.trackVisibleBars=16,this.barScrollPos=0,this.prompt=null,this.prefs=new Pn,this.Ba=null,this.Pa=0,this.Ea=0,this.Ra=0,this.Na=!1,this.Ta=!1,this.Oa=()=>{let t=window.history.state;t&&t.sequenceNumber==this.Pa||(null==t?(this.Pa++,t={canUndo:!0,sequenceNumber:this.Pa,bar:this.bar,channel:this.channel,prompt:this.prompt},new Nt(this,location.hash),window.history.replaceState(t,"","#"+this.song.toBase64String())):(t.sequenceNumber==this.Pa-1?(this.bar=this.Ea,this.channel=this.Ra):t.sequenceNumber!=this.Pa&&(this.bar=t.bar,this.channel=t.channel),this.Pa=t.sequenceNumber,this.prompt=t.prompt,new Nt(this,location.hash)),this.Ea=t.bar,this.Ra=t.channel,this.forgetLastChange(),this.notifier.notifyWatchers())},this.Da=()=>{this.notifier.notifyWatchers()},this.Ia=()=>{this.Ta=!1;const t="#"+this.song.toBase64String();let e;this.Na?(this.Pa++,e={canUndo:!0,sequenceNumber:this.Pa,bar:this.bar,channel:this.channel,prompt:this.prompt},window.history.pushState(e,"",t)):(e={canUndo:!0,sequenceNumber:this.Pa,bar:this.bar,channel:this.channel,prompt:this.prompt},window.history.replaceState(e,"",t)),this.Ea=e.bar,this.Ra=e.channel,this.Na=!1},this.song=new T(t),this.synth=new xe(this.song),this.synth.volume=this.Aa(),"none"==this.song.setSongTheme?null!=window.localStorage.getItem("modboxTheme")?Yt.setTheme(String(window.localStorage.getItem("modboxTheme"))):(window.localStorage.setItem("modboxTheme","default"),Yt.setTheme("default")):Yt.setTheme(this.song.setSongTheme),null!=window.localStorage.getItem("layout")?rn.setLayout(String(window.localStorage.getItem("layout"))):(window.localStorage.setItem("layout","small"),rn.setLayout("small"));let e=window.history.state;null==e&&(e={canUndo:!1,sequenceNumber:0,bar:0,channel:0,prompt:null},window.history.replaceState(e,"","#"+this.song.toBase64String())),window.addEventListener("hashchange",this.Oa),window.addEventListener("popstate",this.Oa),this.bar=e.bar,this.channel=e.channel,this.Ea=e.bar,this.Ra=e.channel,this.barScrollPos=Math.max(0,this.bar-(this.trackVisibleBars-6)),this.prompt=e.prompt;for(const t of["input","change","click","keyup","keydown","mousedown","mousemove","mouseup","touchstart","touchmove","touchend","touchcancel"])window.addEventListener(t,this.Da)}record(t,e=!1){t.isNoop()?(this.Ba=null,e&&window.history.back()):(this.Ba=t,e||(this.Na=!0),this.Ta||(window.requestAnimationFrame(this.Ia),this.Ta=!0))}openPrompt(t){this.prompt=t;const e="#"+this.song.toBase64String();this.Pa++;const n={canUndo:!0,sequenceNumber:this.Pa,bar:this.bar,channel:this.channel,prompt:this.prompt};window.history.pushState(n,"",e)}undo(){window.history.state.canUndo&&window.history.back()}redo(){window.history.forward()}setProspectiveChange(t){this.Ba=t}forgetLastChange(){this.Ba=null}lastChangeWas(t){return null!=t&&t==this.Ba}setVolume(t){this.prefs.volume=t,this.prefs.save(),this.synth.volume=this.Aa()}getMobileLayout(){return window.innerWidth<=710}getFullScreen(){return!this.getMobileLayout()&&"small"!=this.prefs.layout}Aa(){return Math.min(1,Math.pow(this.prefs.volume/50,.5))*Math.pow(2,(this.prefs.volume-75)/25)}getCurrentPattern(){return this.song.getPattern(this.channel,this.bar)}getCurrentInstrument(){const t=this.getCurrentPattern();return null==t?0:t.instrument}getVisibleOctaveCount(){return this.prefs.visibleOctaves}getVisiblePitchCount(){return this.getVisibleOctaveCount()*s.pitchesPerOctave+1}getBaseVisibleOctave(t){return this.song.channels[t].octave}}document.head.appendChild(u.style({type:"text/css"},`\n\n:root {\n--drum-symbol: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="40" viewBox="0 0 32 40"> \t\t\t<defs> \t\t\t\t<linearGradient id="gold1" x1="0%" y1="0%" x2="100%" y2="0%"> \t\t\t\t\t<stop offset="0%" stop-color="%237e3302"/> \t\t\t\t\t<stop offset="40%" stop-color="%23ffec6b"/> \t\t\t\t\t<stop offset="100%" stop-color="%237e3302"/> \t\t\t\t</linearGradient> \t\t\t\t<linearGradient id="gold2" x1="0%" y1="0%" x2="100%" y2="0%"> \t\t\t\t\t<stop offset="0%" stop-color="%23faaf7d"/> \t\t\t\t\t<stop offset="15%" stop-color="%23fffba9"/> \t\t\t\t\t<stop offset="40%" stop-color="%23ffffe3"/> \t\t\t\t\t<stop offset="65%" stop-color="%23fffba9"/> \t\t\t\t\t<stop offset="100%" stop-color="%23faaf7d"/> \t\t\t\t</linearGradient> \t\t\t\t<radialGradient id="gold3" cx="0%" cy="0%" r="100%"> \t\t\t\t\t<stop offset="0%" stop-color="%23ffffe3"/> \t\t\t\t\t<stop offset="50%" stop-color="%23ffec6b"/> \t\t\t\t\t<stop offset="100%" stop-color="%237e3302"/> \t\t\t\t</radialGradient> \t\t\t\t<linearGradient id="red" x1="0%" y1="0%" x2="100%" y2="0%"> \t\t\t\t\t<stop offset="0%" stop-color="%23641919"/> \t\t\t\t\t<stop offset="40%" stop-color="%23cd2c2c"/> \t\t\t\t\t<stop offset="100%" stop-color="%23641919"/> \t\t\t\t</linearGradient> \t\t\t\t<radialGradient id="membrane"> \t\t\t\t\t<stop offset="10%" stop-color="%23cccccc" /> \t\t\t\t\t<stop offset="90%" stop-color="%23f6f6f7" /> \t\t\t\t\t<stop offset="100%" stop-color="%23999" /> \t\t\t\t</radialGradient> \t\t\t</defs> \t\t\t<ellipse cx="16" cy="26" rx="16" ry="14" fill="rgba(0,0,0,0.5)"/> \t\t\t<ellipse cx="16" cy="25" rx="16" ry="14" fill="url(%23gold1)"/> \t\t\t<rect x="0" y="23" width="32" height="2" fill="url(%23gold1)"/> \t\t\t<ellipse cx="16" cy="23" rx="16" ry="14" fill="url(%23gold2)"/> \t\t\t<ellipse cx="16" cy="23" rx="15" ry="13" fill="url(%23red)"/> \t\t\t<rect x="1" y="17" width="30" height="6" fill="url(%23red)"/> \t\t\t<rect x="5" y="27" width="1" height="5" rx="0.5" fill="rgba(0,0,0,0.5)"/> \t\t\t<rect x="15" y="31" width="2" height="5" rx="1" fill="rgba(0,0,0,0.5)"/> \t\t\t<rect x="26" y="27" width="1" height="5" rx="0.5" fill="rgba(0,0,0,0.5)"/> \t\t\t<rect x="5" y="26" width="1" height="5" rx="0.5" fill="url(%23gold3)"/> \t\t\t<rect x="15" y="30" width="2" height="5" rx="1" fill="url(%23gold3)"/> \t\t\t<rect x="26" y="26" width="1" height="5" rx="0.5" fill="url(%23gold3)"/> \t\t\t<ellipse cx="16" cy="18" rx="15" ry="13" fill="rgba(0,0,0,0.5)"/> \t\t\t<ellipse cx="16" cy="16" rx="16" ry="14" fill="url(%23gold1)"/> \t\t\t<rect x="0" y="14" width="32" height="2" fill="url(%23gold1)"/> \t\t\t<ellipse cx="16" cy="14" rx="16" ry="14" fill="url(%23gold2)"/> \t\t\t<ellipse cx="16" cy="14" rx="15" ry="13" fill="url(%23membrane)"/> \t\t</svg>');\n\t--piano-key-symbol: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="15" preserveAspectRatio="none" viewBox="0 -1 32 15"> \t\t\t<defs> \t\t\t\t<linearGradient id="shadow" x1="0%" y1="0%" x2="100%" y2="0%"> \t\t\t\t\t<stop offset="0%" stop-color="rgba(0,0,0,0.5)"/> \t\t\t\t\t<stop offset="100%" stop-color="transparent"/> \t\t\t\t</linearGradient> \t\t\t</defs> \t\t\t<rect x="-1" y="1" width="31" height="1" rx="0.6" fill="rgba(255,255,255,0.4)"/> \t\t\t<path d="M -1 11 L 30 11 L 30 2 L 33 -1 L 33 14 L -1 14 z" fill="rgba(0,0,0,0.7)"/> \t\t\t<rect x="-1" y="-1" width="19" height="15" fill="url(%23shadow)"/> \t\t</svg>');\n}\n\nhtml {\nbackground: ${Yt.pageMargin};\n}\n\n.beepboxEditor .drum-button {\n\tflex: 1;\n\tbackground-color: transparent;\n\tbackground-image: var(--drum-symbol);\n\tbackground-repeat: no-repeat;\n\tbackground-position: center;\n}\n\n.beepboxEditor .piano-button.pressed, .beepboxEditor .drum-button.pressed {\n\tfilter: brightness(0.5);\n}\n\n.beepboxEditor .piano-button {\n\tflex: 1;\n\tposition: relative;\n\tdisplay: flex;\n\talign-items: center;\n}\n.beepboxEditor .piano-button::before {\n\tcontent: "";\n\tposition: absolute;\n\tleft: 0;\n\ttop: 0;\n\twidth: 100%;\n\theight: 100%;\n\tpointer-events: none;\n\tbackground-image: var(--piano-key-symbol);\n\tbackground-repeat: no-repeat;\n\tbackground-position: center;\n\tbackground-size: 100% 115.38%;\n}\n.beepboxEditor .piano-button.disabled::after {\n\tcontent: "";\n\tposition: absolute;\n\tright: 0;\n\ttop: 0;\n\twidth: 70%;\n\theight: 100%;\n\tpointer-events: none;\n\tbackground: ${Yt.editorBackground};\n\t-webkit-mask-image: linear-gradient(90deg, transparent 0%, gray 70%, gray 100%);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n\tmask-image: linear-gradient(90deg, transparent 0%, gray 70%, gray 100%);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n}\n\n.beepboxEditor .piano-button.pressed, .beepboxEditor .drum-button.pressed {\n\tfilter: brightness(0.5);\n}\n\n.beepboxEditor {\n\tdisplay: grid;\n\tgrid-template-areas: "pattern-area settings-area advanced-settings-area" "pattern-area   song-settings-area advanced-settings-area" "track-area   song-settings-area advanced-settings-area";\n\t-webkit-touch-callout: none;\n\t-webkit-user-select: none;\n\t-khtml-user-select: none;\n\t-moz-user-select: none;\n\t-ms-user-select: none;\n\tuser-select: none;\n\tposition: relative;\n\ttouch-action: manipulation;\n\tcursor: default;\n\tfont-size: small;\n\tbackground: ${Yt.editorBackground};\n}\n\n.beepboxEditor .theme-option input:checked ~ * {\n\tcolor: #fff;\n}\n\n.beepboxEditor .theme-option {\n\tcolor: #999;\n}\n\n\n.hintButton {\n\twidth: 0.5em; \n\tdisplay: flex; \n\talign-items: center;\n}\n\n.beepboxEditor div {\n\tmargin: 0;\n\tpadding: 0;\n}\n\n.beepboxEditor .promptContainer {\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n\t/*background: rgba(0,0,0,0.5);*/\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n}\n\n.beepboxEditor .prompt {\n\tmargin: auto;\n\ttext-align: center;\n\tbackground: ${Yt.editorBackground};\n\tborder-radius: 15px;\n\tborder: 4px solid #444;\n\tcolor: #fff;\n\tpadding: 20px;\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.beepboxEditor .prompt > *:not(:first-child) {\n\tmargin-top: 1.5em;\n}\n\n/* Use psuedo-elements to add cross-browser up & down arrows to select elements: */\n.beepboxEditor .selectContainer {\n\tposition: relative;\n\twidth: 100%;\n}\n.beepboxEditor .selectContainer:not(.menu)::before {\n\tcontent: "";\n\tposition: absolute;\n\tright: 0.3em;\n\ttop: 0.4em;\n\tborder-bottom: 0.4em solid currentColor;\n\tborder-left: 0.3em solid transparent;\n\tborder-right: 0.3em solid transparent;\n\tpointer-events: none;\n}\n.beepboxEditor .selectContainer:not(.menu)::after {\n\tcontent: "";\n\tposition: absolute;\n\tright: 0.3em;\n\tbottom: 0.4em;\n\tborder-top: 0.4em solid currentColor;\n\tborder-left: 0.3em solid transparent;\n\tborder-right: 0.3em solid transparent;\n\tpointer-events: none;\n}\n.beepboxEditor .selectContainer.menu::after {\n\tcontent: "";\n\tposition: absolute;\n\tright: 0.7em;\n\tmargin: auto;\n\ttop: 0;\n\tbottom: 0;\n\theight: 0;\n\tborder-top: 0.4em solid currentColor;\n\tborder-left: 0.3em solid transparent;\n\tborder-right: 0.3em solid transparent;\n\tpointer-events: none;\n}\n.beepboxEditor select {\n\tmargin: 0;\n\tpadding: 0 0.3em;\n\tdisplay: block;\n\theight: 2em;\n\tborder: none;\n\tborder-radius: 0.4em;\n\tbackground: ${Yt.uiWidgetBackground};\n\tcolor: inherit;\n\tfont-size: inherit;\n\tcursor: pointer;\n\tfont-family: inherit;\n\n\twidth:100%;\n\n\t-webkit-appearance:none;\n\t-moz-appearance: none;\n\tappearance: none;\n}\n.beepboxEditor .menu select {\n\tpadding: 0 2em;\n}\n.beepboxEditor select:focus {\n\tbackground: ${Yt.uiWidgetFocus};\n\toutline: none;\n}\n.beepboxEditor .menu select {\n\ttext-align: center;\n\ttext-align-last: center;\n}\n\n/* This makes it look better in firefox on my computer... What about others?\n@-moz-document url-prefix() {\n\t.beepboxEditor select { padding: 0 2px; }\n}\n*/\n.beepboxEditor button {\n\tmargin: 0;\n\tposition: relative;\n\theight: 2em;\n\tborder: none;\n\tborder-radius: 0.4em;\n\tbackground: ${Yt.uiWidgetBackground};\n\tcolor: inherit;\n\tfont-size: inherit;\n\tfont-family: inherit;\n\tcursor: pointer;\n}\n.beepboxEditor .numberInput {\n\twidth: 3em !important;\n  \tmargin-left: 1em;\n}\n.beepboxEditor button:focus {\n\tbackground: ${Yt.uiWidgetFocus};\n\toutline: none;\n}\n.beepboxEditor button.playButton, .beepboxEditor button.pauseButton {\n\tpadding-left: 2em;\n}\n.beepboxEditor button.playButton::before {\n\tcontent: "";\n\tposition: absolute;\n\tleft: 0.7em;\n\ttop: 50%;\n\tmargin-top: -0.65em;\n\tborder-left: 1em solid currentColor;\n\tborder-top: 0.65em solid transparent;\n\tborder-bottom: 0.65em solid transparent;\n\tpointer-events: none;\n}\n.beepboxEditor button.pauseButton::before {\n\tcontent: "";\n\tposition: absolute;\n\tleft: 0.7em;\n\ttop: 50%;\n\tmargin-top: -0.65em;\n\twidth: 0.3em;\n\theight: 1.3em;\n\tbackground: currentColor;\n\tpointer-events: none;\n}\n.beepboxEditor button.pauseButton::after {\n\tcontent: "";\n\tposition: absolute;\n\tleft: 1.4em;\n\ttop: 50%;\n\tmargin-top: -0.65em;\n\twidth: 0.3em;\n\theight: 1.3em;\n\tbackground: currentColor;\n\tpointer-events: none;\n}\n\n.beepboxEditor button.prevBarButton::before {\n\tcontent: "";\n\tposition: absolute;\n\tleft: 50%;\n\ttop: 50%;\n\tmargin-left: -0.5em;\n\tmargin-top: -0.5em;\n\twidth: 0.2em;\n\theight: 1em;\n\tbackground: currentColor;\n\tpointer-events: none;\n}\n.beepboxEditor button.prevBarButton::after {\n\tcontent: "";\n\tposition: absolute;\n\tleft: 50%;\n\ttop: 50%;\n\tmargin-left: -0.3em;\n\tmargin-top: -0.5em;\n\tborder-right: 0.8em solid currentColor;\n\tborder-top: 0.5em solid transparent;\n\tborder-bottom: 0.5em solid transparent;\n\tpointer-events: none;\n}\n\n.beepboxEditor .song-settings-area {\n\tgrid-area: song-settings-area;\n}\n\n.beepboxEditor button.nextBarButton::before {\n\tcontent: "";\n\tposition: absolute;\n\tleft: 50%;\n\ttop: 50%;\n\tmargin-left: -0.5em;\n\tmargin-top: -0.5em;\n\tborder-left: 0.8em solid currentColor;\n\tborder-top: 0.5em solid transparent;\n\tborder-bottom: 0.5em solid transparent;\n\tpointer-events: none;\n}\n.beepboxEditor button.nextBarButton::after {\n\tcontent: "";\n\tposition: absolute;\n\tleft: 50%;\n\ttop: 50%;\n\tmargin-left: 0.3em;\n\tmargin-top: -0.5em;\n\twidth: 0.2em;\n\theight: 1em;\n\tbackground: currentColor;\n\tpointer-events: none;\n}\n\n.beepboxEditor canvas {\n\toverflow: hidden;\n\tposition: absolute;\n\tdisplay: block;\n}\n\n.beepboxEditor .trackContainer {\n\toverflow-x: hidden;\n}\n\n.beepboxEditor .trackAndMuteContainer {\n\tdisplay: flex;\n\talign-items: flex-start;\n\twidth: 100%;\n\tmin-height: 0;\n\tflex: 1;\n\toverflow-x: hidden;\n\tposition: relative;\n}\n\n.beepboxEditor .selectRow {\n\tmargin: 0;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tjustify-content: space-between;\n}\n\n.beepboxEditor .selectRow > span {\n\tcolor: ${Yt.secondaryText};\n}\n\n.beepboxEditor .inputRow {\n\tmargin: 0;\n\theight: 2.5em;\n\tdisplay: flex;\n\tflex-direction: row;\n\talign-items: center;\n\tjustify-content: space-between;\n}\n\n.beepboxEditor .inputRow > span {\n\tcolor: ${Yt.secondaryText};\n}\n\n.beepboxEditor .operatorRow {\n\tmargin: 0;\n\theight: 2.5em;\n\tdisplay: flex;\n\tflex-direction: row;\n\talign-items: center;\n}\n\n.beepboxEditor .operatorRow > * {\n\tflex-grow: 1;\n\tflex-shrink: 1;\n}\n\n.beepboxEditor .settings-area {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.beepboxEditor .editor-widgets {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.beepboxEditor .editor-menus {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.beepboxEditor .editor-settings {\n\tdisplay: flex;\n\tflex-direction: column;\n\tmargin-left: 6px;\n}\n\n.beepboxEditor .layout-option {\n\tdisplay: flex;\n\tflex-direction: column;\n\tcursor: pointer;\n\tcolor: ${Yt.secondaryText};\n\twidth: 25%;\n}\n\n.beepboxEditor .layout-option input {\n\tdisplay: none;\n}\n\n.beepboxEditor .layout-option input:checked ~ * {\n\tcolor: ${Yt.primaryText};\n}\n\n.beepboxEditor .editor-song-settings {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.beepboxEditor .editor-instrument-settings {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n.beepboxEditor .advanced-settings-area {\n\tdisplay: flex;\n\tflex-direction: column;\n\tgrid-area: advanced-settings-area;\n}\n\n.beepboxEditor .editorBox {\n\tgrid-area: pattern-area;\n}\n\n.beepboxEditor .track-area {\n\tgrid-area: track-area;\n}\n\n.beepboxEditor .editor-right-menus {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.beepboxEditor .editor-right-settings {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.beepboxEditor .editor-right-song-settings {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.beepboxEditor .editor-right-instrument-settings {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.beepboxEditor .editor-right-side-top > *, .beepboxEditor .editor-right-side-bottom > * {\n\tflex-shrink: 0;\n}\n\n.beepboxEditor input[type=text], .beepboxEditor input[type=number] {\n\tfont-size: inherit;\n\tbackground: transparent;\n\tborder: 1px solid #777;\n\tcolor: white;\n}\n\n.beepboxEditor input[type=checkbox] {\n  transform: scale(1.5);\n}\n\n.beepboxEditor input[type=range] {\n\t-webkit-appearance: none;\n\tcolor: inherit;\n\twidth: 100%;\n\theight: 2em;\n\tfont-size: inherit;\n\tmargin: 0;\n\tcursor: pointer;\n\tbackground-color: ${Yt.editorBackground};\n\ttouch-action: pan-y;\n}\n.beepboxEditor input[type=range]:focus {\n\toutline: none;\n}\n.beepboxEditor input[type=range]::-webkit-slider-runnable-track {\n\twidth: 100%;\n\theight: 0.5em;\n\tcursor: pointer;\n\tbackground: ${Yt.uiWidgetBackground};\n}\n.beepboxEditor input[type=range]::-webkit-slider-thumb {\n\theight: 2em;\n\twidth: 0.5em;\n\tborder-radius: 0.25em;\n\tbackground: currentColor;\n\tcursor: pointer;\n\t-webkit-appearance: none;\n\tmargin-top: -0.75em;\n}\n.beepboxEditor input[type=range]:focus::-webkit-slider-runnable-track {\n\tbackground: ${Yt.uiWidgetFocus};\n}\n.beepboxEditor input[type=range]::-moz-range-track {\n\twidth: 100%;\n\theight: 0.5em;\n\tcursor: pointer;\n\tbackground: ${Yt.uiWidgetBackground};\n}\n.beepboxEditor input[type=range]:focus::-moz-range-track {\n\tbackground: ${Yt.uiWidgetFocus};\n}\n.beepboxEditor input[type=range]::-moz-range-thumb {\n\theight: 2em;\n\twidth: 0.5em;\n\tborder-radius: 0.25em;\n\tborder: none;\n\tbackground: currentColor;\n\tcursor: pointer;\n}\n.beepboxEditor input[type=range]::-ms-track {\n\twidth: 100%;\n\theight: 0.5em;\n\tcursor: pointer;\n\tbackground: ${Yt.uiWidgetBackground};\n\tborder-color: transparent;\n}\n.beepboxEditor input[type=range]:focus::-ms-track {\n\tbackground: ${Yt.uiWidgetFocus};\n}\n.beepboxEditor input[type=range]::-ms-thumb {\n\theight: 2em;\n\twidth: 0.5em;\n\tborder-radius: 0.25em;\n\tbackground: currentColor;\n\tcursor: pointer;\n}\n.beepboxEditor .hintButton {\n\tborder: 1px solid currentColor;\n\tborder-radius: 50%;\n\ttext-decoration: none;\n\theight: 1em;\n\ttext-align: center;\n\tmargin-right: .4em;\n\tcursor: pointer;\n}\n\n/* wide screen */\n@media (min-width: 501px) {\n\t#beepboxEditorContainer {\n\t\tdisplay: table;\n\t}\n\t.beepboxEditor {\n\t\tflex-direction: row;\n\t}\n\t.beepboxEditor:focus-within {\n\t\toutline: 3px solid #555;\n\t}\n\t.beepboxEditor .trackContainer {\n\t\twidth: 512px;\n\t\tgrid-area: track-editor;\n\t}\n\t.beepboxEditor .trackSelectBox {\n\t\tdisplay: none;\n\t}\n\t.beepboxEditor .playback-controls {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t}\n\t.beepboxEditor .playback-bar-controls {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tmargin: .2em 0;\n\t}\n\t.beepboxEditor .playback-volume-controls {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tmargin: .2em 0;\n\t\talign-items: center;\n\t}\n\t.beepboxEditor .pauseButton, .beepboxEditor .playButton {\n\t\tflex-grow: 1;\n\t}\n\t.beepboxEditor .nextBarButton, .beepboxEditor .prevBarButton {\n\t\tflex-grow: 1;\n\t\tmargin-left: 10px;\n\t}\n\t.beepboxEditor .settings-area {\n\t\tmargin-left: 6px;\n\t\twidth: 14em;\n\t\tflex-direction: column;\n\t\tgrid-area: settings-area;\n\t}\n\t.beepboxEditor .advanced-settings-area {\n\t\tmargin-left: 6px;\n\t\twidth: 14em;\n\t\tflex-direction: column;\n\t}\n\t.beepboxEditor .editor-widgets {\n\t\tflex-grow: 1;\n\t}\n\t.beepboxEditor .editor-right-widgets {\n\t\tflex-grow: 1;\n\t}\n\t.beepboxEditor .editor-right-settings input, .beepboxEditor .editor-right-settings select {\n\t\twidth: 100%;\n\t}\n\t.beepboxEditor .editor-menus > * {\n\t\tflex-grow: 1;\n\t\tmargin: .2em 0;\n\t}\n\t.beepboxEditor .editor-right-menus > * {\n\t\tflex-grow: 1;\n\t\tmargin: .2em 0;\n\t}\n\t.beepboxEditor .editor-menus > button {\n\t\tpadding: 0 2em;\n\t\twhite-space: nowrap;\n\t}\n\t.beepboxEditor .editor-right-menus > button {\n\t\tpadding: 0 2em;\n\t\twhite-space: nowrap;\n\t}\n}\n\n/* narrow screen */\n@media (max-width: 500px) {\n\t.beepboxEditor {\n\t\tflex-direction: column;\n\t}\n\t.beepboxEditor:focus-within {\n\t\toutline: none;\n\t}\n\t.beepboxEditor .editorBox {\n\t\tmax-height: 75vh;\n\t\tgrid-area: pattern-area;\n\t}\n\t.beepboxEditor .editor-menus {\n\t\tflex-direction: row;\n\t}\n\t.beepboxEditor .editor-right-menus {\n\t\tflex-direction: row;\n\t}\n\t.beepboxEditor .editor-menus > * {\n\t\tflex-grow: 1;\n\t\tmargin: .10em;\n\t}\n\t.beepboxEditor .editor-right-menus > * {\n\t\tflex-grow: 1;\n\t\tmargin: .2em;\n\t}\n\t.beepboxEditor .editor-menus > button {\n\t\tpadding-left: 2em;\n\t\twhite-space: nowrap;\n\t}\n\t.beepboxEditor .editor-right-menus > button {\n\t\tpadding-left: 2em;\n\t\twhite-space: nowrap;\n\t}\n\t.beepboxEditor .trackContainer {\n\t\toverflow-x: auto;\n\t}\n\t.beepboxEditor .barScrollBar {\n\t\tdisplay: none;\n\t}\n\t.beepboxEditor .playback-controls {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tmargin: .2em 0;\n\t}\n\t.beepboxEditor .playback-bar-controls {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tflex-grow: 1;\n\t}\n\t.beepboxEditor .playback-volume-controls {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\talign-items: center;\n\t\tflex-grow: 1;\n\t\tmargin: 0 .2em;\n\t}\n\t.beepboxEditor .settings-area {\n\t\tflex-direction: column-reverse;\n\t}\n\t.beepboxEditor .editor-settings {\n\t\tflex-direction: row;\n\t\tmargin-left: 6px;\n\t}\n\t.beepboxEditor .advanced-settings-area {\n\t\tflex-direction: column-reverse;\n\t}\n\t.beepboxEditor .editor-right-settings {\n\t\tflex-direction: row;\n\t}\n\t.beepboxEditor .pauseButton, .beepboxEditor .playButton,\n\t.beepboxEditor .nextBarButton, .beepboxEditor .prevBarButton {\n\t\tflex-grow: 1;\n\t\tmargin: 0 .2em;\n\t}\n\t.beepboxEditor .editor-song-settings, .beepboxEditor .editor-instrument-settings {\n\t\tflex-grow: 1;\n\t\tmargin: 0 .2em;\n\t}\n\t.beepboxEditor .editor-right-song-settings, .beepboxEditor .editor-right-instrument-settings {\n\t\tflex-grow: 1;\n\t\tmargin: 0 .2em;\n\t}\n\t.beepboxEditor .editor-settings input, .beepboxEditor .editor-settings .selectContainer {\n\t\twidth: 100%;\n\t}\n\t.beepboxEditor .editor-right-settings input, .beepboxEditor .editor-right-settings .selectContainer {\n\t\twidth: 100%;\n\t}\n\t.beepboxEditor .editor-settings select {\n\t\twidth: 100%;\n\t}\n\t.beepboxEditor .editor-right-settings select {\n\t\twidth: 100%;\n\t}\n\t.fullWidthOnly {\n\t\tdisplay: none;\n\t}\n\tp {\n\t\tmargin: 1em 0.5em;\n\t}\n}\n`));const Rn=new En(location.hash),Nn=new Sn(Rn);if(document.getElementById("beepboxEditorContainer").appendChild(Nn.mainLayer),Nn.whenUpdated(),Nn.mainLayer.focus(),!vn&&Rn.prefs.autoPlay){function Dn(){document.hidden||(Rn.synth.play(),Nn.updatePlayButton(),window.removeEventListener("visibilitychange",Dn))}document.hidden?window.addEventListener("visibilitychange",Dn):Dn()}return"scrollRestoration"in history&&(history.scrollRestoration="manual"),Nn.updatePlayButton(),"serviceWorker"in navigator&&navigator.serviceWorker.register("/service_worker.js",{updateViaCache:"all",scope:"/"}).catch((()=>{})),t.Channel=R,t.Config=s,t.ExportPrompt=Le,t.Instrument=E,t.Pattern=N,t.Song=T,t.SongDocument=En,t.SongEditor=Sn,t.Synth=xe,Object.defineProperty(t,"$a",{value:!0}),t}({});
//# sourceMappingURL=beepbox_editor.min.js.map